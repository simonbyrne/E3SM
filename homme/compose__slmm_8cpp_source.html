<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Homme: src/share/compose/compose_slmm.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Homme
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('compose__slmm_8cpp_source.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">compose_slmm.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="compose__slmm_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="preprocessor">#include &lt;mpi.h&gt;</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160; </div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">// Uncomment this to look for MPI-related memory leaks.</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">//#define COMPOSE_DEBUG_MPI</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160; </div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">//&gt; begin SIQK</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">// To make this initial integration less messy, inline SIQK in this translation</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">// unit. Once we&#39;ve put together the Compose library, I&#39;ll remove this code.</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160; </div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="preprocessor">#ifndef INCLUDE_SIQK_DEFS_HPP</span></div>
<div class="line"><a name="l00011"></a><span class="lineno"><a class="line" href="compose__slmm_8cpp.html#a818a5d9b46e56ed40ddcfbb72b258eff">   11</a></span>&#160;<span class="preprocessor">#define INCLUDE_SIQK_DEFS_HPP</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160; </div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="preprocessor">#include &lt;cmath&gt;</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">#include &lt;cassert&gt;</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#include &lt;cstring&gt;</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#include &lt;sstream&gt;</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160; </div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#ifdef _OPENMP</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor"># include &lt;omp.h&gt;</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160; </div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#include &lt;Kokkos_Core.hpp&gt;</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160; </div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#ifdef SIQK_TIME</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor"># include &lt;unistd.h&gt;</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor"># include &lt;sys/time.h&gt;</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor"># include &lt;sys/resource.h&gt;</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160; </div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment">// Always want this for GPU.</span></div>
<div class="line"><a name="l00032"></a><span class="lineno"><a class="line" href="compose__slmm_8cpp.html#a5c2c8c68c10006186374df743b42bc8a">   32</a></span>&#160;<span class="preprocessor">#define SIQK_NONRECURSIVE</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160; </div>
<div class="line"><a name="l00034"></a><span class="lineno"><a class="line" href="namespacesiqk.html">   34</a></span>&#160;<span class="keyword">namespace </span><a class="code" href="namespacesiqk.html">siqk</a> {</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespace_kokkos.html">ko</a> = <a class="code" href="namespace_kokkos.html">Kokkos</a>;</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160; </div>
<div class="line"><a name="l00037"></a><span class="lineno"><a class="line" href="compose__slmm_8cpp.html#a62f071f9019b2263ed76a35f753af003">   37</a></span>&#160;<span class="preprocessor">#define pr(m) do {                                          \</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="preprocessor">    int _pid_ = 0;                                          \</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="preprocessor">    MPI_Comm_rank(MPI_COMM_WORLD, &amp;_pid_);                  \</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="preprocessor">    std::stringstream _ss_;                                 \</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="preprocessor">    _ss_.precision(15);                                     \</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="preprocessor">    _ss_ &lt;&lt; &quot;slmm: pid &quot;</span> &lt;&lt; _pid_ &lt;&lt; &quot; &quot; &lt;&lt; m &lt;&lt; std::endl; \</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    std::cerr &lt;&lt; _ss_.str();                                \</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;  } while (0)</div>
<div class="line"><a name="l00045"></a><span class="lineno"><a class="line" href="compose__slmm_8cpp.html#aee1c2a81a0aaa758fb41ff058dd320bb">   45</a></span>&#160;<span class="preprocessor">#define prc(m) pr(#m &lt;&lt; &quot; | &quot;</span> &lt;&lt; (m))</div>
<div class="line"><a name="l00046"></a><span class="lineno"><a class="line" href="compose__slmm_8cpp.html#a006202302bcd05004f5b38e2e252090f">   46</a></span>&#160;<span class="preprocessor">#define puf(m)&quot;(&quot;</span> &lt;&lt; #m &lt;&lt; &quot; &quot; &lt;&lt; (m) &lt;&lt; &quot;)&quot;</div>
<div class="line"><a name="l00047"></a><span class="lineno"><a class="line" href="compose__slmm_8cpp.html#acb74fbfd99a1989babb83fdaa6bfe4c5">   47</a></span>&#160;<span class="preprocessor">#define pu(m) &lt;&lt; &quot; &quot;</span> &lt;&lt; puf(m)</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> prarr (<span class="keyword">const</span> std::string&amp; name, <span class="keyword">const</span> T* <span class="keyword">const</span> v, <span class="keyword">const</span> <span class="keywordtype">size_t</span> n) {</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;  std::stringstream ss;</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;  ss &lt;&lt; name &lt;&lt; <span class="stringliteral">&quot;: &quot;</span>;</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; n; ++i) ss &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; v[i];</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;  <a class="code" href="compose__slmm_8cpp.html#a62f071f9019b2263ed76a35f753af003">pr</a>(ss.str());</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;}</div>
<div class="line"><a name="l00055"></a><span class="lineno"><a class="line" href="compose__slmm_8cpp.html#a7c3c704df71e1a19ad95990aa8120aa0">   55</a></span>&#160;<span class="preprocessor">#define mprarr(m) siqk::prarr(#m, m.data(), m.size())</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160; </div>
<div class="line"><a name="l00057"></a><span class="lineno"><a class="line" href="compose__slmm_8cpp.html#a8260a722be35e2170c71931caf67cec0">   57</a></span>&#160;<span class="preprocessor">#define SIQK_THROW_IF(condition, message) do {                          \</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="preprocessor">    if (condition) {                                                    \</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="preprocessor">      std::stringstream _ss_;                                           \</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="preprocessor">      _ss_ &lt;&lt; __FILE__ &lt;&lt; &quot;:&quot;</span> &lt;&lt; __LINE__ &lt;&lt; &quot;: The condition:\n&quot; &lt;&lt; #condition \</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;        &quot;\nled to the exception\n&quot; &lt;&lt; message &lt;&lt; &quot;\n&quot;;                  \</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;        throw std::logic_error(_ss_.str());                             \</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    }                                                                   \</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;  } while (0)</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160; </div>
<div class="line"><a name="l00066"></a><span class="lineno"><a class="line" href="compose__slmm_8cpp.html#a8418a1d3ad58ce9f382797071c2f0f58">   66</a></span>&#160;<span class="preprocessor">#define SIQK_STDERR_IF(condition, message) do {                   \</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="preprocessor">    try { SIQK_THROW_IF(condition, message); }                    \</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="preprocessor">    catch (const std::logic_error&amp; e) { std::cerr &lt;&lt; e.what(); }  \</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="preprocessor">  } while (0)</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160; </div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;KOKKOS_INLINE_FUNCTION <span class="keyword">static</span> <span class="keywordtype">void</span> error (<span class="keyword">const</span> <span class="keywordtype">char</span>* <span class="keyword">const</span> msg)</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;{ ko::abort(msg); }</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160; </div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;KOKKOS_INLINE_FUNCTION <span class="keyword">static</span> <span class="keywordtype">void</span> message (<span class="keyword">const</span> <span class="keywordtype">char</span>* <span class="keyword">const</span> msg)</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;{ printf(<span class="stringliteral">&quot;%s\n&quot;</span>, msg); }</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160; </div>
<div class="line"><a name="l00077"></a><span class="lineno"><a class="line" href="namespacesiqk.html#a04b40b29b12c447399a02e3c1575bf66">   77</a></span>&#160;<span class="keyword">typedef</span> <span class="keywordtype">int</span> <a class="code" href="namespacesiqk.html#a04b40b29b12c447399a02e3c1575bf66">Int</a>;</div>
<div class="line"><a name="l00078"></a><span class="lineno"><a class="line" href="namespacesiqk.html#a6694847e2d56e697aa08277444325083">   78</a></span>&#160;<span class="keyword">typedef</span> <span class="keywordtype">double</span> <a class="code" href="namespacesiqk.html#a6694847e2d56e697aa08277444325083">Real</a>;</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160; </div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="preprocessor">#ifdef KOKKOS_HAVE_CUDA</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="keyword">typedef</span> ko::LayoutLeft <a class="code" href="namespacesiqk.html#a69f02f046f299342da612da59b028644">Layout</a>;</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00083"></a><span class="lineno"><a class="line" href="namespacesiqk.html#a69f02f046f299342da612da59b028644">   83</a></span>&#160;<span class="keyword">typedef</span> ko::LayoutRight <a class="code" href="namespacesiqk.html#a69f02f046f299342da612da59b028644">Layout</a>;</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160; </div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="comment">// SIQK&#39;s array types.</span></div>
<div class="line"><a name="l00087"></a><span class="lineno"><a class="line" href="namespacesiqk.html#a0cb103a46b9c7a9a03cb45e98c34ccc6">   87</a></span>&#160;<span class="keyword">typedef</span> ko::View&lt;Real*[3], Layout&gt; <a class="code" href="namespacesiqk.html#a0cb103a46b9c7a9a03cb45e98c34ccc6">Vec3s</a>;</div>
<div class="line"><a name="l00088"></a><span class="lineno"><a class="line" href="namespacesiqk.html#a1c336be63fc7e99dd624e19821374c89">   88</a></span>&#160;<span class="keyword">typedef</span> ko::View&lt;const Real*[3], Layout&gt; <a class="code" href="namespacesiqk.html#a1c336be63fc7e99dd624e19821374c89">ConstVec3s</a>;</div>
<div class="line"><a name="l00089"></a><span class="lineno"><a class="line" href="namespacesiqk.html#a2027be93ed31a13bb0fa99ad96f05236">   89</a></span>&#160;<span class="keyword">typedef</span> ko::View&lt;Real*[6], Layout&gt; <a class="code" href="namespacesiqk.html#a2027be93ed31a13bb0fa99ad96f05236">Vec6s</a>;</div>
<div class="line"><a name="l00090"></a><span class="lineno"><a class="line" href="namespacesiqk.html#a7276fa86dc33f28f66f7b76d5225f6f7">   90</a></span>&#160;<span class="keyword">typedef</span> ko::View&lt;const Real*[6], Layout&gt; <a class="code" href="namespacesiqk.html#a7276fa86dc33f28f66f7b76d5225f6f7">ConstVec6s</a>;</div>
<div class="line"><a name="l00091"></a><span class="lineno"><a class="line" href="namespacesiqk.html#ae392f7b38ed1db8a53100783574ca586">   91</a></span>&#160;<span class="keyword">typedef</span> ko::View&lt;Real*[3], ko::LayoutRight, ko::MemoryTraits&lt;ko::Unmanaged&gt; &gt; <a class="code" href="namespacesiqk.html#ae392f7b38ed1db8a53100783574ca586">RawVec3s</a>;</div>
<div class="line"><a name="l00092"></a><span class="lineno"><a class="line" href="namespacesiqk.html#aee02aaa385cda31d0db2c0e750f24c08">   92</a></span>&#160;<span class="keyword">typedef</span> ko::View&lt;const Real*[3], ko::LayoutRight, ko::MemoryTraits&lt;ko::Unmanaged&gt; &gt; <a class="code" href="namespacesiqk.html#aee02aaa385cda31d0db2c0e750f24c08">RawConstVec3s</a>;</div>
<div class="line"><a name="l00093"></a><span class="lineno"><a class="line" href="namespacesiqk.html#a55239018e386898ef9705ae765cd09a8">   93</a></span>&#160;<span class="keyword">typedef</span> ko::View&lt;Real*, ko::LayoutRight, ko::MemoryTraits&lt;ko::Unmanaged&gt; &gt; <a class="code" href="namespacesiqk.html#a55239018e386898ef9705ae765cd09a8">RawArray</a>;</div>
<div class="line"><a name="l00094"></a><span class="lineno"><a class="line" href="namespacesiqk.html#a6f525866efd388ad8b6b947226520628">   94</a></span>&#160;<span class="keyword">typedef</span> ko::View&lt;const Real*, ko::LayoutRight, ko::MemoryTraits&lt;ko::Unmanaged&gt; &gt; <a class="code" href="namespacesiqk.html#a6f525866efd388ad8b6b947226520628">RawConstArray</a>;</div>
<div class="line"><a name="l00095"></a><span class="lineno"><a class="line" href="namespacesiqk.html#a40d665fdda062c3a8de4ea96650d0dff">   95</a></span>&#160;<span class="keyword">typedef</span> ko::View&lt;Int**, Layout&gt; <a class="code" href="namespacesiqk.html#a40d665fdda062c3a8de4ea96650d0dff">Idxs</a>;</div>
<div class="line"><a name="l00096"></a><span class="lineno"><a class="line" href="namespacesiqk.html#a05592daa8593f0bb255bf79d8a99a236">   96</a></span>&#160;<span class="keyword">typedef</span> ko::View&lt;const Int**, Layout&gt; <a class="code" href="namespacesiqk.html#a05592daa8593f0bb255bf79d8a99a236">ConstIdxs</a>;</div>
<div class="line"><a name="l00097"></a><span class="lineno"><a class="line" href="namespacesiqk.html#ab14664dea7f479a9a4dd503e93f52152">   97</a></span>&#160;<span class="keyword">typedef</span> ko::View&lt;Int*[8], Layout&gt; <a class="code" href="namespacesiqk.html#ab14664dea7f479a9a4dd503e93f52152">Nodes</a>;</div>
<div class="line"><a name="l00098"></a><span class="lineno"><a class="line" href="namespacesiqk.html#ae334e4fa96b14e72d2fdb867d5838de8">   98</a></span>&#160;<span class="keyword">typedef</span> ko::View&lt;const Int*[8], Layout&gt; <a class="code" href="namespacesiqk.html#ae334e4fa96b14e72d2fdb867d5838de8">ConstNodes</a>;</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160; </div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="comment">// Decorator for a View. UnmanagedView&lt;ViewType&gt; gives the same view as</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="comment">// ViewType, except the memory is unmanaged.</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> ViewT&gt;</div>
<div class="line"><a name="l00103"></a><span class="lineno"><a class="line" href="namespacesiqk.html#a61e7c4d0032d661a1c40535a5c9e329f">  103</a></span>&#160;<span class="keyword">using</span> <a class="code" href="namespacesiqk.html#a61e7c4d0032d661a1c40535a5c9e329f">UnmanagedView</a> = ko::View&lt;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  <span class="keyword">typename</span> ViewT::data_type, <span class="keyword">typename</span> ViewT::array_layout,</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  <span class="keyword">typename</span> ViewT::device_type, ko::MemoryTraits&lt;ko::Unmanaged&gt; &gt;;</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160; </div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="comment">// Get the host or device version of the array.</span></div>
<div class="line"><a name="l00108"></a><span class="lineno"><a class="line" href="structsiqk_1_1_in_exe_space.html">  108</a></span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> VT, <span class="keyword">typename</span> ES&gt; <span class="keyword">struct </span><a class="code" href="structsiqk_1_1_in_exe_space.html">InExeSpace</a> {</div>
<div class="line"><a name="l00109"></a><span class="lineno"><a class="line" href="structsiqk_1_1_in_exe_space.html#a39009b9757c788f34a6db4f442f8adb2">  109</a></span>&#160;  <span class="keyword">typedef</span> VT <a class="code" href="structsiqk_1_1_in_exe_space.html#a39009b9757c788f34a6db4f442f8adb2">type</a>;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;};</div>
<div class="line"><a name="l00111"></a><span class="lineno"><a class="line" href="structsiqk_1_1_in_exe_space_3_01_v_t_00_01ko_1_1_host_space_01_4.html">  111</a></span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> VT&gt; <span class="keyword">struct </span><a class="code" href="structsiqk_1_1_in_exe_space.html">InExeSpace</a>&lt;VT, <a class="code" href="namespace_kokkos.html">ko</a>::HostSpace&gt; {</div>
<div class="line"><a name="l00112"></a><span class="lineno"><a class="line" href="structsiqk_1_1_in_exe_space_3_01_v_t_00_01ko_1_1_host_space_01_4.html#a9541d7505385a5a434cc6ba60a31f15e">  112</a></span>&#160;  <span class="keyword">typedef</span> <span class="keyword">typename</span> VT::HostMirror <a class="code" href="structsiqk_1_1_in_exe_space_3_01_v_t_00_01ko_1_1_host_space_01_4.html#a9541d7505385a5a434cc6ba60a31f15e">type</a>;</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;};</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160; </div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="preprocessor">#ifdef KOKKOS_HAVE_CUDA</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="comment">// A 1D slice of an array.</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> VT&gt; KOKKOS_FORCEINLINE_FUNCTION</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;ko::View&lt;<span class="keyword">typename</span> VT::value_type*, ko::LayoutStride, <span class="keyword">typename</span> VT::device_type,</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;         ko::MemoryTraits&lt;ko::Unmanaged&gt; &gt;</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<a class="code" href="namespacesiqk.html#aef983887889243999a1d7ddea864ad1f">slice</a> (<span class="keyword">const</span> VT&amp; v, <a class="code" href="namespacesiqk.html#a04b40b29b12c447399a02e3c1575bf66">Int</a> i) { <span class="keywordflow">return</span> <a class="code" href="namespace_homme.html#a2fb615d1c0ef9769f9fe6ff030f5af5e">ko::subview</a>(v, i, ko::ALL()); }</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="comment">// An explicitly const 1D slice of an array.</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> VT&gt; KOKKOS_FORCEINLINE_FUNCTION</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;ko::View&lt;<span class="keyword">typename</span> VT::const_value_type*, ko::LayoutStride, <span class="keyword">typename</span> VT::device_type,</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;         ko::MemoryTraits&lt;ko::Unmanaged&gt; &gt;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<a class="code" href="namespacesiqk.html#aaa8c36644caf3da2c7cdcb701a3298c1">const_slice</a> (<span class="keyword">const</span> VT&amp; v, <a class="code" href="namespacesiqk.html#a04b40b29b12c447399a02e3c1575bf66">Int</a> i) { <span class="keywordflow">return</span> <a class="code" href="namespace_homme.html#a2fb615d1c0ef9769f9fe6ff030f5af5e">ko::subview</a>(v, i, ko::ALL()); }</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> VT&gt; KOKKOS_FORCEINLINE_FUNCTION</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="keyword">typename</span> VT::value_type*</div>
<div class="line"><a name="l00129"></a><span class="lineno"><a class="line" href="namespacesiqk.html#aef983887889243999a1d7ddea864ad1f">  129</a></span>&#160;<a class="code" href="namespacesiqk.html#aef983887889243999a1d7ddea864ad1f">slice</a> (<span class="keyword">const</span> VT&amp; v, <a class="code" href="namespacesiqk.html#a04b40b29b12c447399a02e3c1575bf66">Int</a> i) {</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;  assert(i &gt;= 0 &amp;&amp; i &lt; v.extent_int(0));</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;  <span class="keywordflow">return</span> v.data() + v.extent_int(1)*i;</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;}</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> VT&gt; KOKKOS_FORCEINLINE_FUNCTION</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="keyword">typename</span> VT::const_value_type*</div>
<div class="line"><a name="l00135"></a><span class="lineno"><a class="line" href="namespacesiqk.html#aaa8c36644caf3da2c7cdcb701a3298c1">  135</a></span>&#160;<a class="code" href="namespacesiqk.html#aaa8c36644caf3da2c7cdcb701a3298c1">const_slice</a> (<span class="keyword">const</span> VT&amp; v, <a class="code" href="namespacesiqk.html#a04b40b29b12c447399a02e3c1575bf66">Int</a> i) {</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;  assert(i &gt;= 0 &amp;&amp; i &lt; v.extent_int(0));</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;  <span class="keywordflow">return</span> v.data() + v.extent_int(1)*i;</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;}</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160; </div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="comment">// Number of slices in a 2D array, where each row is a slice.</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> A2D&gt; KOKKOS_FORCEINLINE_FUNCTION</div>
<div class="line"><a name="l00143"></a><span class="lineno"><a class="line" href="namespacesiqk.html#a3f1b5069fc1ac06e18aa603b592403e6">  143</a></span>&#160;<a class="code" href="namespacesiqk.html#a04b40b29b12c447399a02e3c1575bf66">Int</a> <a class="code" href="namespacesiqk.html#a3f1b5069fc1ac06e18aa603b592403e6">nslices</a> (<span class="keyword">const</span> A2D&amp; <a class="code" href="namespacejw.html#acf663523b96ec023200fa8a0f58209f8">a</a>) { <span class="keywordflow">return</span> <span class="keyword">static_cast&lt;</span><a class="code" href="namespacesiqk.html#a04b40b29b12c447399a02e3c1575bf66">Int</a><span class="keyword">&gt;</span>(<a class="code" href="namespacejw.html#acf663523b96ec023200fa8a0f58209f8">a</a>.extent_int(0)); }</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160; </div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="comment">// Number of entries in a 2D array&#39;s row.</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> A2D&gt; KOKKOS_FORCEINLINE_FUNCTION</div>
<div class="line"><a name="l00147"></a><span class="lineno"><a class="line" href="namespacesiqk.html#a6c43ff2c83ad6b7d0dc61c2c5e83a680">  147</a></span>&#160;<a class="code" href="namespacesiqk.html#a04b40b29b12c447399a02e3c1575bf66">Int</a> <a class="code" href="namespacesiqk.html#a6c43ff2c83ad6b7d0dc61c2c5e83a680">szslice</a> (<span class="keyword">const</span> A2D&amp; <a class="code" href="namespacejw.html#acf663523b96ec023200fa8a0f58209f8">a</a>) { <span class="keywordflow">return</span> <span class="keyword">static_cast&lt;</span><a class="code" href="namespacesiqk.html#a04b40b29b12c447399a02e3c1575bf66">Int</a><span class="keyword">&gt;</span>(<a class="code" href="namespacejw.html#acf663523b96ec023200fa8a0f58209f8">a</a>.extent_int(1)); }</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160; </div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> V, <span class="keyword">typename</span> CV&gt;</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;KOKKOS_INLINE_FUNCTION</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> copy (V dst, CV src, <span class="keyword">const</span> <a class="code" href="namespacesiqk.html#a04b40b29b12c447399a02e3c1575bf66">Int</a> n) {</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacesiqk.html#a04b40b29b12c447399a02e3c1575bf66">Int</a> i = 0; i &lt; n; ++i) dst[i] = src[i];</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;}</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160; </div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> DV, <span class="keyword">typename</span> SV&gt;</div>
<div class="line"><a name="l00156"></a><span class="lineno"><a class="line" href="namespacesiqk.html#ae6ddc7d5c591da491b22457a56353479">  156</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespacesiqk.html#ae6ddc7d5c591da491b22457a56353479">resize_and_copy</a> (DV&amp; d, <span class="keyword">const</span> SV&amp; s,</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;                      <span class="keyword">typename</span> std::enable_if&lt;DV::rank == 1&gt;::type* = 0) {</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;  ko::resize(d, <a class="code" href="namespacesiqk.html#a3f1b5069fc1ac06e18aa603b592403e6">nslices</a>(s));</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;  ko::deep_copy(d, s);</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;}</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160; </div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> DV, <span class="keyword">typename</span> SV&gt;</div>
<div class="line"><a name="l00163"></a><span class="lineno"><a class="line" href="namespacesiqk.html#ac8a72cf8014224729db4c9b82229e6b6">  163</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespacesiqk.html#ae6ddc7d5c591da491b22457a56353479">resize_and_copy</a> (DV&amp; d, <span class="keyword">const</span> SV&amp; s,</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;                      <span class="keyword">typename</span> std::enable_if&lt;DV::rank == 2&gt;::type* = 0) {</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;  ko::resize(d, <a class="code" href="namespacesiqk.html#a3f1b5069fc1ac06e18aa603b592403e6">nslices</a>(s), <a class="code" href="namespacesiqk.html#a6c43ff2c83ad6b7d0dc61c2c5e83a680">szslice</a>(s));</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;  ko::deep_copy(d, s);</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;}</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160; </div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> DV, <span class="keyword">typename</span> SA&gt;</div>
<div class="line"><a name="l00170"></a><span class="lineno"><a class="line" href="namespacesiqk.html#a8647704258165c25ff17cb2b546a1dae">  170</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespacesiqk.html#a8647704258165c25ff17cb2b546a1dae">hm_resize_and_copy</a> (DV&amp; d, <span class="keyword">const</span> SA&amp; s, <span class="keyword">const</span> <a class="code" href="namespacesiqk.html#a04b40b29b12c447399a02e3c1575bf66">Int</a> n) {</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;  ko::resize(d, n);</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;  <span class="keyword">auto</span> d_hm = ko::create_mirror_view(d);</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacesiqk.html#a04b40b29b12c447399a02e3c1575bf66">Int</a> i = 0; i &lt; n; ++i) d_hm[i] = s[i];</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;  ko::deep_copy(d, d_hm);</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;}</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160; </div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;<span class="comment">// GPU-friendly replacements for std::min/max.</span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt; KOKKOS_INLINE_FUNCTION</div>
<div class="line"><a name="l00179"></a><span class="lineno"><a class="line" href="namespacesiqk.html#aa8af675f4123cd3ef73b7d549fb84324">  179</a></span>&#160;<span class="keyword">const</span> T&amp; <a class="code" href="namespacesiqk.html#aa8af675f4123cd3ef73b7d549fb84324">min</a> (<span class="keyword">const</span> T&amp; <a class="code" href="namespacejw.html#acf663523b96ec023200fa8a0f58209f8">a</a>, <span class="keyword">const</span> T&amp; <a class="code" href="namespacebaroclinic__wave.html#acf8e56bd7dfdfd2c39e16dfa491a5293">b</a>) { <span class="keywordflow">return</span> <a class="code" href="namespacejw.html#acf663523b96ec023200fa8a0f58209f8">a</a> &lt; <a class="code" href="namespacebaroclinic__wave.html#acf8e56bd7dfdfd2c39e16dfa491a5293">b</a> ? <a class="code" href="namespacejw.html#acf663523b96ec023200fa8a0f58209f8">a</a> : <a class="code" href="namespacebaroclinic__wave.html#acf8e56bd7dfdfd2c39e16dfa491a5293">b</a>; }</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt; KOKKOS_INLINE_FUNCTION</div>
<div class="line"><a name="l00181"></a><span class="lineno"><a class="line" href="namespacesiqk.html#a984fe7f0fc55d1f004981d9b6ffac4f7">  181</a></span>&#160;<span class="keyword">const</span> T&amp; <a class="code" href="namespacesiqk.html#a984fe7f0fc55d1f004981d9b6ffac4f7">max</a> (<span class="keyword">const</span> T&amp; <a class="code" href="namespacejw.html#acf663523b96ec023200fa8a0f58209f8">a</a>, <span class="keyword">const</span> T&amp; <a class="code" href="namespacebaroclinic__wave.html#acf8e56bd7dfdfd2c39e16dfa491a5293">b</a>) { <span class="keywordflow">return</span> <a class="code" href="namespacejw.html#acf663523b96ec023200fa8a0f58209f8">a</a> &gt; <a class="code" href="namespacebaroclinic__wave.html#acf8e56bd7dfdfd2c39e16dfa491a5293">b</a> ? <a class="code" href="namespacejw.html#acf663523b96ec023200fa8a0f58209f8">a</a> : <a class="code" href="namespacebaroclinic__wave.html#acf8e56bd7dfdfd2c39e16dfa491a5293">b</a>; }</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt; KOKKOS_INLINE_FUNCTION</div>
<div class="line"><a name="l00183"></a><span class="lineno"><a class="line" href="namespacesiqk.html#a9943941928d901bed7442db5eaecbb46">  183</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespacesiqk.html#a9943941928d901bed7442db5eaecbb46">swap</a> (T&amp; <a class="code" href="namespacejw.html#acf663523b96ec023200fa8a0f58209f8">a</a>, T&amp;<a class="code" href="namespacebaroclinic__wave.html#acf8e56bd7dfdfd2c39e16dfa491a5293">b</a>) {</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;  T tmp = <a class="code" href="namespacejw.html#acf663523b96ec023200fa8a0f58209f8">a</a>;</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;  <a class="code" href="namespacejw.html#acf663523b96ec023200fa8a0f58209f8">a</a> = <a class="code" href="namespacebaroclinic__wave.html#acf8e56bd7dfdfd2c39e16dfa491a5293">b</a>;</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;  <a class="code" href="namespacebaroclinic__wave.html#acf8e56bd7dfdfd2c39e16dfa491a5293">b</a> = tmp;</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;}</div>
<div class="line"><a name="l00188"></a><span class="lineno"><a class="line" href="namespacesiqk.html#aa4d80b92cc4a0024c2a687c4ddeb6e7f">  188</a></span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt; KOKKOS_INLINE_FUNCTION constexpr T <a class="code" href="namespacesiqk.html#aa4d80b92cc4a0024c2a687c4ddeb6e7f">square</a> (<span class="keyword">const</span> T&amp; <a class="code" href="namespacesupercell.html#ae57ef03dc0cb9828dbacc89aac8870c0">x</a>) { <span class="keywordflow">return</span> <a class="code" href="namespacesupercell.html#ae57ef03dc0cb9828dbacc89aac8870c0">x</a>*<a class="code" href="namespacesupercell.html#ae57ef03dc0cb9828dbacc89aac8870c0">x</a>; }</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160; </div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt; KOKKOS_INLINE_FUNCTION</div>
<div class="line"><a name="l00191"></a><span class="lineno"><a class="line" href="namespacesiqk.html#af15b377ddde4f18068942a06030932be">  191</a></span>&#160;T <a class="code" href="namespacesiqk.html#af15b377ddde4f18068942a06030932be">sign</a> (<span class="keyword">const</span> T&amp; <a class="code" href="namespacejw.html#acf663523b96ec023200fa8a0f58209f8">a</a>) { <span class="keywordflow">return</span> <a class="code" href="namespacejw.html#acf663523b96ec023200fa8a0f58209f8">a</a> &gt; 0 ? 1 : (<a class="code" href="namespacejw.html#acf663523b96ec023200fa8a0f58209f8">a</a> &lt; 0 ? -1 : 0); }</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160; </div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;} <span class="comment">// namespace siqk</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160; </div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;<span class="preprocessor">#endif </span><span class="comment">// INCLUDE_SIQK_DEFS_HPP</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160; </div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;<span class="preprocessor">#ifndef INCLUDE_SIQK_QUADRATURE_HPP</span></div>
<div class="line"><a name="l00198"></a><span class="lineno"><a class="line" href="compose__slmm_8cpp.html#a9a0665ee36d9a2a98287ed0edf6025ea">  198</a></span>&#160;<span class="preprocessor">#define INCLUDE_SIQK_QUADRATURE_HPP</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160; </div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<span class="comment">//#include &quot;siqk_defs.hpp&quot;</span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160; </div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespacesiqk.html">siqk</a> {</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160; </div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;<span class="comment">/* For the TRISYM entries, see, e.g.,</span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;<span class="comment">     Triangular quadrature to use for integration Dunavant, D.A. &quot;High Degree</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;<span class="comment">     Efficient Symmetrical Gaussian Quadrature Rules for the Triangle.&quot;</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;<span class="comment">     J. Numer. Meth. Eng., 21, pp 1129-1148.</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;<span class="comment">   and</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="comment">     Zhang, Linbo, Tao Cui, and Hui Liu. &quot;A set of symmetric quadrature rules on</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;<span class="comment">     triangles and tetrahedra.&quot; J. of Computational Mathematics (2009): 89-96.</span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;<span class="comment">   For the TRITAYLOR, see</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;<span class="comment">     Day, David M. and Mark A. Taylor, &quot;A new 11 point degree 6 cubature formula</span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;<span class="comment">     for the triangle&quot;, PAMM 7 (2007)</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;<span class="comment">   and</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;<span class="comment">     Taylor, Mark A., Beth A. Wingate, and Len P. Bos. &quot;A cardinal function</span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;<span class="comment">     algorithm for computing multivariate quadrature points.&quot; SIAM Journal on</span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;<span class="comment">     Numerical Analysis 45.1 (2007): 193-205.</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;<span class="comment">*/</span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160; </div>
<div class="line"><a name="l00220"></a><span class="lineno"><a class="line" href="compose__slmm_8cpp.html#a00c9d73dc78617d79a14652f947cbad0">  220</a></span>&#160;<span class="preprocessor">#define SIQK_QUADRATURE_TRISYM_ORDER4_COORD                  \</span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;<span class="preprocessor">  {0.108103018168070, 0.445948490915965, 0.445948490915965,  \</span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;<span class="preprocessor">   0.445948490915965, 0.108103018168070, 0.445948490915965,  \</span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;<span class="preprocessor">   0.445948490915965, 0.445948490915965, 0.108103018168070,  \</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;<span class="preprocessor">   0.816847572980458, 0.091576213509771, 0.091576213509771,  \</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;<span class="preprocessor">   0.091576213509771, 0.816847572980458, 0.091576213509771,  \</span></div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;<span class="preprocessor">   0.091576213509771, 0.091576213509771, 0.816847572980458}</span></div>
<div class="line"><a name="l00227"></a><span class="lineno"><a class="line" href="compose__slmm_8cpp.html#a0b39b63145e0e7596d715512f46f5238">  227</a></span>&#160;<span class="preprocessor">#define SIQK_QUADRATURE_TRISYM_ORDER4_WEIGHT                 \</span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;<span class="preprocessor">  {0.223381589678011, 0.223381589678011, 0.223381589678011,  \</span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;<span class="preprocessor">   0.109951743655322, 0.109951743655322, 0.109951743655322}</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160; </div>
<div class="line"><a name="l00231"></a><span class="lineno"><a class="line" href="compose__slmm_8cpp.html#a5bc934576043704c15e9b16cc4a8a96b">  231</a></span>&#160;<span class="preprocessor">#define SIQK_QUADRATURE_TRISYM_ORDER8_COORD                  \</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;<span class="preprocessor">  {0.333333333333333, 0.333333333333333, 0.333333333333333,  \</span></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;<span class="preprocessor">   0.081414823414554, 0.459292588292723, 0.459292588292723,  \</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;<span class="preprocessor">   0.459292588292723, 0.081414823414554, 0.459292588292723,  \</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;<span class="preprocessor">   0.459292588292723, 0.459292588292723, 0.081414823414554,  \</span></div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;<span class="preprocessor">   0.658861384496480, 0.170569307751760, 0.170569307751760,  \</span></div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;<span class="preprocessor">   0.170569307751760, 0.658861384496480, 0.170569307751760,  \</span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;<span class="preprocessor">   0.170569307751760, 0.170569307751760, 0.658861384496480,  \</span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;<span class="preprocessor">   0.898905543365938, 0.050547228317031, 0.050547228317031,  \</span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;<span class="preprocessor">   0.050547228317031, 0.898905543365938, 0.050547228317031,  \</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;<span class="preprocessor">   0.050547228317031, 0.050547228317031, 0.898905543365938,  \</span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;<span class="preprocessor">   0.008394777409958, 0.263112829634638, 0.728492392955404,  \</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;<span class="preprocessor">   0.008394777409958, 0.728492392955404, 0.263112829634638,  \</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;<span class="preprocessor">   0.263112829634638, 0.008394777409958, 0.728492392955404,  \</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;<span class="preprocessor">   0.263112829634638, 0.728492392955404, 0.008394777409958,  \</span></div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;<span class="preprocessor">   0.728492392955404, 0.263112829634638, 0.008394777409958,  \</span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;<span class="preprocessor">   0.728492392955404, 0.008394777409958, 0.263112829634638}</span></div>
<div class="line"><a name="l00248"></a><span class="lineno"><a class="line" href="compose__slmm_8cpp.html#a3f1d231278e45a0fb77db7a246ac9315">  248</a></span>&#160;<span class="preprocessor">#define SIQK_QUADRATURE_TRISYM_ORDER8_WEIGHT                 \</span></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;<span class="preprocessor">  {0.144315607677787, 0.095091634267285, 0.095091634267285,  \</span></div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;<span class="preprocessor">   0.095091634267285, 0.103217370534718, 0.103217370534718,  \</span></div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;<span class="preprocessor">   0.103217370534718, 0.032458497623198, 0.032458497623198,  \</span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;<span class="preprocessor">   0.032458497623198, 0.027230314174435, 0.027230314174435,  \</span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;<span class="preprocessor">   0.027230314174435, 0.027230314174435, 0.027230314174435,  \</span></div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;<span class="preprocessor">   0.027230314174435}</span></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160; </div>
<div class="line"><a name="l00256"></a><span class="lineno"><a class="line" href="compose__slmm_8cpp.html#aed31b4c38ebebd571a22e451912558ff">  256</a></span>&#160;<span class="preprocessor">#define SIQK_QUADRATURE_TRITAY_ORDER12_COORD \</span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;<span class="preprocessor">  {7.26510255160501828e-02, 9.27348974483949817e-01, 0.00000000000000000e+00, \</span></div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;<span class="preprocessor">   2.11790731803609689e-02, 2.35517332495786824e-02, 9.55269193570060349e-01, \</span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;<span class="preprocessor">   1.41841115784669236e-01, 5.40914911362088088e-17, 8.58158884215330708e-01, \</span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;<span class="preprocessor">   1.15143666726236216e-02, 9.45475073220970907e-01, 4.30105601064054710e-02, \</span></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;<span class="preprocessor">   2.77555756156289135e-17, 1.54064601626856063e-01, 8.45935398373143910e-01, \</span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;<span class="preprocessor">   3.72684680767588483e-01, -1.88694080537681499e-16, 6.27315319232411683e-01, \</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;<span class="preprocessor">   9.43134911146902510e-01, 2.71109713562557482e-02, 2.97541174968417414e-02, \</span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;<span class="preprocessor">   8.44725347421859452e-01, 1.46044961672175677e-01, 9.22969090596487129e-03, \</span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;<span class="preprocessor">   8.23277107647898521e-01, 2.11522233831219000e-02, 1.55570668968979586e-01, \</span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;<span class="preprocessor">   6.21586880750877868e-01, 1.45665147883470222e-02, 3.63846604460775103e-01, \</span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;<span class="preprocessor">   2.21919501597089841e-02, 7.88601719223131714e-01, 1.89206330617159302e-01, \</span></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;<span class="preprocessor">   2.27722111443204644e-01, 7.49189739790679599e-01, 2.30881487661157569e-02, \</span></div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;<span class="preprocessor">   7.38137544226065284e-02, 7.18714961015890358e-02, 8.54314749475804436e-01, \</span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;<span class="preprocessor">   6.43364629415364875e-01, 3.32129083947645065e-01, 2.45062866369900600e-02, \</span></div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;<span class="preprocessor">   2.28091126376529507e-02, 3.61181591189672080e-01, 6.16009296172674969e-01, \</span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;<span class="preprocessor">   6.63093778446759319e-01, 2.43458133948799671e-01, 9.34480876044410103e-02, \</span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;<span class="preprocessor">   2.51456820638045198e-02, 5.81689214740147453e-01, 3.93165103196048027e-01, \</span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;<span class="preprocessor">   4.29837040104380730e-01, 5.44446676271925334e-01, 2.57162836236939363e-02, \</span></div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;<span class="preprocessor">   9.40413011410586863e-02, 8.26003314017559997e-01, 7.99553848413813162e-02, \</span></div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;<span class="preprocessor">   7.94010795132135239e-01, 1.16386499067277244e-01, 8.96027058005875177e-02, \</span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;<span class="preprocessor">   7.83496599417470019e-02, 2.03768481077729741e-01, 7.17881858980523258e-01, \</span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;<span class="preprocessor">   2.25505520049374242e-01, 6.44132203822605637e-02, 7.10081259568365097e-01, \</span></div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;<span class="preprocessor">   6.43800731623786371e-01, 9.54285858105846096e-02, 2.60770682565629019e-01, \</span></div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;<span class="preprocessor">   5.43837635808460451e-01, 2.44982965093490213e-01, 2.11179399098049336e-01, \</span></div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;<span class="preprocessor">   4.32112641877997194e-01, 7.05667243440369213e-02, 4.97320633777965815e-01, \</span></div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;<span class="preprocessor">   2.55495747579340349e-01, 6.19381257362555782e-01, 1.25122995058103870e-01, \</span></div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;<span class="preprocessor">   1.22162380966293838e-01, 6.27682615680314027e-01, 2.50155003353392136e-01, \</span></div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;<span class="preprocessor">   4.47861373562203791e-01, 4.22605657433460014e-01, 1.29532969004336196e-01, \</span></div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;<span class="preprocessor">   4.09354529674576528e-01, 2.10785259391403995e-01, 3.79860210934019449e-01, \</span></div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;<span class="preprocessor">   1.24718320885524481e-01, 4.08963804491244809e-01, 4.66317874623230710e-01, \</span></div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;<span class="preprocessor">   2.28197277938737758e-01, 2.13777432530059680e-01, 5.58025289531202562e-01, \</span></div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;<span class="preprocessor">   2.88796329020881648e-01, 4.09786577770025306e-01, 3.01417093209092990e-01}</span></div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160; </div>
<div class="line"><a name="l00290"></a><span class="lineno"><a class="line" href="compose__slmm_8cpp.html#a9d6387552f10e43973ff9dc299f016e9">  290</a></span>&#160;<span class="preprocessor">#define SIQK_QUADRATURE_TRISYM_ORDER14_COORD \</span></div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;<span class="preprocessor">  {0.3333333333333333148296162562473910, 0.3333333333333333148296162562473910, 0.3333333333333333148296162562473910, \</span></div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;<span class="preprocessor">   0.0099797608064584319986778382371995, 0.0099797608064584319986778382371995, 0.9800404783870830804914930922677740, \</span></div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;<span class="preprocessor">   0.0099797608064584319986778382371995, 0.9800404783870830804914930922677740, 0.0099797608064584319986778382371995, \</span></div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;<span class="preprocessor">   0.9800404783870830804914930922677740, 0.0099797608064584319986778382371995, 0.0099797608064584319986778382371995, \</span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;<span class="preprocessor">   0.4799778935211884145495275788562139, 0.4799778935211884145495275788562139, 0.0400442129576231709009448422875721, \</span></div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;<span class="preprocessor">   0.4799778935211884145495275788562139, 0.0400442129576231709009448422875721, 0.4799778935211884145495275788562139, \</span></div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;<span class="preprocessor">   0.0400442129576231709009448422875721, 0.4799778935211884145495275788562139, 0.4799778935211884145495275788562139, \</span></div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;<span class="preprocessor">   0.1538119591769669114444951674158801, 0.1538119591769669114444951674158801, 0.6923760816460662326221608964260668, \</span></div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;<span class="preprocessor">   0.1538119591769669114444951674158801, 0.6923760816460662326221608964260668, 0.1538119591769669114444951674158801, \</span></div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;<span class="preprocessor">   0.6923760816460662326221608964260668, 0.1538119591769669114444951674158801, 0.1538119591769669114444951674158801, \</span></div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;<span class="preprocessor">   0.0740234771169878125185448425327195, 0.0740234771169878125185448425327195, 0.8519530457660243749629103149345610, \</span></div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;<span class="preprocessor">   0.0740234771169878125185448425327195, 0.8519530457660243749629103149345610, 0.0740234771169878125185448425327195, \</span></div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;<span class="preprocessor">   0.8519530457660243749629103149345610, 0.0740234771169878125185448425327195, 0.0740234771169878125185448425327195, \</span></div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;<span class="preprocessor">   0.1303546825033299882967696703417460, 0.1303546825033299882967696703417460, 0.7392906349933400234064606593165081, \</span></div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;<span class="preprocessor">   0.1303546825033299882967696703417460, 0.7392906349933400234064606593165081, 0.1303546825033299882967696703417460, \</span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;<span class="preprocessor">   0.7392906349933400234064606593165081, 0.1303546825033299882967696703417460, 0.1303546825033299882967696703417460, \</span></div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;<span class="preprocessor">   0.2306172260266531326422523306973744, 0.2306172260266531326422523306973744, 0.5387655479466937347154953386052512, \</span></div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;<span class="preprocessor">   0.2306172260266531326422523306973744, 0.5387655479466937347154953386052512, 0.2306172260266531326422523306973744, \</span></div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;<span class="preprocessor">   0.5387655479466937347154953386052512, 0.2306172260266531326422523306973744, 0.2306172260266531326422523306973744, \</span></div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;<span class="preprocessor">   0.4223320834191477968211358984262915, 0.4223320834191477968211358984262915, 0.1553358331617044063577282031474169, \</span></div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;<span class="preprocessor">   0.4223320834191477968211358984262915, 0.1553358331617044063577282031474169, 0.4223320834191477968211358984262915, \</span></div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;<span class="preprocessor">   0.1553358331617044063577282031474169, 0.4223320834191477968211358984262915, 0.4223320834191477968211358984262915, \</span></div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;<span class="preprocessor">   0.7862373859346609705767150444444269, 0.1906163600319009110428680742188590, 0.0231462540334381183804168813367141, \</span></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;<span class="preprocessor">   0.7862373859346609705767150444444269, 0.0231462540334381183804168813367141, 0.1906163600319009110428680742188590, \</span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;<span class="preprocessor">   0.1906163600319009110428680742188590, 0.7862373859346609705767150444444269, 0.0231462540334381183804168813367141, \</span></div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;<span class="preprocessor">   0.1906163600319009110428680742188590, 0.0231462540334381183804168813367141, 0.7862373859346609705767150444444269, \</span></div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;<span class="preprocessor">   0.0231462540334381183804168813367141, 0.7862373859346609705767150444444269, 0.1906163600319009110428680742188590, \</span></div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;<span class="preprocessor">   0.0231462540334381183804168813367141, 0.1906163600319009110428680742188590, 0.7862373859346609705767150444444269, \</span></div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;<span class="preprocessor">   0.6305521436606074114905595706659369, 0.3623231377435471300962888108188054, 0.0071247185958454584131516185152577, \</span></div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;<span class="preprocessor">   0.6305521436606074114905595706659369, 0.0071247185958454584131516185152577, 0.3623231377435471300962888108188054, \</span></div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;<span class="preprocessor">   0.3623231377435471300962888108188054, 0.6305521436606074114905595706659369, 0.0071247185958454584131516185152577, \</span></div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;<span class="preprocessor">   0.3623231377435471300962888108188054, 0.0071247185958454584131516185152577, 0.6305521436606074114905595706659369, \</span></div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;<span class="preprocessor">   0.0071247185958454584131516185152577, 0.6305521436606074114905595706659369, 0.3623231377435471300962888108188054, \</span></div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;<span class="preprocessor">   0.0071247185958454584131516185152577, 0.3623231377435471300962888108188054, 0.6305521436606074114905595706659369, \</span></div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;<span class="preprocessor">   0.6265773298563063198329814440512564, 0.2907712058836673940653838599246228, 0.0826514642600262861016346960241208, \</span></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;<span class="preprocessor">   0.6265773298563063198329814440512564, 0.0826514642600262861016346960241208, 0.2907712058836673940653838599246228, \</span></div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;<span class="preprocessor">   0.2907712058836673940653838599246228, 0.6265773298563063198329814440512564, 0.0826514642600262861016346960241208, \</span></div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;<span class="preprocessor">   0.2907712058836673940653838599246228, 0.0826514642600262861016346960241208, 0.6265773298563063198329814440512564, \</span></div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;<span class="preprocessor">   0.0826514642600262861016346960241208, 0.6265773298563063198329814440512564, 0.2907712058836673940653838599246228, \</span></div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;<span class="preprocessor">   0.0826514642600262861016346960241208, 0.2907712058836673940653838599246228, 0.6265773298563063198329814440512564, \</span></div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;<span class="preprocessor">   0.9142099849296254632236014003865421, 0.0711657108777507679819862573822320, 0.0146243041926237687944123422312259, \</span></div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;<span class="preprocessor">   0.9142099849296254632236014003865421, 0.0146243041926237687944123422312259, 0.0711657108777507679819862573822320, \</span></div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;<span class="preprocessor">   0.0711657108777507679819862573822320, 0.9142099849296254632236014003865421, 0.0146243041926237687944123422312259, \</span></div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;<span class="preprocessor">   0.0711657108777507679819862573822320, 0.0146243041926237687944123422312259, 0.9142099849296254632236014003865421, \</span></div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;<span class="preprocessor">   0.0146243041926237687944123422312259, 0.9142099849296254632236014003865421, 0.0711657108777507679819862573822320, \</span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;<span class="preprocessor">   0.0146243041926237687944123422312259, 0.0711657108777507679819862573822320, 0.9142099849296254632236014003865421}</span></div>
<div class="line"><a name="l00337"></a><span class="lineno"><a class="line" href="compose__slmm_8cpp.html#a85cbdff87860f958c17efc14d0931027">  337</a></span>&#160;<span class="preprocessor">#define SIQK_QUADRATURE_TRISYM_ORDER14_WEIGHT \</span></div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;<span class="preprocessor">  {0.0585962852260285965710906452841300,0.0017351512297252675524200649093132,0.0017351512297252675524200649093132, \</span></div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;<span class="preprocessor">   0.0017351512297252675524200649093132,0.0261637825586145227052536910150593,0.0261637825586145227052536910150593, \</span></div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;<span class="preprocessor">   0.0261637825586145227052536910150593,0.0039197292424018289128118119890587,0.0039197292424018289128118119890587, \</span></div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;<span class="preprocessor">   0.0039197292424018289128118119890587,0.0122473597569408669538670864085361,0.0122473597569408669538670864085361, \</span></div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;<span class="preprocessor">   0.0122473597569408669538670864085361,0.0281996285032579604989955157634540,0.0281996285032579604989955157634540, \</span></div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;<span class="preprocessor">   0.0281996285032579604989955157634540,0.0508870871859594883779287499692146,0.0508870871859594883779287499692146, \</span></div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;<span class="preprocessor">   0.0508870871859594883779287499692146,0.0504534399016036000373830461285252,0.0504534399016036000373830461285252, \</span></div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;<span class="preprocessor">   0.0504534399016036000373830461285252,0.0170636442122334523741056244716674,0.0170636442122334523741056244716674, \</span></div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;<span class="preprocessor">   0.0170636442122334523741056244716674,0.0170636442122334523741056244716674,0.0170636442122334523741056244716674, \</span></div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;<span class="preprocessor">   0.0170636442122334523741056244716674,0.0096834664255066003890615178306689,0.0096834664255066003890615178306689, \</span></div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;<span class="preprocessor">   0.0096834664255066003890615178306689,0.0096834664255066003890615178306689,0.0096834664255066003890615178306689, \</span></div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;<span class="preprocessor">   0.0096834664255066003890615178306689,0.0363857559284850029523994408009457,0.0363857559284850029523994408009457, \</span></div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;<span class="preprocessor">   0.0363857559284850029523994408009457,0.0363857559284850029523994408009457,0.0363857559284850029523994408009457, \</span></div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;<span class="preprocessor">   0.0363857559284850029523994408009457,0.0069646633735184126576256424812073,0.0069646633735184126576256424812073, \</span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;<span class="preprocessor">   0.0069646633735184126576256424812073,0.0069646633735184126576256424812073,0.0069646633735184126576256424812073, \</span></div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;<span class="preprocessor">   0.0069646633735184126576256424812073}</span></div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160; </div>
<div class="line"><a name="l00355"></a><span class="lineno"><a class="line" href="compose__slmm_8cpp.html#a8aa8c36c408197a7b5c167212b38cd80">  355</a></span>&#160;<span class="preprocessor">#define SIQK_QUADRATURE_TRITAY_ORDER12_WEIGHT                           \</span></div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;<span class="preprocessor">  {4.888049814660050e-03, 6.675900027367356e-03, 6.845534654343699e-03, \</span></div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;<span class="preprocessor">   7.119751436080721e-03, 7.714492373624846e-03, 9.654708742436301e-03, \</span></div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;<span class="preprocessor">   1.050932673560249e-02, 1.068084365762828e-02, 1.848368581123072e-02, \</span></div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;<span class="preprocessor">   1.854548042160657e-02, 2.062000411968213e-02, 2.168508541701153e-02, \</span></div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;<span class="preprocessor">   2.249074619915818e-02, 2.490407320150775e-02, 2.509917342768508e-02, \</span></div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;<span class="preprocessor">   2.794373431987983e-02, 2.814555860521331e-02, 2.816965445973000e-02, \</span></div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;<span class="preprocessor">   3.052917241207244e-02, 3.057527760403899e-02, 3.957360579297199e-02, \</span></div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;<span class="preprocessor">   4.128188739546268e-02, 4.593784216579169e-02, 4.749957532530720e-02, \</span></div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;<span class="preprocessor">   4.814880503690738e-02, 5.096492487678762e-02, 5.335208304882109e-02, \</span></div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;<span class="preprocessor">   5.414687261316752e-02, 5.943783395113540e-02, 5.998970732710617e-02, \</span></div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;<span class="preprocessor">   6.316454642265663e-02, 7.522206260332436e-02}</span></div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160; </div>
<div class="line"><a name="l00368"></a><span class="lineno"><a class="line" href="compose__slmm_8cpp.html#aedda019adc3bb9a13f9a9289ad3fb53f">  368</a></span>&#160;<span class="preprocessor">#define SIQK_QUADRATURE_TRITAY_ORDER6_COORD                             \</span></div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;<span class="preprocessor">  {4.724686653264358e-02, 5.725498667747682e-02, 8.954981467898796e-01, \</span></div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;<span class="preprocessor">   4.280913872509884e-02, 8.953626400245792e-01, 6.182822125032195e-02, \</span></div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;<span class="preprocessor">   2.921805130458027e-01, 6.844757484565146e-01, 2.334373849768268e-02, \</span></div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;<span class="preprocessor">   8.712234683377076e-01, 6.874625591502949e-02, 6.003027574726293e-02, \</span></div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;<span class="preprocessor">   5.086198608278325e-02, 6.156762055758400e-01, 3.334618083413767e-01, \</span></div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;<span class="preprocessor">   2.128646728100595e-01, 6.279461411977890e-01, 1.591891859921515e-01, \</span></div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;<span class="preprocessor">   2.817957679526839e-01, 6.290913834186361e-02, 6.552950937054525e-01, \</span></div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;<span class="preprocessor">   6.225041026512227e-01, 6.837821192050995e-02, 3.091176854282673e-01, \</span></div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;<span class="preprocessor">   7.604403244598745e-02, 2.875294583743921e-01, 6.364265091796204e-01, \</span></div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;<span class="preprocessor">   5.941924379444020e-01, 3.287835564131346e-01, 7.702400564246337e-02, \</span></div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;<span class="preprocessor">   3.353648085404556e-01, 3.122904050136449e-01, 3.523447864458995e-01}</span></div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160; </div>
<div class="line"><a name="l00381"></a><span class="lineno"><a class="line" href="compose__slmm_8cpp.html#a89a02be79466842475d4bb9d65b20b19">  381</a></span>&#160;<span class="preprocessor">#define SIQK_QUADRATURE_TRITAY_ORDER6_WEIGHT                            \</span></div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;<span class="preprocessor">  {3.806807185295551e-02, 3.837935530775279e-02, 4.620045674456197e-02, \</span></div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;<span class="preprocessor">   5.346758944419899e-02, 8.375582696574595e-02, 1.016448330255167e-01, \</span></div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;<span class="preprocessor">   1.018615244613670e-01, 1.114218316600018e-01, 1.120094502629461e-01, \</span></div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;<span class="preprocessor">   1.247875714375583e-01, 1.884034888373949e-01}</span></div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160; </div>
<div class="line"><a name="l00387"></a><span class="lineno"><a class="line" href="classsiqk_1_1_triangle_quadrature.html">  387</a></span>&#160;<span class="keyword">class </span><a class="code" href="classsiqk_1_1_triangle_quadrature.html">TriangleQuadrature</a> {</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;  <span class="keyword">const</span> <a class="code" href="namespacesiqk.html#a6694847e2d56e697aa08277444325083">Real</a> trisym_order4_coord_  [ 18] = <a class="code" href="compose__slmm_8cpp.html#a00c9d73dc78617d79a14652f947cbad0">SIQK_QUADRATURE_TRISYM_ORDER4_COORD</a>;</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;  <span class="keyword">const</span> <a class="code" href="namespacesiqk.html#a6694847e2d56e697aa08277444325083">Real</a> trisym_order4_weight_ [  6] = <a class="code" href="compose__slmm_8cpp.html#a0b39b63145e0e7596d715512f46f5238">SIQK_QUADRATURE_TRISYM_ORDER4_WEIGHT</a>;</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;  <span class="keyword">const</span> <a class="code" href="namespacesiqk.html#a6694847e2d56e697aa08277444325083">Real</a> tritay_order6_coord_  [ 33] = <a class="code" href="compose__slmm_8cpp.html#aedda019adc3bb9a13f9a9289ad3fb53f">SIQK_QUADRATURE_TRITAY_ORDER6_COORD</a>;</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;  <span class="keyword">const</span> <a class="code" href="namespacesiqk.html#a6694847e2d56e697aa08277444325083">Real</a> tritay_order6_weight_ [ 11] = <a class="code" href="compose__slmm_8cpp.html#a89a02be79466842475d4bb9d65b20b19">SIQK_QUADRATURE_TRITAY_ORDER6_WEIGHT</a>;</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;  <span class="keyword">const</span> <a class="code" href="namespacesiqk.html#a6694847e2d56e697aa08277444325083">Real</a> trisym_order8_coord_  [ 48] = <a class="code" href="compose__slmm_8cpp.html#a5bc934576043704c15e9b16cc4a8a96b">SIQK_QUADRATURE_TRISYM_ORDER8_COORD</a>;</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;  <span class="keyword">const</span> <a class="code" href="namespacesiqk.html#a6694847e2d56e697aa08277444325083">Real</a> trisym_order8_weight_ [ 16] = <a class="code" href="compose__slmm_8cpp.html#a3f1d231278e45a0fb77db7a246ac9315">SIQK_QUADRATURE_TRISYM_ORDER8_WEIGHT</a>;</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;  <span class="keyword">const</span> <a class="code" href="namespacesiqk.html#a6694847e2d56e697aa08277444325083">Real</a> tritay_order12_coord_ [ 96] = <a class="code" href="compose__slmm_8cpp.html#aed31b4c38ebebd571a22e451912558ff">SIQK_QUADRATURE_TRITAY_ORDER12_COORD</a>;</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;  <span class="keyword">const</span> <a class="code" href="namespacesiqk.html#a6694847e2d56e697aa08277444325083">Real</a> tritay_order12_weight_[ 32] = <a class="code" href="compose__slmm_8cpp.html#a8aa8c36c408197a7b5c167212b38cd80">SIQK_QUADRATURE_TRITAY_ORDER12_WEIGHT</a>;</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;  <span class="keyword">const</span> <a class="code" href="namespacesiqk.html#a6694847e2d56e697aa08277444325083">Real</a> trisym_order14_coord_ [138] = <a class="code" href="compose__slmm_8cpp.html#a9d6387552f10e43973ff9dc299f016e9">SIQK_QUADRATURE_TRISYM_ORDER14_COORD</a>;</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;  <span class="keyword">const</span> <a class="code" href="namespacesiqk.html#a6694847e2d56e697aa08277444325083">Real</a> trisym_order14_weight_[ 46] = <a class="code" href="compose__slmm_8cpp.html#a85cbdff87860f958c17efc14d0931027">SIQK_QUADRATURE_TRISYM_ORDER14_WEIGHT</a>;</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160; </div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00400"></a><span class="lineno"><a class="line" href="classsiqk_1_1_triangle_quadrature.html#a98b6e36083268cd1d09bf00592986c42">  400</a></span>&#160;  KOKKOS_INLINE_FUNCTION <a class="code" href="classsiqk_1_1_triangle_quadrature.html#a98b6e36083268cd1d09bf00592986c42">TriangleQuadrature</a> () {}</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160; </div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;  KOKKOS_INLINE_FUNCTION</div>
<div class="line"><a name="l00403"></a><span class="lineno"><a class="line" href="classsiqk_1_1_triangle_quadrature.html#a3cd181896eb90a4aa5e813b0f1697aec">  403</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classsiqk_1_1_triangle_quadrature.html#a3cd181896eb90a4aa5e813b0f1697aec">get_coef</a> (<span class="keyword">const</span> <span class="keywordtype">int</span> order, <a class="code" href="namespacesiqk.html#aee02aaa385cda31d0db2c0e750f24c08">RawConstVec3s</a>&amp; coord,</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;                 <a class="code" href="namespacesiqk.html#a6f525866efd388ad8b6b947226520628">RawConstArray</a>&amp; weight)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;    <span class="keywordflow">switch</span> (order) {</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    <span class="keywordflow">case</span> 4:</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;      coord = <a class="code" href="namespacesiqk.html#aee02aaa385cda31d0db2c0e750f24c08">RawConstVec3s</a>(trisym_order4_coord_, 6);</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;      weight = <a class="code" href="namespacesiqk.html#a6f525866efd388ad8b6b947226520628">RawConstArray</a>(trisym_order4_weight_, 6);</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;    <span class="keywordflow">case</span> 6:</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;      coord = <a class="code" href="namespacesiqk.html#aee02aaa385cda31d0db2c0e750f24c08">RawConstVec3s</a>(tritay_order6_coord_, 11);</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;      weight = <a class="code" href="namespacesiqk.html#a6f525866efd388ad8b6b947226520628">RawConstArray</a>(tritay_order6_weight_, 11);</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;    <span class="keywordflow">case</span> 8:</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;      coord = <a class="code" href="namespacesiqk.html#aee02aaa385cda31d0db2c0e750f24c08">RawConstVec3s</a>(trisym_order8_coord_, 16);</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;      weight = <a class="code" href="namespacesiqk.html#a6f525866efd388ad8b6b947226520628">RawConstArray</a>(trisym_order8_weight_, 16);</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    <span class="keywordflow">case</span> 12:</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;      coord = <a class="code" href="namespacesiqk.html#aee02aaa385cda31d0db2c0e750f24c08">RawConstVec3s</a>(tritay_order12_coord_, 32);</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;      weight = <a class="code" href="namespacesiqk.html#a6f525866efd388ad8b6b947226520628">RawConstArray</a>(tritay_order12_weight_, 32);</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    <span class="keywordflow">case</span> 14:</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;      coord = <a class="code" href="namespacesiqk.html#aee02aaa385cda31d0db2c0e750f24c08">RawConstVec3s</a>(trisym_order14_coord_, 46);</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;      weight = <a class="code" href="namespacesiqk.html#a6f525866efd388ad8b6b947226520628">RawConstArray</a>(trisym_order14_weight_, 46);</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;      ko::abort(<span class="stringliteral">&quot;TriangleQuadrature::get_coef: order not supported.&quot;</span>);</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    }</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;  }</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;};</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160; </div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;} <span class="comment">// namespace siqk</span></div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160; </div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;<span class="preprocessor">#endif </span><span class="comment">// INCLUDE_SIQK_QUADRATURE_HPP</span></div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160; </div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;<span class="preprocessor">#ifndef INCLUDE_SIQK_GEOMETRY_HPP</span></div>
<div class="line"><a name="l00437"></a><span class="lineno"><a class="line" href="compose__slmm_8cpp.html#a5b920619345b3c2515b96af249b07b4b">  437</a></span>&#160;<span class="preprocessor">#define INCLUDE_SIQK_GEOMETRY_HPP</span></div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160; </div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;<span class="comment">//#include &quot;siqk_defs.hpp&quot;</span></div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;<span class="comment">//#include &quot;siqk_quadrature.hpp&quot;</span></div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160; </div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespacesiqk.html">siqk</a> {</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160; </div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;<span class="comment">// Vectors and points are 2D. Thus, if you&#39;re working on planes in 3D, project</span></div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;<span class="comment">// to a 2D space before calling these.</span></div>
<div class="line"><a name="l00446"></a><span class="lineno"><a class="line" href="structsiqk_1_1_plane_geometry.html">  446</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structsiqk_1_1_plane_geometry.html">PlaneGeometry</a> {</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> V&gt; KOKKOS_INLINE_FUNCTION</div>
<div class="line"><a name="l00448"></a><span class="lineno"><a class="line" href="structsiqk_1_1_plane_geometry.html#a2c0abf0414aad833e56ebe59405c926a">  448</a></span>&#160;  <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="structsiqk_1_1_plane_geometry.html#a2c0abf0414aad833e56ebe59405c926a">scale</a> (<span class="keyword">const</span> <a class="code" href="namespacesiqk.html#a6694847e2d56e697aa08277444325083">Real</a>&amp; <a class="code" href="namespacejw.html#acf663523b96ec023200fa8a0f58209f8">a</a>, V v) {</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;    v[0] *= <a class="code" href="namespacejw.html#acf663523b96ec023200fa8a0f58209f8">a</a>; v[1] *= <a class="code" href="namespacejw.html#acf663523b96ec023200fa8a0f58209f8">a</a>;</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;  }</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> CV&gt; KOKKOS_INLINE_FUNCTION</div>
<div class="line"><a name="l00452"></a><span class="lineno"><a class="line" href="structsiqk_1_1_plane_geometry.html#aaff4adc83dcf850e47fa175ed4d27d7f">  452</a></span>&#160;  <span class="keyword">static</span> <a class="code" href="namespacesiqk.html#a6694847e2d56e697aa08277444325083">Real</a> <a class="code" href="structsiqk_1_1_plane_geometry.html#aaff4adc83dcf850e47fa175ed4d27d7f">dot_c_amb</a> (<span class="keyword">const</span> CV c, <span class="keyword">const</span> CV <a class="code" href="namespacejw.html#acf663523b96ec023200fa8a0f58209f8">a</a>, <span class="keyword">const</span> CV <a class="code" href="namespacebaroclinic__wave.html#acf8e56bd7dfdfd2c39e16dfa491a5293">b</a>) {</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;    <span class="keywordflow">return</span> c[0]*(<a class="code" href="namespacejw.html#acf663523b96ec023200fa8a0f58209f8">a</a>[0] - <a class="code" href="namespacebaroclinic__wave.html#acf8e56bd7dfdfd2c39e16dfa491a5293">b</a>[0]) + c[1]*(<a class="code" href="namespacejw.html#acf663523b96ec023200fa8a0f58209f8">a</a>[1] - <a class="code" href="namespacebaroclinic__wave.html#acf8e56bd7dfdfd2c39e16dfa491a5293">b</a>[1]);</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;  }</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> CV, <span class="keyword">typename</span> V&gt; KOKKOS_INLINE_FUNCTION</div>
<div class="line"><a name="l00456"></a><span class="lineno"><a class="line" href="structsiqk_1_1_plane_geometry.html#ae32bb0359254d2eb1cff27c3ea3a5b0b">  456</a></span>&#160;  <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="structsiqk_1_1_plane_geometry.html#ae32bb0359254d2eb1cff27c3ea3a5b0b">combine</a> (<span class="keyword">const</span> CV u, <span class="keyword">const</span> CV v, <span class="keyword">const</span> <a class="code" href="namespacesiqk.html#a6694847e2d56e697aa08277444325083">Real</a>&amp; <a class="code" href="namespacejw.html#acf663523b96ec023200fa8a0f58209f8">a</a>, V <a class="code" href="namespacesupercell.html#ae57ef03dc0cb9828dbacc89aac8870c0">x</a>) {</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;    <span class="keyword">const</span> <a class="code" href="namespacesiqk.html#a6694847e2d56e697aa08277444325083">Real</a>&amp; oma = 1 - <a class="code" href="namespacejw.html#acf663523b96ec023200fa8a0f58209f8">a</a>;</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;    <a class="code" href="namespacesupercell.html#ae57ef03dc0cb9828dbacc89aac8870c0">x</a>[0] = oma*u[0] + <a class="code" href="namespacejw.html#acf663523b96ec023200fa8a0f58209f8">a</a>*v[0];</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;    <a class="code" href="namespacesupercell.html#ae57ef03dc0cb9828dbacc89aac8870c0">x</a>[1] = oma*u[1] + <a class="code" href="namespacejw.html#acf663523b96ec023200fa8a0f58209f8">a</a>*v[1];</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;  }</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> CV, <span class="keyword">typename</span> V&gt; KOKKOS_INLINE_FUNCTION</div>
<div class="line"><a name="l00462"></a><span class="lineno"><a class="line" href="structsiqk_1_1_plane_geometry.html#ab04d3962792af51655f60857a6cb31d7">  462</a></span>&#160;  <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="structsiqk_1_1_plane_geometry.html#ab04d3962792af51655f60857a6cb31d7">axpy</a> (<span class="keyword">const</span> <a class="code" href="namespacesiqk.html#a6694847e2d56e697aa08277444325083">Real</a>&amp; <a class="code" href="namespacejw.html#acf663523b96ec023200fa8a0f58209f8">a</a>, <span class="keyword">const</span> CV <a class="code" href="namespacesupercell.html#ae57ef03dc0cb9828dbacc89aac8870c0">x</a>, V y) {</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;    y[0] += <a class="code" href="namespacejw.html#acf663523b96ec023200fa8a0f58209f8">a</a>*<a class="code" href="namespacesupercell.html#ae57ef03dc0cb9828dbacc89aac8870c0">x</a>[0];</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;    y[1] += <a class="code" href="namespacejw.html#acf663523b96ec023200fa8a0f58209f8">a</a>*<a class="code" href="namespacesupercell.html#ae57ef03dc0cb9828dbacc89aac8870c0">x</a>[1];</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;  }</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160; </div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> CV, <span class="keyword">typename</span> V&gt; KOKKOS_INLINE_FUNCTION</div>
<div class="line"><a name="l00468"></a><span class="lineno"><a class="line" href="structsiqk_1_1_plane_geometry.html#a2f85a124e19fb90b952844385342d0a8">  468</a></span>&#160;  <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="structsiqk_1_1_plane_geometry.html#a2f85a124e19fb90b952844385342d0a8">edge_normal</a> (<span class="keyword">const</span> CV e1, <span class="keyword">const</span> CV e2, V en) {</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;    en[0] = e1[1] - e2[1];</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;    en[1] = e2[0] - e1[0];</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;  }</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160; </div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> CV&gt; KOKKOS_INLINE_FUNCTION</div>
<div class="line"><a name="l00474"></a><span class="lineno"><a class="line" href="structsiqk_1_1_plane_geometry.html#a4995be0c4128dddab5ed06cf36c36de7">  474</a></span>&#160;  <span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="structsiqk_1_1_plane_geometry.html#a4995be0c4128dddab5ed06cf36c36de7">inside</a> (<span class="keyword">const</span> CV v, <span class="keyword">const</span> CV e1, <span class="keyword">const</span> CV en) {</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="structsiqk_1_1_plane_geometry.html#aaff4adc83dcf850e47fa175ed4d27d7f">dot_c_amb</a>(en, v, e1) &gt;= 0;</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;  }</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160; </div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> CV, <span class="keyword">typename</span> V&gt; KOKKOS_INLINE_FUNCTION</div>
<div class="line"><a name="l00479"></a><span class="lineno"><a class="line" href="structsiqk_1_1_plane_geometry.html#a5bcade77711cd1e96bd6ac787dcef0a8">  479</a></span>&#160;  <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="structsiqk_1_1_plane_geometry.html#a5bcade77711cd1e96bd6ac787dcef0a8">intersect</a> (<span class="keyword">const</span> CV v1, <span class="keyword">const</span> CV v2, <span class="keyword">const</span> CV e1, <span class="keyword">const</span> CV en,</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;                         V intersection) {</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;    <a class="code" href="namespacesiqk.html#a6694847e2d56e697aa08277444325083">Real</a> <a class="code" href="namespacejw.html#acf663523b96ec023200fa8a0f58209f8">a</a>; {</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;      <span class="keyword">const</span> <a class="code" href="namespacesiqk.html#a6694847e2d56e697aa08277444325083">Real</a></div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;        num = <a class="code" href="structsiqk_1_1_plane_geometry.html#aaff4adc83dcf850e47fa175ed4d27d7f">dot_c_amb</a>(en, e1, v1),</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;        den = <a class="code" href="structsiqk_1_1_plane_geometry.html#aaff4adc83dcf850e47fa175ed4d27d7f">dot_c_amb</a>(en, v2, v1);</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;      <a class="code" href="namespacejw.html#acf663523b96ec023200fa8a0f58209f8">a</a> = num == 0 || den == 0 ? 0 : num/den;</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;      <a class="code" href="namespacejw.html#acf663523b96ec023200fa8a0f58209f8">a</a> = a &lt; 0 ? 0 : a &gt; 1 ? 1 : <a class="code" href="namespacejw.html#acf663523b96ec023200fa8a0f58209f8">a</a>;</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    }</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;    <a class="code" href="structsiqk_1_1_plane_geometry.html#ae32bb0359254d2eb1cff27c3ea3a5b0b">combine</a>(v1, v2, <a class="code" href="namespacejw.html#acf663523b96ec023200fa8a0f58209f8">a</a>, intersection);</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;  }</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160; </div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> CV, <span class="keyword">typename</span> V&gt; KOKKOS_INLINE_FUNCTION</div>
<div class="line"><a name="l00492"></a><span class="lineno"><a class="line" href="structsiqk_1_1_plane_geometry.html#a6cd5d37ee1e3d437fa9e29488a79e62d">  492</a></span>&#160;  <span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="structsiqk_1_1_plane_geometry.html#a6cd5d37ee1e3d437fa9e29488a79e62d">output</a> (<span class="keyword">const</span> CV v, <a class="code" href="namespacesiqk.html#a04b40b29b12c447399a02e3c1575bf66">Int</a>&amp; no, <span class="keyword">const</span> V vo) {</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;<span class="preprocessor">#ifdef SIQK_DEBUG</span></div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;    <span class="keywordflow">if</span> (no &gt;= <a class="code" href="namespacesiqk.html#a3f1b5069fc1ac06e18aa603b592403e6">nslices</a>(vo)) {</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;      std::stringstream ss;</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;      ss &lt;&lt; <span class="stringliteral">&quot;output: No room in vo; vo.n() is &quot;</span> &lt;&lt; <a class="code" href="namespacesiqk.html#a3f1b5069fc1ac06e18aa603b592403e6">nslices</a>(vo) &lt;&lt; <span class="stringliteral">&quot; but no is &quot;</span></div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;         &lt;&lt; no &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;      message(ss.str().c_str());</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;    }</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;    <span class="keywordflow">if</span> (no &gt;= <a class="code" href="namespacesiqk.html#a3f1b5069fc1ac06e18aa603b592403e6">nslices</a>(vo)) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;    vo(no,0) = v[0];</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;    vo(no,1) = v[1];</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;    ++no;</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;  }</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160; </div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;  <span class="comment">//todo Handle non-convex case.</span></div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> CV2s&gt;</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;  KOKKOS_INLINE_FUNCTION</div>
<div class="line"><a name="l00511"></a><span class="lineno"><a class="line" href="structsiqk_1_1_plane_geometry.html#a98ba6fd378e91f6ae5a861dea14c56d1">  511</a></span>&#160;  <span class="keyword">static</span> <a class="code" href="namespacesiqk.html#a6694847e2d56e697aa08277444325083">Real</a> <a class="code" href="structsiqk_1_1_plane_geometry.html#a98ba6fd378e91f6ae5a861dea14c56d1">calc_area</a> (<span class="keyword">const</span> <a class="code" href="classsiqk_1_1_triangle_quadrature.html">TriangleQuadrature</a>&amp; , <span class="keyword">const</span> CV2s&amp; v,</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;                         <span class="keyword">const</span> <a class="code" href="namespacesiqk.html#a04b40b29b12c447399a02e3c1575bf66">Int</a> n) {</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="structsiqk_1_1_plane_geometry.html#aabd0bea685514cc050df35ed109aa0c0">calc_area_formula</a>(v, n);</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;  }</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160; </div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> CV2s&gt;</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;  KOKKOS_INLINE_FUNCTION</div>
<div class="line"><a name="l00518"></a><span class="lineno"><a class="line" href="structsiqk_1_1_plane_geometry.html#aabd0bea685514cc050df35ed109aa0c0">  518</a></span>&#160;  <span class="keyword">static</span> <a class="code" href="namespacesiqk.html#a6694847e2d56e697aa08277444325083">Real</a> <a class="code" href="structsiqk_1_1_plane_geometry.html#aabd0bea685514cc050df35ed109aa0c0">calc_area_formula</a> (<span class="keyword">const</span> CV2s&amp; v, <span class="keyword">const</span> <a class="code" href="namespacesiqk.html#a04b40b29b12c447399a02e3c1575bf66">Int</a> n) {</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;    <a class="code" href="namespacesiqk.html#a6694847e2d56e697aa08277444325083">Real</a> area = 0;</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="namespacesiqk.html#a04b40b29b12c447399a02e3c1575bf66">Int</a> i = 1, ilim = n - 1; i &lt; ilim; ++i)</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;      area += <a class="code" href="structsiqk_1_1_plane_geometry.html#a61208fd207658a785e7e50954b9316a8">calc_tri_jacobian</a>(<a class="code" href="namespacesiqk.html#aef983887889243999a1d7ddea864ad1f">slice</a>(v,0), <a class="code" href="namespacesiqk.html#aef983887889243999a1d7ddea864ad1f">slice</a>(v,i), <a class="code" href="namespacesiqk.html#aef983887889243999a1d7ddea864ad1f">slice</a>(v,i+1));</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;    <span class="keywordflow">return</span> 0.5*area;</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;  }</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160; </div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> CV, <span class="keyword">typename</span> CA&gt;</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;  KOKKOS_INLINE_FUNCTION</div>
<div class="line"><a name="l00527"></a><span class="lineno"><a class="line" href="structsiqk_1_1_plane_geometry.html#ae854fb6c0d18fec7d947e06266bce8e8">  527</a></span>&#160;  <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="structsiqk_1_1_plane_geometry.html#ae854fb6c0d18fec7d947e06266bce8e8">bary2coord</a> (<span class="keyword">const</span> CV v1, <span class="keyword">const</span> CV v2, <span class="keyword">const</span> CV v3, <span class="keyword">const</span> CA alpha,</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;                          <a class="code" href="namespacesiqk.html#a6694847e2d56e697aa08277444325083">Real</a> u[2]) {</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="namespacesiqk.html#a04b40b29b12c447399a02e3c1575bf66">Int</a> <a class="code" href="namespacebaroclinic__wave.html#a8619f63e6dd6db1077c1a18788afa359">k</a> = 0; <a class="code" href="namespacebaroclinic__wave.html#a8619f63e6dd6db1077c1a18788afa359">k</a> &lt; 2; ++<a class="code" href="namespacebaroclinic__wave.html#a8619f63e6dd6db1077c1a18788afa359">k</a>) u[<a class="code" href="namespacebaroclinic__wave.html#a8619f63e6dd6db1077c1a18788afa359">k</a>] = 0;</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;    <a class="code" href="structsiqk_1_1_plane_geometry.html#ab04d3962792af51655f60857a6cb31d7">axpy</a>(alpha[0], v1, u);</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;    <a class="code" href="structsiqk_1_1_plane_geometry.html#ab04d3962792af51655f60857a6cb31d7">axpy</a>(alpha[1], v2, u);</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;    <a class="code" href="structsiqk_1_1_plane_geometry.html#ab04d3962792af51655f60857a6cb31d7">axpy</a>(alpha[2], v3, u);</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;  }</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160; </div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> CV&gt;</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;  KOKKOS_INLINE_FUNCTION</div>
<div class="line"><a name="l00537"></a><span class="lineno"><a class="line" href="structsiqk_1_1_plane_geometry.html#a61208fd207658a785e7e50954b9316a8">  537</a></span>&#160;  <span class="keyword">static</span> <a class="code" href="namespacesiqk.html#a6694847e2d56e697aa08277444325083">Real</a> <a class="code" href="structsiqk_1_1_plane_geometry.html#a61208fd207658a785e7e50954b9316a8">calc_tri_jacobian</a> (<span class="keyword">const</span> CV v1, <span class="keyword">const</span> CV v2, <span class="keyword">const</span> CV v3) {</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;    <a class="code" href="namespacesiqk.html#a6694847e2d56e697aa08277444325083">Real</a> r1[2], r2[2];</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;    r1[0] = v2[0] - v1[0];</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;    r1[1] = v2[1] - v1[1];</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;    r2[0] = v3[0] - v1[0];</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;    r2[1] = v3[1] - v1[1];</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;    <span class="keyword">const</span> <a class="code" href="namespacesiqk.html#a6694847e2d56e697aa08277444325083">Real</a> <a class="code" href="namespacejw.html#acf663523b96ec023200fa8a0f58209f8">a</a> = r1[0]*r2[1] - r1[1]*r2[0];</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacejw.html#acf663523b96ec023200fa8a0f58209f8">a</a>;</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;  }</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;};</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160; </div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;<span class="comment">// All inputs and outputs are relative to the unit-radius sphere. Vectors and</span></div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;<span class="comment">// points are 3D.</span></div>
<div class="line"><a name="l00550"></a><span class="lineno"><a class="line" href="structsiqk_1_1_sphere_geometry.html">  550</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structsiqk_1_1_sphere_geometry.html">SphereGeometry</a> {</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> CV, <span class="keyword">typename</span> V&gt; KOKKOS_INLINE_FUNCTION</div>
<div class="line"><a name="l00552"></a><span class="lineno"><a class="line" href="structsiqk_1_1_sphere_geometry.html#aa3b244e614f36a709624d53b10909334">  552</a></span>&#160;  <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="structsiqk_1_1_sphere_geometry.html#aa3b244e614f36a709624d53b10909334">cross</a> (<span class="keyword">const</span> CV <a class="code" href="namespacejw.html#acf663523b96ec023200fa8a0f58209f8">a</a>, <span class="keyword">const</span> CV <a class="code" href="namespacebaroclinic__wave.html#acf8e56bd7dfdfd2c39e16dfa491a5293">b</a>, V c) {</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;    c[0] = <a class="code" href="namespacejw.html#acf663523b96ec023200fa8a0f58209f8">a</a>[1]*<a class="code" href="namespacebaroclinic__wave.html#acf8e56bd7dfdfd2c39e16dfa491a5293">b</a>[2] - <a class="code" href="namespacejw.html#acf663523b96ec023200fa8a0f58209f8">a</a>[2]*<a class="code" href="namespacebaroclinic__wave.html#acf8e56bd7dfdfd2c39e16dfa491a5293">b</a>[1];</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;    c[1] = <a class="code" href="namespacejw.html#acf663523b96ec023200fa8a0f58209f8">a</a>[2]*<a class="code" href="namespacebaroclinic__wave.html#acf8e56bd7dfdfd2c39e16dfa491a5293">b</a>[0] - <a class="code" href="namespacejw.html#acf663523b96ec023200fa8a0f58209f8">a</a>[0]*<a class="code" href="namespacebaroclinic__wave.html#acf8e56bd7dfdfd2c39e16dfa491a5293">b</a>[2];</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;    c[2] = <a class="code" href="namespacejw.html#acf663523b96ec023200fa8a0f58209f8">a</a>[0]*<a class="code" href="namespacebaroclinic__wave.html#acf8e56bd7dfdfd2c39e16dfa491a5293">b</a>[1] - <a class="code" href="namespacejw.html#acf663523b96ec023200fa8a0f58209f8">a</a>[1]*<a class="code" href="namespacebaroclinic__wave.html#acf8e56bd7dfdfd2c39e16dfa491a5293">b</a>[0];</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;  }</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> CVA, <span class="keyword">typename</span> CVB&gt; KOKKOS_INLINE_FUNCTION</div>
<div class="line"><a name="l00558"></a><span class="lineno"><a class="line" href="structsiqk_1_1_sphere_geometry.html#ab09386c8b086f7b7df5c15b3f72af91e">  558</a></span>&#160;  <span class="keyword">static</span> <a class="code" href="namespacesiqk.html#a6694847e2d56e697aa08277444325083">Real</a> <a class="code" href="structsiqk_1_1_sphere_geometry.html#ab09386c8b086f7b7df5c15b3f72af91e">dot</a> (<span class="keyword">const</span> CVA <a class="code" href="namespacejw.html#acf663523b96ec023200fa8a0f58209f8">a</a>, <span class="keyword">const</span> CVB <a class="code" href="namespacebaroclinic__wave.html#acf8e56bd7dfdfd2c39e16dfa491a5293">b</a>) {</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacejw.html#acf663523b96ec023200fa8a0f58209f8">a</a>[0]*<a class="code" href="namespacebaroclinic__wave.html#acf8e56bd7dfdfd2c39e16dfa491a5293">b</a>[0] + <a class="code" href="namespacejw.html#acf663523b96ec023200fa8a0f58209f8">a</a>[1]*<a class="code" href="namespacebaroclinic__wave.html#acf8e56bd7dfdfd2c39e16dfa491a5293">b</a>[1] + <a class="code" href="namespacejw.html#acf663523b96ec023200fa8a0f58209f8">a</a>[2]*<a class="code" href="namespacebaroclinic__wave.html#acf8e56bd7dfdfd2c39e16dfa491a5293">b</a>[2];</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;  }</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> CV&gt; KOKKOS_INLINE_FUNCTION</div>
<div class="line"><a name="l00562"></a><span class="lineno"><a class="line" href="structsiqk_1_1_sphere_geometry.html#abeb5a91432744cabf20d3a357e08f18d">  562</a></span>&#160;  <span class="keyword">static</span> <a class="code" href="namespacesiqk.html#a6694847e2d56e697aa08277444325083">Real</a> <a class="code" href="structsiqk_1_1_sphere_geometry.html#abeb5a91432744cabf20d3a357e08f18d">norm2</a> (<span class="keyword">const</span> CV v) {</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="structsiqk_1_1_sphere_geometry.html#ab09386c8b086f7b7df5c15b3f72af91e">dot</a>(v, v);</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;  }</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> V&gt; KOKKOS_INLINE_FUNCTION</div>
<div class="line"><a name="l00566"></a><span class="lineno"><a class="line" href="structsiqk_1_1_sphere_geometry.html#a5cd34159f10e01024d4425b363e922e8">  566</a></span>&#160;  <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="structsiqk_1_1_sphere_geometry.html#a5cd34159f10e01024d4425b363e922e8">scale</a> (<span class="keyword">const</span> <a class="code" href="namespacesiqk.html#a6694847e2d56e697aa08277444325083">Real</a>&amp; <a class="code" href="namespacejw.html#acf663523b96ec023200fa8a0f58209f8">a</a>, V v) {</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;    v[0] *= <a class="code" href="namespacejw.html#acf663523b96ec023200fa8a0f58209f8">a</a>; v[1] *= <a class="code" href="namespacejw.html#acf663523b96ec023200fa8a0f58209f8">a</a>; v[2] *= <a class="code" href="namespacejw.html#acf663523b96ec023200fa8a0f58209f8">a</a>;</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;  }</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> V&gt; KOKKOS_INLINE_FUNCTION</div>
<div class="line"><a name="l00570"></a><span class="lineno"><a class="line" href="structsiqk_1_1_sphere_geometry.html#a5d62310dba1533d5822d1e61a2124303">  570</a></span>&#160;  <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="structsiqk_1_1_sphere_geometry.html#a5d62310dba1533d5822d1e61a2124303">normalize</a> (V v) {</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;    <a class="code" href="structsiqk_1_1_sphere_geometry.html#a5cd34159f10e01024d4425b363e922e8">scale</a>(1.0/std::sqrt(<a class="code" href="structsiqk_1_1_sphere_geometry.html#abeb5a91432744cabf20d3a357e08f18d">norm2</a>(v)), v);</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;  }</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> CVC, <span class="keyword">typename</span> CVA, <span class="keyword">typename</span> CVB&gt; KOKKOS_INLINE_FUNCTION</div>
<div class="line"><a name="l00574"></a><span class="lineno"><a class="line" href="structsiqk_1_1_sphere_geometry.html#a4285d0d14d246cfc3e6687c7aed5ec36">  574</a></span>&#160;  <span class="keyword">static</span> <a class="code" href="namespacesiqk.html#a6694847e2d56e697aa08277444325083">Real</a> <a class="code" href="structsiqk_1_1_sphere_geometry.html#a4285d0d14d246cfc3e6687c7aed5ec36">dot_c_amb</a> (<span class="keyword">const</span> CVC c, <span class="keyword">const</span> CVA <a class="code" href="namespacejw.html#acf663523b96ec023200fa8a0f58209f8">a</a>, <span class="keyword">const</span> CVB <a class="code" href="namespacebaroclinic__wave.html#acf8e56bd7dfdfd2c39e16dfa491a5293">b</a>) {</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;    <span class="keywordflow">return</span> c[0]*(<a class="code" href="namespacejw.html#acf663523b96ec023200fa8a0f58209f8">a</a>[0] - <a class="code" href="namespacebaroclinic__wave.html#acf8e56bd7dfdfd2c39e16dfa491a5293">b</a>[0]) + c[1]*(<a class="code" href="namespacejw.html#acf663523b96ec023200fa8a0f58209f8">a</a>[1] - <a class="code" href="namespacebaroclinic__wave.html#acf8e56bd7dfdfd2c39e16dfa491a5293">b</a>[1]) + c[2]*(<a class="code" href="namespacejw.html#acf663523b96ec023200fa8a0f58209f8">a</a>[2] - <a class="code" href="namespacebaroclinic__wave.html#acf8e56bd7dfdfd2c39e16dfa491a5293">b</a>[2]);</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;  }</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> CV, <span class="keyword">typename</span> V&gt; KOKKOS_INLINE_FUNCTION</div>
<div class="line"><a name="l00578"></a><span class="lineno"><a class="line" href="structsiqk_1_1_sphere_geometry.html#a08158927fa5b0e17115588332406f820">  578</a></span>&#160;  <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="structsiqk_1_1_sphere_geometry.html#a08158927fa5b0e17115588332406f820">axpy</a> (<span class="keyword">const</span> <a class="code" href="namespacesiqk.html#a6694847e2d56e697aa08277444325083">Real</a>&amp; <a class="code" href="namespacejw.html#acf663523b96ec023200fa8a0f58209f8">a</a>, <span class="keyword">const</span> CV <a class="code" href="namespacesupercell.html#ae57ef03dc0cb9828dbacc89aac8870c0">x</a>, V y) {</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;    y[0] += <a class="code" href="namespacejw.html#acf663523b96ec023200fa8a0f58209f8">a</a>*<a class="code" href="namespacesupercell.html#ae57ef03dc0cb9828dbacc89aac8870c0">x</a>[0];</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;    y[1] += <a class="code" href="namespacejw.html#acf663523b96ec023200fa8a0f58209f8">a</a>*<a class="code" href="namespacesupercell.html#ae57ef03dc0cb9828dbacc89aac8870c0">x</a>[1];</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;    y[2] += <a class="code" href="namespacejw.html#acf663523b96ec023200fa8a0f58209f8">a</a>*<a class="code" href="namespacesupercell.html#ae57ef03dc0cb9828dbacc89aac8870c0">x</a>[2];</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;  }</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> CVX, <span class="keyword">typename</span> CVY, <span class="keyword">typename</span> VZ&gt; KOKKOS_INLINE_FUNCTION</div>
<div class="line"><a name="l00584"></a><span class="lineno"><a class="line" href="structsiqk_1_1_sphere_geometry.html#abe55b2f04df31eb101c6ede1d4e2da3f">  584</a></span>&#160;  <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="structsiqk_1_1_sphere_geometry.html#abe55b2f04df31eb101c6ede1d4e2da3f">axpbyz</a> (<span class="keyword">const</span> <a class="code" href="namespacesiqk.html#a6694847e2d56e697aa08277444325083">Real</a>&amp; <a class="code" href="namespacejw.html#acf663523b96ec023200fa8a0f58209f8">a</a>, <span class="keyword">const</span> CVX <a class="code" href="namespacesupercell.html#ae57ef03dc0cb9828dbacc89aac8870c0">x</a>, <span class="keyword">const</span> <a class="code" href="namespacesiqk.html#a6694847e2d56e697aa08277444325083">Real</a>&amp; <a class="code" href="namespacebaroclinic__wave.html#acf8e56bd7dfdfd2c39e16dfa491a5293">b</a>, <span class="keyword">const</span> CVY y,</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;                      VZ z) {</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;    z[0] = <a class="code" href="namespacejw.html#acf663523b96ec023200fa8a0f58209f8">a</a>*<a class="code" href="namespacesupercell.html#ae57ef03dc0cb9828dbacc89aac8870c0">x</a>[0] + <a class="code" href="namespacebaroclinic__wave.html#acf8e56bd7dfdfd2c39e16dfa491a5293">b</a>*y[0];</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;    z[1] = <a class="code" href="namespacejw.html#acf663523b96ec023200fa8a0f58209f8">a</a>*<a class="code" href="namespacesupercell.html#ae57ef03dc0cb9828dbacc89aac8870c0">x</a>[1] + <a class="code" href="namespacebaroclinic__wave.html#acf8e56bd7dfdfd2c39e16dfa491a5293">b</a>*y[1];</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;    z[2] = <a class="code" href="namespacejw.html#acf663523b96ec023200fa8a0f58209f8">a</a>*<a class="code" href="namespacesupercell.html#ae57ef03dc0cb9828dbacc89aac8870c0">x</a>[2] + <a class="code" href="namespacebaroclinic__wave.html#acf8e56bd7dfdfd2c39e16dfa491a5293">b</a>*y[2];</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;  }</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> V, <span class="keyword">typename</span> CV&gt; KOKKOS_INLINE_FUNCTION</div>
<div class="line"><a name="l00591"></a><span class="lineno"><a class="line" href="structsiqk_1_1_sphere_geometry.html#ac0ede37337f870a25eebf6c08e13e0a7">  591</a></span>&#160;  <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="structsiqk_1_1_sphere_geometry.html#ac0ede37337f870a25eebf6c08e13e0a7">copy</a> (V d, <span class="keyword">const</span> CV s) {</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;    d[0] = s[0];</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;    d[1] = s[1];</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;    d[2] = s[2];</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;  }</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> CV, <span class="keyword">typename</span> V&gt; KOKKOS_INLINE_FUNCTION</div>
<div class="line"><a name="l00597"></a><span class="lineno"><a class="line" href="structsiqk_1_1_sphere_geometry.html#a96b5477dfa04c756127d8c8a528cec0e">  597</a></span>&#160;  <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="structsiqk_1_1_sphere_geometry.html#a96b5477dfa04c756127d8c8a528cec0e">combine</a> (<span class="keyword">const</span> CV u, <span class="keyword">const</span> CV v, <span class="keyword">const</span> <a class="code" href="namespacesiqk.html#a6694847e2d56e697aa08277444325083">Real</a>&amp; <a class="code" href="namespacejw.html#acf663523b96ec023200fa8a0f58209f8">a</a>, V <a class="code" href="namespacesupercell.html#ae57ef03dc0cb9828dbacc89aac8870c0">x</a>) {</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;    <span class="keyword">const</span> <a class="code" href="namespacesiqk.html#a6694847e2d56e697aa08277444325083">Real</a>&amp; oma = 1 - <a class="code" href="namespacejw.html#acf663523b96ec023200fa8a0f58209f8">a</a>;</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;    <a class="code" href="namespacesupercell.html#ae57ef03dc0cb9828dbacc89aac8870c0">x</a>[0] = oma*u[0] + <a class="code" href="namespacejw.html#acf663523b96ec023200fa8a0f58209f8">a</a>*v[0];</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;    <a class="code" href="namespacesupercell.html#ae57ef03dc0cb9828dbacc89aac8870c0">x</a>[1] = oma*u[1] + <a class="code" href="namespacejw.html#acf663523b96ec023200fa8a0f58209f8">a</a>*v[1];</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;    <a class="code" href="namespacesupercell.html#ae57ef03dc0cb9828dbacc89aac8870c0">x</a>[2] = oma*u[2] + <a class="code" href="namespacejw.html#acf663523b96ec023200fa8a0f58209f8">a</a>*v[2];</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;  }</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160; </div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> CV, <span class="keyword">typename</span> V&gt; KOKKOS_INLINE_FUNCTION</div>
<div class="line"><a name="l00605"></a><span class="lineno"><a class="line" href="structsiqk_1_1_sphere_geometry.html#a10bebaf5ff1a296f4dfaa50523876b73">  605</a></span>&#160;  <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="structsiqk_1_1_sphere_geometry.html#a10bebaf5ff1a296f4dfaa50523876b73">edge_normal</a> (<span class="keyword">const</span> CV <a class="code" href="namespacejw.html#acf663523b96ec023200fa8a0f58209f8">a</a>, <span class="keyword">const</span> CV <a class="code" href="namespacebaroclinic__wave.html#acf8e56bd7dfdfd2c39e16dfa491a5293">b</a>, V en) {</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;    <a class="code" href="structsiqk_1_1_sphere_geometry.html#aa3b244e614f36a709624d53b10909334">cross</a>(<a class="code" href="namespacejw.html#acf663523b96ec023200fa8a0f58209f8">a</a>, <a class="code" href="namespacebaroclinic__wave.html#acf8e56bd7dfdfd2c39e16dfa491a5293">b</a>, en);</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;    <a class="code" href="structsiqk_1_1_sphere_geometry.html#a5d62310dba1533d5822d1e61a2124303">normalize</a>(en);</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;  }</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160; </div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;  <span class="comment">// Is v inside the line anchored at a with inward-facing normal n?</span></div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> CVV, <span class="keyword">typename</span> CVA, <span class="keyword">typename</span> CVN&gt; KOKKOS_INLINE_FUNCTION</div>
<div class="line"><a name="l00612"></a><span class="lineno"><a class="line" href="structsiqk_1_1_sphere_geometry.html#a76492d5747e39b374b0c253894ad5744">  612</a></span>&#160;  <span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="structsiqk_1_1_sphere_geometry.html#a76492d5747e39b374b0c253894ad5744">inside</a> (<span class="keyword">const</span> CVV v, <span class="keyword">const</span> CVA <a class="code" href="namespacejw.html#acf663523b96ec023200fa8a0f58209f8">a</a>, <span class="keyword">const</span> CVN n) {</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="structsiqk_1_1_sphere_geometry.html#a4285d0d14d246cfc3e6687c7aed5ec36">dot_c_amb</a>(n, v, <a class="code" href="namespacejw.html#acf663523b96ec023200fa8a0f58209f8">a</a>) &gt;= 0;</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;  }</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160; </div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;  <span class="comment">/* Let</span></div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;<span class="comment">       en = edge normal</span></div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;<span class="comment">       e1 = edge starting point</span></div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;<span class="comment">       d = en&#39; e1</span></div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;<span class="comment">       v(a) = (1 - a) v1 + a v2.</span></div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;<span class="comment">     Solve n&#39; v = d for a:</span></div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;<span class="comment">       a = (en&#39; (e1 - v1)) / (en&#39; (v2 - v1)).</span></div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;<span class="comment">     Then uvec(v(a)) is the intersection point on the unit sphere. Assume</span></div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;<span class="comment">     intersection exists. (Already filtered by &#39;inside&#39;.)</span></div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;<span class="comment">  */</span></div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> CV, <span class="keyword">typename</span> V&gt; KOKKOS_INLINE_FUNCTION</div>
<div class="line"><a name="l00627"></a><span class="lineno"><a class="line" href="structsiqk_1_1_sphere_geometry.html#ad5491c146f58632ad07f1717bc705028">  627</a></span>&#160;  <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="structsiqk_1_1_sphere_geometry.html#ad5491c146f58632ad07f1717bc705028">intersect</a> (<span class="keyword">const</span> CV v1, <span class="keyword">const</span> CV v2, <span class="keyword">const</span> CV e1, <span class="keyword">const</span> CV en,</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;                         V intersection) {</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;    <a class="code" href="namespacesiqk.html#a6694847e2d56e697aa08277444325083">Real</a> <a class="code" href="namespacejw.html#acf663523b96ec023200fa8a0f58209f8">a</a>; {</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;      <span class="keyword">const</span> <a class="code" href="namespacesiqk.html#a6694847e2d56e697aa08277444325083">Real</a></div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;        num = <a class="code" href="structsiqk_1_1_sphere_geometry.html#a4285d0d14d246cfc3e6687c7aed5ec36">dot_c_amb</a>(en, e1, v1),</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;        den = <a class="code" href="structsiqk_1_1_sphere_geometry.html#a4285d0d14d246cfc3e6687c7aed5ec36">dot_c_amb</a>(en, v2, v1);</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;      <a class="code" href="namespacejw.html#acf663523b96ec023200fa8a0f58209f8">a</a> = num == 0 || den == 0 ? 0 : num/den;</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;      <a class="code" href="namespacejw.html#acf663523b96ec023200fa8a0f58209f8">a</a> = a &lt; 0 ? 0 : a &gt; 1 ? 1 : <a class="code" href="namespacejw.html#acf663523b96ec023200fa8a0f58209f8">a</a>;</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;    }</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;    <a class="code" href="structsiqk_1_1_sphere_geometry.html#a96b5477dfa04c756127d8c8a528cec0e">combine</a>(v1, v2, <a class="code" href="namespacejw.html#acf663523b96ec023200fa8a0f58209f8">a</a>, intersection);</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;    <a class="code" href="structsiqk_1_1_sphere_geometry.html#a5d62310dba1533d5822d1e61a2124303">normalize</a>(intersection);</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;  }</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160; </div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> CV, <span class="keyword">typename</span> V&gt; KOKKOS_INLINE_FUNCTION</div>
<div class="line"><a name="l00641"></a><span class="lineno"><a class="line" href="structsiqk_1_1_sphere_geometry.html#a27022ecf217cd41de8b02d307c8e283c">  641</a></span>&#160;  <span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="structsiqk_1_1_sphere_geometry.html#a27022ecf217cd41de8b02d307c8e283c">output</a> (<span class="keyword">const</span> CV v, <a class="code" href="namespacesiqk.html#a04b40b29b12c447399a02e3c1575bf66">Int</a>&amp; no, V vo) {</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;<span class="preprocessor">#ifdef SIQK_DEBUG</span></div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;    <span class="keywordflow">if</span> (no &gt;= <a class="code" href="namespacesiqk.html#a3f1b5069fc1ac06e18aa603b592403e6">nslices</a>(vo)) {</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;      std::stringstream ss;</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;      ss &lt;&lt; <span class="stringliteral">&quot;output: No room in vo; vo.n() is &quot;</span> &lt;&lt; <a class="code" href="namespacesiqk.html#a3f1b5069fc1ac06e18aa603b592403e6">nslices</a>(vo) &lt;&lt; <span class="stringliteral">&quot; but no is &quot;</span></div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;         &lt;&lt; no &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;      message(ss.str().c_str());</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;    }</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;    <span class="keywordflow">if</span> (no &gt;= <a class="code" href="namespacesiqk.html#a3f1b5069fc1ac06e18aa603b592403e6">nslices</a>(vo)) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;    vo(no,0) = v[0];</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;    vo(no,1) = v[1];</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;    vo(no,2) = v[2];</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;    ++no;</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;  }</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160; </div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;  <span class="comment">//todo Handle non-convex case.</span></div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;  <span class="comment">// This uses a terrible formula, but it&#39;s just for testing.</span></div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> CV3s&gt;</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;  KOKKOS_INLINE_FUNCTION</div>
<div class="line"><a name="l00662"></a><span class="lineno"><a class="line" href="structsiqk_1_1_sphere_geometry.html#a1618aaa4edfb918ad167c9fdb75cc8eb">  662</a></span>&#160;  <span class="keyword">static</span> <a class="code" href="namespacesiqk.html#a6694847e2d56e697aa08277444325083">Real</a> <a class="code" href="structsiqk_1_1_sphere_geometry.html#a1618aaa4edfb918ad167c9fdb75cc8eb">calc_area_formula</a> (<span class="keyword">const</span> CV3s&amp; v, <span class="keyword">const</span> <a class="code" href="namespacesiqk.html#a04b40b29b12c447399a02e3c1575bf66">Int</a> n) {</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;    <a class="code" href="namespacesiqk.html#a6694847e2d56e697aa08277444325083">Real</a> area = 0;</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="namespacesiqk.html#a04b40b29b12c447399a02e3c1575bf66">Int</a> i = 1, ilim = n - 1; i &lt; ilim; ++i) {</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;      <span class="keyword">const</span> <a class="code" href="namespacesiqk.html#a6694847e2d56e697aa08277444325083">Real</a> <a class="code" href="namespacejw.html#acf663523b96ec023200fa8a0f58209f8">a</a> = <a class="code" href="structsiqk_1_1_sphere_geometry.html#a4e6a9a84dc10f2cbccf89be84af41a7e">calc_arc_length</a>(<a class="code" href="namespacesiqk.html#aef983887889243999a1d7ddea864ad1f">slice</a>(v,0), <a class="code" href="namespacesiqk.html#aef983887889243999a1d7ddea864ad1f">slice</a>(v,i));</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;      <span class="keyword">const</span> <a class="code" href="namespacesiqk.html#a6694847e2d56e697aa08277444325083">Real</a> <a class="code" href="namespacebaroclinic__wave.html#acf8e56bd7dfdfd2c39e16dfa491a5293">b</a> = <a class="code" href="structsiqk_1_1_sphere_geometry.html#a4e6a9a84dc10f2cbccf89be84af41a7e">calc_arc_length</a>(<a class="code" href="namespacesiqk.html#aef983887889243999a1d7ddea864ad1f">slice</a>(v,i), <a class="code" href="namespacesiqk.html#aef983887889243999a1d7ddea864ad1f">slice</a>(v,i+1));</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;      <span class="keyword">const</span> <a class="code" href="namespacesiqk.html#a6694847e2d56e697aa08277444325083">Real</a> c = <a class="code" href="structsiqk_1_1_sphere_geometry.html#a4e6a9a84dc10f2cbccf89be84af41a7e">calc_arc_length</a>(<a class="code" href="namespacesiqk.html#aef983887889243999a1d7ddea864ad1f">slice</a>(v,i+1), <a class="code" href="namespacesiqk.html#aef983887889243999a1d7ddea864ad1f">slice</a>(v,0));</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;      <span class="keyword">const</span> <a class="code" href="namespacesiqk.html#a6694847e2d56e697aa08277444325083">Real</a> s = 0.5*(<a class="code" href="namespacejw.html#acf663523b96ec023200fa8a0f58209f8">a</a> + <a class="code" href="namespacebaroclinic__wave.html#acf8e56bd7dfdfd2c39e16dfa491a5293">b</a> + c);</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;      <span class="keyword">const</span> <a class="code" href="namespacesiqk.html#a6694847e2d56e697aa08277444325083">Real</a> d = (std::tan(0.5*s)*std::tan(0.5*(s-<a class="code" href="namespacejw.html#acf663523b96ec023200fa8a0f58209f8">a</a>))*</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;                      std::tan(0.5*(s-<a class="code" href="namespacebaroclinic__wave.html#acf8e56bd7dfdfd2c39e16dfa491a5293">b</a>))*std::tan(0.5*(s-c)));</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;      <span class="keywordflow">if</span> (d &lt;= 0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;      area += 4*std::atan(std::sqrt(d));</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;    }</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;    <span class="keywordflow">return</span> area;</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;  }</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> CV&gt; KOKKOS_INLINE_FUNCTION</div>
<div class="line"><a name="l00677"></a><span class="lineno"><a class="line" href="structsiqk_1_1_sphere_geometry.html#a4e6a9a84dc10f2cbccf89be84af41a7e">  677</a></span>&#160;  <span class="keyword">static</span> <a class="code" href="namespacesiqk.html#a6694847e2d56e697aa08277444325083">Real</a> <a class="code" href="structsiqk_1_1_sphere_geometry.html#a4e6a9a84dc10f2cbccf89be84af41a7e">calc_arc_length</a> (<span class="keyword">const</span> CV <a class="code" href="namespacejw.html#acf663523b96ec023200fa8a0f58209f8">a</a>, <span class="keyword">const</span> CV <a class="code" href="namespacebaroclinic__wave.html#acf8e56bd7dfdfd2c39e16dfa491a5293">b</a>) {</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;    <span class="keyword">const</span> <a class="code" href="namespacesiqk.html#a6694847e2d56e697aa08277444325083">Real</a> d = <a class="code" href="structsiqk_1_1_sphere_geometry.html#ab09386c8b086f7b7df5c15b3f72af91e">dot</a>(<a class="code" href="namespacejw.html#acf663523b96ec023200fa8a0f58209f8">a</a>, <a class="code" href="namespacebaroclinic__wave.html#acf8e56bd7dfdfd2c39e16dfa491a5293">b</a>);</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;    <span class="keywordflow">if</span> (d &gt;= 1) <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;    <span class="keywordflow">return</span> acos(d);</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;  }</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160; </div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> CV3s&gt;</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;  KOKKOS_INLINE_FUNCTION</div>
<div class="line"><a name="l00685"></a><span class="lineno"><a class="line" href="structsiqk_1_1_sphere_geometry.html#a02d2e96e35359f90e419eb4fba379e34">  685</a></span>&#160;  <span class="keyword">static</span> <a class="code" href="namespacesiqk.html#a6694847e2d56e697aa08277444325083">Real</a> <a class="code" href="structsiqk_1_1_sphere_geometry.html#a02d2e96e35359f90e419eb4fba379e34">calc_area</a> (<span class="keyword">const</span> <a class="code" href="classsiqk_1_1_triangle_quadrature.html">TriangleQuadrature</a>&amp; q, <span class="keyword">const</span> CV3s&amp; v,</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;                         <span class="keyword">const</span> <a class="code" href="namespacesiqk.html#a04b40b29b12c447399a02e3c1575bf66">Int</a> n) {</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;    <a class="code" href="namespacesiqk.html#a6694847e2d56e697aa08277444325083">Real</a> area = 0, u[3];</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="namespacesiqk.html#a04b40b29b12c447399a02e3c1575bf66">Int</a> i = 1, ilim = n - 1; i &lt; ilim; ++i) {</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;      <a class="code" href="namespacesiqk.html#a6694847e2d56e697aa08277444325083">Real</a> <a class="code" href="namespacejw.html#acf663523b96ec023200fa8a0f58209f8">a</a> = 0;</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;      <a class="code" href="namespacesiqk.html#aee02aaa385cda31d0db2c0e750f24c08">RawConstVec3s</a> coord;</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;      <a class="code" href="namespacesiqk.html#a6f525866efd388ad8b6b947226520628">RawConstArray</a> weight;</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;      q.<a class="code" href="classsiqk_1_1_triangle_quadrature.html#a3cd181896eb90a4aa5e813b0f1697aec">get_coef</a>(8, coord, weight);</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="namespacesiqk.html#a04b40b29b12c447399a02e3c1575bf66">Int</a> <a class="code" href="namespacebaroclinic__wave.html#a8619f63e6dd6db1077c1a18788afa359">k</a> = 0, klim = <a class="code" href="namespacesiqk.html#a3f1b5069fc1ac06e18aa603b592403e6">nslices</a>(coord); <a class="code" href="namespacebaroclinic__wave.html#a8619f63e6dd6db1077c1a18788afa359">k</a> &lt; klim; ++<a class="code" href="namespacebaroclinic__wave.html#a8619f63e6dd6db1077c1a18788afa359">k</a>) {</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;        <span class="keyword">const</span> <a class="code" href="namespacesiqk.html#a6694847e2d56e697aa08277444325083">Real</a> jac = <a class="code" href="structsiqk_1_1_sphere_geometry.html#a925ea6009b465032ab66aeb8a7465120">calc_tri_jacobian</a>(<a class="code" href="namespacesiqk.html#aef983887889243999a1d7ddea864ad1f">slice</a>(v,0), <a class="code" href="namespacesiqk.html#aef983887889243999a1d7ddea864ad1f">slice</a>(v,i), <a class="code" href="namespacesiqk.html#aef983887889243999a1d7ddea864ad1f">slice</a>(v,i+1),</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;                                           <a class="code" href="namespacesiqk.html#aef983887889243999a1d7ddea864ad1f">slice</a>(coord, <a class="code" href="namespacebaroclinic__wave.html#a8619f63e6dd6db1077c1a18788afa359">k</a>), u);</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;        <a class="code" href="namespacejw.html#acf663523b96ec023200fa8a0f58209f8">a</a> += weight[<a class="code" href="namespacebaroclinic__wave.html#a8619f63e6dd6db1077c1a18788afa359">k</a>]*jac;</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;      }</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;      area += 0.5*<a class="code" href="namespacejw.html#acf663523b96ec023200fa8a0f58209f8">a</a>;</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;    }</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;    <span class="keywordflow">return</span> area;</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;  }</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160; </div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> CV, <span class="keyword">typename</span> CA&gt;</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;  KOKKOS_INLINE_FUNCTION</div>
<div class="line"><a name="l00705"></a><span class="lineno"><a class="line" href="structsiqk_1_1_sphere_geometry.html#a925ea6009b465032ab66aeb8a7465120">  705</a></span>&#160;  <span class="keyword">static</span> <a class="code" href="namespacesiqk.html#a6694847e2d56e697aa08277444325083">Real</a> <a class="code" href="structsiqk_1_1_sphere_geometry.html#a925ea6009b465032ab66aeb8a7465120">calc_tri_jacobian</a> (<span class="keyword">const</span> CV v1, <span class="keyword">const</span> CV v2, <span class="keyword">const</span> CV v3,</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;                                 <span class="keyword">const</span> CA alpha, <a class="code" href="namespacesiqk.html#a6694847e2d56e697aa08277444325083">Real</a> u[3]) {</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;    <span class="comment">// V(:,i) is vertex i of the spherical triangle on the unit sphere. The</span></div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;    <span class="comment">// coefs</span></div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;    <span class="comment">//     alpha = [a1, a2, 1 - a1 - a2]&#39;</span></div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;    <span class="comment">//           = [1 0; 0 1; -1 -1] [a1, a2]&#39;</span></div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;    <span class="comment">//           = alpha_a a</span></div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;    <span class="comment">// (barycentric coords) give the location</span></div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;    <span class="comment">//     v = V alpha</span></div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;    <span class="comment">// on the planar triangle, and u = uvec(v) is the point on the unit sphere.</span></div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;    <span class="comment">//   For a planar tri in 3D, the jacobian is</span></div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;    <span class="comment">//     v_a = v_alpha alpha_a</span></div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;    <span class="comment">//         = V [1 0; 0 1; -1 -1]</span></div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;    <span class="comment">//     J = norm(cross(v_a(:,1), v_a(:,2))).</span></div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;    <span class="comment">// For a spherical tri with the same vertices,</span></div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;    <span class="comment">//     u = v/(v&#39; v)^{1/2}</span></div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;    <span class="comment">//     u_a = u_alpha alpha_a</span></div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;    <span class="comment">//         = (v&#39;v)^{-1/2} (I - u u&#39;) V alpha_a</span></div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;    <span class="comment">//         = (v&#39;v)^{-1/2} (I - u u&#39;) v_a</span></div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;    <span class="comment">//     J = norm(cross(u_a(:,1), u_a(:,2))).</span></div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="namespacesiqk.html#a04b40b29b12c447399a02e3c1575bf66">Int</a> <a class="code" href="namespacebaroclinic__wave.html#a8619f63e6dd6db1077c1a18788afa359">k</a> = 0; <a class="code" href="namespacebaroclinic__wave.html#a8619f63e6dd6db1077c1a18788afa359">k</a> &lt; 3; ++<a class="code" href="namespacebaroclinic__wave.html#a8619f63e6dd6db1077c1a18788afa359">k</a>) u[<a class="code" href="namespacebaroclinic__wave.html#a8619f63e6dd6db1077c1a18788afa359">k</a>] = 0;</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;    <a class="code" href="structsiqk_1_1_sphere_geometry.html#a08158927fa5b0e17115588332406f820">axpy</a>(alpha[0], v1, u);</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;    <a class="code" href="structsiqk_1_1_sphere_geometry.html#a08158927fa5b0e17115588332406f820">axpy</a>(alpha[1], v2, u);</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;    <a class="code" href="structsiqk_1_1_sphere_geometry.html#a08158927fa5b0e17115588332406f820">axpy</a>(alpha[2], v3, u);</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span> oovn = 1/std::sqrt(<a class="code" href="structsiqk_1_1_sphere_geometry.html#abeb5a91432744cabf20d3a357e08f18d">norm2</a>(u));</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;    <a class="code" href="structsiqk_1_1_sphere_geometry.html#a5cd34159f10e01024d4425b363e922e8">scale</a>(oovn, u);</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;    <a class="code" href="namespacesiqk.html#a6694847e2d56e697aa08277444325083">Real</a> u_a[3][3];</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;    <a class="code" href="structsiqk_1_1_sphere_geometry.html#abe55b2f04df31eb101c6ede1d4e2da3f">axpbyz</a>(1, v1, -1, v3, u_a[0]);</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;    <a class="code" href="structsiqk_1_1_sphere_geometry.html#abe55b2f04df31eb101c6ede1d4e2da3f">axpbyz</a>(1, v2, -1, v3, u_a[1]);</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 2; ++i) {</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;      <a class="code" href="structsiqk_1_1_sphere_geometry.html#a08158927fa5b0e17115588332406f820">axpy</a>(-<a class="code" href="structsiqk_1_1_sphere_geometry.html#ab09386c8b086f7b7df5c15b3f72af91e">dot</a>(u, u_a[i]), u, u_a[i]);</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;      <a class="code" href="structsiqk_1_1_sphere_geometry.html#a5cd34159f10e01024d4425b363e922e8">scale</a>(oovn, u_a[i]);</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;    }</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;    <a class="code" href="structsiqk_1_1_sphere_geometry.html#aa3b244e614f36a709624d53b10909334">cross</a>(u_a[0], u_a[1], u_a[2]);</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;    <span class="keywordflow">return</span> std::sqrt(<a class="code" href="structsiqk_1_1_sphere_geometry.html#abeb5a91432744cabf20d3a357e08f18d">norm2</a>(u_a[2]));</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;  }</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;};</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160; </div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;} <span class="comment">// namespace siqk</span></div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160; </div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;<span class="preprocessor">#endif </span><span class="comment">// INCLUDE_SIQK_GEOMETRY_HPP</span></div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160; </div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;<span class="preprocessor">#ifndef INCLUDE_SIQK_INTERSECT_HPP</span></div>
<div class="line"><a name="l00748"></a><span class="lineno"><a class="line" href="compose__slmm_8cpp.html#aca424a5e8cd2653f4d6db39cc4c0cfad">  748</a></span>&#160;<span class="preprocessor">#define INCLUDE_SIQK_INTERSECT_HPP</span></div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160; </div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;<span class="comment">//#include &quot;siqk_defs.hpp&quot;</span></div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;<span class="comment">//#include &quot;siqk_geometry.hpp&quot;</span></div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;<span class="comment">//#include &quot;siqk_search.hpp&quot;</span></div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;<span class="comment">//#include &quot;siqk_quadrature.hpp&quot;</span></div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160; </div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespacesiqk.html">siqk</a> {</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160; </div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;<span class="comment">// Sutherland-Hodgmann polygon clipping algorithm. Follow Foley, van Dam,</span></div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;<span class="comment">// Feiner, Hughes Fig 3.49.</span></div>
<div class="line"><a name="l00759"></a><span class="lineno"><a class="line" href="namespacesiqk_1_1sh.html">  759</a></span>&#160;<span class="keyword">namespace </span>sh {</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;<span class="comment">/* A mesh is described by the following arrays:</span></div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;<span class="comment">       p: 3 x #nodes, the array of vertices.</span></div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;<span class="comment">       e: max(#verts) x #elems, the array of element base-0 indices.</span></div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;<span class="comment">       nml: 3 x #edges, the array of edge normals.</span></div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;<span class="comment">       en: max(#verts) x #elems, the array of edge-normal base-0 indices.</span></div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;<span class="comment">     e. e indexes p. e(i,j) == -1 in column j indicates that j:end are not used.</span></div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;<span class="comment">     nml. As a mesh is refined, cancellation error makes an edge normal based</span></div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;<span class="comment">   off of an element&#39;s vertices increasingly inaccurate. Roughly, if an edge</span></div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;<span class="comment">   subtends angle phi of the sphere, -log10(phi/(2 pi)) digits are lost in the</span></div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;<span class="comment">   edge normal. Therefore, we compute edge normals offline, since in certain</span></div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;<span class="comment">   meshes, they can be computed by an accurate means. E.g., in a cubed-sphere</span></div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;<span class="comment">   mesh, the whole line of a square face can be used to compute the edge</span></div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;<span class="comment">   normal. Furthermore, there are far fewer unique edge normals than edges.</span></div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> ES = ko::DefaultExecutionSpace&gt;</div>
<div class="line"><a name="l00775"></a><span class="lineno"><a class="line" href="structsiqk_1_1sh_1_1_mesh.html">  775</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structsiqk_1_1sh_1_1_mesh.html">Mesh</a> {</div>
<div class="line"><a name="l00776"></a><span class="lineno"><a class="line" href="structsiqk_1_1sh_1_1_mesh.html#abb2b255c79d852e853cdc9ab6ffc092f">  776</a></span>&#160;  <span class="keyword">typedef</span> <span class="keyword">typename</span> <a class="code" href="structsiqk_1_1_in_exe_space.html#a39009b9757c788f34a6db4f442f8adb2">InExeSpace&lt;ConstVec3s, ES&gt;::type</a> <a class="code" href="structsiqk_1_1sh_1_1_mesh.html#abb2b255c79d852e853cdc9ab6ffc092f">RealArray</a>;</div>
<div class="line"><a name="l00777"></a><span class="lineno"><a class="line" href="structsiqk_1_1sh_1_1_mesh.html#a1ebc900d7142e767c6b27925916fc917">  777</a></span>&#160;  <span class="keyword">typedef</span> <span class="keyword">typename</span> <a class="code" href="structsiqk_1_1_in_exe_space.html#a39009b9757c788f34a6db4f442f8adb2">InExeSpace&lt;ConstIdxs, ES&gt;::type</a> <a class="code" href="structsiqk_1_1sh_1_1_mesh.html#a1ebc900d7142e767c6b27925916fc917">IntArray</a>;</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160; </div>
<div class="line"><a name="l00779"></a><span class="lineno"><a class="line" href="structsiqk_1_1sh_1_1_mesh.html#a08b7acf03ca69f64736bda8060053539">  779</a></span>&#160;  <a class="code" href="structsiqk_1_1sh_1_1_mesh.html#abb2b255c79d852e853cdc9ab6ffc092f">RealArray</a> <a class="code" href="structsiqk_1_1sh_1_1_mesh.html#a09ea9632dd1680a04d53aec55d4b6e4f">p</a>, <a class="code" href="structsiqk_1_1sh_1_1_mesh.html#a08b7acf03ca69f64736bda8060053539">nml</a>;</div>
<div class="line"><a name="l00780"></a><span class="lineno"><a class="line" href="structsiqk_1_1sh_1_1_mesh.html#a3e86d388497c2a559b87e401a1235e87">  780</a></span>&#160;  <a class="code" href="structsiqk_1_1sh_1_1_mesh.html#a1ebc900d7142e767c6b27925916fc917">IntArray</a> <a class="code" href="structsiqk_1_1sh_1_1_mesh.html#a3e86d388497c2a559b87e401a1235e87">e</a>, <a class="code" href="structsiqk_1_1sh_1_1_mesh.html#ac734002157287653809b1a732348d568">en</a>;</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160; </div>
<div class="line"><a name="l00782"></a><span class="lineno"><a class="line" href="structsiqk_1_1sh_1_1_mesh.html#ae6c581aa93fb98d457e55dfad1f6f898">  782</a></span>&#160;  <a class="code" href="structsiqk_1_1sh_1_1_mesh.html#ae6c581aa93fb98d457e55dfad1f6f898">Mesh</a> () {}</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160; </div>
<div class="line"><a name="l00784"></a><span class="lineno"><a class="line" href="structsiqk_1_1sh_1_1_mesh.html#a5840d05f3000193f5e19bbf51e0b2845">  784</a></span>&#160;  <a class="code" href="structsiqk_1_1sh_1_1_mesh.html#a5840d05f3000193f5e19bbf51e0b2845">Mesh</a> (<span class="keyword">const</span> <a class="code" href="structsiqk_1_1sh_1_1_mesh.html">Mesh&lt;ko::HostSpace&gt;</a>&amp; m) {</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;    <span class="keyword">typename</span> <a class="code" href="structsiqk_1_1_in_exe_space.html#a39009b9757c788f34a6db4f442f8adb2">InExeSpace&lt;Vec3s, ES&gt;::type</a> tp, tnml;</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;    <span class="keyword">typename</span> <a class="code" href="structsiqk_1_1_in_exe_space.html#a39009b9757c788f34a6db4f442f8adb2">InExeSpace&lt;Idxs, ES&gt;::type</a> te, ten;</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;    <a class="code" href="namespacesiqk.html#ae6ddc7d5c591da491b22457a56353479">resize_and_copy</a>(tp, m.<a class="code" href="structsiqk_1_1sh_1_1_mesh.html#a09ea9632dd1680a04d53aec55d4b6e4f">p</a>); <a class="code" href="structsiqk_1_1sh_1_1_mesh.html#a09ea9632dd1680a04d53aec55d4b6e4f">p</a> = tp;</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;    <a class="code" href="namespacesiqk.html#ae6ddc7d5c591da491b22457a56353479">resize_and_copy</a>(tnml, m.<a class="code" href="structsiqk_1_1sh_1_1_mesh.html#a08b7acf03ca69f64736bda8060053539">nml</a>); <a class="code" href="structsiqk_1_1sh_1_1_mesh.html#a08b7acf03ca69f64736bda8060053539">nml</a> = tnml;</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;    <a class="code" href="namespacesiqk.html#ae6ddc7d5c591da491b22457a56353479">resize_and_copy</a>(te, m.<a class="code" href="structsiqk_1_1sh_1_1_mesh.html#a3e86d388497c2a559b87e401a1235e87">e</a>); <a class="code" href="structsiqk_1_1sh_1_1_mesh.html#a3e86d388497c2a559b87e401a1235e87">e</a> = te;</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;    <a class="code" href="namespacesiqk.html#ae6ddc7d5c591da491b22457a56353479">resize_and_copy</a>(ten, m.<a class="code" href="structsiqk_1_1sh_1_1_mesh.html#ac734002157287653809b1a732348d568">en</a>); <a class="code" href="structsiqk_1_1sh_1_1_mesh.html#ac734002157287653809b1a732348d568">en</a> = ten;</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;  }</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;};</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;} <span class="comment">// namespace sh</span></div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160; </div>
<div class="line"><a name="l00795"></a><span class="lineno"><a class="line" href="namespacesiqk_1_1test.html">  795</a></span>&#160;<span class="keyword">namespace </span>test {</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;<span class="keyword">static</span> constexpr <a class="code" href="namespacesiqk.html#a04b40b29b12c447399a02e3c1575bf66">Int</a> max_nvert = 20;</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;<span class="keyword">static</span> constexpr <a class="code" href="namespacesiqk.html#a04b40b29b12c447399a02e3c1575bf66">Int</a> max_hits = 25; <span class="comment">// Covers at least a 2-halo.</span></div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160; </div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;<span class="comment">// Inward-oriented normal. In practice, we want to form high-quality normals</span></div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;<span class="comment">// using information about the cubed-sphere mesh. This is a low-quality</span></div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;<span class="comment">// brute-force calculation.</span></div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> geo&gt;</div>
<div class="line"><a name="l00803"></a><span class="lineno"><a class="line" href="namespacesiqk_1_1test.html#a75fe76653ae6f11ac4078ebf74da87e6">  803</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespacesiqk_1_1test.html#a75fe76653ae6f11ac4078ebf74da87e6">fill_normals</a> (<a class="code" href="structsiqk_1_1sh_1_1_mesh.html">sh::Mesh&lt;ko::HostSpace&gt;</a>&amp; m) {</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;  <span class="comment">// Count number of edges.</span></div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;  <a class="code" href="namespacesiqk.html#a04b40b29b12c447399a02e3c1575bf66">Int</a> <a class="code" href="namespacedimensions__mod.html#af137394c40531d5d6f0daa64351372e7">ne</a> = 0;</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacesiqk.html#a04b40b29b12c447399a02e3c1575bf66">Int</a> ip = 0; ip &lt; <a class="code" href="namespacesiqk.html#a3f1b5069fc1ac06e18aa603b592403e6">nslices</a>(m.<a class="code" href="structsiqk_1_1sh_1_1_mesh.html#a3e86d388497c2a559b87e401a1235e87">e</a>); ++ip)</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="namespacesiqk.html#a04b40b29b12c447399a02e3c1575bf66">Int</a> iv = 0; iv &lt; <a class="code" href="namespacesiqk.html#a6c43ff2c83ad6b7d0dc61c2c5e83a680">szslice</a>(m.<a class="code" href="structsiqk_1_1sh_1_1_mesh.html#a3e86d388497c2a559b87e401a1235e87">e</a>); ++iv)</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;      <span class="keywordflow">if</span> (m.<a class="code" href="structsiqk_1_1sh_1_1_mesh.html#a3e86d388497c2a559b87e401a1235e87">e</a>(ip,iv) == -1) <span class="keywordflow">break</span>; <span class="keywordflow">else</span> ++<a class="code" href="namespacedimensions__mod.html#af137394c40531d5d6f0daa64351372e7">ne</a>;</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;  <span class="comment">// Fill.</span></div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;  Idxs::HostMirror en(<span class="stringliteral">&quot;en&quot;</span>, <a class="code" href="namespacesiqk.html#a3f1b5069fc1ac06e18aa603b592403e6">nslices</a>(m.<a class="code" href="structsiqk_1_1sh_1_1_mesh.html#a3e86d388497c2a559b87e401a1235e87">e</a>), <a class="code" href="namespacesiqk.html#a6c43ff2c83ad6b7d0dc61c2c5e83a680">szslice</a>(m.<a class="code" href="structsiqk_1_1sh_1_1_mesh.html#a3e86d388497c2a559b87e401a1235e87">e</a>));</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;  ko::deep_copy(en, -1);</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;  Vec3s::HostMirror nml(<span class="stringliteral">&quot;nml&quot;</span>, <a class="code" href="namespacedimensions__mod.html#af137394c40531d5d6f0daa64351372e7">ne</a>);</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;  <a class="code" href="namespacesiqk.html#a04b40b29b12c447399a02e3c1575bf66">Int</a> ie = 0;</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacesiqk.html#a04b40b29b12c447399a02e3c1575bf66">Int</a> ip = 0; ip &lt; <a class="code" href="namespacesiqk.html#a3f1b5069fc1ac06e18aa603b592403e6">nslices</a>(m.<a class="code" href="structsiqk_1_1sh_1_1_mesh.html#a3e86d388497c2a559b87e401a1235e87">e</a>); ++ip)</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="namespacesiqk.html#a04b40b29b12c447399a02e3c1575bf66">Int</a> iv = 0; iv &lt; <a class="code" href="namespacesiqk.html#a6c43ff2c83ad6b7d0dc61c2c5e83a680">szslice</a>(m.<a class="code" href="structsiqk_1_1sh_1_1_mesh.html#a3e86d388497c2a559b87e401a1235e87">e</a>); ++iv)</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;      <span class="keywordflow">if</span> (m.<a class="code" href="structsiqk_1_1sh_1_1_mesh.html#a3e86d388497c2a559b87e401a1235e87">e</a>(ip,iv) == -1)</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;      <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;        <span class="comment">// Somewhat complicated next node index.</span></div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;        <span class="keyword">const</span> <a class="code" href="namespacesiqk.html#a04b40b29b12c447399a02e3c1575bf66">Int</a> iv_next = (iv+1 == <a class="code" href="namespacesiqk.html#a6c43ff2c83ad6b7d0dc61c2c5e83a680">szslice</a>(m.<a class="code" href="structsiqk_1_1sh_1_1_mesh.html#a3e86d388497c2a559b87e401a1235e87">e</a>) ? 0 :</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;                             (m.<a class="code" href="structsiqk_1_1sh_1_1_mesh.html#a3e86d388497c2a559b87e401a1235e87">e</a>(ip,iv+1) == -1 ? 0 : iv+1));</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;        geo::edge_normal(<a class="code" href="namespacesiqk.html#aef983887889243999a1d7ddea864ad1f">slice</a>(m.<a class="code" href="structsiqk_1_1sh_1_1_mesh.html#a09ea9632dd1680a04d53aec55d4b6e4f">p</a>, m.<a class="code" href="structsiqk_1_1sh_1_1_mesh.html#a3e86d388497c2a559b87e401a1235e87">e</a>(ip, iv)), <a class="code" href="namespacesiqk.html#aef983887889243999a1d7ddea864ad1f">slice</a>(m.<a class="code" href="structsiqk_1_1sh_1_1_mesh.html#a09ea9632dd1680a04d53aec55d4b6e4f">p</a>, m.<a class="code" href="structsiqk_1_1sh_1_1_mesh.html#a3e86d388497c2a559b87e401a1235e87">e</a>(ip, iv_next)),</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;                         <a class="code" href="namespacesiqk.html#aef983887889243999a1d7ddea864ad1f">slice</a>(nml, ie));</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;        en(ip,iv) = ie;</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;        ++ie;</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;      }</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;  m.<a class="code" href="structsiqk_1_1sh_1_1_mesh.html#ac734002157287653809b1a732348d568">en</a> = en;</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;  m.<a class="code" href="structsiqk_1_1sh_1_1_mesh.html#a08b7acf03ca69f64736bda8060053539">nml</a> = nml;</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;}</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;} <span class="comment">// namespace test</span></div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;} <span class="comment">// namespace siqk</span></div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160; </div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;<span class="preprocessor">#endif </span><span class="comment">// INCLUDE_SIQK_INTERSECT_HPP</span></div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160; </div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;<span class="preprocessor">#ifndef INCLUDE_SIQK_SQR_HPP</span></div>
<div class="line"><a name="l00836"></a><span class="lineno"><a class="line" href="compose__slmm_8cpp.html#ad4ed349f967b89434e118a4972c7d759">  836</a></span>&#160;<span class="preprocessor">#define INCLUDE_SIQK_SQR_HPP</span></div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160; </div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;<span class="comment">//#include &quot;siqk_defs.hpp&quot;</span></div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;<span class="comment">//#include &quot;siqk_intersect.hpp&quot;</span></div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160; </div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespacesiqk.html">siqk</a> {</div>
<div class="line"><a name="l00842"></a><span class="lineno"><a class="line" href="namespacesiqk_1_1sqr.html">  842</a></span>&#160;<span class="keyword">namespace </span>sqr { <span class="comment">// spherical quadrilateral &lt;-&gt; reference square</span></div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;<span class="comment">/* Let p be a 3x4 matrix with p(:,i) the i&#39;th vertex in a spherical quad in CCW</span></div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;<span class="comment">   order. Let (a,b) be coordinates in the reference square [0,1]^2. (Here we</span></div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;<span class="comment">   choose [0,1] instead of [-1,1].) (a,b) = (0,0) corresponds to p(:,1); (1,0)</span></div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;<span class="comment">   is p(:,2); (1,1) is p(:,3); (0,1) is p(:,4).</span></div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;<span class="comment">     The map from reference square to bilinear quad can be written</span></div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;<span class="comment">       T = p*[ 1 -1 1 -1</span></div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;<span class="comment">              -1  1 0  0</span></div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;<span class="comment">              -1  0 0  1</span></div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;<span class="comment">               1  0 0  0]&#39;;</span></div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;<span class="comment">       f(a,b) = T(:,1)*a*b + T(:,2)*a + T(:,3)*b + T(:,4);</span></div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;<span class="comment">   The map to the sphere is then completed with</span></div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;<span class="comment">       g(a,b) = norm(f(a,b))</span></div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;<span class="comment">       q = f(a,b) / g(a,b).</span></div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;<span class="comment">   The Jacobian matrix for q is given by</span></div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;<span class="comment">       q_a = f_a/g - (f g_a)/g^2</span></div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;<span class="comment">       g_a = g_f f_a</span></div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;<span class="comment">   and similarly for q_b.</span></div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;<span class="comment">*/</span></div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160; </div>
<div class="line"><a name="l00862"></a><span class="lineno"><a class="line" href="namespacesiqk_1_1sqr_1_1impl.html">  862</a></span>&#160;<span class="keyword">namespace </span>impl {</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;<span class="comment">// Compute T(i,:).</span></div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> ConstVec3sT, <span class="keyword">typename</span> Quad&gt;</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;KOKKOS_INLINE_FUNCTION</div>
<div class="line"><a name="l00866"></a><span class="lineno"><a class="line" href="namespacesiqk_1_1sqr_1_1impl.html#ab91b2a1a1a339e965efac255aac58f83">  866</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespacesiqk_1_1sqr_1_1impl.html#ab91b2a1a1a339e965efac255aac58f83">calc_T_row</a> (<span class="keyword">const</span> ConstVec3sT&amp; p, <span class="keyword">const</span> Quad&amp; e, <span class="keyword">const</span> <a class="code" href="namespacesiqk.html#a04b40b29b12c447399a02e3c1575bf66">Int</a> i,</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;                 <a class="code" href="namespacesiqk.html#a6694847e2d56e697aa08277444325083">Real</a>&amp; t1, <a class="code" href="namespacesiqk.html#a6694847e2d56e697aa08277444325083">Real</a>&amp; t2, <a class="code" href="namespacesiqk.html#a6694847e2d56e697aa08277444325083">Real</a>&amp; t3, <a class="code" href="namespacesiqk.html#a6694847e2d56e697aa08277444325083">Real</a>&amp; t4) {</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;  t4 = p(e[0],i);</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;  t3 = -t4 + p(e[3],i);</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;  t2 = -t4 + p(e[1],i);</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;  t1 = -t2 + p(e[2],i) - p(e[3],i);</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;}</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160; </div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;<span class="comment">// Compute T(:,1)*a*b + T(:,2)*a + T(:,3)*b + T(:,4).</span></div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> ConstVec3sT, <span class="keyword">typename</span> Quad&gt;</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;KOKKOS_INLINE_FUNCTION</div>
<div class="line"><a name="l00877"></a><span class="lineno"><a class="line" href="namespacesiqk_1_1sqr_1_1impl.html#a86e87f8161a3c6475f4f45a668fe6779">  877</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespacesiqk_1_1sqr_1_1impl.html#a86e87f8161a3c6475f4f45a668fe6779">calc_ref_to_bilinear</a> (<span class="keyword">const</span> ConstVec3sT&amp; p, <span class="keyword">const</span> Quad&amp; e,</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;                           <a class="code" href="namespacesiqk.html#a6694847e2d56e697aa08277444325083">Real</a> <a class="code" href="namespacejw.html#acf663523b96ec023200fa8a0f58209f8">a</a>, <a class="code" href="namespacesiqk.html#a6694847e2d56e697aa08277444325083">Real</a> <a class="code" href="namespacebaroclinic__wave.html#acf8e56bd7dfdfd2c39e16dfa491a5293">b</a>, <a class="code" href="namespacesiqk.html#a6694847e2d56e697aa08277444325083">Real</a> q[3]) {</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;  <a class="code" href="namespacejw.html#acf663523b96ec023200fa8a0f58209f8">a</a> = 0.5*(<a class="code" href="namespacejw.html#acf663523b96ec023200fa8a0f58209f8">a</a> + 1);</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;  <a class="code" href="namespacebaroclinic__wave.html#acf8e56bd7dfdfd2c39e16dfa491a5293">b</a> = 0.5*(<a class="code" href="namespacebaroclinic__wave.html#acf8e56bd7dfdfd2c39e16dfa491a5293">b</a> + 1);</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacesiqk.html#a04b40b29b12c447399a02e3c1575bf66">Int</a> i = 0; i &lt; 3; ++i) {</div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;    <a class="code" href="namespacesiqk.html#a6694847e2d56e697aa08277444325083">Real</a> t1, t2, t3, t4;</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;    <a class="code" href="namespacesiqk_1_1sqr_1_1impl.html#ab91b2a1a1a339e965efac255aac58f83">impl::calc_T_row</a>(p, e, i, t1, t2, t3, t4);</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;    q[i] = t1*<a class="code" href="namespacejw.html#acf663523b96ec023200fa8a0f58209f8">a</a>*<a class="code" href="namespacebaroclinic__wave.html#acf8e56bd7dfdfd2c39e16dfa491a5293">b</a> + t2*<a class="code" href="namespacejw.html#acf663523b96ec023200fa8a0f58209f8">a</a> + t3*<a class="code" href="namespacebaroclinic__wave.html#acf8e56bd7dfdfd2c39e16dfa491a5293">b</a> + t4;</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;  }</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;}</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160; </div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;<span class="comment">// The residual function is r(a,b) = f(a,b)/g(a,b) - q.</span></div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> ConstVec3sT, <span class="keyword">typename</span> Quad&gt;</div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;KOKKOS_INLINE_FUNCTION</div>
<div class="line"><a name="l00891"></a><span class="lineno"><a class="line" href="namespacesiqk_1_1sqr_1_1impl.html#ac54967e129cebae1d0b0652fd27c3081">  891</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespacesiqk_1_1sqr_1_1impl.html#ac54967e129cebae1d0b0652fd27c3081">calc_residual</a> (<span class="keyword">const</span> ConstVec3sT&amp; p, <span class="keyword">const</span> Quad&amp; e, <span class="keyword">const</span> <a class="code" href="namespacesiqk.html#a6694847e2d56e697aa08277444325083">Real</a> <a class="code" href="namespacejw.html#acf663523b96ec023200fa8a0f58209f8">a</a>,</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;                    <span class="keyword">const</span> <a class="code" href="namespacesiqk.html#a6694847e2d56e697aa08277444325083">Real</a> <a class="code" href="namespacebaroclinic__wave.html#acf8e56bd7dfdfd2c39e16dfa491a5293">b</a>, <span class="keyword">const</span> <a class="code" href="namespacesiqk.html#a6694847e2d56e697aa08277444325083">Real</a> q[3], <a class="code" href="namespacesiqk.html#a6694847e2d56e697aa08277444325083">Real</a> r[3]) {</div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;  <a class="code" href="namespacesiqk_1_1sqr_1_1impl.html#a86e87f8161a3c6475f4f45a668fe6779">calc_ref_to_bilinear</a>(p, e, <a class="code" href="namespacejw.html#acf663523b96ec023200fa8a0f58209f8">a</a>, <a class="code" href="namespacebaroclinic__wave.html#acf8e56bd7dfdfd2c39e16dfa491a5293">b</a>, r);</div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;  <span class="keyword">const</span> <a class="code" href="namespacesiqk.html#a6694847e2d56e697aa08277444325083">Real</a> rnorm = std::sqrt(<a class="code" href="structsiqk_1_1_sphere_geometry.html#abeb5a91432744cabf20d3a357e08f18d">SphereGeometry::norm2</a>(r));</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacesiqk.html#a04b40b29b12c447399a02e3c1575bf66">Int</a> i = 0; i &lt; 3; ++i)</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;    r[i] = r[i]/rnorm - q[i];  </div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;}</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160; </div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;<span class="comment">// Compute the Jacobian matrix of the residual function: Jacobian(ref square -&gt;</span></div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;<span class="comment">// sphere).</span></div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;<span class="comment">//   TODO Consider rewriting this in terms of the p=1 basis isoparametric</span></div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;<span class="comment">// interpolation formulation. Better performance? See</span></div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;<span class="comment">// calc_isoparametric_jacobian in slmmir.cpp.</span></div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> ConstVec3sT, <span class="keyword">typename</span> Quad&gt;</div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;KOKKOS_INLINE_FUNCTION</div>
<div class="line"><a name="l00906"></a><span class="lineno"><a class="line" href="namespacesiqk_1_1sqr_1_1impl.html#a0426c38c677787ff0781f439d8049f4b">  906</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespacesiqk_1_1sqr_1_1impl.html#a0426c38c677787ff0781f439d8049f4b">calc_Jacobian</a> (<span class="keyword">const</span> ConstVec3sT&amp; p, <span class="keyword">const</span> Quad&amp; e, <a class="code" href="namespacesiqk.html#a6694847e2d56e697aa08277444325083">Real</a> <a class="code" href="namespacejw.html#acf663523b96ec023200fa8a0f58209f8">a</a>, <a class="code" href="namespacesiqk.html#a6694847e2d56e697aa08277444325083">Real</a> <a class="code" href="namespacebaroclinic__wave.html#acf8e56bd7dfdfd2c39e16dfa491a5293">b</a>,</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;                    <a class="code" href="namespacesiqk.html#a6694847e2d56e697aa08277444325083">Real</a> J[6]) {</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;  <a class="code" href="namespacejw.html#acf663523b96ec023200fa8a0f58209f8">a</a> = 0.5*(<a class="code" href="namespacejw.html#acf663523b96ec023200fa8a0f58209f8">a</a> + 1);</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;  <a class="code" href="namespacebaroclinic__wave.html#acf8e56bd7dfdfd2c39e16dfa491a5293">b</a> = 0.5*(<a class="code" href="namespacebaroclinic__wave.html#acf8e56bd7dfdfd2c39e16dfa491a5293">b</a> + 1);  </div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;  <a class="code" href="namespacesiqk.html#a6694847e2d56e697aa08277444325083">Real</a> r[3];</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacesiqk.html#a04b40b29b12c447399a02e3c1575bf66">Int</a> i = 0; i &lt; 3; ++i) {</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;    <a class="code" href="namespacesiqk.html#a6694847e2d56e697aa08277444325083">Real</a> t1, t2, t3, t4;</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;    <a class="code" href="namespacesiqk_1_1sqr_1_1impl.html#ab91b2a1a1a339e965efac255aac58f83">calc_T_row</a>(p, e, i, t1, t2, t3, t4);</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;    r[  i] = t1*<a class="code" href="namespacejw.html#acf663523b96ec023200fa8a0f58209f8">a</a>*<a class="code" href="namespacebaroclinic__wave.html#acf8e56bd7dfdfd2c39e16dfa491a5293">b</a> + t2*<a class="code" href="namespacejw.html#acf663523b96ec023200fa8a0f58209f8">a</a> + t3*<a class="code" href="namespacebaroclinic__wave.html#acf8e56bd7dfdfd2c39e16dfa491a5293">b</a> + t4;</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;    J[  i] = t1*<a class="code" href="namespacebaroclinic__wave.html#acf8e56bd7dfdfd2c39e16dfa491a5293">b</a> + t2;</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;    J[3+i] = t1*<a class="code" href="namespacejw.html#acf663523b96ec023200fa8a0f58209f8">a</a> + t3;</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;  }</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;  <a class="code" href="namespacesiqk.html#a6694847e2d56e697aa08277444325083">Real</a> rtJ[2] = {0};</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacesiqk.html#a04b40b29b12c447399a02e3c1575bf66">Int</a> j = 0; j &lt; 2; ++j) {</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;    <span class="keyword">const</span> <a class="code" href="namespacesiqk.html#a6694847e2d56e697aa08277444325083">Real</a>* <span class="keyword">const</span> Jj = J + 3*j;</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="namespacesiqk.html#a04b40b29b12c447399a02e3c1575bf66">Int</a> i = 0; i &lt; 3; ++i)</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;      rtJ[j] += r[i]*Jj[i];</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;  }</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;  <span class="keyword">const</span> <a class="code" href="namespacesiqk.html#a6694847e2d56e697aa08277444325083">Real</a> rnorm2 = <a class="code" href="structsiqk_1_1_sphere_geometry.html#abeb5a91432744cabf20d3a357e08f18d">SphereGeometry::norm2</a>(r), rnorm = std::sqrt(rnorm2);</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacesiqk.html#a04b40b29b12c447399a02e3c1575bf66">Int</a> j = 0; j &lt; 2; ++j) {</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;    <a class="code" href="namespacesiqk.html#a6694847e2d56e697aa08277444325083">Real</a>* <span class="keyword">const</span> Jj = J + 3*j;</div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="namespacesiqk.html#a04b40b29b12c447399a02e3c1575bf66">Int</a> i = 0; i &lt; 3; ++i)</div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;      Jj[i] = (Jj[i] - r[i]*rtJ[j]/rnorm2)/rnorm;</div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;  }</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;}</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160; </div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;<span class="comment">// Solve J dx = r.</span></div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;KOKKOS_INLINE_FUNCTION</div>
<div class="line"><a name="l00934"></a><span class="lineno"><a class="line" href="namespacesiqk_1_1sqr_1_1impl.html#a7d208820b935d30c141634dc64f5dd2c">  934</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespacesiqk_1_1sqr_1_1impl.html#a7d208820b935d30c141634dc64f5dd2c">solve_Jxr</a> (<a class="code" href="namespacesiqk.html#a6694847e2d56e697aa08277444325083">Real</a> J[6], <span class="keyword">const</span> <a class="code" href="namespacesiqk.html#a6694847e2d56e697aa08277444325083">Real</a> r[3], <a class="code" href="namespacesiqk.html#a6694847e2d56e697aa08277444325083">Real</a> <a class="code" href="namespacephysical__constants.html#a8f292bec2061eac2b56d3f01a57eeff2">dx</a>[2]) {</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;  <span class="comment">// QR factorization: J -&gt; J [n1 a; 0 n2].</span></div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;  <span class="keyword">const</span> <a class="code" href="namespacesiqk.html#a6694847e2d56e697aa08277444325083">Real</a> n1 = std::sqrt(<a class="code" href="structsiqk_1_1_sphere_geometry.html#abeb5a91432744cabf20d3a357e08f18d">SphereGeometry::norm2</a>(J));</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;  <a class="code" href="structsiqk_1_1_sphere_geometry.html#a5cd34159f10e01024d4425b363e922e8">SphereGeometry::scale</a>(1/n1, J);</div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;  <span class="keyword">const</span> <a class="code" href="namespacesiqk.html#a6694847e2d56e697aa08277444325083">Real</a> <a class="code" href="namespacejw.html#acf663523b96ec023200fa8a0f58209f8">a</a> = <a class="code" href="structsiqk_1_1_sphere_geometry.html#ab09386c8b086f7b7df5c15b3f72af91e">SphereGeometry::dot</a>(J, J+3);</div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;  <a class="code" href="structsiqk_1_1_sphere_geometry.html#a08158927fa5b0e17115588332406f820">SphereGeometry::axpy</a>(-<a class="code" href="namespacejw.html#acf663523b96ec023200fa8a0f58209f8">a</a>, J, J+3);</div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;  <span class="keyword">const</span> <a class="code" href="namespacesiqk.html#a6694847e2d56e697aa08277444325083">Real</a> n2 = std::sqrt(<a class="code" href="structsiqk_1_1_sphere_geometry.html#abeb5a91432744cabf20d3a357e08f18d">SphereGeometry::norm2</a>(J+3));</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;  <a class="code" href="structsiqk_1_1_sphere_geometry.html#a5cd34159f10e01024d4425b363e922e8">SphereGeometry::scale</a>(1/n2, J+3);</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;  <span class="comment">// r -&gt; Q&#39; r.</span></div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;  <a class="code" href="namespacesiqk.html#a6694847e2d56e697aa08277444325083">Real</a> Qtr[2] = {0};</div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacesiqk.html#a04b40b29b12c447399a02e3c1575bf66">Int</a> j = 0; j &lt; 2; ++j) {</div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;    <span class="keyword">const</span> <a class="code" href="namespacesiqk.html#a6694847e2d56e697aa08277444325083">Real</a>* <span class="keyword">const</span> Jj = J + 3*j;</div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="namespacesiqk.html#a04b40b29b12c447399a02e3c1575bf66">Int</a> i = 0; i &lt; 3; ++i)</div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;      Qtr[j] += Jj[i]*r[i];</div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;  }</div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;  <span class="comment">// dx = R \ (Q&#39; r).</span></div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;  <a class="code" href="namespacephysical__constants.html#a8f292bec2061eac2b56d3f01a57eeff2">dx</a>[1] = 2*(Qtr[1] / n2);</div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;  <a class="code" href="namespacephysical__constants.html#a8f292bec2061eac2b56d3f01a57eeff2">dx</a>[0] = 2*((Qtr[0] - <a class="code" href="namespacejw.html#acf663523b96ec023200fa8a0f58209f8">a</a>*<a class="code" href="namespacephysical__constants.html#a8f292bec2061eac2b56d3f01a57eeff2">dx</a>[1]) / n1);</div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;}</div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;} <span class="comment">// namespace impl</span></div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160; </div>
<div class="line"><a name="l00955"></a><span class="lineno"><a class="line" href="structsiqk_1_1sqr_1_1_info.html">  955</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structsiqk_1_1sqr_1_1_info.html">Info</a> {</div>
<div class="line"><a name="l00956"></a><span class="lineno"><a class="line" href="structsiqk_1_1sqr_1_1_info.html#a9a01d651b2e286335a208f672c8dbf0c">  956</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="structsiqk_1_1sqr_1_1_info.html#a9a01d651b2e286335a208f672c8dbf0c">success</a>;</div>
<div class="line"><a name="l00957"></a><span class="lineno"><a class="line" href="structsiqk_1_1sqr_1_1_info.html#aae7126c703242df2f17f566307ed4e5a">  957</a></span>&#160;  <a class="code" href="namespacesiqk.html#a04b40b29b12c447399a02e3c1575bf66">Int</a> <a class="code" href="structsiqk_1_1sqr_1_1_info.html#aae7126c703242df2f17f566307ed4e5a">n_iterations</a>;</div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;};</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160; </div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> ConstVec3sT, <span class="keyword">typename</span> Quad&gt;</div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;KOKKOS_INLINE_FUNCTION</div>
<div class="line"><a name="l00962"></a><span class="lineno"><a class="line" href="namespacesiqk_1_1sqr.html#ae226341260ce9658bed3b60c48625886">  962</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespacesiqk_1_1sqr.html#ae226341260ce9658bed3b60c48625886">calc_ref_to_sphere</a> (</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;  <span class="comment">// The spherical quad containing the point.</span></div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;  <span class="keyword">const</span> ConstVec3sT&amp; p, <span class="keyword">const</span> Quad&amp; e,</div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;  <span class="comment">// (a,b) in [-1,1]</span></div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;  <span class="keyword">const</span> <a class="code" href="namespacesiqk.html#a6694847e2d56e697aa08277444325083">Real</a> <a class="code" href="namespacejw.html#acf663523b96ec023200fa8a0f58209f8">a</a>, <span class="keyword">const</span> <a class="code" href="namespacesiqk.html#a6694847e2d56e697aa08277444325083">Real</a> <a class="code" href="namespacebaroclinic__wave.html#acf8e56bd7dfdfd2c39e16dfa491a5293">b</a>,</div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;  <span class="comment">// The point on the sphere.</span></div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;  <a class="code" href="namespacesiqk.html#a6694847e2d56e697aa08277444325083">Real</a> q[3])</div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;{</div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;  <a class="code" href="namespacesiqk_1_1sqr_1_1impl.html#a86e87f8161a3c6475f4f45a668fe6779">impl::calc_ref_to_bilinear</a>(p, e, <a class="code" href="namespacejw.html#acf663523b96ec023200fa8a0f58209f8">a</a>, <a class="code" href="namespacebaroclinic__wave.html#acf8e56bd7dfdfd2c39e16dfa491a5293">b</a>, q);</div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;  <a class="code" href="structsiqk_1_1_sphere_geometry.html#a5d62310dba1533d5822d1e61a2124303">SphereGeometry::normalize</a>(q);</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;}</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160; </div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> ConstVec3sT, <span class="keyword">typename</span> Quad&gt;</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;KOKKOS_INLINE_FUNCTION</div>
<div class="line"><a name="l00976"></a><span class="lineno"><a class="line" href="namespacesiqk_1_1sqr.html#a257faae633641a8c200b1213b5d81a1e">  976</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespacesiqk_1_1sqr.html#a257faae633641a8c200b1213b5d81a1e">calc_sphere_to_ref</a> (</div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;  <span class="comment">// The spherical quad containing the point.</span></div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;  <span class="keyword">const</span> ConstVec3sT&amp; p, <span class="keyword">const</span> Quad&amp; e,</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;  <span class="comment">// The point on the sphere.</span></div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;  <span class="keyword">const</span> <a class="code" href="namespacesiqk.html#a6694847e2d56e697aa08277444325083">Real</a> q[3],</div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;  <span class="comment">// (a,b) in [-1,1]</span></div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;  <a class="code" href="namespacesiqk.html#a6694847e2d56e697aa08277444325083">Real</a>&amp; <a class="code" href="namespacejw.html#acf663523b96ec023200fa8a0f58209f8">a</a>, <a class="code" href="namespacesiqk.html#a6694847e2d56e697aa08277444325083">Real</a>&amp; <a class="code" href="namespacebaroclinic__wave.html#acf8e56bd7dfdfd2c39e16dfa491a5293">b</a>,</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;  <span class="comment">// Optional info output.</span></div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;  <a class="code" href="structsiqk_1_1sqr_1_1_info.html">Info</a>* <span class="keyword">const</span> info = <span class="keyword">nullptr</span>,</div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;  <span class="comment">// Max number of iterations before returning with failure.</span></div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;  <span class="keyword">const</span> <a class="code" href="namespacesiqk.html#a04b40b29b12c447399a02e3c1575bf66">Int</a> max_its = 10,</div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;  <span class="comment">// Tolerance for Newton iteration.</span></div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;  <span class="keyword">const</span> <a class="code" href="namespacesiqk.html#a6694847e2d56e697aa08277444325083">Real</a> <a class="code" href="namespacecontrol__mod.html#a19f70697971fe3e6502be3097865437a">tol</a> = 1e2*<a class="code" href="namespacedcmip2012__test5.html#a23dbdf598e3e14675594d87b6df56eb3">std::numeric_limits&lt;Real&gt;::epsilon</a>())</div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;{</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;  <span class="keyword">const</span> <a class="code" href="namespacesiqk.html#a6694847e2d56e697aa08277444325083">Real</a> tol2 = <a class="code" href="namespacesiqk.html#aa4d80b92cc4a0024c2a687c4ddeb6e7f">square</a>(<a class="code" href="namespacecontrol__mod.html#a19f70697971fe3e6502be3097865437a">tol</a>);</div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;  <a class="code" href="namespacesiqk.html#a6694847e2d56e697aa08277444325083">Real</a> rnorm2 = 1;</div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;  <a class="code" href="namespacejw.html#acf663523b96ec023200fa8a0f58209f8">a</a> = <a class="code" href="namespacebaroclinic__wave.html#acf8e56bd7dfdfd2c39e16dfa491a5293">b</a> = 0;</div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;  <a class="code" href="namespacesiqk.html#a04b40b29b12c447399a02e3c1575bf66">Int</a> it = 0;</div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;  <span class="keywordflow">for</span> (it = 1; it &lt;= max_its; ++it) { <span class="comment">// Newton&#39;s method.</span></div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;    <a class="code" href="namespacesiqk.html#a6694847e2d56e697aa08277444325083">Real</a> r[3], J[6];</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;    <a class="code" href="namespacesiqk_1_1sqr_1_1impl.html#ac54967e129cebae1d0b0652fd27c3081">impl::calc_residual</a>(p, e, <a class="code" href="namespacejw.html#acf663523b96ec023200fa8a0f58209f8">a</a>, <a class="code" href="namespacebaroclinic__wave.html#acf8e56bd7dfdfd2c39e16dfa491a5293">b</a>, q, r);</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;    rnorm2 = <a class="code" href="structsiqk_1_1_sphere_geometry.html#abeb5a91432744cabf20d3a357e08f18d">SphereGeometry::norm2</a>(r);</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;    <span class="keywordflow">if</span> (rnorm2 &lt;= tol2) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;    <a class="code" href="namespacesiqk_1_1sqr_1_1impl.html#a0426c38c677787ff0781f439d8049f4b">impl::calc_Jacobian</a>(p, e, <a class="code" href="namespacejw.html#acf663523b96ec023200fa8a0f58209f8">a</a>, <a class="code" href="namespacebaroclinic__wave.html#acf8e56bd7dfdfd2c39e16dfa491a5293">b</a>, J);</div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;    <a class="code" href="namespacesiqk.html#a6694847e2d56e697aa08277444325083">Real</a> <a class="code" href="namespacephysical__constants.html#a8f292bec2061eac2b56d3f01a57eeff2">dx</a>[2];</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;    <a class="code" href="namespacesiqk_1_1sqr_1_1impl.html#a7d208820b935d30c141634dc64f5dd2c">impl::solve_Jxr</a>(J, r, <a class="code" href="namespacephysical__constants.html#a8f292bec2061eac2b56d3f01a57eeff2">dx</a>);</div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;    <a class="code" href="namespacejw.html#acf663523b96ec023200fa8a0f58209f8">a</a> -= <a class="code" href="namespacephysical__constants.html#a8f292bec2061eac2b56d3f01a57eeff2">dx</a>[0];</div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;    <a class="code" href="namespacebaroclinic__wave.html#acf8e56bd7dfdfd2c39e16dfa491a5293">b</a> -= <a class="code" href="namespacephysical__constants.html#a8f292bec2061eac2b56d3f01a57eeff2">dx</a>[1];</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;  }</div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;  <span class="keywordflow">if</span> (info) {</div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;    info-&gt;success = rnorm2 &lt;= tol2;</div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;    info-&gt;n_iterations = it;</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;  }</div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;}</div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160; </div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;<span class="comment">// Ref coords, packed (x,y), CCW, starting from (-1,-1).</span></div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;KOKKOS_INLINE_FUNCTION</div>
<div class="line"><a name="l01013"></a><span class="lineno"><a class="line" href="namespacesiqk_1_1sqr.html#a7472c75ffb07a32dc295a6a28f51fe96"> 1013</a></span>&#160;<span class="keyword">const</span> <a class="code" href="namespacesiqk.html#a6694847e2d56e697aa08277444325083">Real</a>* <a class="code" href="namespacesiqk_1_1sqr.html#a7472c75ffb07a32dc295a6a28f51fe96">get_ref_vertices</a> () {</div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;  <span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="namespacesiqk.html#a6694847e2d56e697aa08277444325083">Real</a> c[] = {-1, -1, 1, -1, 1, 1, -1, 1};</div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;  <span class="keywordflow">return</span> c;</div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;}</div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160; </div>
<div class="line"><a name="l01018"></a><span class="lineno"><a class="line" href="namespacesiqk_1_1sqr_1_1test.html"> 1018</a></span>&#160;<span class="keyword">namespace </span>test {</div>
<div class="line"><a name="l01019"></a><span class="lineno"><a class="line" href="structsiqk_1_1sqr_1_1test_1_1_info.html"> 1019</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structsiqk_1_1sqr_1_1test_1_1_info.html">Info</a> {</div>
<div class="line"><a name="l01020"></a><span class="lineno"><a class="line" href="structsiqk_1_1sqr_1_1test_1_1_info.html#a81481f3c64cc936710bc2230fa9114d0"> 1020</a></span>&#160;  <a class="code" href="namespacesiqk.html#a04b40b29b12c447399a02e3c1575bf66">Int</a> <a class="code" href="structsiqk_1_1sqr_1_1test_1_1_info.html#a28ab5b87898dc4d6116ae6b6e6460707">sum_nits</a>, <a class="code" href="structsiqk_1_1sqr_1_1test_1_1_info.html#a81481f3c64cc936710bc2230fa9114d0">max_nits</a>, <a class="code" href="structsiqk_1_1sqr_1_1test_1_1_info.html#a387b7c755b2504b200f2fb502560f719">nfails</a>;</div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;};</div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160; </div>
<div class="line"><a name="l01023"></a><span class="lineno"><a class="line" href="classsiqk_1_1sqr_1_1test_1_1_test_sphere_to_ref_kernel.html"> 1023</a></span>&#160;<span class="keyword">class </span><a class="code" href="classsiqk_1_1sqr_1_1test_1_1_test_sphere_to_ref_kernel.html">TestSphereToRefKernel</a> {</div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;  <span class="keyword">const</span> <a class="code" href="namespacesiqk.html#a6694847e2d56e697aa08277444325083">Real</a> a_test[9] = {-0.1, -1e-16, 0, 1e-15, 0.1, 0.7, 1, 1-1e-14, 1.1};</div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;  <span class="keyword">const</span> <a class="code" href="namespacesiqk.html#a04b40b29b12c447399a02e3c1575bf66">Int</a> n_a_test = <span class="keyword">sizeof</span>(a_test)/<span class="keyword">sizeof</span>(*a_test);</div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160; </div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;  <span class="keyword">const</span> <a class="code" href="namespacesiqk.html#a6694847e2d56e697aa08277444325083">Real</a> tol_;</div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;  <span class="keyword">mutable</span> <a class="code" href="namespacesiqk.html#a1c336be63fc7e99dd624e19821374c89">ConstVec3s</a> p_;</div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;  <span class="keyword">mutable</span> <a class="code" href="namespacesiqk.html#a05592daa8593f0bb255bf79d8a99a236">ConstIdxs</a> e_;</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160; </div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l01032"></a><span class="lineno"><a class="line" href="classsiqk_1_1sqr_1_1test_1_1_test_sphere_to_ref_kernel.html#ad58b936a1d42f02feb13c065ccda87d7"> 1032</a></span>&#160;  <span class="keyword">typedef</span> <a class="code" href="structsiqk_1_1sqr_1_1test_1_1_info.html">Info</a> <a class="code" href="classsiqk_1_1sqr_1_1test_1_1_test_sphere_to_ref_kernel.html#ad58b936a1d42f02feb13c065ccda87d7">value_type</a>;</div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160; </div>
<div class="line"><a name="l01034"></a><span class="lineno"><a class="line" href="classsiqk_1_1sqr_1_1test_1_1_test_sphere_to_ref_kernel.html#a508abfeec572974dc3374424d383ac36"> 1034</a></span>&#160;  <a class="code" href="classsiqk_1_1sqr_1_1test_1_1_test_sphere_to_ref_kernel.html#a508abfeec572974dc3374424d383ac36">TestSphereToRefKernel</a> (<span class="keyword">const</span> ConstVec3s::HostMirror&amp; p_hm,</div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;                         <span class="keyword">const</span> ConstIdxs::HostMirror&amp; e_hm,</div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;                         <span class="keyword">const</span> <a class="code" href="namespacesiqk.html#a6694847e2d56e697aa08277444325083">Real</a> <a class="code" href="classsiqk_1_1sqr_1_1test_1_1_test_sphere_to_ref_kernel.html#ad9b6cc015222f088841dbdc47b31751b">tol</a> = 1e1*<a class="code" href="namespacedcmip2012__test5.html#a23dbdf598e3e14675594d87b6df56eb3">std::numeric_limits&lt;Real&gt;::epsilon</a>())</div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;    : tol_(<a class="code" href="classsiqk_1_1sqr_1_1test_1_1_test_sphere_to_ref_kernel.html#ad9b6cc015222f088841dbdc47b31751b">tol</a>)</div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;  {</div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;    { <a class="code" href="namespacesiqk.html#a0cb103a46b9c7a9a03cb45e98c34ccc6">Vec3s</a> p; <a class="code" href="namespacesiqk.html#ae6ddc7d5c591da491b22457a56353479">resize_and_copy</a>(p, p_hm); p_ = p; }</div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;    { <a class="code" href="namespacesiqk.html#a40d665fdda062c3a8de4ea96650d0dff">Idxs</a> e; <a class="code" href="namespacesiqk.html#ae6ddc7d5c591da491b22457a56353479">resize_and_copy</a>(e, e_hm); e_ = e; }</div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;  }</div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160; </div>
<div class="line"><a name="l01043"></a><span class="lineno"><a class="line" href="classsiqk_1_1sqr_1_1test_1_1_test_sphere_to_ref_kernel.html#ae2b7bf8675fbb4d60a4402bf914cfca9"> 1043</a></span>&#160;  <a class="code" href="namespacesiqk.html#a04b40b29b12c447399a02e3c1575bf66">Int</a> <a class="code" href="classsiqk_1_1sqr_1_1test_1_1_test_sphere_to_ref_kernel.html#ae2b7bf8675fbb4d60a4402bf914cfca9">n</a> ()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="namespacesiqk.html#a3f1b5069fc1ac06e18aa603b592403e6">nslices</a>(e_)*<a class="code" href="namespacesiqk.html#aa4d80b92cc4a0024c2a687c4ddeb6e7f">square</a>(n_a_test); }</div>
<div class="line"><a name="l01044"></a><span class="lineno"><a class="line" href="classsiqk_1_1sqr_1_1test_1_1_test_sphere_to_ref_kernel.html#ad9b6cc015222f088841dbdc47b31751b"> 1044</a></span>&#160;  <span class="keyword">const</span> <a class="code" href="namespacesiqk.html#a6694847e2d56e697aa08277444325083">Real</a>&amp; <a class="code" href="classsiqk_1_1sqr_1_1test_1_1_test_sphere_to_ref_kernel.html#ad9b6cc015222f088841dbdc47b31751b">tol</a> ()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> tol_; }</div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160; </div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;  KOKKOS_INLINE_FUNCTION</div>
<div class="line"><a name="l01047"></a><span class="lineno"><a class="line" href="classsiqk_1_1sqr_1_1test_1_1_test_sphere_to_ref_kernel.html#af96f6bfba3b45a7323a3cd4a350fffb2"> 1047</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classsiqk_1_1sqr_1_1test_1_1_test_sphere_to_ref_kernel.html#af96f6bfba3b45a7323a3cd4a350fffb2">operator() </a>(<span class="keyword">const</span> <a class="code" href="namespacesiqk.html#a04b40b29b12c447399a02e3c1575bf66">Int</a> <a class="code" href="namespacebaroclinic__wave.html#a8619f63e6dd6db1077c1a18788afa359">k</a>, <a class="code" href="structsiqk_1_1sqr_1_1test_1_1_info.html">value_type</a>&amp; jinfo)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;    <span class="keyword">const</span> <a class="code" href="namespacesiqk.html#a04b40b29b12c447399a02e3c1575bf66">Int</a></div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;      ei = <a class="code" href="namespacebaroclinic__wave.html#a8619f63e6dd6db1077c1a18788afa359">k</a> / <a class="code" href="namespacesiqk.html#aa4d80b92cc4a0024c2a687c4ddeb6e7f">square</a>(n_a_test),</div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;      ij = <a class="code" href="namespacebaroclinic__wave.html#a8619f63e6dd6db1077c1a18788afa359">k</a> % <a class="code" href="namespacesiqk.html#aa4d80b92cc4a0024c2a687c4ddeb6e7f">square</a>(n_a_test),</div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;      i = ij / n_a_test,</div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;      j = ij % n_a_test;</div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;    <span class="keyword">const</span> <a class="code" href="namespacesiqk.html#a6694847e2d56e697aa08277444325083">Real</a> a_t = a_test[i], b_t = a_test[j];</div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;    <a class="code" href="namespacesiqk.html#a6694847e2d56e697aa08277444325083">Real</a> q[3];</div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;    <a class="code" href="namespacesiqk_1_1sqr.html#ae226341260ce9658bed3b60c48625886">sqr::calc_ref_to_sphere</a>(p_, <a class="code" href="namespacesiqk.html#aef983887889243999a1d7ddea864ad1f">slice</a>(e_, ei), a_t, b_t, q);</div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;    <a class="code" href="namespacesiqk.html#a6694847e2d56e697aa08277444325083">Real</a> <a class="code" href="namespacejw.html#acf663523b96ec023200fa8a0f58209f8">a</a>, <a class="code" href="namespacebaroclinic__wave.html#acf8e56bd7dfdfd2c39e16dfa491a5293">b</a>;</div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;    <a class="code" href="structsiqk_1_1sqr_1_1_info.html">sqr::Info</a> info;</div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;    <a class="code" href="namespacesiqk_1_1sqr.html#a257faae633641a8c200b1213b5d81a1e">sqr::calc_sphere_to_ref</a>(p_, <a class="code" href="namespacesiqk.html#aef983887889243999a1d7ddea864ad1f">slice</a>(e_, ei), q, <a class="code" href="namespacejw.html#acf663523b96ec023200fa8a0f58209f8">a</a>, <a class="code" href="namespacebaroclinic__wave.html#acf8e56bd7dfdfd2c39e16dfa491a5293">b</a>, &amp;info, 100, tol_);</div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;    <span class="keyword">const</span> <a class="code" href="namespacesiqk.html#a6694847e2d56e697aa08277444325083">Real</a> err = std::sqrt(<a class="code" href="namespacesiqk.html#aa4d80b92cc4a0024c2a687c4ddeb6e7f">square</a>(a_t - <a class="code" href="namespacejw.html#acf663523b96ec023200fa8a0f58209f8">a</a>) + <a class="code" href="namespacesiqk.html#aa4d80b92cc4a0024c2a687c4ddeb6e7f">square</a>(b_t - <a class="code" href="namespacebaroclinic__wave.html#acf8e56bd7dfdfd2c39e16dfa491a5293">b</a>));</div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;    <span class="comment">// tol is on dx, not (a,b), so adjust slightly.</span></div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;    <span class="keywordflow">if</span> ( ! info.<a class="code" href="structsiqk_1_1sqr_1_1_info.html#a9a01d651b2e286335a208f672c8dbf0c">success</a> || err &gt; 1e4*tol_) {</div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;      jinfo.<a class="code" href="structsiqk_1_1sqr_1_1test_1_1_info.html#a387b7c755b2504b200f2fb502560f719">nfails</a>++;</div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;      printf(<span class="stringliteral">&quot;calc_sphere_to_ref ei %d i %d j %d: nits %d re %1.1e\n&quot;</span>,</div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;             ei, i, j, info.<a class="code" href="structsiqk_1_1sqr_1_1_info.html#aae7126c703242df2f17f566307ed4e5a">n_iterations</a>, err);</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;    }</div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;    jinfo.<a class="code" href="structsiqk_1_1sqr_1_1test_1_1_info.html#a28ab5b87898dc4d6116ae6b6e6460707">sum_nits</a> += info.<a class="code" href="structsiqk_1_1sqr_1_1_info.html#aae7126c703242df2f17f566307ed4e5a">n_iterations</a>;</div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;    jinfo.<a class="code" href="structsiqk_1_1sqr_1_1test_1_1_info.html#a81481f3c64cc936710bc2230fa9114d0">max_nits</a> = <a class="code" href="namespacesiqk.html#a984fe7f0fc55d1f004981d9b6ffac4f7">max</a>(jinfo.<a class="code" href="structsiqk_1_1sqr_1_1test_1_1_info.html#a81481f3c64cc936710bc2230fa9114d0">max_nits</a>, info.<a class="code" href="structsiqk_1_1sqr_1_1_info.html#aae7126c703242df2f17f566307ed4e5a">n_iterations</a>);</div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;  }</div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160; </div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;  KOKKOS_INLINE_FUNCTION</div>
<div class="line"><a name="l01071"></a><span class="lineno"><a class="line" href="classsiqk_1_1sqr_1_1test_1_1_test_sphere_to_ref_kernel.html#a0dc66e9c787165eecfbdfe698ba8aee6"> 1071</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classsiqk_1_1sqr_1_1test_1_1_test_sphere_to_ref_kernel.html#a0dc66e9c787165eecfbdfe698ba8aee6">init</a> (<a class="code" href="structsiqk_1_1sqr_1_1test_1_1_info.html">value_type</a>&amp; info) {</div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;    info.<a class="code" href="structsiqk_1_1sqr_1_1test_1_1_info.html#a28ab5b87898dc4d6116ae6b6e6460707">sum_nits</a> = 0;</div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;    info.<a class="code" href="structsiqk_1_1sqr_1_1test_1_1_info.html#a81481f3c64cc936710bc2230fa9114d0">max_nits</a> = 0;</div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;    info.<a class="code" href="structsiqk_1_1sqr_1_1test_1_1_info.html#a387b7c755b2504b200f2fb502560f719">nfails</a> = 0;</div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;  }</div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160; </div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;  KOKKOS_INLINE_FUNCTION</div>
<div class="line"><a name="l01078"></a><span class="lineno"><a class="line" href="classsiqk_1_1sqr_1_1test_1_1_test_sphere_to_ref_kernel.html#a26cfdf240ac511c0a671eadc5d653045"> 1078</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classsiqk_1_1sqr_1_1test_1_1_test_sphere_to_ref_kernel.html#a26cfdf240ac511c0a671eadc5d653045">join</a> (<span class="keyword">volatile</span> <a class="code" href="structsiqk_1_1sqr_1_1test_1_1_info.html">value_type</a>&amp; dst, <span class="keyword">volatile</span> <a class="code" href="structsiqk_1_1sqr_1_1test_1_1_info.html">value_type</a> <span class="keyword">const</span>&amp; src)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;    dst.<a class="code" href="structsiqk_1_1sqr_1_1test_1_1_info.html#a81481f3c64cc936710bc2230fa9114d0">max_nits</a> = <a class="code" href="namespacesiqk.html#a984fe7f0fc55d1f004981d9b6ffac4f7">max</a>(dst.<a class="code" href="structsiqk_1_1sqr_1_1test_1_1_info.html#a81481f3c64cc936710bc2230fa9114d0">max_nits</a>, src.<a class="code" href="structsiqk_1_1sqr_1_1test_1_1_info.html#a81481f3c64cc936710bc2230fa9114d0">max_nits</a>);</div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;    dst.<a class="code" href="structsiqk_1_1sqr_1_1test_1_1_info.html#a28ab5b87898dc4d6116ae6b6e6460707">sum_nits</a> += src.<a class="code" href="structsiqk_1_1sqr_1_1test_1_1_info.html#a28ab5b87898dc4d6116ae6b6e6460707">sum_nits</a>;</div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;    dst.<a class="code" href="structsiqk_1_1sqr_1_1test_1_1_info.html#a387b7c755b2504b200f2fb502560f719">nfails</a> += src.<a class="code" href="structsiqk_1_1sqr_1_1test_1_1_info.html#a387b7c755b2504b200f2fb502560f719">nfails</a>;</div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;  }</div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;};</div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160; </div>
<div class="line"><a name="l01085"></a><span class="lineno"><a class="line" href="namespacesiqk_1_1sqr_1_1test.html#a0c8752204330c8d761ae520a8e3fc220"> 1085</a></span>&#160;<span class="keyword">inline</span> <a class="code" href="namespacesiqk.html#a04b40b29b12c447399a02e3c1575bf66">Int</a> <a class="code" href="namespacesiqk_1_1sqr_1_1test.html#a0c8752204330c8d761ae520a8e3fc220">test_sphere_to_ref</a> (<span class="keyword">const</span> ConstVec3s::HostMirror&amp; p,</div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;                               <span class="keyword">const</span> ConstIdxs::HostMirror&amp; e) {</div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;  <a class="code" href="classsiqk_1_1sqr_1_1test_1_1_test_sphere_to_ref_kernel.html">TestSphereToRefKernel</a> <a class="code" href="namespacebaroclinic__wave.html#a8619f63e6dd6db1077c1a18788afa359">k</a>(p, e);</div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;  <a class="code" href="structsiqk_1_1sqr_1_1test_1_1_info.html">Info</a> info;</div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;  ko::parallel_reduce(<a class="code" href="namespacebaroclinic__wave.html#a8619f63e6dd6db1077c1a18788afa359">k</a>.n(), <a class="code" href="namespacebaroclinic__wave.html#a8619f63e6dd6db1077c1a18788afa359">k</a>, info);</div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;  <span class="keywordflow">return</span> info.<a class="code" href="structsiqk_1_1sqr_1_1test_1_1_info.html#a387b7c755b2504b200f2fb502560f719">nfails</a>;</div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;}</div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;} <span class="comment">// namespace test</span></div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;} <span class="comment">// namespace sqr</span></div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;} <span class="comment">// namespace siqk</span></div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160; </div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;<span class="preprocessor">#endif </span><span class="comment">// INCLUDE_SIQK_SQR_HPP</span></div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160; </div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;<span class="comment">// Unit tests.</span></div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;<span class="preprocessor">#include &lt;limits&gt;</span></div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160; </div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;<span class="comment">//#include &quot;siqk.hpp&quot;</span></div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespacesiqk.html">siqk</a> {</div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160; </div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;<span class="preprocessor">#ifdef SLMM_MAIN</span></div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;<span class="preprocessor"># define INSTANTIATE_PLANE</span></div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160; </div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;} <span class="comment">// namespace siqk</span></div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160; </div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;<span class="comment">//&gt; end SIQK</span></div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160; </div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;<span class="preprocessor">#include &lt;sys/time.h&gt;</span></div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;<span class="preprocessor">#include &lt;mpi.h&gt;</span></div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;<span class="preprocessor">#include &lt;cassert&gt;</span></div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;<span class="preprocessor">#include &lt;cmath&gt;</span></div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;<span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;<span class="preprocessor">#include &lt;sstream&gt;</span></div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;<span class="preprocessor">#include &lt;map&gt;</span></div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;<span class="preprocessor">#include &lt;set&gt;</span></div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;<span class="preprocessor">#include &lt;list&gt;</span></div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;<span class="preprocessor">#include &lt;vector&gt;</span></div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;<span class="preprocessor">#include &lt;memory&gt;</span></div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;<span class="preprocessor">#include &lt;limits&gt;</span></div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;<span class="preprocessor">#include &lt;algorithm&gt;</span></div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160; </div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;<span class="preprocessor">#include &lt;Kokkos_Core.hpp&gt;</span></div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160; </div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;<span class="preprocessor">#ifndef NDEBUG</span></div>
<div class="line"><a name="l01129"></a><span class="lineno"><a class="line" href="compose__slmm_8cpp.html#a2912a5cf7e76e41c2ecf69b5c610479d"> 1129</a></span>&#160;<span class="preprocessor"># define slmm_assert(condition) do {                                    \</span></div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;<span class="preprocessor">    if ( ! (condition)) {                                               \</span></div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;<span class="preprocessor">      std::stringstream _ss_;                                           \</span></div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;<span class="preprocessor">      _ss_ &lt;&lt; __FILE__ &lt;&lt; &quot;:&quot;</span> &lt;&lt; __LINE__ &lt;&lt; &quot;: FAIL:\n&quot; &lt;&lt; #condition  \</div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;        &lt;&lt; &quot;\n&quot;;                                                        \</div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;      throw std::logic_error(_ss_.str());                               \</div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;    }                                                                   \</div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;  } while (0)</div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;<span class="preprocessor"># define slmm_assert(condition)</span></div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01140"></a><span class="lineno"><a class="line" href="compose__slmm_8cpp.html#a7290a1aabe779e162c8d6a36b3abec04"> 1140</a></span>&#160;<span class="preprocessor">#define slmm_throw_if(condition, message) do {                          \</span></div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;<span class="preprocessor">    if (condition) {                                                    \</span></div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;<span class="preprocessor">      std::stringstream _ss_;                                           \</span></div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;<span class="preprocessor">      _ss_ &lt;&lt; __FILE__ &lt;&lt; &quot;:&quot;</span> &lt;&lt; __LINE__ &lt;&lt; &quot;: The condition:\n&quot;       \</div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;           &lt;&lt; #condition &quot;\nled to the exception\n&quot; &lt;&lt; message &lt;&lt; &quot;\n&quot;; \</div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;      throw std::logic_error(_ss_.str());                               \</div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;    }                                                                   \</div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;  } while (0)</div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160; </div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;<span class="keyword">extern</span> <span class="stringliteral">&quot;C&quot;</span> <span class="keywordtype">void</span></div>
<div class="line"><a name="l01150"></a><span class="lineno"><a class="line" href="compose__slmm_8cpp.html#a5d150781e1388bb857ce7cd759bff4cc"> 1150</a></span>&#160;<a class="code" href="compose__slmm_8cpp.html#a5d150781e1388bb857ce7cd759bff4cc">dpotrf_</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* uplo, <span class="keyword">const</span> <span class="keywordtype">int</span>* n, <span class="keywordtype">double</span>* <a class="code" href="namespacejw.html#acf663523b96ec023200fa8a0f58209f8">a</a>, <span class="keyword">const</span> <span class="keywordtype">int</span>* lda, <span class="keywordtype">int</span>* info);</div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;<span class="keyword">extern</span> <span class="stringliteral">&quot;C&quot;</span> <span class="keywordtype">void</span></div>
<div class="line"><a name="l01152"></a><span class="lineno"><a class="line" href="compose__slmm_8cpp.html#aa9db60fd5d4873a20a8e4b8b98f68e65"> 1152</a></span>&#160;<a class="code" href="compose__slmm_8cpp.html#aa9db60fd5d4873a20a8e4b8b98f68e65">dpotrs_</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* uplo, <span class="keyword">const</span> <span class="keywordtype">int</span>* n, <span class="keyword">const</span> <span class="keywordtype">int</span>* nrhs, <span class="keyword">const</span> <span class="keywordtype">double</span>* <a class="code" href="namespacejw.html#acf663523b96ec023200fa8a0f58209f8">a</a>,</div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span>* lda, <span class="keywordtype">double</span>* <a class="code" href="namespacebaroclinic__wave.html#acf8e56bd7dfdfd2c39e16dfa491a5293">b</a>, <span class="keyword">const</span> <span class="keywordtype">int</span>* ldb, <span class="keywordtype">int</span>* info);</div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160; </div>
<div class="line"><a name="l01155"></a><span class="lineno"><a class="line" href="namespaceslmm.html"> 1155</a></span>&#160;<span class="keyword">namespace </span><a class="code" href="namespaceslmm.html">slmm</a> {</div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;<span class="keyword">using</span> <a class="code" href="namespacesiqk.html#a04b40b29b12c447399a02e3c1575bf66">siqk::Int</a>;</div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;<span class="keyword">using</span> <a class="code" href="namespacesiqk.html#a6694847e2d56e697aa08277444325083">siqk::Real</a>;</div>
<div class="line"><a name="l01158"></a><span class="lineno"><a class="line" href="namespaceslmm.html#a4d04f3d5ecdda3f8eab0b349aab35fe7"> 1158</a></span>&#160;<span class="keyword">typedef</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> <a class="code" href="namespaceslmm.html#a4d04f3d5ecdda3f8eab0b349aab35fe7">Size</a>;</div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160; </div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespace_kokkos.html">ko</a> = <a class="code" href="namespace_kokkos.html">Kokkos</a>;</div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160; </div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;<span class="comment">// A 2D array A can be thought of as having nslices(A) rows and szslice(A)</span></div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;<span class="comment">// columns. A slice can be obtained by</span></div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;<span class="comment">//     auto ak = slice(A, k);</span></div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;<span class="comment">// We use this format for arrays of vertices and adjacency arrays, for</span></div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;<span class="comment">// example. In most or all cases, the intention is to parallelize over slices,</span></div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;<span class="comment">// so a Kokkos operator() will do work on a particular slice.</span></div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;<span class="keyword">using</span> <a class="code" href="namespacesiqk.html#a3f1b5069fc1ac06e18aa603b592403e6">siqk::nslices</a>;</div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;<span class="keyword">using</span> <a class="code" href="namespacesiqk.html#a6c43ff2c83ad6b7d0dc61c2c5e83a680">siqk::szslice</a>;</div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;<span class="keyword">using</span> <a class="code" href="namespacesiqk.html#aef983887889243999a1d7ddea864ad1f">siqk::slice</a>;</div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160; </div>
<div class="line"><a name="l01172"></a><span class="lineno"><a class="line" href="namespaceslmm.html#aae47f57e3c25fdbca5ac4c99101905c0"> 1172</a></span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">typename</span> V&gt; <span class="keyword">inline</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> <a class="code" href="namespaceslmm.html#aae47f57e3c25fdbca5ac4c99101905c0">len</a> (<span class="keyword">const</span> V&amp; v)</div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;{ <span class="keywordflow">return</span> <span class="keyword">static_cast&lt;</span><a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a><span class="keyword">&gt;</span>(v.extent_int(0)); }</div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160; </div>
<div class="line"><a name="l01175"></a><span class="lineno"><a class="line" href="namespaceslmm.html#a87a51b455bf70931b5c98f9d422b5d11"> 1175</a></span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt; <span class="keyword">inline</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> <a class="code" href="namespaceslmm.html#aae47f57e3c25fdbca5ac4c99101905c0">len</a> (<span class="keyword">const</span> std::vector&lt;T&gt;&amp; v)</div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;{ <span class="keywordflow">return</span> <span class="keyword">static_cast&lt;</span><a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a><span class="keyword">&gt;</span>(v.size()); }</div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160; </div>
<div class="line"><a name="l01178"></a><span class="lineno"><a class="line" href="structslmm_1_1_basis.html"> 1178</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structslmm_1_1_basis.html">Basis</a> {</div>
<div class="line"><a name="l01179"></a><span class="lineno"><a class="line" href="structslmm_1_1_basis.html#a4460417806b4ac2e9928cb430b847d1a"> 1179</a></span>&#160;  <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> <a class="code" href="structslmm_1_1_basis.html#a7eed6557d9778a23be30031ef7e7206f">np</a>, <a class="code" href="structslmm_1_1_basis.html#a4460417806b4ac2e9928cb430b847d1a">monotone_type</a>;</div>
<div class="line"><a name="l01180"></a><span class="lineno"><a class="line" href="structslmm_1_1_basis.html#affebd08fdc6df6ed442ebee3691db7ed"> 1180</a></span>&#160;  <a class="code" href="structslmm_1_1_basis.html#affebd08fdc6df6ed442ebee3691db7ed">Basis</a> () : <a class="code" href="structslmm_1_1_basis.html#a7eed6557d9778a23be30031ef7e7206f">np</a>(0), <a class="code" href="structslmm_1_1_basis.html#a4460417806b4ac2e9928cb430b847d1a">monotone_type</a>(-1) {} <span class="comment">// invalid values</span></div>
<div class="line"><a name="l01181"></a><span class="lineno"><a class="line" href="structslmm_1_1_basis.html#a62914faa92816a730775972caf7015d3"> 1181</a></span>&#160;  <a class="code" href="structslmm_1_1_basis.html#a62914faa92816a730775972caf7015d3">Basis</a> (<span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> inp, <span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> imt) : <a class="code" href="structslmm_1_1_basis.html#a7eed6557d9778a23be30031ef7e7206f">np</a>(inp), <a class="code" href="structslmm_1_1_basis.html#a4460417806b4ac2e9928cb430b847d1a">monotone_type</a>(imt) {}</div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;};</div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160; </div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;<span class="comment">// These basis functions follow TempestRemap&#39;s monotone_type 0 and 1 basis</span></div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;<span class="comment">// functions.</span></div>
<div class="line"><a name="l01186"></a><span class="lineno"><a class="line" href="classslmm_1_1_g_l_l.html"> 1186</a></span>&#160;<span class="keyword">class </span><a class="code" href="classslmm_1_1_g_l_l.html">GLL</a> {</div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;  <span class="keyword">const</span> <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a> oo3 = 1.0/3.0;</div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;  <span class="keyword">const</span> <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a> to3 = 2.0/3.0;</div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;  <span class="keyword">const</span> <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a> oo6 = 1.0/6.0;</div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;  <span class="keyword">const</span> <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a> oo8 = 1.0/8.0;</div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;  <span class="keyword">const</span> <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a> sqrt5 = std::sqrt(5.0);</div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;  <span class="keyword">const</span> <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a> oosqrt5 = 1.0/sqrt5;</div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;  <span class="keyword">const</span> <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a> np2_coord[2] = {-1.0, 1.0};</div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;  <span class="keyword">const</span> <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a> np2_wt[2]    = {1.0, 1.0};</div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;  <span class="keyword">const</span> <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a> np3_coord[3] = {-1.0, 0.0, 1.0};</div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;  <span class="keyword">const</span> <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a> np3_wt[3]    = {oo3, 2.0 - to3, oo3};</div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;  <span class="keyword">const</span> <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a> np4_coord[4] = {-1.0, -oosqrt5, oosqrt5, 1.0};</div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;  <span class="keyword">const</span> <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a> np4_wt[4]    = {oo6, 1.0 - oo6, 1.0 - oo6, oo6};</div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160; </div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l01201"></a><span class="lineno"><a class="line" href="classslmm_1_1_g_l_l.html#aa681216b46ee048c89a20a2cf8094284a572bdf0ea4245230402c0ef9a860b5f8"> 1201</a></span>&#160;  <span class="keyword">enum</span> { <a class="code" href="classslmm_1_1_g_l_l.html#aa681216b46ee048c89a20a2cf8094284a572bdf0ea4245230402c0ef9a860b5f8">np_max</a> = 4 };</div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160; </div>
<div class="line"><a name="l01203"></a><span class="lineno"><a class="line" href="classslmm_1_1_g_l_l.html#a545619c94529c2ab082fa64f90b27654"> 1203</a></span>&#160;  KOKKOS_INLINE_FUNCTION <a class="code" href="classslmm_1_1_g_l_l.html#a545619c94529c2ab082fa64f90b27654">GLL</a> () {}</div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160; </div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;  KOKKOS_INLINE_FUNCTION</div>
<div class="line"><a name="l01206"></a><span class="lineno"><a class="line" href="classslmm_1_1_g_l_l.html#a54fba27da4d71f6b3bca5964f1ff48b1"> 1206</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classslmm_1_1_g_l_l.html#a54fba27da4d71f6b3bca5964f1ff48b1">get_coef</a> (<span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> <a class="code" href="namespacedimensions__mod.html#a8648e26ae0e474ccf69d32a8148520c9">np</a>, <span class="keyword">const</span> <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a>*&amp; coord, <span class="keyword">const</span> <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a>*&amp; wt)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;    <span class="keywordflow">switch</span> (<a class="code" href="namespacedimensions__mod.html#a8648e26ae0e474ccf69d32a8148520c9">np</a>) {</div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;    <span class="keywordflow">case</span> 2:</div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;      coord = np2_coord;</div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;      wt = np2_wt;</div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;    <span class="keywordflow">case</span> 3:</div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;      coord = np3_coord;</div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;      wt = np3_wt;</div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;    <span class="keywordflow">case</span> 4:</div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;      coord = np4_coord;</div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;      wt = np4_wt;</div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;    <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;      coord = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;      wt = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;      siqk::error(<span class="stringliteral">&quot;GLL::get_coef: order not supported.&quot;</span>);</div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;    }</div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;  }</div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;  KOKKOS_INLINE_FUNCTION</div>
<div class="line"><a name="l01227"></a><span class="lineno"><a class="line" href="classslmm_1_1_g_l_l.html#addadc6c09df1b566581f17e15ff4c746"> 1227</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classslmm_1_1_g_l_l.html#addadc6c09df1b566581f17e15ff4c746">get_coef</a> (<span class="keyword">const</span> <a class="code" href="structslmm_1_1_basis.html">Basis</a>&amp; <a class="code" href="namespacebaroclinic__wave.html#acf8e56bd7dfdfd2c39e16dfa491a5293">b</a>, <span class="keyword">const</span> <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a>*&amp; coord, <span class="keyword">const</span> <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a>*&amp; wt)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;    <a class="code" href="classslmm_1_1_g_l_l.html#a54fba27da4d71f6b3bca5964f1ff48b1">get_coef</a>(<a class="code" href="namespacebaroclinic__wave.html#acf8e56bd7dfdfd2c39e16dfa491a5293">b</a>.np, coord, wt);</div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;  }</div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160; </div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;  <span class="comment">// x in [-1, 1].</span></div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;  KOKKOS_INLINE_FUNCTION</div>
<div class="line"><a name="l01233"></a><span class="lineno"><a class="line" href="classslmm_1_1_g_l_l.html#ab585b784c0bbf8faf7ab4fb351f686e3"> 1233</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classslmm_1_1_g_l_l.html#ab585b784c0bbf8faf7ab4fb351f686e3">eval</a> (<span class="keyword">const</span> <a class="code" href="structslmm_1_1_basis.html">Basis</a>&amp; <a class="code" href="namespacebaroclinic__wave.html#acf8e56bd7dfdfd2c39e16dfa491a5293">b</a>, <span class="keyword">const</span> <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a>&amp; <a class="code" href="namespacesupercell.html#ae57ef03dc0cb9828dbacc89aac8870c0">x</a>, <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a>* <span class="keyword">const</span> ge)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacebaroclinic__wave.html#acf8e56bd7dfdfd2c39e16dfa491a5293">b</a>.monotone_type &lt; 0 || <a class="code" href="namespacebaroclinic__wave.html#acf8e56bd7dfdfd2c39e16dfa491a5293">b</a>.monotone_type &gt; 1)</div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;      siqk::error(<span class="stringliteral">&quot;GLL::eval: monotone_type not supported.&quot;</span>);</div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;    <span class="keywordflow">switch</span> (<a class="code" href="namespacebaroclinic__wave.html#acf8e56bd7dfdfd2c39e16dfa491a5293">b</a>.np) {</div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;    <span class="keywordflow">case</span> 2: {</div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;      ge[0] = 0.5*(1.0 - <a class="code" href="namespacesupercell.html#ae57ef03dc0cb9828dbacc89aac8870c0">x</a>);</div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;      ge[1] = 0.5*(1.0 + <a class="code" href="namespacesupercell.html#ae57ef03dc0cb9828dbacc89aac8870c0">x</a>);</div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;    } <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;    <span class="keywordflow">case</span> 3: {</div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;      <span class="keyword">const</span> <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a> x2 = <a class="code" href="namespacesupercell.html#ae57ef03dc0cb9828dbacc89aac8870c0">x</a>*<a class="code" href="namespacesupercell.html#ae57ef03dc0cb9828dbacc89aac8870c0">x</a>;</div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="namespacebaroclinic__wave.html#acf8e56bd7dfdfd2c39e16dfa491a5293">b</a>.monotone_type == 0) {</div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;        ge[0] = 0.5*(x2 - <a class="code" href="namespacesupercell.html#ae57ef03dc0cb9828dbacc89aac8870c0">x</a>);</div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;        ge[1] = 1.0 - x2;</div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;        ge[2] = 0.5*(x2 + <a class="code" href="namespacesupercell.html#ae57ef03dc0cb9828dbacc89aac8870c0">x</a>);</div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="namespacesupercell.html#ae57ef03dc0cb9828dbacc89aac8870c0">x</a> &lt; 0) {</div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;          ge[0] = x2;</div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;          ge[1] = 1 - x2;</div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;          ge[2] = 0;</div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;          ge[0] = 0;</div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;          ge[1] = 1 - x2;</div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;          ge[2] = x2;</div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;        }</div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;      }</div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;    } <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;    <span class="keywordflow">case</span> 4: {</div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;      <span class="keyword">const</span> <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a> x2 = <a class="code" href="namespacesupercell.html#ae57ef03dc0cb9828dbacc89aac8870c0">x</a>*<a class="code" href="namespacesupercell.html#ae57ef03dc0cb9828dbacc89aac8870c0">x</a>;</div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="namespacebaroclinic__wave.html#acf8e56bd7dfdfd2c39e16dfa491a5293">b</a>.monotone_type == 0) {</div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;        ge[0] = (1.0 - <a class="code" href="namespacesupercell.html#ae57ef03dc0cb9828dbacc89aac8870c0">x</a>)*(5.0*x2 - 1.0)*oo8;</div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;        ge[1] = -sqrt5*oo8*(sqrt5 - 5.0*<a class="code" href="namespacesupercell.html#ae57ef03dc0cb9828dbacc89aac8870c0">x</a>)*(x2 - 1.0);</div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;        ge[2] = -sqrt5*oo8*(sqrt5 + 5.0*<a class="code" href="namespacesupercell.html#ae57ef03dc0cb9828dbacc89aac8870c0">x</a>)*(x2 - 1.0);</div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;        ge[3] = (1.0 + <a class="code" href="namespacesupercell.html#ae57ef03dc0cb9828dbacc89aac8870c0">x</a>)*(5.0*x2 - 1.0)*oo8;</div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;        <span class="keyword">const</span> <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a> a0 = (1 + sqrt5)/16;</div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;        <span class="keyword">const</span> <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a> b0 = (5 + sqrt5)/16;</div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;        <span class="keyword">const</span> <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a> c0 = (-5 - 5*sqrt5)/16;</div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;        <span class="keyword">const</span> <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a> d0 = (-25 - 5*sqrt5)/16;</div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;        <span class="keyword">const</span> <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a> b1 = -0.75*sqrt5;</div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;        <span class="keyword">const</span> <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a> d1 = 1.25*sqrt5;</div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="namespacesupercell.html#ae57ef03dc0cb9828dbacc89aac8870c0">x</a> &lt; -oosqrt5) {</div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;          ge[0] = a0 + <a class="code" href="namespacesupercell.html#ae57ef03dc0cb9828dbacc89aac8870c0">x</a>*(b0 + <a class="code" href="namespacesupercell.html#ae57ef03dc0cb9828dbacc89aac8870c0">x</a>*(c0 + <a class="code" href="namespacesupercell.html#ae57ef03dc0cb9828dbacc89aac8870c0">x</a>*d0));</div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;          ge[1] = 1 - ge[0];</div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;          ge[2] = 0;</div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;          ge[3] = 0;</div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="namespacesupercell.html#ae57ef03dc0cb9828dbacc89aac8870c0">x</a> &lt; oosqrt5) {</div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;          ge[0] = 0;</div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;          ge[1] = 0.5 + <a class="code" href="namespacesupercell.html#ae57ef03dc0cb9828dbacc89aac8870c0">x</a>*(b1 + x2*d1);</div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;          ge[2] = 1 - ge[1];</div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;          ge[3] = 0;</div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;          ge[0] = 0;</div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;          ge[1] = 0;</div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;          ge[3] = a0 - <a class="code" href="namespacesupercell.html#ae57ef03dc0cb9828dbacc89aac8870c0">x</a>*(b0 - <a class="code" href="namespacesupercell.html#ae57ef03dc0cb9828dbacc89aac8870c0">x</a>*(c0 - <a class="code" href="namespacesupercell.html#ae57ef03dc0cb9828dbacc89aac8870c0">x</a>*d0));</div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;          ge[2] = 1 - ge[3];</div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;        }</div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;      }</div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;    } <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;    <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="namespacebaroclinic__wave.html#acf8e56bd7dfdfd2c39e16dfa491a5293">b</a>.np; ++i) ge[i] = 0;</div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;      siqk::error(<span class="stringliteral">&quot;GLL::eval: order not supported.&quot;</span>);</div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;    }</div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;  }</div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160; </div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;  KOKKOS_INLINE_FUNCTION</div>
<div class="line"><a name="l01298"></a><span class="lineno"><a class="line" href="classslmm_1_1_g_l_l.html#a412b4075256ad5aca5309352b97cba91"> 1298</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classslmm_1_1_g_l_l.html#a412b4075256ad5aca5309352b97cba91">eval_derivative</a> (<span class="keyword">const</span> <a class="code" href="structslmm_1_1_basis.html">Basis</a>&amp; <a class="code" href="namespacebaroclinic__wave.html#acf8e56bd7dfdfd2c39e16dfa491a5293">b</a>, <span class="keyword">const</span> <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a>&amp; <a class="code" href="namespacesupercell.html#ae57ef03dc0cb9828dbacc89aac8870c0">x</a>, <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a>* <span class="keyword">const</span> ge)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacebaroclinic__wave.html#acf8e56bd7dfdfd2c39e16dfa491a5293">b</a>.monotone_type != 0)</div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;      siqk::error(<span class="stringliteral">&quot;GLL::eval: monotone_type not supported.&quot;</span>);</div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;    <span class="keywordflow">switch</span> (<a class="code" href="namespacebaroclinic__wave.html#acf8e56bd7dfdfd2c39e16dfa491a5293">b</a>.np) {</div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;    <span class="keywordflow">case</span> 2: {</div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;      ge[0] = -0.5;</div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;      ge[1] =  0.5;</div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;    } <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;    <span class="keywordflow">case</span> 3: {</div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;      <span class="keyword">const</span> <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a> x2p = 2*<a class="code" href="namespacesupercell.html#ae57ef03dc0cb9828dbacc89aac8870c0">x</a>;</div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;      ge[0] =  0.5*(x2p - 1);</div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;      ge[1] = -x2p;</div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;      ge[2] =  0.5*(x2p + 1);</div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;    } <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;    <span class="keywordflow">case</span> 4: {</div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;      ge[0] =  oo8*((10 - 15*<a class="code" href="namespacesupercell.html#ae57ef03dc0cb9828dbacc89aac8870c0">x</a>)*<a class="code" href="namespacesupercell.html#ae57ef03dc0cb9828dbacc89aac8870c0">x</a> + 1);</div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;      ge[1] = -sqrt5*oo8*((2*sqrt5 - 15*<a class="code" href="namespacesupercell.html#ae57ef03dc0cb9828dbacc89aac8870c0">x</a>)*<a class="code" href="namespacesupercell.html#ae57ef03dc0cb9828dbacc89aac8870c0">x</a> + 5);</div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;      ge[2] = -sqrt5*oo8*((2*sqrt5 + 15*<a class="code" href="namespacesupercell.html#ae57ef03dc0cb9828dbacc89aac8870c0">x</a>)*<a class="code" href="namespacesupercell.html#ae57ef03dc0cb9828dbacc89aac8870c0">x</a> - 5);</div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;      ge[3] =  oo8*((10 + 15*<a class="code" href="namespacesupercell.html#ae57ef03dc0cb9828dbacc89aac8870c0">x</a>)*<a class="code" href="namespacesupercell.html#ae57ef03dc0cb9828dbacc89aac8870c0">x</a> - 1);</div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;    } <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;    <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="namespacebaroclinic__wave.html#acf8e56bd7dfdfd2c39e16dfa491a5293">b</a>.np; ++i) ge[i] = 0;</div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;      siqk::error(<span class="stringliteral">&quot;GLL::eval: order not supported.&quot;</span>);</div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;    }</div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;  }</div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;};</div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160; </div>
<div class="line"><a name="l01325"></a><span class="lineno"><a class="line" href="namespaceslmm.html#a2a193298c724f6fb329cfb2ba9785d88"> 1325</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="namespaceslmm.html#a2a193298c724f6fb329cfb2ba9785d88">dpotrf</a> (<span class="keywordtype">char</span> uplo, <span class="keywordtype">int</span> n, <span class="keywordtype">double</span>* <a class="code" href="namespacejw.html#acf663523b96ec023200fa8a0f58209f8">a</a>, <span class="keywordtype">int</span> lda) {</div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;  <span class="keywordtype">int</span> info;</div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;  <a class="code" href="compose__slmm_8cpp.html#a5d150781e1388bb857ce7cd759bff4cc">dpotrf_</a>(&amp;uplo, &amp;n, <a class="code" href="namespacejw.html#acf663523b96ec023200fa8a0f58209f8">a</a>, &amp;lda, &amp;info);</div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;  <span class="keywordflow">return</span> info;</div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;}</div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160; </div>
<div class="line"><a name="l01331"></a><span class="lineno"><a class="line" href="namespaceslmm.html#a3dd4be7f13cb04a0eb5d8e12138f308d"> 1331</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="namespaceslmm.html#a3dd4be7f13cb04a0eb5d8e12138f308d">dpotrs</a> (<span class="keywordtype">char</span> uplo, <span class="keywordtype">int</span> n, <span class="keywordtype">int</span> nrhs, <span class="keyword">const</span> <span class="keywordtype">double</span>* <a class="code" href="namespacejw.html#acf663523b96ec023200fa8a0f58209f8">a</a>, <span class="keywordtype">int</span> lda, <span class="keywordtype">double</span>* bx,</div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;            <span class="keywordtype">int</span> ldb) {</div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;  <span class="keywordtype">int</span> info;</div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;  <a class="code" href="compose__slmm_8cpp.html#aa9db60fd5d4873a20a8e4b8b98f68e65">dpotrs_</a>(&amp;uplo, &amp;n, &amp;nrhs, <span class="keyword">const_cast&lt;</span><span class="keywordtype">double</span>*<span class="keyword">&gt;</span>(<a class="code" href="namespacejw.html#acf663523b96ec023200fa8a0f58209f8">a</a>), &amp;lda, bx, &amp;ldb, &amp;info);</div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;  <span class="keywordflow">return</span> info;</div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;}</div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160; </div>
<div class="line"><a name="l01338"></a><span class="lineno"><a class="line" href="namespaceslmm.html#a72e0b388216ade5a898974cd0ca27c01"> 1338</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespaceslmm.html#a72e0b388216ade5a898974cd0ca27c01">copy_vertices</a> (</div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;  <span class="keyword">const</span> siqk::ConstVec3s::HostMirror&amp; p, <span class="keyword">const</span> siqk::ConstIdxs::HostMirror&amp; c2n,</div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;  <span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> ci, <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a>* ps)</div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;{</div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;  <span class="keyword">const</span> <span class="keyword">auto</span> cell = <a class="code" href="namespacesiqk.html#aef983887889243999a1d7ddea864ad1f">slice</a>(c2n, ci);</div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> i = 0; i &lt; <a class="code" href="namespacesiqk.html#a6c43ff2c83ad6b7d0dc61c2c5e83a680">szslice</a>(c2n); ++i) {</div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span> n = <a class="code" href="namespacesiqk.html#aef983887889243999a1d7ddea864ad1f">slice</a>(p, cell[i]);</div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> <a class="code" href="namespacebaroclinic__wave.html#a8619f63e6dd6db1077c1a18788afa359">k</a> = 0; <a class="code" href="namespacebaroclinic__wave.html#a8619f63e6dd6db1077c1a18788afa359">k</a> &lt; 3; ++<a class="code" href="namespacebaroclinic__wave.html#a8619f63e6dd6db1077c1a18788afa359">k</a>) ps[<a class="code" href="namespacebaroclinic__wave.html#a8619f63e6dd6db1077c1a18788afa359">k</a>] = n[<a class="code" href="namespacebaroclinic__wave.html#a8619f63e6dd6db1077c1a18788afa359">k</a>];</div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;    ps += 3;</div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;  }</div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;}</div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160; </div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;<span class="keyword">static</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> test_gll () {</div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;  <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> nerr = 0;</div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;  <span class="keyword">const</span> <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a> <a class="code" href="namespacecontrol__mod.html#a19f70697971fe3e6502be3097865437a">tol</a> = 1e2*<a class="code" href="namespacedcmip2012__test5.html#a23dbdf598e3e14675594d87b6df56eb3">std::numeric_limits&lt;Real&gt;::epsilon</a>();</div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;  GLL gll;</div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;  <span class="keyword">const</span> <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a>* <a class="code" href="namespacesupercell.html#ae57ef03dc0cb9828dbacc89aac8870c0">x</a>, * wt;</div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> <a class="code" href="namespacedimensions__mod.html#a8648e26ae0e474ccf69d32a8148520c9">np</a> = 2; <a class="code" href="namespacedimensions__mod.html#a8648e26ae0e474ccf69d32a8148520c9">np</a> &lt;= 4; ++<a class="code" href="namespacedimensions__mod.html#a8648e26ae0e474ccf69d32a8148520c9">np</a>) {</div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> monotone_type = 0; monotone_type &lt;= 1; ++monotone_type) {</div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;      <span class="keyword">const</span> Basis <a class="code" href="namespacebaroclinic__wave.html#acf8e56bd7dfdfd2c39e16dfa491a5293">b</a>(<a class="code" href="namespacedimensions__mod.html#a8648e26ae0e474ccf69d32a8148520c9">np</a>, monotone_type);</div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;      gll.get_coef(<a class="code" href="namespacebaroclinic__wave.html#acf8e56bd7dfdfd2c39e16dfa491a5293">b</a>, <a class="code" href="namespacesupercell.html#ae57ef03dc0cb9828dbacc89aac8870c0">x</a>, wt);</div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;      <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a> sum = 0;</div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> i = 0; i &lt; <a class="code" href="namespacebaroclinic__wave.html#acf8e56bd7dfdfd2c39e16dfa491a5293">b</a>.np; ++i)</div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;        sum += wt[i];</div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;      <span class="keywordflow">if</span> (std::abs(2 - sum) &gt; <a class="code" href="namespacecontrol__mod.html#a19f70697971fe3e6502be3097865437a">tol</a>) {</div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;        std::cerr &lt;&lt; <span class="stringliteral">&quot;test_gll &quot;</span> &lt;&lt; <a class="code" href="namespacedimensions__mod.html#a8648e26ae0e474ccf69d32a8148520c9">np</a> &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; monotone_type</div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;                  &lt;&lt; <span class="stringliteral">&quot;: 2 - sum = &quot;</span> &lt;&lt; 2 - sum &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;        ++nerr;</div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;      }</div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> j = 0; j &lt; <a class="code" href="namespacebaroclinic__wave.html#acf8e56bd7dfdfd2c39e16dfa491a5293">b</a>.np; ++j) {</div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;        <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a> gj[<a class="code" href="classslmm_1_1_g_l_l.html#aa681216b46ee048c89a20a2cf8094284a572bdf0ea4245230402c0ef9a860b5f8">GLL::np_max</a>];</div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;        gll.eval(<a class="code" href="namespacebaroclinic__wave.html#acf8e56bd7dfdfd2c39e16dfa491a5293">b</a>, <a class="code" href="namespacesupercell.html#ae57ef03dc0cb9828dbacc89aac8870c0">x</a>[j], gj);</div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> i = 0; i &lt; <a class="code" href="namespacebaroclinic__wave.html#acf8e56bd7dfdfd2c39e16dfa491a5293">b</a>.np; ++i) {</div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;          <span class="keywordflow">if</span> (j == i) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;          <span class="keywordflow">if</span> (std::abs(gj[i]) &gt; <a class="code" href="namespacecontrol__mod.html#a19f70697971fe3e6502be3097865437a">tol</a>) {</div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;            std::cerr &lt;&lt; <span class="stringliteral">&quot;test_gll &quot;</span> &lt;&lt; <a class="code" href="namespacedimensions__mod.html#a8648e26ae0e474ccf69d32a8148520c9">np</a> &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; monotone_type &lt;&lt; <span class="stringliteral">&quot;: gj[&quot;</span></div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;                      &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot;] = &quot;</span> &lt;&lt; gj[i] &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;            ++nerr;</div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;          }</div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;        }</div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;      }</div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;    }</div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;  }</div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> <a class="code" href="namespacedimensions__mod.html#a8648e26ae0e474ccf69d32a8148520c9">np</a> = 2; <a class="code" href="namespacedimensions__mod.html#a8648e26ae0e474ccf69d32a8148520c9">np</a> &lt;= 4; ++<a class="code" href="namespacedimensions__mod.html#a8648e26ae0e474ccf69d32a8148520c9">np</a>) {</div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;    <span class="keyword">const</span> Basis <a class="code" href="namespacebaroclinic__wave.html#acf8e56bd7dfdfd2c39e16dfa491a5293">b</a>(<a class="code" href="namespacedimensions__mod.html#a8648e26ae0e474ccf69d32a8148520c9">np</a>, 0);</div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;    <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a> <a class="code" href="namespacejw.html#acf663523b96ec023200fa8a0f58209f8">a</a>[] = {-0.9, -0.7, -0.3, 0.1, 0.2, 0.4, 0.6, 0.8};</div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;    <span class="keyword">const</span> <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a> delta = std::sqrt(<a class="code" href="namespacedcmip2012__test5.html#a23dbdf598e3e14675594d87b6df56eb3">std::numeric_limits&lt;Real&gt;::epsilon</a>());</div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> ia = 0; ia &lt; <span class="keyword">sizeof</span>(<a class="code" href="namespacejw.html#acf663523b96ec023200fa8a0f58209f8">a</a>)/<span class="keyword">sizeof</span>(<a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a>); ++ia) {</div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;      <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a> gj[<a class="code" href="classslmm_1_1_g_l_l.html#aa681216b46ee048c89a20a2cf8094284a572bdf0ea4245230402c0ef9a860b5f8">GLL::np_max</a>], gjp[<a class="code" href="classslmm_1_1_g_l_l.html#aa681216b46ee048c89a20a2cf8094284a572bdf0ea4245230402c0ef9a860b5f8">GLL::np_max</a>], gjm[<a class="code" href="classslmm_1_1_g_l_l.html#aa681216b46ee048c89a20a2cf8094284a572bdf0ea4245230402c0ef9a860b5f8">GLL::np_max</a>];</div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;      gll.eval_derivative(<a class="code" href="namespacebaroclinic__wave.html#acf8e56bd7dfdfd2c39e16dfa491a5293">b</a>, <a class="code" href="namespacejw.html#acf663523b96ec023200fa8a0f58209f8">a</a>[ia], gj);</div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;      gll.eval(<a class="code" href="namespacebaroclinic__wave.html#acf8e56bd7dfdfd2c39e16dfa491a5293">b</a>, <a class="code" href="namespacejw.html#acf663523b96ec023200fa8a0f58209f8">a</a>[ia] + delta, gjp);</div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;      gll.eval(<a class="code" href="namespacebaroclinic__wave.html#acf8e56bd7dfdfd2c39e16dfa491a5293">b</a>, <a class="code" href="namespacejw.html#acf663523b96ec023200fa8a0f58209f8">a</a>[ia] - delta, gjm);</div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> i = 0; i &lt; <a class="code" href="namespacebaroclinic__wave.html#acf8e56bd7dfdfd2c39e16dfa491a5293">b</a>.np; ++i) {</div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;        <span class="keyword">const</span> <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a> fd = (gjp[i] - gjm[i])/(2*delta);</div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;        <span class="keywordflow">if</span> (std::abs(fd - gj[i]) &gt;= delta*std::abs(gjp[i]))</div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;          ++nerr;</div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;      }</div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;    }</div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;  }</div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;  <span class="keywordflow">return</span> nerr;</div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;}</div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160; </div>
<div class="line"><a name="l01400"></a><span class="lineno"><a class="line" href="namespaceslmm.html#a7a1095b904c8047101a58045c12f867c"> 1400</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="namespaceslmm.html#a7a1095b904c8047101a58045c12f867c">unittest</a> () {</div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;  <span class="keywordtype">int</span> nerr = 0;</div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;  nerr += test_gll();</div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;  <span class="keywordflow">return</span> nerr;</div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;}</div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160; </div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a> sqrt5 = std::sqrt(5.0);</div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a> oosqrt5 = 1.0 / sqrt5;</div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160; </div>
<div class="line"><a name="l01409"></a><span class="lineno"><a class="line" href="namespaceslmm.html#a4d941cd95a177036a863d2f3387db705"> 1409</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespaceslmm.html#a4d941cd95a177036a863d2f3387db705">gll_np4_eval</a> (<span class="keyword">const</span> <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a> <a class="code" href="namespacesupercell.html#ae57ef03dc0cb9828dbacc89aac8870c0">x</a>, <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a> y[4]) {</div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;  <span class="keyword">static</span> constexpr <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a> oo8 = 1.0/8.0;</div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;  <span class="keyword">const</span> <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a> x2 = <a class="code" href="namespacesupercell.html#ae57ef03dc0cb9828dbacc89aac8870c0">x</a>*<a class="code" href="namespacesupercell.html#ae57ef03dc0cb9828dbacc89aac8870c0">x</a>;</div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;  y[0] = (1.0 - <a class="code" href="namespacesupercell.html#ae57ef03dc0cb9828dbacc89aac8870c0">x</a>)*(5.0*x2 - 1.0)*oo8;</div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;  y[1] = -sqrt5*oo8*(sqrt5 - 5.0*<a class="code" href="namespacesupercell.html#ae57ef03dc0cb9828dbacc89aac8870c0">x</a>)*(x2 - 1.0);</div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;  y[2] = -sqrt5*oo8*(sqrt5 + 5.0*<a class="code" href="namespacesupercell.html#ae57ef03dc0cb9828dbacc89aac8870c0">x</a>)*(x2 - 1.0);</div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;  y[3] = (1.0 + <a class="code" href="namespacesupercell.html#ae57ef03dc0cb9828dbacc89aac8870c0">x</a>)*(5.0*x2 - 1.0)*oo8;</div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;}</div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160; </div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;<span class="comment">// Linear interp in each region.</span></div>
<div class="line"><a name="l01419"></a><span class="lineno"><a class="line" href="namespaceslmm.html#a6b2f7bea32d0ed791568dd376bc34122"> 1419</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespaceslmm.html#a6b2f7bea32d0ed791568dd376bc34122">gll_np4_subgrid_eval</a> (<span class="keyword">const</span> <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a>&amp; <a class="code" href="namespacesupercell.html#ae57ef03dc0cb9828dbacc89aac8870c0">x</a>, <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a> y[4]) {</div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacesupercell.html#ae57ef03dc0cb9828dbacc89aac8870c0">x</a> &gt; 0) {</div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;    <a class="code" href="namespaceslmm.html#a6b2f7bea32d0ed791568dd376bc34122">gll_np4_subgrid_eval</a>(-<a class="code" href="namespacesupercell.html#ae57ef03dc0cb9828dbacc89aac8870c0">x</a>, y);</div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;    <a class="code" href="namespacesiqk.html#a9943941928d901bed7442db5eaecbb46">std::swap</a>(y[0], y[3]);</div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;    <a class="code" href="namespacesiqk.html#a9943941928d901bed7442db5eaecbb46">std::swap</a>(y[1], y[2]);    </div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;  }</div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacesupercell.html#ae57ef03dc0cb9828dbacc89aac8870c0">x</a> &lt; -oosqrt5) {</div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;    <span class="keyword">const</span> <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a> alpha = (<a class="code" href="namespacesupercell.html#ae57ef03dc0cb9828dbacc89aac8870c0">x</a> + 1)/(1 - oosqrt5);</div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;    y[0] = 1 - alpha;</div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;    y[1] = alpha;</div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;    y[2] = 0;</div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;    y[3] = 0;</div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;    <span class="keyword">const</span> <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a> alpha = (<a class="code" href="namespacesupercell.html#ae57ef03dc0cb9828dbacc89aac8870c0">x</a> + oosqrt5)/(2*oosqrt5);</div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;    y[0] = 0;</div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;    y[1] = 1 - alpha;</div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;    y[2] = alpha;</div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;    y[3] = 0;</div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;  }</div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;}</div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160; </div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;<span class="comment">// Quadratic interpolant across nodes 1,2,3 -- i.e., excluding node 0 -- of the</span></div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;<span class="comment">// np=4 reference element.</span></div>
<div class="line"><a name="l01443"></a><span class="lineno"><a class="line" href="namespaceslmm.html#ab6e385dfff0e6b930f379fd12241e018"> 1443</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespaceslmm.html#ab6e385dfff0e6b930f379fd12241e018">outer_eval</a> (<span class="keyword">const</span> <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a>&amp; <a class="code" href="namespacesupercell.html#ae57ef03dc0cb9828dbacc89aac8870c0">x</a>, <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a> v[4]) {</div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;  <span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a></div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;    xbar = (2*oosqrt5) / (1 + oosqrt5),</div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;    ooxbar = 1 / xbar,</div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;    ybar = 1 / (xbar - 1);</div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;  <span class="keyword">const</span> <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a> xn = (<a class="code" href="namespacesupercell.html#ae57ef03dc0cb9828dbacc89aac8870c0">x</a> + oosqrt5) / (1 + oosqrt5);</div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;  v[0] = 0;</div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;  v[1] = 1 + ybar*xn*((1 - ooxbar)*xn + ooxbar - xbar);</div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;  v[2] = ybar*ooxbar*xn*(xn - 1);</div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;  v[3] = ybar*xn*(xbar - xn);</div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;}</div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160; </div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;<span class="comment">// In the middle region, use the standard GLL np=4 interpolant; in the two outer</span></div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;<span class="comment">// regions, use an order-reduced interpolant, but one that stabilizes the</span></div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;<span class="comment">// resulting classical SL method stable for the uniform-flow problem on a</span></div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;<span class="comment">// uniform mesh.</span></div>
<div class="line"><a name="l01459"></a><span class="lineno"><a class="line" href="namespaceslmm.html#abdee94ea2e7e6d3c8fbeca0ddc821f8d"> 1459</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespaceslmm.html#abdee94ea2e7e6d3c8fbeca0ddc821f8d">gll_np4_subgrid_exp_eval</a> (<span class="keyword">const</span> <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a>&amp; <a class="code" href="namespacesupercell.html#ae57ef03dc0cb9828dbacc89aac8870c0">x</a>, <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a> y[4]) {</div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;  <span class="keyword">static</span> constexpr <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a></div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;    alpha = 0.5527864045000416708,</div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;    v = 0.427*(1 + alpha),</div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;    x2 = 0.4472135954999579277,</div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;    x3 = 1 - x2,</div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;    det = x2*x3*(x2 - x3),</div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;    y2 = alpha,</div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;    y3 = v,</div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;    c1 = (x3*y2 - x2*y3)/det,</div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;    c2 = (-x3*x3*y2 + x2*x2*y3)/det;</div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;  <span class="keywordflow">if</span> (x &lt; -oosqrt5 || x &gt; oosqrt5) {</div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacesupercell.html#ae57ef03dc0cb9828dbacc89aac8870c0">x</a> &lt; -oosqrt5) {</div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;      <a class="code" href="namespaceslmm.html#ab6e385dfff0e6b930f379fd12241e018">outer_eval</a>(-<a class="code" href="namespacesupercell.html#ae57ef03dc0cb9828dbacc89aac8870c0">x</a>, y);</div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;      <a class="code" href="namespacesiqk.html#a9943941928d901bed7442db5eaecbb46">std::swap</a>(y[0], y[3]);</div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;      <a class="code" href="namespacesiqk.html#a9943941928d901bed7442db5eaecbb46">std::swap</a>(y[1], y[2]);</div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;    } <span class="keywordflow">else</span></div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;      <a class="code" href="namespaceslmm.html#ab6e385dfff0e6b930f379fd12241e018">outer_eval</a>(<a class="code" href="namespacesupercell.html#ae57ef03dc0cb9828dbacc89aac8870c0">x</a>, y);</div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;    <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a> y4[4];</div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;    <a class="code" href="namespaceslmm.html#a4d941cd95a177036a863d2f3387db705">gll_np4_eval</a>(<a class="code" href="namespacesupercell.html#ae57ef03dc0cb9828dbacc89aac8870c0">x</a>, y4);</div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;    <span class="keyword">const</span> <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a> x0 = 1 - std::abs(<a class="code" href="namespacesupercell.html#ae57ef03dc0cb9828dbacc89aac8870c0">x</a>);</div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;    <span class="keyword">const</span> <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a> <a class="code" href="namespacejw.html#acf663523b96ec023200fa8a0f58209f8">a</a> = (c1*x0 + c2)*x0;</div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 4; ++i)</div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;      y[i] = <a class="code" href="namespacejw.html#acf663523b96ec023200fa8a0f58209f8">a</a>*y[i] + (1 - <a class="code" href="namespacejw.html#acf663523b96ec023200fa8a0f58209f8">a</a>)*y4[i];</div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;  } <span class="keywordflow">else</span></div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;    <a class="code" href="namespaceslmm.html#a4d941cd95a177036a863d2f3387db705">gll_np4_eval</a>(<a class="code" href="namespacesupercell.html#ae57ef03dc0cb9828dbacc89aac8870c0">x</a>, y);</div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;}</div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160; </div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;<span class="comment">// Is v inside, including on, the quad ic?</span></div>
<div class="line"><a name="l01488"></a><span class="lineno"><a class="line" href="namespaceslmm.html#a3df487e50f2e0c22abe225c73df0e4a4"> 1488</a></span>&#160;<span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="namespaceslmm.html#a3df487e50f2e0c22abe225c73df0e4a4">is_inside</a> (<span class="keyword">const</span> <a class="code" href="structsiqk_1_1sh_1_1_mesh.html">siqk::sh::Mesh&lt;siqk::ko::HostSpace&gt;</a>&amp; m,</div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;                       <span class="keyword">const</span> <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a>* v, <span class="keyword">const</span> <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a>&amp; atol, <span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a>&amp; ic) {</div>
<div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;  <span class="keyword">using</span> <a class="code" href="namespacesiqk.html#aef983887889243999a1d7ddea864ad1f">slmm::slice</a>;</div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;  <span class="keyword">const</span> <span class="keyword">auto</span> cell = <a class="code" href="namespacesiqk.html#aef983887889243999a1d7ddea864ad1f">slice</a>(m.<a class="code" href="structsiqk_1_1sh_1_1_mesh.html#a3e86d388497c2a559b87e401a1235e87">e</a>, ic);</div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;  <span class="keyword">const</span> <span class="keyword">auto</span> celln = <a class="code" href="namespacesiqk.html#aef983887889243999a1d7ddea864ad1f">slice</a>(m.<a class="code" href="structsiqk_1_1sh_1_1_mesh.html#ac734002157287653809b1a732348d568">en</a>, ic);</div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;  <span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> <a class="code" href="namespacedimensions__mod.html#af137394c40531d5d6f0daa64351372e7">ne</a> = 4;</div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;  assert(<a class="code" href="namespacesiqk.html#a6c43ff2c83ad6b7d0dc61c2c5e83a680">szslice</a>(m.<a class="code" href="structsiqk_1_1sh_1_1_mesh.html#a3e86d388497c2a559b87e401a1235e87">e</a>) == <a class="code" href="namespacedimensions__mod.html#af137394c40531d5d6f0daa64351372e7">ne</a>);</div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;  assert(<a class="code" href="namespacesiqk.html#a6c43ff2c83ad6b7d0dc61c2c5e83a680">szslice</a>(m.<a class="code" href="structsiqk_1_1sh_1_1_mesh.html#ac734002157287653809b1a732348d568">en</a>) == <a class="code" href="namespacedimensions__mod.html#af137394c40531d5d6f0daa64351372e7">ne</a>);</div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;  <span class="keywordtype">bool</span> inside = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> ie = 0; ie &lt; <a class="code" href="namespacedimensions__mod.html#af137394c40531d5d6f0daa64351372e7">ne</a>; ++ie)</div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="structsiqk_1_1_sphere_geometry.html#a4285d0d14d246cfc3e6687c7aed5ec36">siqk::SphereGeometry::dot_c_amb</a>(<a class="code" href="namespacesiqk.html#aef983887889243999a1d7ddea864ad1f">slice</a>(m.<a class="code" href="structsiqk_1_1sh_1_1_mesh.html#a08b7acf03ca69f64736bda8060053539">nml</a>, celln[ie]),</div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;                                        v, <a class="code" href="namespacesiqk.html#aef983887889243999a1d7ddea864ad1f">slice</a>(m.<a class="code" href="structsiqk_1_1sh_1_1_mesh.html#a09ea9632dd1680a04d53aec55d4b6e4f">p</a>, cell[ie]))</div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;        &lt; -atol) {</div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;      inside = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;    }</div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;  <span class="keywordflow">return</span> inside;</div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;}</div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160; </div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;<span class="comment">// Both cubed_sphere_map=0 and cubed_sphere_map=2 can use this</span></div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;<span class="comment">// method. (cubed_sphere_map=1 is not impl&#39;ed in Homme.) This method is natural</span></div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;<span class="comment">// for cubed_sphere_map=2, so RRM works automatically. cubed_sphere_map=0 is</span></div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;<span class="comment">// supported in Homme only for regular cubed-sphere meshes, not RRM; in that</span></div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;<span class="comment">// case, edges are great arcs, so again this impl works. In contrast,</span></div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;<span class="comment">// calc_sphere_to_ref has to be specialized on cubed_sphere_map.</span></div>
<div class="line"><a name="l01513"></a><span class="lineno"><a class="line" href="namespaceslmm.html#a09c707719e4082afb80a56b15c2db8ac"> 1513</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="namespaceslmm.html#a09c707719e4082afb80a56b15c2db8ac">get_src_cell</a> (<span class="keyword">const</span> <a class="code" href="structsiqk_1_1sh_1_1_mesh.html">siqk::sh::Mesh&lt;siqk::ko::HostSpace&gt;</a>&amp; m, <span class="comment">// Local mesh.</span></div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;                  <span class="keyword">const</span> <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a>* v, <span class="comment">// 3D Cartesian point.</span></div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;                  <span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> my_ic = -1) { <span class="comment">// Target cell in the local mesh.</span></div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;  <span class="keyword">using</span> <a class="code" href="namespaceslmm.html#aae47f57e3c25fdbca5ac4c99101905c0">slmm::len</a>;</div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;  <span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> nc = <a class="code" href="namespaceslmm.html#aae47f57e3c25fdbca5ac4c99101905c0">len</a>(m.<a class="code" href="structsiqk_1_1sh_1_1_mesh.html#a3e86d388497c2a559b87e401a1235e87">e</a>);</div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;  <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a> atol = 0;</div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> trial = 0; trial &lt; 3; ++trial) {</div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;    <span class="keywordflow">if</span> (trial &gt; 0) {</div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;      <span class="keywordflow">if</span> (trial == 1) {</div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;        <span class="keyword">using</span> <a class="code" href="namespacesiqk.html#aef983887889243999a1d7ddea864ad1f">slmm::slice</a>;</div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;        <span class="comment">// If !inside in the first sweep, pad each cell. Recall we&#39;re operating</span></div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;        <span class="comment">// on the unit sphere, so we don&#39;t have to worry about a radius in the</span></div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;        <span class="comment">// following.</span></div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;        <span class="comment">//   Get a representative edge length.</span></div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> ic = my_ic == -1 ? 0 : my_ic;</div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;        <span class="keyword">const</span> <span class="keyword">auto</span> cell = <a class="code" href="namespacesiqk.html#aef983887889243999a1d7ddea864ad1f">slice</a>(m.<a class="code" href="structsiqk_1_1sh_1_1_mesh.html#a3e86d388497c2a559b87e401a1235e87">e</a>, ic);</div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;        <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a> d[3];</div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;        <a class="code" href="structsiqk_1_1_sphere_geometry.html#abe55b2f04df31eb101c6ede1d4e2da3f">siqk::SphereGeometry::axpbyz</a>(1, <a class="code" href="namespacesiqk.html#aef983887889243999a1d7ddea864ad1f">slice</a>(m.<a class="code" href="structsiqk_1_1sh_1_1_mesh.html#a09ea9632dd1680a04d53aec55d4b6e4f">p</a>, cell[1]),</div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;                                     -1, <a class="code" href="namespacesiqk.html#aef983887889243999a1d7ddea864ad1f">slice</a>(m.<a class="code" href="structsiqk_1_1sh_1_1_mesh.html#a09ea9632dd1680a04d53aec55d4b6e4f">p</a>, cell[0]),</div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;                                     d);</div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;        <span class="keyword">const</span> <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a> L = std::sqrt(<a class="code" href="structsiqk_1_1_sphere_geometry.html#abeb5a91432744cabf20d3a357e08f18d">siqk::SphereGeometry::norm2</a>(d));</div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;        <span class="comment">// We can expect to lose approx. -log10(L) digits due to cancellation in</span></div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;        <span class="comment">// the formation of the edge normal and in dot_c_amb. Multiply by 100</span></div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;        <span class="comment">// for a little extra padding.</span></div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;        atol = 1e2 * <a class="code" href="namespacedcmip2012__test5.html#a23dbdf598e3e14675594d87b6df56eb3">std::numeric_limits&lt;Real&gt;::epsilon</a>() / L;</div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;        <span class="comment">// Ok, we really didn&#39;t do that very well. We&#39;re still failing to find</span></div>
<div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;        <span class="comment">// the element. Ramp up the atol even more.</span></div>
<div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;        atol = <a class="code" href="namespacesiqk.html#a984fe7f0fc55d1f004981d9b6ffac4f7">std::max</a>(1e3*atol,</div>
<div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;                        std::sqrt(<a class="code" href="namespacedcmip2012__test5.html#a23dbdf598e3e14675594d87b6df56eb3">std::numeric_limits&lt;Real&gt;::epsilon</a>()));</div>
<div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;      }</div>
<div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;    }</div>
<div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;    <span class="keywordflow">if</span> (my_ic != -1 &amp;&amp; <a class="code" href="namespaceslmm.html#a3df487e50f2e0c22abe225c73df0e4a4">is_inside</a>(m, v, atol, my_ic)) <span class="keywordflow">return</span> my_ic;</div>
<div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> ic = 0; ic &lt; nc; ++ic) {</div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;      <span class="keywordflow">if</span> (ic == my_ic) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="namespaceslmm.html#a3df487e50f2e0c22abe225c73df0e4a4">is_inside</a>(m, v, atol, ic)) <span class="keywordflow">return</span> ic;</div>
<div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;    }</div>
<div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;  }</div>
<div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;  <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;}</div>
<div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160; </div>
<div class="line"><a name="l01554"></a><span class="lineno"><a class="line" href="namespaceslmm.html#abd0cae1accc71492fec5b3a5cfb40d09"> 1554</a></span>&#160;std::string <a class="code" href="namespaceslmm.html#abd0cae1accc71492fec5b3a5cfb40d09">to_string</a> (<span class="keyword">const</span> <a class="code" href="structsiqk_1_1sh_1_1_mesh.html">siqk::sh::Mesh&lt;siqk::ko::HostSpace&gt;</a>&amp; m) {</div>
<div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;  std::stringstream ss;</div>
<div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;  ss.precision(17);</div>
<div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;  ss &lt;&lt; <span class="stringliteral">&quot;(mesh nnode &quot;</span> &lt;&lt; <a class="code" href="namespacesiqk.html#a3f1b5069fc1ac06e18aa603b592403e6">nslices</a>(m.<a class="code" href="structsiqk_1_1sh_1_1_mesh.html#a09ea9632dd1680a04d53aec55d4b6e4f">p</a>) &lt;&lt; <span class="stringliteral">&quot; nelem &quot;</span> &lt;&lt; <a class="code" href="namespacesiqk.html#a3f1b5069fc1ac06e18aa603b592403e6">nslices</a>(m.<a class="code" href="structsiqk_1_1sh_1_1_mesh.html#a3e86d388497c2a559b87e401a1235e87">e</a>);</div>
<div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> ie = 0; ie &lt; <a class="code" href="namespacesiqk.html#a3f1b5069fc1ac06e18aa603b592403e6">nslices</a>(m.<a class="code" href="structsiqk_1_1sh_1_1_mesh.html#a3e86d388497c2a559b87e401a1235e87">e</a>); ++ie) {</div>
<div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;    ss &lt;&lt; <span class="stringliteral">&quot;\n  (elem &quot;</span> &lt;&lt; ie;</div>
<div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;    ss &lt;&lt; <span class="stringliteral">&quot; (&quot;</span>;</div>
<div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> iv = 0; iv &lt; <a class="code" href="namespacesiqk.html#a6c43ff2c83ad6b7d0dc61c2c5e83a680">szslice</a>(m.<a class="code" href="structsiqk_1_1sh_1_1_mesh.html#a3e86d388497c2a559b87e401a1235e87">e</a>); ++iv) ss &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; m.<a class="code" href="structsiqk_1_1sh_1_1_mesh.html#a3e86d388497c2a559b87e401a1235e87">e</a>(ie,iv);</div>
<div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;    ss &lt;&lt; <span class="stringliteral">&quot;)&quot;</span>;</div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> iv = 0; iv &lt; <a class="code" href="namespacesiqk.html#a6c43ff2c83ad6b7d0dc61c2c5e83a680">szslice</a>(m.<a class="code" href="structsiqk_1_1sh_1_1_mesh.html#a3e86d388497c2a559b87e401a1235e87">e</a>); ++iv) {</div>
<div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;      ss &lt;&lt; <span class="stringliteral">&quot;\n     (p&quot;</span>;</div>
<div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> d = 0; d &lt; 3; ++d)</div>
<div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;        ss &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; m.<a class="code" href="structsiqk_1_1sh_1_1_mesh.html#a09ea9632dd1680a04d53aec55d4b6e4f">p</a>(m.<a class="code" href="structsiqk_1_1sh_1_1_mesh.html#a3e86d388497c2a559b87e401a1235e87">e</a>(ie,iv),d);</div>
<div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;      ss &lt;&lt; <span class="stringliteral">&quot;)&quot;</span>;</div>
<div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;      ss &lt;&lt; <span class="stringliteral">&quot;\n     (nml&quot;</span>;</div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> d = 0; d &lt; 3; ++d)</div>
<div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;        ss &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; m.<a class="code" href="structsiqk_1_1sh_1_1_mesh.html#a08b7acf03ca69f64736bda8060053539">nml</a>(m.<a class="code" href="structsiqk_1_1sh_1_1_mesh.html#ac734002157287653809b1a732348d568">en</a>(ie,iv),d);</div>
<div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;      ss &lt;&lt; <span class="stringliteral">&quot;)&quot;</span>;</div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;    }</div>
<div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;    ss &lt;&lt; <span class="stringliteral">&quot;))&quot;</span>;</div>
<div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;  }</div>
<div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;  ss &lt;&lt; <span class="stringliteral">&quot;)&quot;</span>;</div>
<div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;  <span class="keywordflow">return</span> ss.str();</div>
<div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;}</div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160; </div>
<div class="line"><a name="l01579"></a><span class="lineno"><a class="line" href="namespaceslmm_1_1nearest__point.html"> 1579</a></span>&#160;<span class="keyword">namespace </span>nearest_point {</div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;<span class="comment">/* Get external segments in preproc step.</span></div>
<div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;<span class="comment">   Get approximate nearest point in each segment.</span></div>
<div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;<span class="comment">     Project onto plane of segment and normalize.</span></div>
<div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;<span class="comment">     If outside of arc, choose nearest endpoint.</span></div>
<div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;<span class="comment">     Approx distance as cartesian distance.</span></div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;<span class="comment">   Of the approx dists, take the point associated with smallest.</span></div>
<div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160; </div>
<div class="line"><a name="l01588"></a><span class="lineno"><a class="line" href="namespaceslmm_1_1nearest__point.html#aa389a84fa6e8831d1ba347ec19219c0d"> 1588</a></span>&#160;<span class="keyword">typedef</span> <a class="code" href="structsiqk_1_1sh_1_1_mesh.html">siqk::sh::Mesh&lt;siqk::ko::HostSpace&gt;</a> <a class="code" href="namespaceslmm_1_1nearest__point.html#aa389a84fa6e8831d1ba347ec19219c0d">Mesh</a>;</div>
<div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160; </div>
<div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> ES = ko::DefaultExecutionSpace&gt;</div>
<div class="line"><a name="l01591"></a><span class="lineno"><a class="line" href="structslmm_1_1nearest__point_1_1_mesh_nearest_point_data.html"> 1591</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structslmm_1_1nearest__point_1_1_mesh_nearest_point_data.html">MeshNearestPointData</a> {</div>
<div class="line"><a name="l01592"></a><span class="lineno"><a class="line" href="structslmm_1_1nearest__point_1_1_mesh_nearest_point_data.html#ab588a28d42c14b6d948b948da9c91f6c"> 1592</a></span>&#160;  <span class="keyword">typedef</span> ko::View&lt;Int*,ES&gt; <a class="code" href="structslmm_1_1nearest__point_1_1_mesh_nearest_point_data.html#ab588a28d42c14b6d948b948da9c91f6c">Ints</a>;</div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;  <span class="comment">// mesh.p(perimp(k),:) is the k&#39;th vertex in the mesh&#39;s perimeter. Similarly,</span></div>
<div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;  <span class="comment">// mesh.nml(perimnml(k),:) is the k&#39;th edge&#39;s normal.</span></div>
<div class="line"><a name="l01595"></a><span class="lineno"><a class="line" href="structslmm_1_1nearest__point_1_1_mesh_nearest_point_data.html#a960ab7dce344a0638cc7916beb860e17"> 1595</a></span>&#160;  <a class="code" href="structslmm_1_1nearest__point_1_1_mesh_nearest_point_data.html#ab588a28d42c14b6d948b948da9c91f6c">Ints</a> <a class="code" href="structslmm_1_1nearest__point_1_1_mesh_nearest_point_data.html#ac72796b400d078db1a96e260968ff226">perimp</a>, <a class="code" href="structslmm_1_1nearest__point_1_1_mesh_nearest_point_data.html#a960ab7dce344a0638cc7916beb860e17">perimnml</a>;</div>
<div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;};</div>
<div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160; </div>
<div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> V3a, <span class="keyword">typename</span> V3b&gt;</div>
<div class="line"><a name="l01599"></a><span class="lineno"><a class="line" href="namespaceslmm_1_1nearest__point.html#a8df5028268da3dd050d3db963e11780d"> 1599</a></span>&#160;<span class="keyword">inline</span> <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a> <a class="code" href="namespaceslmm_1_1nearest__point.html#a8df5028268da3dd050d3db963e11780d">calc_dist</a> (<span class="keyword">const</span> V3a&amp; <a class="code" href="namespace_homme_1_1_physical_constants.html#af1c6ba44dbdc6bf279635f8ef11b6862">p0</a>, <span class="keyword">const</span> V3b&amp; p1) {</div>
<div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;  <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a> <a class="code" href="namespaceslmm.html#aae47f57e3c25fdbca5ac4c99101905c0">len</a> = 0;</div>
<div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> d = 0; d &lt; 3; ++d) <a class="code" href="namespaceslmm.html#aae47f57e3c25fdbca5ac4c99101905c0">len</a> += <a class="code" href="namespacesiqk.html#aa4d80b92cc4a0024c2a687c4ddeb6e7f">siqk::square</a>(<a class="code" href="namespace_homme_1_1_physical_constants.html#af1c6ba44dbdc6bf279635f8ef11b6862">p0</a>[d] - p1[d]);</div>
<div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;  <span class="keywordflow">return</span> std::sqrt(<a class="code" href="namespaceslmm.html#aae47f57e3c25fdbca5ac4c99101905c0">len</a>);    </div>
<div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;}</div>
<div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160; </div>
<div class="line"><a name="l01605"></a><span class="lineno"><a class="line" href="namespaceslmm_1_1nearest__point.html#a16c7a1cf8af3f2bb54711cab361a4e00"> 1605</a></span>&#160;<span class="keyword">inline</span> <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a> <a class="code" href="namespaceslmm_1_1nearest__point.html#a8df5028268da3dd050d3db963e11780d">calc_dist</a> (<span class="keyword">const</span> <a class="code" href="structsiqk_1_1sh_1_1_mesh.html">Mesh</a>&amp; m, <span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a>&amp; i0, <span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a>&amp; i1) {</div>
<div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespaceslmm_1_1nearest__point.html#a8df5028268da3dd050d3db963e11780d">calc_dist</a>(<a class="code" href="namespacesiqk.html#aef983887889243999a1d7ddea864ad1f">slice</a>(m.<a class="code" href="structsiqk_1_1sh_1_1_mesh.html#a09ea9632dd1680a04d53aec55d4b6e4f">p</a>, i0), <a class="code" href="namespacesiqk.html#aef983887889243999a1d7ddea864ad1f">slice</a>(m.<a class="code" href="structsiqk_1_1sh_1_1_mesh.html#a09ea9632dd1680a04d53aec55d4b6e4f">p</a>, i1));</div>
<div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;}</div>
<div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160; </div>
<div class="line"><a name="l01609"></a><span class="lineno"><a class="line" href="namespaceslmm_1_1nearest__point.html#a0ec75593ecf9631ec941a4f063a5d331"> 1609</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespaceslmm_1_1nearest__point.html#a0ec75593ecf9631ec941a4f063a5d331">find_external_edges</a> (<span class="keyword">const</span> <a class="code" href="structsiqk_1_1sh_1_1_mesh.html">Mesh</a>&amp; m, std::vector&lt;Int&gt;&amp; external_edges) {</div>
<div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;  <span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> ncell = <a class="code" href="namespacesiqk.html#a3f1b5069fc1ac06e18aa603b592403e6">nslices</a>(m.<a class="code" href="structsiqk_1_1sh_1_1_mesh.html#a3e86d388497c2a559b87e401a1235e87">e</a>);</div>
<div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;  <span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> nedge = 4*ncell;</div>
<div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;  <span class="comment">// Get the minimum edge length to normalize distance.</span></div>
<div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;  <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a> min_edge_len = 10;</div>
<div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> ic = 0; ic &lt; ncell; ++ic) {</div>
<div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span> cell = <a class="code" href="namespacesiqk.html#aef983887889243999a1d7ddea864ad1f">slice</a>(m.<a class="code" href="structsiqk_1_1sh_1_1_mesh.html#a3e86d388497c2a559b87e401a1235e87">e</a>, ic);</div>
<div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> ie = 0; ie &lt; 4; ++ie)</div>
<div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;      min_edge_len = <a class="code" href="namespacesiqk.html#aa8af675f4123cd3ef73b7d549fb84324">std::min</a>(min_edge_len,</div>
<div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;                              <a class="code" href="namespaceslmm_1_1nearest__point.html#a8df5028268da3dd050d3db963e11780d">calc_dist</a>(m, cell[ie], cell[(ie+1)%4]));</div>
<div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;  }</div>
<div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;  <span class="comment">// If two edges are sufficiently close, they are interpreted as the same and</span></div>
<div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;  <span class="comment">// so internal. That leaves just the external edges.</span></div>
<div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> ic0 = 0; ic0 &lt; ncell; ++ic0) {</div>
<div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span> cell0 = <a class="code" href="namespacesiqk.html#aef983887889243999a1d7ddea864ad1f">slice</a>(m.<a class="code" href="structsiqk_1_1sh_1_1_mesh.html#a3e86d388497c2a559b87e401a1235e87">e</a>, ic0);</div>
<div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> ie0 = 0; ie0 &lt; 4; ++ie0) {</div>
<div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;      <span class="keywordtype">bool</span> fnd_match = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> ic1 = 0; ic1 &lt; ncell; ++ic1) {</div>
<div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;        <span class="keywordflow">if</span> (ic1 == ic0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;        <span class="keyword">const</span> <span class="keyword">auto</span> cell1 = <a class="code" href="namespacesiqk.html#aef983887889243999a1d7ddea864ad1f">slice</a>(m.<a class="code" href="structsiqk_1_1sh_1_1_mesh.html#a3e86d388497c2a559b87e401a1235e87">e</a>, ic1);</div>
<div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> ie1 = 0; ie1 &lt; 4; ++ie1) {</div>
<div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;          <span class="keyword">const</span> <span class="keyword">auto</span> edist = </div>
<div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;            <a class="code" href="namespacesiqk.html#aa8af675f4123cd3ef73b7d549fb84324">std::min</a>(<a class="code" href="namespaceslmm_1_1nearest__point.html#a8df5028268da3dd050d3db963e11780d">calc_dist</a>(m, cell0[ie0], cell1[ie1]) +</div>
<div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;                     <a class="code" href="namespaceslmm_1_1nearest__point.html#a8df5028268da3dd050d3db963e11780d">calc_dist</a>(m, cell0[(ie0+1)%4], cell1[(ie1+1)%4]),</div>
<div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;                     <a class="code" href="namespaceslmm_1_1nearest__point.html#a8df5028268da3dd050d3db963e11780d">calc_dist</a>(m, cell0[ie0], cell1[(ie1+1)%4]) +</div>
<div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;                     <a class="code" href="namespaceslmm_1_1nearest__point.html#a8df5028268da3dd050d3db963e11780d">calc_dist</a>(m, cell0[(ie0+1)%4], cell1[ie1]));</div>
<div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;          <span class="keywordflow">if</span> (edist &lt; 0.01*min_edge_len) {</div>
<div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;            fnd_match = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;          }</div>
<div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;        }</div>
<div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;        <span class="keywordflow">if</span> (fnd_match) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;      }</div>
<div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;      <span class="keywordflow">if</span> ( ! fnd_match) external_edges.push_back(4*ic0 + ie0);</div>
<div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;    }</div>
<div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;  }</div>
<div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;  <span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> nee = external_edges.size();</div>
<div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;  <a class="code" href="compose__slmm_8cpp.html#a7290a1aabe779e162c8d6a36b3abec04">slmm_throw_if</a>((<a class="code" href="namespacesiqk.html#a3f1b5069fc1ac06e18aa603b592403e6">nslices</a>(m.<a class="code" href="structsiqk_1_1sh_1_1_mesh.html#a3e86d388497c2a559b87e401a1235e87">e</a>) == 9 &amp;&amp; nee != 12) ||</div>
<div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;                (<a class="code" href="namespacesiqk.html#a3f1b5069fc1ac06e18aa603b592403e6">nslices</a>(m.<a class="code" href="structsiqk_1_1sh_1_1_mesh.html#a3e86d388497c2a559b87e401a1235e87">e</a>) == 8 &amp;&amp; nee != 10),</div>
<div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;                <span class="stringliteral">&quot;The local mesh has &quot;</span> &lt;&lt; <a class="code" href="namespacesiqk.html#a3f1b5069fc1ac06e18aa603b592403e6">nslices</a>(m.<a class="code" href="structsiqk_1_1sh_1_1_mesh.html#a3e86d388497c2a559b87e401a1235e87">e</a>)</div>
<div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;                &lt;&lt; <span class="stringliteral">&quot; edges but fill_perim found &quot;</span> &lt;&lt; nee</div>
<div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;                &lt;&lt; <span class="stringliteral">&quot; external edges. Mesh:\n&quot;</span></div>
<div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;                &lt;&lt; <a class="code" href="namespaceslmm.html#abd0cae1accc71492fec5b3a5cfb40d09">to_string</a>(m));</div>
<div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;  <span class="comment">// Order edges so the leading point of edge i is the same as the trailing</span></div>
<div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;  <span class="comment">// point of edge (i+1) % nee.</span></div>
<div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> i = 0; i &lt; nee-2; ++i) {</div>
<div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;    <span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> ic = external_edges[i] / 4, ie = external_edges[i] % 4;</div>
<div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span> icell = <a class="code" href="namespacesiqk.html#aef983887889243999a1d7ddea864ad1f">slice</a>(m.<a class="code" href="structsiqk_1_1sh_1_1_mesh.html#a3e86d388497c2a559b87e401a1235e87">e</a>, ic);</div>
<div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;    <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a> min_dist = 10;</div>
<div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;    <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> min_j = -1;</div>
<div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> j = i+1; j &lt; nee; ++j) {</div>
<div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;      <span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> jc = external_edges[j] / 4, je = external_edges[j] % 4;</div>
<div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;      <span class="keyword">const</span> <span class="keyword">auto</span> jcell = <a class="code" href="namespacesiqk.html#aef983887889243999a1d7ddea864ad1f">slice</a>(m.<a class="code" href="structsiqk_1_1sh_1_1_mesh.html#a3e86d388497c2a559b87e401a1235e87">e</a>, jc);</div>
<div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;      <span class="comment">// External edges are all oriented CCW, so the leading point of one</span></div>
<div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;      <span class="comment">// matches the trailing point of the next.</span></div>
<div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;      <span class="keyword">const</span> <span class="keyword">auto</span> d = <a class="code" href="namespaceslmm_1_1nearest__point.html#a8df5028268da3dd050d3db963e11780d">calc_dist</a>(m, icell[(ie+1)%4], jcell[je]);</div>
<div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;      <span class="keywordflow">if</span> (d &lt; min_dist) {</div>
<div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;        min_dist = d;</div>
<div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;        min_j = j;</div>
<div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;      }</div>
<div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;    }</div>
<div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;    <span class="keywordflow">if</span> (min_j != i+1)</div>
<div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;      <a class="code" href="namespacesiqk.html#a9943941928d901bed7442db5eaecbb46">std::swap</a>(external_edges[i+1], external_edges[min_j]);</div>
<div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;  }</div>
<div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;}</div>
<div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160; </div>
<div class="line"><a name="l01675"></a><span class="lineno"><a class="line" href="namespaceslmm_1_1nearest__point.html#a11b8bb5966e37004487b1867b4f761b5"> 1675</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespaceslmm_1_1nearest__point.html#a11b8bb5966e37004487b1867b4f761b5">fill_perim</a> (<span class="keyword">const</span> <a class="code" href="structsiqk_1_1sh_1_1_mesh.html">Mesh</a>&amp; m, <a class="code" href="structslmm_1_1nearest__point_1_1_mesh_nearest_point_data.html">MeshNearestPointData&lt;ko::HostSpace&gt;</a>&amp; d) {</div>
<div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;  std::vector&lt;Int&gt; external_edges;</div>
<div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;  <a class="code" href="namespaceslmm_1_1nearest__point.html#a0ec75593ecf9631ec941a4f063a5d331">find_external_edges</a>(m, external_edges);</div>
<div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;  <span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> nee = external_edges.size();</div>
<div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;  d.<a class="code" href="structslmm_1_1nearest__point_1_1_mesh_nearest_point_data.html#ac72796b400d078db1a96e260968ff226">perimp</a> = <a class="code" href="structslmm_1_1nearest__point_1_1_mesh_nearest_point_data.html#ab588a28d42c14b6d948b948da9c91f6c">MeshNearestPointData&lt;ko::HostSpace&gt;::Ints</a>(<span class="stringliteral">&quot;perimp&quot;</span>, nee);</div>
<div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;  d.<a class="code" href="structslmm_1_1nearest__point_1_1_mesh_nearest_point_data.html#a960ab7dce344a0638cc7916beb860e17">perimnml</a> = <a class="code" href="structslmm_1_1nearest__point_1_1_mesh_nearest_point_data.html#ab588a28d42c14b6d948b948da9c91f6c">MeshNearestPointData&lt;ko::HostSpace&gt;::Ints</a>(<span class="stringliteral">&quot;perimnml&quot;</span>, nee);</div>
<div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> <a class="code" href="namespacebaroclinic__wave.html#a8619f63e6dd6db1077c1a18788afa359">k</a> = 0; <a class="code" href="namespacebaroclinic__wave.html#a8619f63e6dd6db1077c1a18788afa359">k</a> &lt; nee; ++<a class="code" href="namespacebaroclinic__wave.html#a8619f63e6dd6db1077c1a18788afa359">k</a>) {</div>
<div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span> i = external_edges[<a class="code" href="namespacebaroclinic__wave.html#a8619f63e6dd6db1077c1a18788afa359">k</a>];</div>
<div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span> ic = i / 4, ie = i % 4;</div>
<div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;    d.<a class="code" href="structslmm_1_1nearest__point_1_1_mesh_nearest_point_data.html#ac72796b400d078db1a96e260968ff226">perimp</a>(<a class="code" href="namespacebaroclinic__wave.html#a8619f63e6dd6db1077c1a18788afa359">k</a>) = m.<a class="code" href="structsiqk_1_1sh_1_1_mesh.html#a3e86d388497c2a559b87e401a1235e87">e</a>(ic, ie);</div>
<div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;    d.<a class="code" href="structslmm_1_1nearest__point_1_1_mesh_nearest_point_data.html#a960ab7dce344a0638cc7916beb860e17">perimnml</a>(<a class="code" href="namespacebaroclinic__wave.html#a8619f63e6dd6db1077c1a18788afa359">k</a>) = m.<a class="code" href="structsiqk_1_1sh_1_1_mesh.html#ac734002157287653809b1a732348d568">en</a>(ic, ie);</div>
<div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;  }</div>
<div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;}</div>
<div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160; </div>
<div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> V3&gt;</div>
<div class="line"><a name="l01690"></a><span class="lineno"><a class="line" href="namespaceslmm_1_1nearest__point.html#ad8d54e9957242292b2386108848c9fb1"> 1690</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespaceslmm_1_1nearest__point.html#ad8d54e9957242292b2386108848c9fb1">calc_approx_nearest_point_on_arc</a> (</div>
<div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;  <span class="keyword">const</span> V3&amp; <a class="code" href="namespace_homme_1_1_physical_constants.html#af1c6ba44dbdc6bf279635f8ef11b6862">p0</a>, <span class="keyword">const</span> V3&amp; p1, <span class="keyword">const</span> V3&amp; nml, <span class="keyword">const</span> <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a>* point, <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a>* nearest)</div>
<div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;{</div>
<div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;  <span class="comment">// Approximation is to project point onto the plane of the arc, then to</span></div>
<div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;  <span class="comment">// normalize to the arc. If point is on the arc, then nearest = point, as</span></div>
<div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;  <span class="comment">// desired.</span></div>
<div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;  <span class="keyword">using</span> geo = <a class="code" href="structsiqk_1_1_sphere_geometry.html">siqk::SphereGeometry</a>;</div>
<div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;  <span class="keyword">const</span> <span class="keyword">auto</span> dot = geo::dot(point, nml);</div>
<div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> d = 0; d &lt; 3; ++d) nearest[d] = point[d] - dot*nml[d];</div>
<div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;  geo::normalize(nearest);</div>
<div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;  <span class="comment">// If this initial value for nearest is outside of the arc, then &#39;nearest&#39; is</span></div>
<div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;  <span class="comment">// set to the nearer of p0 and p1.</span></div>
<div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;  <span class="comment">//   Find the nearest point on line in parameterized coord alpha. alpha is in</span></div>
<div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;  <span class="comment">// [0,1] if &#39;nearest&#39; is on the arc segment.</span></div>
<div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;  <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a> pdiff[3];</div>
<div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> d = 0; d &lt; 3; ++d) pdiff[d] = <a class="code" href="namespace_homme_1_1_physical_constants.html#af1c6ba44dbdc6bf279635f8ef11b6862">p0</a>[d] - p1[d];</div>
<div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;  <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a> p1mn[3];</div>
<div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> d = 0; d &lt; 3; ++d) p1mn[d] = nearest[d] - p1[d];</div>
<div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;  <span class="keyword">const</span> <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a> alpha = geo::dot(p1mn, pdiff) / geo::norm2(pdiff);</div>
<div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;  <span class="keywordflow">if</span>      (alpha &lt;= 0) <span class="keywordflow">for</span> (<a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> d = 0; d &lt; 3; ++d) nearest[d] = p1[d];</div>
<div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (alpha &gt;= 1) <span class="keywordflow">for</span> (<a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> d = 0; d &lt; 3; ++d) nearest[d] = <a class="code" href="namespace_homme_1_1_physical_constants.html#af1c6ba44dbdc6bf279635f8ef11b6862">p0</a>[d];</div>
<div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;}</div>
<div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160; </div>
<div class="line"><a name="l01713"></a><span class="lineno"><a class="line" href="namespaceslmm_1_1nearest__point.html#ad4423d9ff23bfc563b52a5e68635de6e"> 1713</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespaceslmm_1_1nearest__point.html#ad4423d9ff23bfc563b52a5e68635de6e">calc</a> (<span class="keyword">const</span> <a class="code" href="structsiqk_1_1sh_1_1_mesh.html">Mesh</a>&amp; m, <span class="keyword">const</span> <a class="code" href="structslmm_1_1nearest__point_1_1_mesh_nearest_point_data.html">MeshNearestPointData&lt;ko::HostSpace&gt;</a>&amp; d,</div>
<div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;           <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a>* v) {</div>
<div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;  <span class="keyword">using</span> geo = <a class="code" href="structsiqk_1_1_sphere_geometry.html">siqk::SphereGeometry</a>;</div>
<div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;  <span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> nedge = d.<a class="code" href="structslmm_1_1nearest__point_1_1_mesh_nearest_point_data.html#ac72796b400d078db1a96e260968ff226">perimp</a>.size();</div>
<div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;  <span class="keyword">const</span> <span class="keyword">auto</span> canpoa = [&amp;] (<span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a>&amp; ie, <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a>* vn) {</div>
<div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;    <a class="code" href="namespaceslmm_1_1nearest__point.html#ad8d54e9957242292b2386108848c9fb1">calc_approx_nearest_point_on_arc</a>(<a class="code" href="namespacesiqk.html#aef983887889243999a1d7ddea864ad1f">slice</a>(m.<a class="code" href="structsiqk_1_1sh_1_1_mesh.html#a09ea9632dd1680a04d53aec55d4b6e4f">p</a>, d.<a class="code" href="structslmm_1_1nearest__point_1_1_mesh_nearest_point_data.html#ac72796b400d078db1a96e260968ff226">perimp</a>(ie)),</div>
<div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;                                     <a class="code" href="namespacesiqk.html#aef983887889243999a1d7ddea864ad1f">slice</a>(m.<a class="code" href="structsiqk_1_1sh_1_1_mesh.html#a09ea9632dd1680a04d53aec55d4b6e4f">p</a>, d.<a class="code" href="structslmm_1_1nearest__point_1_1_mesh_nearest_point_data.html#ac72796b400d078db1a96e260968ff226">perimp</a>((ie+1) % nedge)),</div>
<div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;                                     <a class="code" href="namespacesiqk.html#aef983887889243999a1d7ddea864ad1f">slice</a>(m.<a class="code" href="structsiqk_1_1sh_1_1_mesh.html#a08b7acf03ca69f64736bda8060053539">nml</a>, d.<a class="code" href="structslmm_1_1nearest__point_1_1_mesh_nearest_point_data.html#a960ab7dce344a0638cc7916beb860e17">perimnml</a>(ie)),</div>
<div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;                                     v, vn);</div>
<div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;  };</div>
<div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;  <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a> min_dist2 = 100;</div>
<div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;  <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> min_ie = -1;</div>
<div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> ie = 0; ie &lt; nedge; ++ie) {</div>
<div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;    <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a> vn[3];</div>
<div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;    canpoa(ie, vn);</div>
<div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;    <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a> d[3];</div>
<div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> i = 0; i &lt; 3; ++i) d[i] = vn[i] - v[i];</div>
<div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;    <span class="keyword">const</span> <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a> dist2 = geo::norm2(d);</div>
<div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;    <span class="keywordflow">if</span> (dist2 &lt; min_dist2) {</div>
<div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;      min_ie = ie;</div>
<div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;      min_dist2 = dist2;</div>
<div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;    }</div>
<div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;  }</div>
<div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;  {</div>
<div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;    <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a> vn[3];</div>
<div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;    canpoa(min_ie, vn);</div>
<div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> d = 0; d &lt; 3; ++d) v[d] = vn[d];</div>
<div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;  }</div>
<div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;}</div>
<div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160; </div>
<div class="line"><a name="l01743"></a><span class="lineno"><a class="line" href="namespaceslmm_1_1nearest__point.html#ae5d25f37a8bc726da32ca0557f53115e"> 1743</a></span>&#160;<a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> <a class="code" href="namespaceslmm_1_1nearest__point.html#ae5d25f37a8bc726da32ca0557f53115e">test_canpoa</a> () {</div>
<div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;  <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> nerr = 0;</div>
<div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;  <span class="keyword">using</span> geo = <a class="code" href="structsiqk_1_1_sphere_geometry.html">siqk::SphereGeometry</a>;</div>
<div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;  <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a> <a class="code" href="namespace_homme_1_1_physical_constants.html#af1c6ba44dbdc6bf279635f8ef11b6862">p0</a>[] = {-0.5,0.5,0}, p1[] = {0.1,0.8,0}, nml[] = {0,0,-1};</div>
<div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;  geo::normalize(<a class="code" href="namespace_homme_1_1_physical_constants.html#af1c6ba44dbdc6bf279635f8ef11b6862">p0</a>);</div>
<div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;  geo::normalize(p1);</div>
<div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;  <span class="keyword">const</span> <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a> points[][3] = {{-100,1,7}, {0,1,-7}, {11,-1,7}};</div>
<div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;  <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a> correct[3][3];</div>
<div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;  geo::copy(correct[0], <a class="code" href="namespace_homme_1_1_physical_constants.html#af1c6ba44dbdc6bf279635f8ef11b6862">p0</a>);</div>
<div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;  correct[1][0] = 0; correct[1][1] = 1; correct[1][2] = 0;</div>
<div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;  geo::copy(correct[2], p1);</div>
<div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> i = 0; i &lt; 3; ++i) {</div>
<div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;    <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a> nr[3];</div>
<div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;    <a class="code" href="namespaceslmm_1_1nearest__point.html#ad8d54e9957242292b2386108848c9fb1">nearest_point::calc_approx_nearest_point_on_arc</a>(<a class="code" href="namespace_homme_1_1_physical_constants.html#af1c6ba44dbdc6bf279635f8ef11b6862">p0</a>, p1, nml, points[i], nr);</div>
<div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;    <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a> d[3];</div>
<div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;    geo::axpbyz(1, nr, -1, correct[i], d);</div>
<div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;    <span class="keywordflow">if</span> (std::sqrt(geo::norm2(d)) &gt; 10*<a class="code" href="namespacedcmip2012__test5.html#a23dbdf598e3e14675594d87b6df56eb3">std::numeric_limits&lt;Real&gt;::epsilon</a>())</div>
<div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;      ++nerr;</div>
<div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;  }</div>
<div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;  <span class="keywordflow">return</span> nerr;</div>
<div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;}</div>
<div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160; </div>
<div class="line"><a name="l01765"></a><span class="lineno"><a class="line" href="namespaceslmm_1_1nearest__point.html#ae742c9deb75c67768851067d200f7441"> 1765</a></span>&#160;<a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> <a class="code" href="namespaceslmm_1_1nearest__point.html#ae742c9deb75c67768851067d200f7441">test_calc</a> (<span class="keyword">const</span> <a class="code" href="structsiqk_1_1sh_1_1_mesh.html">Mesh</a>&amp; m, <span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a>&amp; tgt_ic,</div>
<div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;               <span class="keyword">const</span> <a class="code" href="structslmm_1_1nearest__point_1_1_mesh_nearest_point_data.html">MeshNearestPointData&lt;ko::HostSpace&gt;</a>&amp; md)</div>
<div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;{</div>
<div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;  <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> nerr = 0;</div>
<div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;  <span class="comment">// If a point is on the perim, then calc should return it as the nearest</span></div>
<div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;  <span class="comment">// point.</span></div>
<div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;  <span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> np_perim = <a class="code" href="namespaceslmm.html#aae47f57e3c25fdbca5ac4c99101905c0">len</a>(md.<a class="code" href="structslmm_1_1nearest__point_1_1_mesh_nearest_point_data.html#ac72796b400d078db1a96e260968ff226">perimp</a>);</div>
<div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> <a class="code" href="namespacebaroclinic__wave.html#a8619f63e6dd6db1077c1a18788afa359">k</a> = 0; <a class="code" href="namespacebaroclinic__wave.html#a8619f63e6dd6db1077c1a18788afa359">k</a> &lt; np_perim; ++<a class="code" href="namespacebaroclinic__wave.html#a8619f63e6dd6db1077c1a18788afa359">k</a>) {</div>
<div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span> <a class="code" href="namespace_homme_1_1_physical_constants.html#af1c6ba44dbdc6bf279635f8ef11b6862">p0</a> = <a class="code" href="namespacesiqk.html#aef983887889243999a1d7ddea864ad1f">slice</a>(m.<a class="code" href="structsiqk_1_1sh_1_1_mesh.html#a09ea9632dd1680a04d53aec55d4b6e4f">p</a>, md.<a class="code" href="structslmm_1_1nearest__point_1_1_mesh_nearest_point_data.html#ac72796b400d078db1a96e260968ff226">perimp</a>(<a class="code" href="namespacebaroclinic__wave.html#a8619f63e6dd6db1077c1a18788afa359">k</a>));</div>
<div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span> p1 = <a class="code" href="namespacesiqk.html#aef983887889243999a1d7ddea864ad1f">slice</a>(m.<a class="code" href="structsiqk_1_1sh_1_1_mesh.html#a09ea9632dd1680a04d53aec55d4b6e4f">p</a>, md.<a class="code" href="structslmm_1_1nearest__point_1_1_mesh_nearest_point_data.html#ac72796b400d078db1a96e260968ff226">perimp</a>((<a class="code" href="namespacebaroclinic__wave.html#a8619f63e6dd6db1077c1a18788afa359">k</a>+1) % np_perim));</div>
<div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span> L = <a class="code" href="namespaceslmm_1_1nearest__point.html#a8df5028268da3dd050d3db963e11780d">calc_dist</a>(<a class="code" href="namespace_homme_1_1_physical_constants.html#af1c6ba44dbdc6bf279635f8ef11b6862">p0</a>, p1);</div>
<div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;    <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a> v[3];</div>
<div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> d = 0; d &lt; 3; ++d) v[d] = <a class="code" href="namespace_homme_1_1_physical_constants.html#af1c6ba44dbdc6bf279635f8ef11b6862">p0</a>[d];</div>
<div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;    <a class="code" href="namespaceslmm_1_1nearest__point.html#ad4423d9ff23bfc563b52a5e68635de6e">calc</a>(m, md, v);</div>
<div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespaceslmm_1_1nearest__point.html#a8df5028268da3dd050d3db963e11780d">calc_dist</a>(<a class="code" href="namespace_homme_1_1_physical_constants.html#af1c6ba44dbdc6bf279635f8ef11b6862">p0</a>, v) &gt; <a class="code" href="namespacedcmip2012__test5.html#a23dbdf598e3e14675594d87b6df56eb3">std::numeric_limits&lt;Real&gt;::epsilon</a>() / L) ++nerr;</div>
<div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;    <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a> on[3];</div>
<div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;    <a class="code" href="structsiqk_1_1_sphere_geometry.html#a96b5477dfa04c756127d8c8a528cec0e">siqk::SphereGeometry::combine</a>(<a class="code" href="namespace_homme_1_1_physical_constants.html#af1c6ba44dbdc6bf279635f8ef11b6862">p0</a>, p1, 0.4, on);</div>
<div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;    <a class="code" href="structsiqk_1_1_sphere_geometry.html#a5d62310dba1533d5822d1e61a2124303">siqk::SphereGeometry::normalize</a>(on);</div>
<div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> d = 0; d &lt; 3; ++d) v[d] = on[d];</div>
<div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;    <a class="code" href="namespaceslmm_1_1nearest__point.html#ad4423d9ff23bfc563b52a5e68635de6e">calc</a>(m, md, v);</div>
<div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespaceslmm_1_1nearest__point.html#a8df5028268da3dd050d3db963e11780d">calc_dist</a>(on, v) &gt; 1e2*<a class="code" href="namespacedcmip2012__test5.html#a23dbdf598e3e14675594d87b6df56eb3">std::numeric_limits&lt;Real&gt;::epsilon</a>() / L) ++nerr;</div>
<div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;  }</div>
<div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;  <span class="keywordflow">return</span> nerr;</div>
<div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;}</div>
<div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160; </div>
<div class="line"><a name="l01790"></a><span class="lineno"><a class="line" href="namespaceslmm_1_1nearest__point.html#a51823a25c8ab8941ce41bb0d8f659047"> 1790</a></span>&#160;<a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> <a class="code" href="namespaceslmm_1_1nearest__point.html#a51823a25c8ab8941ce41bb0d8f659047">test_fill_perim</a> (<span class="keyword">const</span> <a class="code" href="structsiqk_1_1sh_1_1_mesh.html">Mesh</a>&amp; m, <span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a>&amp; tgt_ic,</div>
<div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;                     <span class="keyword">const</span> <a class="code" href="structslmm_1_1nearest__point_1_1_mesh_nearest_point_data.html">MeshNearestPointData&lt;ko::HostSpace&gt;</a>&amp; md) {</div>
<div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;  <span class="keyword">using</span> geo = <a class="code" href="structsiqk_1_1_sphere_geometry.html">siqk::SphereGeometry</a>;</div>
<div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;  <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> nerr = 0;</div>
<div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;  <span class="keyword">const</span> <span class="keyword">auto</span> tgt_cell = <a class="code" href="namespacesiqk.html#aef983887889243999a1d7ddea864ad1f">slice</a>(m.<a class="code" href="structsiqk_1_1sh_1_1_mesh.html#a3e86d388497c2a559b87e401a1235e87">e</a>, tgt_ic);</div>
<div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;  <span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> np_perim = <a class="code" href="namespaceslmm.html#aae47f57e3c25fdbca5ac4c99101905c0">len</a>(md.<a class="code" href="structslmm_1_1nearest__point_1_1_mesh_nearest_point_data.html#ac72796b400d078db1a96e260968ff226">perimp</a>);</div>
<div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;  { <span class="comment">// Check that no target-cell point is on the perim.</span></div>
<div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;    <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> on = 0;</div>
<div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> ip = 0; ip &lt; 4; ++ip) {</div>
<div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;      <span class="keyword">const</span> <span class="keyword">auto</span> p = <a class="code" href="namespacesiqk.html#aef983887889243999a1d7ddea864ad1f">slice</a>(m.<a class="code" href="structsiqk_1_1sh_1_1_mesh.html#a09ea9632dd1680a04d53aec55d4b6e4f">p</a>, tgt_cell[ip]);</div>
<div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> <a class="code" href="namespacebaroclinic__wave.html#a8619f63e6dd6db1077c1a18788afa359">k</a> = 0; <a class="code" href="namespacebaroclinic__wave.html#a8619f63e6dd6db1077c1a18788afa359">k</a> &lt; np_perim; ++<a class="code" href="namespacebaroclinic__wave.html#a8619f63e6dd6db1077c1a18788afa359">k</a>) {</div>
<div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;        <span class="keyword">const</span> <span class="keyword">auto</span> perim = <a class="code" href="namespacesiqk.html#aef983887889243999a1d7ddea864ad1f">slice</a>(m.<a class="code" href="structsiqk_1_1sh_1_1_mesh.html#a09ea9632dd1680a04d53aec55d4b6e4f">p</a>, md.<a class="code" href="structslmm_1_1nearest__point_1_1_mesh_nearest_point_data.html#ac72796b400d078db1a96e260968ff226">perimp</a>(<a class="code" href="namespacebaroclinic__wave.html#a8619f63e6dd6db1077c1a18788afa359">k</a>));</div>
<div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;        <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a> diff = 0;</div>
<div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> i = 0; i &lt; 3; ++i) diff += std::abs(p[i] - perim[i]);</div>
<div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;        <span class="keywordflow">if</span> (diff == 0) ++on;</div>
<div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;      }</div>
<div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;    }</div>
<div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;    <span class="keywordflow">if</span> (on &gt; 0) ++nerr;</div>
<div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;  }</div>
<div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;  { <span class="comment">// Check that adjacent perimeter points agree with the edge&#39;s normal.</span></div>
<div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> <a class="code" href="namespacebaroclinic__wave.html#a8619f63e6dd6db1077c1a18788afa359">k</a> = 0; <a class="code" href="namespacebaroclinic__wave.html#a8619f63e6dd6db1077c1a18788afa359">k</a> &lt; np_perim; ++<a class="code" href="namespacebaroclinic__wave.html#a8619f63e6dd6db1077c1a18788afa359">k</a>) {</div>
<div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;      <span class="keyword">const</span> <span class="keyword">auto</span> <a class="code" href="namespace_homme_1_1_physical_constants.html#af1c6ba44dbdc6bf279635f8ef11b6862">p0</a> = <a class="code" href="namespacesiqk.html#aef983887889243999a1d7ddea864ad1f">slice</a>(m.<a class="code" href="structsiqk_1_1sh_1_1_mesh.html#a09ea9632dd1680a04d53aec55d4b6e4f">p</a>, md.<a class="code" href="structslmm_1_1nearest__point_1_1_mesh_nearest_point_data.html#ac72796b400d078db1a96e260968ff226">perimp</a>(<a class="code" href="namespacebaroclinic__wave.html#a8619f63e6dd6db1077c1a18788afa359">k</a>));</div>
<div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;      <span class="keyword">const</span> <span class="keyword">auto</span> p1 = <a class="code" href="namespacesiqk.html#aef983887889243999a1d7ddea864ad1f">slice</a>(m.<a class="code" href="structsiqk_1_1sh_1_1_mesh.html#a09ea9632dd1680a04d53aec55d4b6e4f">p</a>, md.<a class="code" href="structslmm_1_1nearest__point_1_1_mesh_nearest_point_data.html#ac72796b400d078db1a96e260968ff226">perimp</a>((<a class="code" href="namespacebaroclinic__wave.html#a8619f63e6dd6db1077c1a18788afa359">k</a>+1) % np_perim));</div>
<div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;      <span class="keyword">const</span> <span class="keyword">auto</span> nml = <a class="code" href="namespacesiqk.html#aef983887889243999a1d7ddea864ad1f">slice</a>(m.<a class="code" href="structsiqk_1_1sh_1_1_mesh.html#a08b7acf03ca69f64736bda8060053539">nml</a>, md.<a class="code" href="structslmm_1_1nearest__point_1_1_mesh_nearest_point_data.html#a960ab7dce344a0638cc7916beb860e17">perimnml</a>(<a class="code" href="namespacebaroclinic__wave.html#a8619f63e6dd6db1077c1a18788afa359">k</a>));</div>
<div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;      <span class="keyword">const</span> <span class="keyword">auto</span> dot = geo::dot_c_amb(nml, p1, <a class="code" href="namespace_homme_1_1_physical_constants.html#af1c6ba44dbdc6bf279635f8ef11b6862">p0</a>);</div>
<div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;      <span class="keyword">const</span> <span class="keyword">auto</span> L = <a class="code" href="namespaceslmm_1_1nearest__point.html#a8df5028268da3dd050d3db963e11780d">calc_dist</a>(<a class="code" href="namespace_homme_1_1_physical_constants.html#af1c6ba44dbdc6bf279635f8ef11b6862">p0</a>, p1);</div>
<div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;      <span class="comment">// Normal orthogonal to edge?</span></div>
<div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;      <span class="keywordflow">if</span> (std::abs(dot) &gt; 1e2*<a class="code" href="namespacedcmip2012__test5.html#a23dbdf598e3e14675594d87b6df56eb3">std::numeric_limits&lt;Real&gt;::epsilon</a>()/L) ++nerr;</div>
<div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;      <span class="comment">// Oriented inwards?</span></div>
<div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;      <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a> outward[3];</div>
<div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;      geo::cross(p1, <a class="code" href="namespace_homme_1_1_physical_constants.html#af1c6ba44dbdc6bf279635f8ef11b6862">p0</a>, outward);</div>
<div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;      <span class="keywordflow">if</span> (geo::dot(nml, outward) &gt;= 0) ++nerr;</div>
<div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;    }</div>
<div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;  }</div>
<div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;  <span class="keywordflow">return</span> nerr;</div>
<div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;}</div>
<div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;} <span class="comment">// namespace nearest_point</span></div>
<div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160; </div>
<div class="line"><a name="l01828"></a><span class="lineno"><a class="line" href="namespaceslmm.html#ac44161582202202a4c59397831ab8cc2"> 1828</a></span>&#160;<span class="keyword">typedef</span> <a class="code" href="structslmm_1_1nearest__point_1_1_mesh_nearest_point_data.html">nearest_point::MeshNearestPointData&lt;ko::HostSpace&gt;</a> <a class="code" href="namespaceslmm.html#ac44161582202202a4c59397831ab8cc2">MeshNearestPointData</a>;</div>
<div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160; </div>
<div class="line"><a name="l01830"></a><span class="lineno"><a class="line" href="namespaceslmm.html#a3158888774efd0768378cbf65b50e923"> 1830</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespaceslmm.html#a3158888774efd0768378cbf65b50e923">init_nearest_point_data</a> (<span class="keyword">const</span> <a class="code" href="structsiqk_1_1sh_1_1_mesh.html">nearest_point::Mesh</a>&amp; m,</div>
<div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;                              <a class="code" href="structslmm_1_1nearest__point_1_1_mesh_nearest_point_data.html">MeshNearestPointData</a>&amp; d) {</div>
<div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;  <a class="code" href="namespaceslmm_1_1nearest__point.html#a11b8bb5966e37004487b1867b4f761b5">nearest_point::fill_perim</a>(m, d);</div>
<div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;}</div>
<div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160; </div>
<div class="line"><a name="l01835"></a><span class="lineno"><a class="line" href="namespaceslmm.html#aa3b5eab9cd0be884ffa31f0f38300fd4"> 1835</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="namespaceslmm.html#aa3b5eab9cd0be884ffa31f0f38300fd4">get_nearest_point</a> (<span class="keyword">const</span> <a class="code" href="structsiqk_1_1sh_1_1_mesh.html">nearest_point::Mesh</a>&amp; m, <span class="keyword">const</span> <a class="code" href="structslmm_1_1nearest__point_1_1_mesh_nearest_point_data.html">MeshNearestPointData</a>&amp; d,</div>
<div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;                       <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a>* v, <span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> my_ic) {</div>
<div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;  <a class="code" href="namespaceslmm_1_1nearest__point.html#ad4423d9ff23bfc563b52a5e68635de6e">nearest_point::calc</a>(m, d, v);</div>
<div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespaceslmm.html#a09c707719e4082afb80a56b15c2db8ac">get_src_cell</a>(m, v, my_ic);</div>
<div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;}</div>
<div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160; </div>
<div class="line"><a name="l01841"></a><span class="lineno"><a class="line" href="namespaceslmm.html#a4620e67f831066bf4a72e568116e3f20"> 1841</a></span>&#160;<a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> <a class="code" href="namespaceslmm.html#a7a1095b904c8047101a58045c12f867c">unittest</a> (<span class="keyword">const</span> <a class="code" href="structsiqk_1_1sh_1_1_mesh.html">nearest_point::Mesh</a>&amp; m, <span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> tgt_elem) {</div>
<div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;  <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> nerr = 0, <a class="code" href="namespacedimensions__mod.html#af137394c40531d5d6f0daa64351372e7">ne</a> = 0;</div>
<div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;  <span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> nc = <a class="code" href="namespaceslmm.html#aae47f57e3c25fdbca5ac4c99101905c0">len</a>(m.<a class="code" href="structsiqk_1_1sh_1_1_mesh.html#a3e86d388497c2a559b87e401a1235e87">e</a>);</div>
<div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> ic = 0; ic &lt; nc; ++ic) {</div>
<div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span> cell = <a class="code" href="namespacesiqk.html#aef983887889243999a1d7ddea864ad1f">slice</a>(m.<a class="code" href="structsiqk_1_1sh_1_1_mesh.html#a3e86d388497c2a559b87e401a1235e87">e</a>, ic);</div>
<div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;    <span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a> alphas[] = { 0.01, 0.99, 0, 1 };</div>
<div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;    <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span> nalphas = <span class="keyword">sizeof</span>(alphas)/<span class="keyword">sizeof</span>(*alphas);</div>
<div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> i = 0; i &lt; nalphas; ++i)</div>
<div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> j = 0; j &lt; nalphas; ++j) {</div>
<div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;        <span class="keyword">const</span> <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a> <a class="code" href="namespacejw.html#acf663523b96ec023200fa8a0f58209f8">a</a> = alphas[i], oma = 1-<a class="code" href="namespacejw.html#acf663523b96ec023200fa8a0f58209f8">a</a>, <a class="code" href="namespacebaroclinic__wave.html#acf8e56bd7dfdfd2c39e16dfa491a5293">b</a> = alphas[j], omb = 1-<a class="code" href="namespacebaroclinic__wave.html#acf8e56bd7dfdfd2c39e16dfa491a5293">b</a>;</div>
<div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;        <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a> v[3] = {0};</div>
<div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> d = 0; d &lt; 3; ++d)</div>
<div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;          v[d] = (  <a class="code" href="namespacebaroclinic__wave.html#acf8e56bd7dfdfd2c39e16dfa491a5293">b</a>*(<a class="code" href="namespacejw.html#acf663523b96ec023200fa8a0f58209f8">a</a>*m.<a class="code" href="structsiqk_1_1sh_1_1_mesh.html#a09ea9632dd1680a04d53aec55d4b6e4f">p</a>(cell[0], d) + oma*m.<a class="code" href="structsiqk_1_1sh_1_1_mesh.html#a09ea9632dd1680a04d53aec55d4b6e4f">p</a>(cell[1], d)) + </div>
<div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;                  omb*(<a class="code" href="namespacejw.html#acf663523b96ec023200fa8a0f58209f8">a</a>*m.<a class="code" href="structsiqk_1_1sh_1_1_mesh.html#a09ea9632dd1680a04d53aec55d4b6e4f">p</a>(cell[3], d) + oma*m.<a class="code" href="structsiqk_1_1sh_1_1_mesh.html#a09ea9632dd1680a04d53aec55d4b6e4f">p</a>(cell[2], d)));</div>
<div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;        <span class="keywordflow">if</span> (i &lt; 2 &amp;&amp; j &lt; 2) {</div>
<div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="namespaceslmm.html#a09c707719e4082afb80a56b15c2db8ac">get_src_cell</a>(m, v, tgt_elem) != ic) ++<a class="code" href="namespacedimensions__mod.html#af137394c40531d5d6f0daa64351372e7">ne</a>;</div>
<div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="namespaceslmm.html#a09c707719e4082afb80a56b15c2db8ac">get_src_cell</a>(m, v, tgt_elem) == -1) ++<a class="code" href="namespacedimensions__mod.html#af137394c40531d5d6f0daa64351372e7">ne</a>;</div>
<div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;        }</div>
<div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;      }</div>
<div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;  }</div>
<div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacedimensions__mod.html#af137394c40531d5d6f0daa64351372e7">ne</a>) <a class="code" href="compose__slmm_8cpp.html#a62f071f9019b2263ed76a35f753af003">pr</a>(<span class="stringliteral">&quot;slmm::unittest: get_src_cell failed&quot;</span>);</div>
<div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;  nerr += <a class="code" href="namespacedimensions__mod.html#af137394c40531d5d6f0daa64351372e7">ne</a>;</div>
<div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;  <a class="code" href="namespacedimensions__mod.html#af137394c40531d5d6f0daa64351372e7">ne</a> = <a class="code" href="namespaceslmm_1_1nearest__point.html#ae5d25f37a8bc726da32ca0557f53115e">nearest_point::test_canpoa</a>();</div>
<div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;  nerr += <a class="code" href="namespacedimensions__mod.html#af137394c40531d5d6f0daa64351372e7">ne</a>;</div>
<div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacedimensions__mod.html#af137394c40531d5d6f0daa64351372e7">ne</a>) <a class="code" href="compose__slmm_8cpp.html#a62f071f9019b2263ed76a35f753af003">pr</a>(<span class="stringliteral">&quot;slmm::unittest: test_canpoa failed&quot;</span>);</div>
<div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;  {</div>
<div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;    <a class="code" href="structslmm_1_1nearest__point_1_1_mesh_nearest_point_data.html">MeshNearestPointData</a> d;</div>
<div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;    <a class="code" href="namespaceslmm.html#a3158888774efd0768378cbf65b50e923">init_nearest_point_data</a>(m, d);</div>
<div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;    <a class="code" href="namespacedimensions__mod.html#af137394c40531d5d6f0daa64351372e7">ne</a> = <a class="code" href="namespaceslmm_1_1nearest__point.html#a51823a25c8ab8941ce41bb0d8f659047">nearest_point::test_fill_perim</a>(m, tgt_elem, d);</div>
<div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacedimensions__mod.html#af137394c40531d5d6f0daa64351372e7">ne</a>) <a class="code" href="compose__slmm_8cpp.html#a62f071f9019b2263ed76a35f753af003">pr</a>(<span class="stringliteral">&quot;slmm::unittest: test_fill_perim failed&quot;</span>);</div>
<div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;    nerr += <a class="code" href="namespacedimensions__mod.html#af137394c40531d5d6f0daa64351372e7">ne</a>;</div>
<div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;    <a class="code" href="namespacedimensions__mod.html#af137394c40531d5d6f0daa64351372e7">ne</a> = <a class="code" href="namespaceslmm_1_1nearest__point.html#ae742c9deb75c67768851067d200f7441">nearest_point::test_calc</a>(m, tgt_elem, d);</div>
<div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacedimensions__mod.html#af137394c40531d5d6f0daa64351372e7">ne</a>) <a class="code" href="compose__slmm_8cpp.html#a62f071f9019b2263ed76a35f753af003">pr</a>(<span class="stringliteral">&quot;slmm::unittest: test_calc failed&quot;</span>);</div>
<div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;    nerr += <a class="code" href="namespacedimensions__mod.html#af137394c40531d5d6f0daa64351372e7">ne</a>;</div>
<div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;  }</div>
<div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;  <span class="keywordflow">return</span> nerr;</div>
<div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;}</div>
<div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160; </div>
<div class="line"><a name="l01880"></a><span class="lineno"><a class="line" href="namespaceslmm.html#a410e5c4c97a57814b75c6a9b4583ced2"> 1880</a></span>&#160;<span class="keyword">typedef</span> Kokkos::View&lt;Int*, ko::HostSpace&gt; <a class="code" href="namespaceslmm.html#a410e5c4c97a57814b75c6a9b4583ced2">Ints</a>;</div>
<div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160; </div>
<div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;<span class="comment">//TODO We might switch to one </span></div>
<div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;<span class="comment">// Local mesh patch centered on the target element.</span></div>
<div class="line"><a name="l01884"></a><span class="lineno"><a class="line" href="structslmm_1_1_local_mesh.html"> 1884</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structslmm_1_1_local_mesh.html">LocalMesh</a> : <span class="keyword">public</span> <a class="code" href="structsiqk_1_1sh_1_1_mesh.html">siqk::sh::Mesh</a>&lt;ko::HostSpace&gt; {</div>
<div class="line"><a name="l01885"></a><span class="lineno"><a class="line" href="structslmm_1_1_local_mesh.html#ac076fa9e10662f4d1e3dd776f3a11695"> 1885</a></span>&#160;  <span class="keyword">typedef</span> <a class="code" href="structsiqk_1_1sh_1_1_mesh.html">siqk::sh::Mesh&lt;ko::HostSpace&gt;</a> <a class="code" href="structslmm_1_1_local_mesh.html#ac076fa9e10662f4d1e3dd776f3a11695">Super</a>;</div>
<div class="line"><a name="l01886"></a><span class="lineno"><a class="line" href="structslmm_1_1_local_mesh.html#a31bfa049e11148a3474fc90b8c7303a6"> 1886</a></span>&#160;  <span class="keyword">typedef</span> <span class="keyword">typename</span> <a class="code" href="structsiqk_1_1sh_1_1_mesh.html#a1ebc900d7142e767c6b27925916fc917">Super::IntArray</a> <a class="code" href="structslmm_1_1_local_mesh.html#a31bfa049e11148a3474fc90b8c7303a6">IntArray</a>;</div>
<div class="line"><a name="l01887"></a><span class="lineno"><a class="line" href="structslmm_1_1_local_mesh.html#ad312495f9adc29acc50c47b1ab281447"> 1887</a></span>&#160;  <span class="keyword">typedef</span> <span class="keyword">typename</span> <a class="code" href="structsiqk_1_1sh_1_1_mesh.html#abb2b255c79d852e853cdc9ab6ffc092f">Super::RealArray</a> <a class="code" href="structslmm_1_1_local_mesh.html#ad312495f9adc29acc50c47b1ab281447">RealArray</a>;</div>
<div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160; </div>
<div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;  <span class="comment">// tgt_elem is the index of the target element in this mesh.</span></div>
<div class="line"><a name="l01890"></a><span class="lineno"><a class="line" href="structslmm_1_1_local_mesh.html#a84bbd39af98680d8f3441c37db94faa2"> 1890</a></span>&#160;  <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> <a class="code" href="structslmm_1_1_local_mesh.html#a84bbd39af98680d8f3441c37db94faa2">tgt_elem</a>;</div>
<div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;};</div>
<div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160; </div>
<div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;<span class="comment">// Wrap call to siqk::sqr::calc_sphere_to_ref. That impl supports only</span></div>
<div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;<span class="comment">// cubed_sphere_map=2, and we want to keep it that way. This wrapper supports,</span></div>
<div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;<span class="comment">// in addition, cubed_sphere_map=0.</span></div>
<div class="line"><a name="l01896"></a><span class="lineno"><a class="line" href="structslmm_1_1_sphere_to_ref.html"> 1896</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structslmm_1_1_sphere_to_ref.html">SphereToRef</a> {</div>
<div class="line"><a name="l01897"></a><span class="lineno"><a class="line" href="structslmm_1_1_sphere_to_ref.html#a6a0b6d9c7df0e737dcc7c458533e6620"> 1897</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="structslmm_1_1_sphere_to_ref.html#a6a0b6d9c7df0e737dcc7c458533e6620">init</a> (<span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> <a class="code" href="namespacecontrol__mod.html#aff62de0026bd6ea7c244564a9cbf1c03">cubed_sphere_map</a>, <span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> nelem_global,</div>
<div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;             <span class="keyword">const</span> Ints::const_type&amp; lid2facenum) {</div>
<div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;    cubed_sphere_map_ = <a class="code" href="namespacecontrol__mod.html#aff62de0026bd6ea7c244564a9cbf1c03">cubed_sphere_map</a>;</div>
<div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;    ne_ = <span class="keyword">static_cast&lt;</span><a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a><span class="keyword">&gt;</span>(std::round(std::sqrt((nelem_global / 6))));</div>
<div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;    <a class="code" href="compose__slmm_8cpp.html#a7290a1aabe779e162c8d6a36b3abec04">slmm_throw_if</a>( ! (cubed_sphere_map_ != 0 || 6*ne_*ne_ == nelem_global),</div>
<div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;                  <span class="stringliteral">&quot;If cubed_sphere_map = 0, then the mesh must be a &quot;</span></div>
<div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;                  <span class="stringliteral">&quot;regular cubed-sphere.&quot;</span>);</div>
<div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;    lid2facenum_ = lid2facenum;</div>
<div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;  }</div>
<div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160; </div>
<div class="line"><a name="l01907"></a><span class="lineno"><a class="line" href="structslmm_1_1_sphere_to_ref.html#a617fc3725ecbe170be737594d8928138"> 1907</a></span>&#160;  <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a> <a class="code" href="structslmm_1_1_sphere_to_ref.html#a617fc3725ecbe170be737594d8928138">tol</a> ()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;    <span class="keywordflow">return</span> 1e3 * ne_ * <a class="code" href="namespacedcmip2012__test5.html#a23dbdf598e3e14675594d87b6df56eb3">std::numeric_limits&lt;Real&gt;::epsilon</a>();</div>
<div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;  }</div>
<div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160; </div>
<div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;  <span class="comment">// See siqk::sqr::calc_sphere_to_ref for docs.</span></div>
<div class="line"><a name="l01912"></a><span class="lineno"><a class="line" href="structslmm_1_1_sphere_to_ref.html#aaad555824cc81462aa94165d11702bc9"> 1912</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="structslmm_1_1_sphere_to_ref.html#aaad555824cc81462aa94165d11702bc9">calc_sphere_to_ref</a> (</div>
<div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;    <span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a>&amp; ie, <span class="keyword">const</span> <a class="code" href="structslmm_1_1_local_mesh.html">LocalMesh</a>&amp; m,</div>
<div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;    <span class="keyword">const</span> <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a> q[3],</div>
<div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;    <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a>&amp; <a class="code" href="namespacejw.html#acf663523b96ec023200fa8a0f58209f8">a</a>, <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a>&amp; <a class="code" href="namespacebaroclinic__wave.html#acf8e56bd7dfdfd2c39e16dfa491a5293">b</a>,</div>
<div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;    <a class="code" href="structsiqk_1_1sqr_1_1_info.html">siqk::sqr::Info</a>* <span class="keyword">const</span> info = <span class="keyword">nullptr</span>,</div>
<div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;    <span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> max_its = 10,</div>
<div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;    <span class="keyword">const</span> <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a> <a class="code" href="structslmm_1_1_sphere_to_ref.html#a617fc3725ecbe170be737594d8928138">tol</a> = 1e2*<a class="code" href="namespacedcmip2012__test5.html#a23dbdf598e3e14675594d87b6df56eb3">std::numeric_limits&lt;Real&gt;::epsilon</a>())<span class="keyword"> const</span></div>
<div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;    <span class="keywordflow">if</span> (cubed_sphere_map_ == 2)</div>
<div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;      <a class="code" href="namespacesiqk_1_1sqr.html#a257faae633641a8c200b1213b5d81a1e">siqk::sqr::calc_sphere_to_ref</a>(m.<a class="code" href="structsiqk_1_1sh_1_1_mesh.html#a09ea9632dd1680a04d53aec55d4b6e4f">p</a>, <a class="code" href="namespacesiqk.html#aef983887889243999a1d7ddea864ad1f">slice</a>(m.<a class="code" href="structsiqk_1_1sh_1_1_mesh.html#a3e86d388497c2a559b87e401a1235e87">e</a>, m.<a class="code" href="structslmm_1_1_local_mesh.html#a84bbd39af98680d8f3441c37db94faa2">tgt_elem</a>), q, <a class="code" href="namespacejw.html#acf663523b96ec023200fa8a0f58209f8">a</a>, <a class="code" href="namespacebaroclinic__wave.html#acf8e56bd7dfdfd2c39e16dfa491a5293">b</a>,</div>
<div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;                                    info, max_its, <a class="code" href="structslmm_1_1_sphere_to_ref.html#a617fc3725ecbe170be737594d8928138">tol</a>);</div>
<div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;      <span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> face = lid2facenum_(ie); <span class="comment">//assume: ie corresponds to m.tgt_elem.</span></div>
<div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;      map_sphere_coord_to_face_coord(face-1, q[0], q[1], q[2], <a class="code" href="namespacejw.html#acf663523b96ec023200fa8a0f58209f8">a</a>, <a class="code" href="namespacebaroclinic__wave.html#acf8e56bd7dfdfd2c39e16dfa491a5293">b</a>);</div>
<div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;      <a class="code" href="namespacejw.html#acf663523b96ec023200fa8a0f58209f8">a</a> = map_face_coord_to_cell_ref_coord(<a class="code" href="namespacejw.html#acf663523b96ec023200fa8a0f58209f8">a</a>);</div>
<div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;      <a class="code" href="namespacebaroclinic__wave.html#acf8e56bd7dfdfd2c39e16dfa491a5293">b</a> = map_face_coord_to_cell_ref_coord(<a class="code" href="namespacebaroclinic__wave.html#acf8e56bd7dfdfd2c39e16dfa491a5293">b</a>);</div>
<div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;      <span class="keywordflow">if</span> (info) { info-&gt;success = <span class="keyword">true</span>; info-&gt;n_iterations = 1; }</div>
<div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;    }</div>
<div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;  }</div>
<div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160; </div>
<div class="line"><a name="l01932"></a><span class="lineno"><a class="line" href="structslmm_1_1_sphere_to_ref.html#aad9870de578831b4c97c7a1d9916533c"> 1932</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="structslmm_1_1_sphere_to_ref.html#aad9870de578831b4c97c7a1d9916533c">check</a> (<span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a>&amp; ie, <span class="keyword">const</span> <a class="code" href="structslmm_1_1_local_mesh.html">LocalMesh</a>&amp; m)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;    <span class="keywordflow">if</span> (cubed_sphere_map_ != 0) <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;    <span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> face = lid2facenum_(ie); <span class="comment">//assume: ie corresponds to m.tgt_elem.</span></div>
<div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;    <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a> cent[3] = {0};</div>
<div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span> cell = <a class="code" href="namespacesiqk.html#aef983887889243999a1d7ddea864ad1f">slice</a>(m.<a class="code" href="structsiqk_1_1sh_1_1_mesh.html#a3e86d388497c2a559b87e401a1235e87">e</a>, m.<a class="code" href="structslmm_1_1_local_mesh.html#a84bbd39af98680d8f3441c37db94faa2">tgt_elem</a>);</div>
<div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 4; ++i)</div>
<div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> d = 0; d &lt; 3; ++d)</div>
<div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;        cent[d] += 0.25*m.<a class="code" href="structsiqk_1_1sh_1_1_mesh.html#a09ea9632dd1680a04d53aec55d4b6e4f">p</a>(cell[i], d);</div>
<div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;    <span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> cf = get_cube_face_idx(cent[0], cent[1], cent[2]) + 1;</div>
<div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;    <span class="keywordflow">return</span> face == cf;</div>
<div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;  }</div>
<div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160; </div>
<div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;<span class="keyword">private</span>:</div>
<div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;  <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> ne_, cubed_sphere_map_;</div>
<div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;  Ints::const_type lid2facenum_;</div>
<div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160; </div>
<div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;  <span class="comment">// Follow the description given in</span></div>
<div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;  <span class="comment">//     coordinate_systems_mod::unit_face_based_cube_to_unit_sphere.</span></div>
<div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;  <span class="keyword">static</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> get_cube_face_idx (<span class="keyword">const</span> <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a>&amp; <a class="code" href="namespacesupercell.html#ae57ef03dc0cb9828dbacc89aac8870c0">x</a>, <span class="keyword">const</span> <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a>&amp; y, <span class="keyword">const</span> <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a>&amp; z) {</div>
<div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;    <span class="keyword">const</span> <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a> ax = std::abs(<a class="code" href="namespacesupercell.html#ae57ef03dc0cb9828dbacc89aac8870c0">x</a>), ay = std::abs(y), az = std::abs(z);</div>
<div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;    <span class="keywordflow">if</span> (ax &gt;= ay) {</div>
<div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;      <span class="keywordflow">if</span> (ax &gt;= az) <span class="keywordflow">return</span> <a class="code" href="namespacesupercell.html#ae57ef03dc0cb9828dbacc89aac8870c0">x</a> &gt; 0 ? 0 : 2;</div>
<div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">return</span> z &gt; 0 ? 5 : 4;</div>
<div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;      <span class="keywordflow">if</span> (ay &gt;= az) <span class="keywordflow">return</span> y &gt; 0 ? 1 : 3;</div>
<div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">return</span> z &gt; 0 ? 5 : 4;</div>
<div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;    }</div>
<div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;  }</div>
<div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160; </div>
<div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;  <span class="keyword">static</span> <span class="keywordtype">void</span> map_sphere_coord_to_face_coord (</div>
<div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;    <span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a>&amp; face_idx, <span class="keyword">const</span> <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a>&amp; <a class="code" href="namespacesupercell.html#ae57ef03dc0cb9828dbacc89aac8870c0">x</a>, <span class="keyword">const</span> <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a>&amp; y, <span class="keyword">const</span> <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a>&amp; z,</div>
<div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;    <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a>&amp; fx, <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a>&amp; fy)</div>
<div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;  {</div>
<div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;    <span class="keyword">static</span> constexpr <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a> theta_max = 0.25*M_PI;</div>
<div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;    <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a> d;</div>
<div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;    <span class="keywordflow">switch</span> (face_idx) {</div>
<div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;    <span class="keywordflow">case</span>  0: d = std::abs(<a class="code" href="namespacesupercell.html#ae57ef03dc0cb9828dbacc89aac8870c0">x</a>); fx =  y/d; fy =  z/d; <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;    <span class="keywordflow">case</span>  1: d = std::abs(y); fx = -<a class="code" href="namespacesupercell.html#ae57ef03dc0cb9828dbacc89aac8870c0">x</a>/d; fy =  z/d; <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;    <span class="keywordflow">case</span>  2: d = std::abs(<a class="code" href="namespacesupercell.html#ae57ef03dc0cb9828dbacc89aac8870c0">x</a>); fx = -y/d; fy =  z/d; <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;    <span class="keywordflow">case</span>  3: d = std::abs(y); fx =  <a class="code" href="namespacesupercell.html#ae57ef03dc0cb9828dbacc89aac8870c0">x</a>/d; fy =  z/d; <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;    <span class="keywordflow">case</span>  4: d = std::abs(z); fx =  y/d; fy =  <a class="code" href="namespacesupercell.html#ae57ef03dc0cb9828dbacc89aac8870c0">x</a>/d; <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;    <span class="keywordflow">default</span>: d = std::abs(z); fx =  y/d; fy = -<a class="code" href="namespacesupercell.html#ae57ef03dc0cb9828dbacc89aac8870c0">x</a>/d;</div>
<div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;    }</div>
<div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;    fx = std::atan(fx) / theta_max;</div>
<div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;    fy = std::atan(fy) / theta_max;</div>
<div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;  }</div>
<div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160; </div>
<div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;  <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a> map_face_coord_to_cell_ref_coord (<a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a> <a class="code" href="namespacejw.html#acf663523b96ec023200fa8a0f58209f8">a</a>)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;    <a class="code" href="namespacejw.html#acf663523b96ec023200fa8a0f58209f8">a</a> = (0.5*(1 + <a class="code" href="namespacejw.html#acf663523b96ec023200fa8a0f58209f8">a</a>))*ne_;</div>
<div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;    <a class="code" href="namespacejw.html#acf663523b96ec023200fa8a0f58209f8">a</a> = 2*(<a class="code" href="namespacejw.html#acf663523b96ec023200fa8a0f58209f8">a</a> - std::floor(<a class="code" href="namespacejw.html#acf663523b96ec023200fa8a0f58209f8">a</a>)) - 1;</div>
<div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacejw.html#acf663523b96ec023200fa8a0f58209f8">a</a>;</div>
<div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;  }</div>
<div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;};</div>
<div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160; </div>
<div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;<span class="comment">// Advecter has purely mesh-local knowledge, with once exception noted below.</span></div>
<div class="line"><a name="l01987"></a><span class="lineno"><a class="line" href="structslmm_1_1_advecter.html"> 1987</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structslmm_1_1_advecter.html">Advecter</a> {</div>
<div class="line"><a name="l01988"></a><span class="lineno"><a class="line" href="structslmm_1_1_advecter.html#a6aee13815de2f218c92599d2e145f7f9"> 1988</a></span>&#160;  <span class="keyword">typedef</span> std::shared_ptr&lt;Advecter&gt; <a class="code" href="structslmm_1_1_advecter.html#a6aee13815de2f218c92599d2e145f7f9">Ptr</a>;</div>
<div class="line"><a name="l01989"></a><span class="lineno"><a class="line" href="structslmm_1_1_advecter.html#a14d43ce08c47ea1df937dc1703d195f3"> 1989</a></span>&#160;  <span class="keyword">typedef</span> std::shared_ptr&lt;const Advecter&gt; <a class="code" href="structslmm_1_1_advecter.html#a14d43ce08c47ea1df937dc1703d195f3">ConstPtr</a>;</div>
<div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160; </div>
<div class="line"><a name="l01991"></a><span class="lineno"><a class="line" href="structslmm_1_1_advecter_1_1_alg.html"> 1991</a></span>&#160;  <span class="keyword">struct </span><a class="code" href="structslmm_1_1_advecter_1_1_alg.html">Alg</a> {</div>
<div class="line"><a name="l01992"></a><span class="lineno"><a class="line" href="structslmm_1_1_advecter_1_1_alg.html#a8d25733af0135add595ca9429d96ae15"> 1992</a></span>&#160;    <span class="keyword">enum</span> <a class="code" href="structslmm_1_1_advecter_1_1_alg.html#a8d25733af0135add595ca9429d96ae15">Enum</a> {</div>
<div class="line"><a name="l01993"></a><span class="lineno"><a class="line" href="structslmm_1_1_advecter_1_1_alg.html#a8d25733af0135add595ca9429d96ae15a58d3371520961c730ed3d792dd6ef208"> 1993</a></span>&#160;      <a class="code" href="structslmm_1_1_advecter_1_1_alg.html#a8d25733af0135add595ca9429d96ae15a58d3371520961c730ed3d792dd6ef208">jct</a>,             <span class="comment">// Cell-integrated Jacobian-combined transport.</span></div>
<div class="line"><a name="l01994"></a><span class="lineno"><a class="line" href="structslmm_1_1_advecter_1_1_alg.html#a8d25733af0135add595ca9429d96ae15a10bd2bf4e2e9889c0eb5f8c08a26489d"> 1994</a></span>&#160;      <a class="code" href="structslmm_1_1_advecter_1_1_alg.html#a8d25733af0135add595ca9429d96ae15a10bd2bf4e2e9889c0eb5f8c08a26489d">qos</a>,             <span class="comment">// Cell-integrated quadrature-on-sphere transport.</span></div>
<div class="line"><a name="l01995"></a><span class="lineno"><a class="line" href="structslmm_1_1_advecter_1_1_alg.html#a8d25733af0135add595ca9429d96ae15a04aca1177ddd519ab399ffe663fe5cbb"> 1995</a></span>&#160;      <a class="code" href="structslmm_1_1_advecter_1_1_alg.html#a8d25733af0135add595ca9429d96ae15a04aca1177ddd519ab399ffe663fe5cbb">csl_gll</a>,         <span class="comment">// Intended to mimic original Fortran CSL.</span></div>
<div class="line"><a name="l01996"></a><span class="lineno"><a class="line" href="structslmm_1_1_advecter_1_1_alg.html#a8d25733af0135add595ca9429d96ae15a4b92e82dd683b8e5e36401c4c417320c"> 1996</a></span>&#160;      <a class="code" href="structslmm_1_1_advecter_1_1_alg.html#a8d25733af0135add595ca9429d96ae15a4b92e82dd683b8e5e36401c4c417320c">csl_gll_subgrid</a>, <span class="comment">// Stable np=4 subgrid bilinear interp.</span></div>
<div class="line"><a name="l01997"></a><span class="lineno"><a class="line" href="structslmm_1_1_advecter_1_1_alg.html#a8d25733af0135add595ca9429d96ae15a0fa461bca58d930799338c0dd9b26df2"> 1997</a></span>&#160;      <a class="code" href="structslmm_1_1_advecter_1_1_alg.html#a8d25733af0135add595ca9429d96ae15a0fa461bca58d930799338c0dd9b26df2">csl_gll_exp</a>,     <span class="comment">// Stabilized np=4 subgrid reconstruction.</span></div>
<div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;    };</div>
<div class="line"><a name="l01999"></a><span class="lineno"><a class="line" href="structslmm_1_1_advecter_1_1_alg.html#af754ef31d61d9d042335b77f28880bab"> 1999</a></span>&#160;    <span class="keyword">static</span> <a class="code" href="structslmm_1_1_advecter_1_1_alg.html#a8d25733af0135add595ca9429d96ae15">Enum</a> <a class="code" href="structslmm_1_1_advecter_1_1_alg.html#af754ef31d61d9d042335b77f28880bab">convert</a> (<a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> <a class="code" href="structslmm_1_1_advecter.html#a9f36cc9f88fbd851722e96c247d07ea5">alg</a>) {</div>
<div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;      <span class="keywordflow">switch</span> (<a class="code" href="structslmm_1_1_advecter.html#a9f36cc9f88fbd851722e96c247d07ea5">alg</a>) {</div>
<div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;      <span class="keywordflow">case</span> 2: <span class="keywordflow">case</span> 29:  <span class="keywordflow">return</span> <a class="code" href="structslmm_1_1_advecter_1_1_alg.html#a8d25733af0135add595ca9429d96ae15a58d3371520961c730ed3d792dd6ef208">jct</a>;</div>
<div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;      <span class="keywordflow">case</span> 3: <span class="keywordflow">case</span> 39:  <span class="keywordflow">return</span> <a class="code" href="structslmm_1_1_advecter_1_1_alg.html#a8d25733af0135add595ca9429d96ae15a10bd2bf4e2e9889c0eb5f8c08a26489d">qos</a>;</div>
<div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;      <span class="keywordflow">case</span> 10: <span class="keywordflow">case</span> 18: <span class="keywordflow">return</span> <a class="code" href="structslmm_1_1_advecter_1_1_alg.html#a8d25733af0135add595ca9429d96ae15a04aca1177ddd519ab399ffe663fe5cbb">csl_gll</a>;</div>
<div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;      <span class="keywordflow">case</span> 11: <span class="keywordflow">case</span> 17: <span class="keywordflow">return</span> <a class="code" href="structslmm_1_1_advecter_1_1_alg.html#a8d25733af0135add595ca9429d96ae15a4b92e82dd683b8e5e36401c4c417320c">csl_gll_subgrid</a>;</div>
<div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;      <span class="keywordflow">case</span> 12: <span class="keywordflow">case</span> 19: <span class="keywordflow">return</span> <a class="code" href="structslmm_1_1_advecter_1_1_alg.html#a8d25733af0135add595ca9429d96ae15a0fa461bca58d930799338c0dd9b26df2">csl_gll_exp</a>;</div>
<div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;      <span class="keywordflow">default</span>: <a class="code" href="compose__slmm_8cpp.html#a7290a1aabe779e162c8d6a36b3abec04">slmm_throw_if</a>(<span class="keyword">true</span>, <span class="stringliteral">&quot;transport_alg &quot;</span> &lt;&lt; <a class="code" href="structslmm_1_1_advecter.html#a9f36cc9f88fbd851722e96c247d07ea5">alg</a> &lt;&lt; <span class="stringliteral">&quot; is invalid.&quot;</span>);</div>
<div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;      }</div>
<div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;    }</div>
<div class="line"><a name="l02009"></a><span class="lineno"><a class="line" href="structslmm_1_1_advecter_1_1_alg.html#aa5850685e0fb4b5bc662118d9209fab9"> 2009</a></span>&#160;    <span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="structslmm_1_1_advecter_1_1_alg.html#aa5850685e0fb4b5bc662118d9209fab9">is_cisl</a> (<span class="keyword">const</span> <a class="code" href="structslmm_1_1_advecter_1_1_alg.html#a8d25733af0135add595ca9429d96ae15">Enum</a>&amp; <a class="code" href="structslmm_1_1_advecter.html#a9f36cc9f88fbd851722e96c247d07ea5">alg</a>) { <span class="keywordflow">return</span> <a class="code" href="structslmm_1_1_advecter.html#a9f36cc9f88fbd851722e96c247d07ea5">alg</a> == <a class="code" href="structslmm_1_1_advecter_1_1_alg.html#a8d25733af0135add595ca9429d96ae15a58d3371520961c730ed3d792dd6ef208">jct</a> || <a class="code" href="structslmm_1_1_advecter.html#a9f36cc9f88fbd851722e96c247d07ea5">alg</a> == <a class="code" href="structslmm_1_1_advecter_1_1_alg.html#a8d25733af0135add595ca9429d96ae15a10bd2bf4e2e9889c0eb5f8c08a26489d">qos</a>; }</div>
<div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;  };</div>
<div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160; </div>
<div class="line"><a name="l02012"></a><span class="lineno"><a class="line" href="structslmm_1_1_advecter.html#ac93fc0f27e3838ae2ccea5ddcc983c41"> 2012</a></span>&#160;  <a class="code" href="structslmm_1_1_advecter.html#ac93fc0f27e3838ae2ccea5ddcc983c41">Advecter</a> (<span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> <a class="code" href="structslmm_1_1_advecter.html#a84b17c3e0c8ceb58d593fec7b3d07850">np</a>, <span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> <a class="code" href="structslmm_1_1_advecter.html#aef6709967e01e0162a7ce68093e38a6e">nelem</a>, <span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> <a class="code" href="namespacecontrol__mod.html#a7843d1e9a4379154a53150027e49f43b">transport_alg</a>,</div>
<div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;            <span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> <a class="code" href="structslmm_1_1_advecter.html#aa9c928d571650b1b4a4a73e03f5890ca">cubed_sphere_map</a>, <span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> nearest_point_permitted_lev_bdy)</div>
<div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;    : alg_(<a class="code" href="structslmm_1_1_advecter_1_1_alg.html">Alg</a>::<a class="code" href="namespacedcmip2012__test5.html#ad89ae7f123bdc5a628ee8e834c3e18a5">convert</a>(<a class="code" href="namespacecontrol__mod.html#a7843d1e9a4379154a53150027e49f43b">transport_alg</a>)),</div>
<div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;      np_(<a class="code" href="structslmm_1_1_advecter.html#a84b17c3e0c8ceb58d593fec7b3d07850">np</a>), np2_(<a class="code" href="structslmm_1_1_advecter.html#a84b17c3e0c8ceb58d593fec7b3d07850">np</a>*<a class="code" href="structslmm_1_1_advecter.html#a84b17c3e0c8ceb58d593fec7b3d07850">np</a>), np4_(np2_*np2_),</div>
<div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;      cubed_sphere_map_(<a class="code" href="structslmm_1_1_advecter.html#aa9c928d571650b1b4a4a73e03f5890ca">cubed_sphere_map</a>),</div>
<div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;      tq_order_(alg_ == <a class="code" href="structslmm_1_1_advecter_1_1_alg.html">Alg</a>::qos ? 14 : 12),</div>
<div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;      nearest_point_permitted_lev_bdy_(nearest_point_permitted_lev_bdy)</div>
<div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;  {</div>
<div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;    <a class="code" href="compose__slmm_8cpp.html#a7290a1aabe779e162c8d6a36b3abec04">slmm_throw_if</a>(<a class="code" href="structslmm_1_1_advecter.html#aa9c928d571650b1b4a4a73e03f5890ca">cubed_sphere_map</a> == 0 &amp;&amp; <a class="code" href="structslmm_1_1_advecter_1_1_alg.html#aa5850685e0fb4b5bc662118d9209fab9">Alg::is_cisl</a>(alg_),</div>
<div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;                  <span class="stringliteral">&quot;When cubed_sphere_map = 0, SLMM supports only ISL methods.&quot;</span>);</div>
<div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;    local_mesh_.resize(<a class="code" href="structslmm_1_1_advecter.html#aef6709967e01e0162a7ce68093e38a6e">nelem</a>);</div>
<div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="structslmm_1_1_advecter_1_1_alg.html#aa5850685e0fb4b5bc662118d9209fab9">Alg::is_cisl</a>(alg_))</div>
<div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;      mass_mix_.resize(np4_);</div>
<div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;    <span class="keywordflow">if</span> (nearest_point_permitted_lev_bdy_ &gt;= 0)</div>
<div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;      local_mesh_nearest_point_data_.resize(<a class="code" href="structslmm_1_1_advecter.html#aef6709967e01e0162a7ce68093e38a6e">nelem</a>);</div>
<div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;  }</div>
<div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160; </div>
<div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="structslmm_1_1_advecter.html#aca02b2cf0c258e41f36f324159f5d0a8">fill_nearest_points_if_needed</a>();</div>
<div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160; </div>
<div class="line"><a name="l02031"></a><span class="lineno"><a class="line" href="structslmm_1_1_advecter.html#a84b17c3e0c8ceb58d593fec7b3d07850"> 2031</a></span>&#160;  <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> <a class="code" href="structslmm_1_1_advecter.html#a84b17c3e0c8ceb58d593fec7b3d07850">np</a>  ()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> np_ ; }</div>
<div class="line"><a name="l02032"></a><span class="lineno"><a class="line" href="structslmm_1_1_advecter.html#a5be0d0c905559d9d7e7ff775c5a4f593"> 2032</a></span>&#160;  <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> <a class="code" href="structslmm_1_1_advecter.html#a5be0d0c905559d9d7e7ff775c5a4f593">np2</a> ()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> np2_; }</div>
<div class="line"><a name="l02033"></a><span class="lineno"><a class="line" href="structslmm_1_1_advecter.html#a1dda64ded895b0512f71910a86cfd93b"> 2033</a></span>&#160;  <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> <a class="code" href="structslmm_1_1_advecter.html#a1dda64ded895b0512f71910a86cfd93b">np4</a> ()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> np4_; }</div>
<div class="line"><a name="l02034"></a><span class="lineno"><a class="line" href="structslmm_1_1_advecter.html#aef6709967e01e0162a7ce68093e38a6e"> 2034</a></span>&#160;  <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> <a class="code" href="structslmm_1_1_advecter.html#aef6709967e01e0162a7ce68093e38a6e">nelem</a> ()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> local_mesh_.size(); }</div>
<div class="line"><a name="l02035"></a><span class="lineno"><a class="line" href="structslmm_1_1_advecter.html#a55953c4bd87ec3121bf9993bcc11dbf2"> 2035</a></span>&#160;  <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> <a class="code" href="structslmm_1_1_advecter.html#a55953c4bd87ec3121bf9993bcc11dbf2">tq_order</a> ()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> tq_order_; }</div>
<div class="line"><a name="l02036"></a><span class="lineno"><a class="line" href="structslmm_1_1_advecter.html#a9f36cc9f88fbd851722e96c247d07ea5"> 2036</a></span>&#160;  <a class="code" href="structslmm_1_1_advecter_1_1_alg.html#a8d25733af0135add595ca9429d96ae15">Alg::Enum</a> <a class="code" href="structslmm_1_1_advecter.html#a9f36cc9f88fbd851722e96c247d07ea5">alg</a> ()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> alg_; }</div>
<div class="line"><a name="l02037"></a><span class="lineno"><a class="line" href="structslmm_1_1_advecter.html#ab9a96789ed360210aee71d6b904cf8db"> 2037</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="structslmm_1_1_advecter.html#ab9a96789ed360210aee71d6b904cf8db">is_cisl</a> ()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="structslmm_1_1_advecter_1_1_alg.html#aa5850685e0fb4b5bc662118d9209fab9">Alg::is_cisl</a>(alg_); }</div>
<div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160; </div>
<div class="line"><a name="l02039"></a><span class="lineno"><a class="line" href="structslmm_1_1_advecter.html#aa9c928d571650b1b4a4a73e03f5890ca"> 2039</a></span>&#160;  <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> <a class="code" href="structslmm_1_1_advecter.html#aa9c928d571650b1b4a4a73e03f5890ca">cubed_sphere_map</a> ()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> cubed_sphere_map_; }</div>
<div class="line"><a name="l02040"></a><span class="lineno"><a class="line" href="structslmm_1_1_advecter.html#adec3da25a76af49865473c80f45ea9bf"> 2040</a></span>&#160;  <span class="keyword">const</span> <a class="code" href="namespaceslmm.html#a410e5c4c97a57814b75c6a9b4583ced2">Ints</a>&amp; <a class="code" href="structslmm_1_1_advecter.html#adec3da25a76af49865473c80f45ea9bf">lid2facenum</a> ()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> lid2facenum_; }</div>
<div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160; </div>
<div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;  <span class="comment">// nelem_global is used only if cubed_sphere_map = 0, to deduce ne in</span></div>
<div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;  <span class="comment">// nelem_global = 6 ne^2. That is b/c cubed_sphere_map = 0 is supported in</span></div>
<div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;  <span class="comment">// Homme only for regular meshes (not RRM), and ne is essential to using the</span></div>
<div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;  <span class="comment">// efficiency it provides.</span></div>
<div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="structslmm_1_1_advecter.html#a513fc6399078d132a97d0d449a843607">init_meta_data</a>(<span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> nelem_global, <span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a>* <a class="code" href="structslmm_1_1_advecter.html#adec3da25a76af49865473c80f45ea9bf">lid2facenum</a>);</div>
<div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160; </div>
<div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Array3D&gt;</div>
<div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="structslmm_1_1_advecter.html#a8bad166a3312089bd75418f41519c86c">init_local_mesh_if_needed</a>(<span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> ie, <span class="keyword">const</span> Array3D&amp; corners,</div>
<div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;                                 <span class="keyword">const</span> <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a>* p_inside);</div>
<div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160; </div>
<div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;  <span class="comment">// Check that our ref &lt;-&gt; sphere map agrees with Homme&#39;s. p_homme is a GLL</span></div>
<div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160;  <span class="comment">// point on the sphere. Check that we map it to a GLL ref point.</span></div>
<div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="structslmm_1_1_advecter.html#a669827265583101df84a49f02b700057">check_ref2sphere</a>(<span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> ie, <span class="keyword">const</span> <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a>* p_homme);</div>
<div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160; </div>
<div class="line"><a name="l02056"></a><span class="lineno"><a class="line" href="structslmm_1_1_advecter.html#af0e7e647ca4de5abe97fa3f04b96792d"> 2056</a></span>&#160;  <span class="keyword">const</span> <a class="code" href="structslmm_1_1_local_mesh.html">LocalMesh</a>&amp; <a class="code" href="structslmm_1_1_advecter.html#af0e7e647ca4de5abe97fa3f04b96792d">local_mesh</a> (<span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> ie)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160;    <a class="code" href="compose__slmm_8cpp.html#a2912a5cf7e76e41c2ecf69b5c610479d">slmm_assert</a>(ie &lt; <span class="keyword">static_cast&lt;</span><a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a><span class="keyword">&gt;</span>(local_mesh_.size()));</div>
<div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160;    <span class="keywordflow">return</span> local_mesh_[ie];</div>
<div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160;  }</div>
<div class="line"><a name="l02060"></a><span class="lineno"><a class="line" href="structslmm_1_1_advecter.html#a39c4157f373425e5604b1f0a087f1c8d"> 2060</a></span>&#160;  <a class="code" href="structslmm_1_1_local_mesh.html">LocalMesh</a>&amp; <a class="code" href="structslmm_1_1_advecter.html#a39c4157f373425e5604b1f0a087f1c8d">local_mesh</a> (<span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> ie) {</div>
<div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;    <a class="code" href="compose__slmm_8cpp.html#a2912a5cf7e76e41c2ecf69b5c610479d">slmm_assert</a>(ie &lt; <span class="keyword">static_cast&lt;</span><a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a><span class="keyword">&gt;</span>(local_mesh_.size()));</div>
<div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160;    <span class="keywordflow">return</span> local_mesh_[ie];</div>
<div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160;  }</div>
<div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160; </div>
<div class="line"><a name="l02065"></a><span class="lineno"><a class="line" href="structslmm_1_1_advecter.html#a91fd6505ebc4de2399ebaf6b259424f2"> 2065</a></span>&#160;  <span class="keyword">const</span> <a class="code" href="structslmm_1_1nearest__point_1_1_mesh_nearest_point_data.html">MeshNearestPointData</a>&amp; <a class="code" href="structslmm_1_1_advecter.html#a91fd6505ebc4de2399ebaf6b259424f2">nearest_point_data</a> (<span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> ie)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160;    <a class="code" href="compose__slmm_8cpp.html#a2912a5cf7e76e41c2ecf69b5c610479d">slmm_assert</a>(ie &lt; <span class="keyword">static_cast&lt;</span><a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a><span class="keyword">&gt;</span>(local_mesh_nearest_point_data_.size()));</div>
<div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;    <span class="keywordflow">return</span> local_mesh_nearest_point_data_[ie];</div>
<div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160;  }</div>
<div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160; </div>
<div class="line"><a name="l02070"></a><span class="lineno"><a class="line" href="structslmm_1_1_advecter.html#ad0c9dc9bf29858727dae8c578fee42f1"> 2070</a></span>&#160;  std::vector&lt;Real&gt;&amp; <a class="code" href="structslmm_1_1_advecter.html#ad0c9dc9bf29858727dae8c578fee42f1">rhs_buffer</a> (<span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> <a class="code" href="namespacedimensions__mod.html#a0070848a40ac48379601d9a8a183c83b">qsize</a>) {</div>
<div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160;    rhs_.resize(np2_*<a class="code" href="namespacedimensions__mod.html#a0070848a40ac48379601d9a8a183c83b">qsize</a>);</div>
<div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;    <span class="keywordflow">return</span> rhs_;</div>
<div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;  }</div>
<div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160; </div>
<div class="line"><a name="l02075"></a><span class="lineno"><a class="line" href="structslmm_1_1_advecter.html#a22cd6080ae37bf5092cf4d6dc0a4772a"> 2075</a></span>&#160;  std::vector&lt;Real&gt;&amp; <a class="code" href="structslmm_1_1_advecter.html#a22cd6080ae37bf5092cf4d6dc0a4772a">mass_mix_buffer</a> () { <span class="keywordflow">return</span> mass_mix_; }</div>
<div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160; </div>
<div class="line"><a name="l02077"></a><span class="lineno"><a class="line" href="structslmm_1_1_advecter.html#a5e2a035d422023c3a4f696a7eae46f12"> 2077</a></span>&#160;  <span class="keyword">const</span> <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a>* <a class="code" href="structslmm_1_1_advecter.html#a5e2a035d422023c3a4f696a7eae46f12">M_tgt</a> (<span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a>&amp; ie) {</div>
<div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160;    <a class="code" href="compose__slmm_8cpp.html#a2912a5cf7e76e41c2ecf69b5c610479d">slmm_assert</a>(ie &gt;= 0 &amp;&amp; ie &lt; <a class="code" href="structslmm_1_1_advecter.html#aef6709967e01e0162a7ce68093e38a6e">nelem</a>());</div>
<div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160;    <span class="keywordflow">return</span> alg_ == <a class="code" href="structslmm_1_1_advecter_1_1_alg.html#a8d25733af0135add595ca9429d96ae15a58d3371520961c730ed3d792dd6ef208">Alg::jct</a> ?</div>
<div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;      mass_tgt_.data() :</div>
<div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;      mass_tgt_.data() + ie*np4_;</div>
<div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;  }</div>
<div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160; </div>
<div class="line"><a name="l02084"></a><span class="lineno"><a class="line" href="structslmm_1_1_advecter.html#ae0e59b5516d366a7d8ea825f37674d27"> 2084</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="structslmm_1_1_advecter.html#ae0e59b5516d366a7d8ea825f37674d27">nearest_point_permitted</a> (<span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a>&amp; lev)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160;    <span class="keywordflow">return</span> lev &lt;= nearest_point_permitted_lev_bdy_;</div>
<div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160;  }</div>
<div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160; </div>
<div class="line"><a name="l02088"></a><span class="lineno"><a class="line" href="structslmm_1_1_advecter.html#ac48a72f438fd44f70a224323415ae435"> 2088</a></span>&#160;  <span class="keyword">const</span> <a class="code" href="structslmm_1_1_sphere_to_ref.html">SphereToRef</a>&amp; <a class="code" href="structslmm_1_1_advecter.html#ac48a72f438fd44f70a224323415ae435">s2r</a> ()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> s2r_; }</div>
<div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160; </div>
<div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160;<span class="keyword">private</span>:</div>
<div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160;  <span class="keyword">const</span> <a class="code" href="structslmm_1_1_advecter_1_1_alg.html#a8d25733af0135add595ca9429d96ae15">Alg::Enum</a> alg_;</div>
<div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160;  <span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> np_, np2_, np4_, cubed_sphere_map_;</div>
<div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160;  std::vector&lt;LocalMesh&gt; local_mesh_;</div>
<div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;  <span class="comment">// For CISL:</span></div>
<div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;  <span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> tq_order_;</div>
<div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160;  std::vector&lt;Real&gt; mass_tgt_, mass_mix_, rhs_;</div>
<div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160;  <span class="comment">// For recovery from get_src_cell failure:</span></div>
<div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160;  <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> nearest_point_permitted_lev_bdy_;</div>
<div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160;  std::vector&lt;MeshNearestPointData&gt; local_mesh_nearest_point_data_;</div>
<div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160;  <span class="comment">// Meta data obtained at initialization that can be used later.</span></div>
<div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160;  <a class="code" href="namespaceslmm.html#a410e5c4c97a57814b75c6a9b4583ced2">Ints</a> lid2facenum_;</div>
<div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160;  <a class="code" href="structslmm_1_1_sphere_to_ref.html">SphereToRef</a> s2r_;</div>
<div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160;};</div>
<div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160; </div>
<div class="line"><a name="l02105"></a><span class="lineno"><a class="line" href="structslmm_1_1_advecter.html#a513fc6399078d132a97d0d449a843607"> 2105</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="structslmm_1_1_advecter.html#a513fc6399078d132a97d0d449a843607">Advecter</a></div>
<div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160;<a class="code" href="structslmm_1_1_advecter.html#a513fc6399078d132a97d0d449a843607">::init_meta_data</a> (<span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> nelem_global, <span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a>* lid2facenum) {</div>
<div class="line"><a name="l02107"></a><span class="lineno"> 2107</span>&#160;  <span class="keyword">const</span> <span class="keyword">auto</span> <a class="code" href="namespacedimensions__mod.html#af2bd2c00f3bbb316bc19c0b7964b18c4">nelemd</a> = local_mesh_.size();</div>
<div class="line"><a name="l02108"></a><span class="lineno"> 2108</span>&#160;  lid2facenum_ = <a class="code" href="namespaceslmm.html#a410e5c4c97a57814b75c6a9b4583ced2">Ints</a>(<span class="stringliteral">&quot;Advecter::lid2facenum&quot;</span>, <a class="code" href="namespacedimensions__mod.html#af2bd2c00f3bbb316bc19c0b7964b18c4">nelemd</a>);</div>
<div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160;  std::copy(lid2facenum, lid2facenum + <a class="code" href="namespacedimensions__mod.html#af2bd2c00f3bbb316bc19c0b7964b18c4">nelemd</a>, lid2facenum_.data());</div>
<div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160;  s2r_.init(cubed_sphere_map_, nelem_global, lid2facenum_);</div>
<div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160;}</div>
<div class="line"><a name="l02112"></a><span class="lineno"> 2112</span>&#160; </div>
<div class="line"><a name="l02113"></a><span class="lineno"> 2113</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> Array3D&gt;</div>
<div class="line"><a name="l02114"></a><span class="lineno"><a class="line" href="structslmm_1_1_advecter.html#a8bad166a3312089bd75418f41519c86c"> 2114</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="structslmm_1_1_advecter.html#a8bad166a3312089bd75418f41519c86c">Advecter::init_local_mesh_if_needed</a> (<span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> ie, <span class="keyword">const</span> Array3D&amp; corners,</div>
<div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160;                                          <span class="keyword">const</span> <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a>* p_inside) {</div>
<div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160;  <a class="code" href="compose__slmm_8cpp.html#a2912a5cf7e76e41c2ecf69b5c610479d">slmm_assert</a>(ie &lt; <span class="keyword">static_cast&lt;</span><a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a><span class="keyword">&gt;</span>(local_mesh_.size()));</div>
<div class="line"><a name="l02117"></a><span class="lineno"> 2117</span>&#160;  <span class="keywordflow">if</span> (local_mesh_[ie].p.extent_int(0) != 0) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02118"></a><span class="lineno"> 2118</span>&#160;  <span class="keyword">auto</span>&amp; m = local_mesh_[ie];</div>
<div class="line"><a name="l02119"></a><span class="lineno"> 2119</span>&#160;  <span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a></div>
<div class="line"><a name="l02120"></a><span class="lineno"> 2120</span>&#160;    nd = 3,</div>
<div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160;    nvert = corners.extent_int(1),</div>
<div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160;    ncell = corners.extent_int(2),</div>
<div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160;    N = nvert*ncell;</div>
<div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160;  m.<a class="code" href="structsiqk_1_1sh_1_1_mesh.html#a09ea9632dd1680a04d53aec55d4b6e4f">p</a> = <span class="keyword">typename</span> <a class="code" href="structslmm_1_1_local_mesh.html#ad312495f9adc29acc50c47b1ab281447">LocalMesh::RealArray</a>(<span class="stringliteral">&quot;p&quot;</span>, N);</div>
<div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160;  m.<a class="code" href="structsiqk_1_1sh_1_1_mesh.html#a3e86d388497c2a559b87e401a1235e87">e</a> = <span class="keyword">typename</span> <a class="code" href="structslmm_1_1_local_mesh.html#a31bfa049e11148a3474fc90b8c7303a6">LocalMesh::IntArray</a>(<span class="stringliteral">&quot;e&quot;</span>, ncell, nvert);</div>
<div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> ci = 0, <a class="code" href="namespacebaroclinic__wave.html#a8619f63e6dd6db1077c1a18788afa359">k</a> = 0; ci &lt; ncell; ++ci)</div>
<div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> vi = 0; vi &lt; nvert; ++vi, ++<a class="code" href="namespacebaroclinic__wave.html#a8619f63e6dd6db1077c1a18788afa359">k</a>) {</div>
<div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; nd; ++j)</div>
<div class="line"><a name="l02129"></a><span class="lineno"> 2129</span>&#160;        m.<a class="code" href="structsiqk_1_1sh_1_1_mesh.html#a09ea9632dd1680a04d53aec55d4b6e4f">p</a>(<a class="code" href="namespacebaroclinic__wave.html#a8619f63e6dd6db1077c1a18788afa359">k</a>,j) = corners(j,vi,ci);</div>
<div class="line"><a name="l02130"></a><span class="lineno"> 2130</span>&#160;      m.<a class="code" href="structsiqk_1_1sh_1_1_mesh.html#a3e86d388497c2a559b87e401a1235e87">e</a>(ci,vi) = <a class="code" href="namespacebaroclinic__wave.html#a8619f63e6dd6db1077c1a18788afa359">k</a>;</div>
<div class="line"><a name="l02131"></a><span class="lineno"> 2131</span>&#160;    }</div>
<div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160;  siqk::test::fill_normals&lt;siqk::SphereGeometry&gt;(m);</div>
<div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160;  m.<a class="code" href="structslmm_1_1_local_mesh.html#a84bbd39af98680d8f3441c37db94faa2">tgt_elem</a> = <a class="code" href="namespaceslmm.html#a09c707719e4082afb80a56b15c2db8ac">slmm::get_src_cell</a>(m, p_inside);</div>
<div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160;  <a class="code" href="compose__slmm_8cpp.html#a2912a5cf7e76e41c2ecf69b5c610479d">slmm_assert</a>(m.<a class="code" href="structslmm_1_1_local_mesh.html#a84bbd39af98680d8f3441c37db94faa2">tgt_elem</a> &gt;= 0 &amp;&amp;</div>
<div class="line"><a name="l02135"></a><span class="lineno"> 2135</span>&#160;              m.<a class="code" href="structslmm_1_1_local_mesh.html#a84bbd39af98680d8f3441c37db94faa2">tgt_elem</a> &lt; ncell);</div>
<div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160;}</div>
<div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160; </div>
<div class="line"><a name="l02138"></a><span class="lineno"><a class="line" href="structslmm_1_1_advecter.html#aca02b2cf0c258e41f36f324159f5d0a8"> 2138</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="structslmm_1_1_advecter.html#aca02b2cf0c258e41f36f324159f5d0a8">Advecter::fill_nearest_points_if_needed</a> () {</div>
<div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160;  <span class="keywordflow">if</span> (nearest_point_permitted_lev_bdy_ &gt;= 0)</div>
<div class="line"><a name="l02140"></a><span class="lineno"> 2140</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> ie = 0; ie &lt; static_cast&lt;Int&gt;(local_mesh_.size()); ++ie)</div>
<div class="line"><a name="l02141"></a><span class="lineno"> 2141</span>&#160;      <a class="code" href="namespaceslmm.html#a3158888774efd0768378cbf65b50e923">init_nearest_point_data</a>(local_mesh_[ie],</div>
<div class="line"><a name="l02142"></a><span class="lineno"> 2142</span>&#160;                              local_mesh_nearest_point_data_[ie]);</div>
<div class="line"><a name="l02143"></a><span class="lineno"> 2143</span>&#160;}</div>
<div class="line"><a name="l02144"></a><span class="lineno"> 2144</span>&#160; </div>
<div class="line"><a name="l02145"></a><span class="lineno"><a class="line" href="structslmm_1_1_advecter.html#a669827265583101df84a49f02b700057"> 2145</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="structslmm_1_1_advecter.html#a669827265583101df84a49f02b700057">Advecter::check_ref2sphere</a> (<span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> ie, <span class="keyword">const</span> <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a>* p_homme) {</div>
<div class="line"><a name="l02146"></a><span class="lineno"> 2146</span>&#160;  <span class="keyword">const</span> <span class="keyword">auto</span>&amp; m = <a class="code" href="structslmm_1_1_advecter.html#af0e7e647ca4de5abe97fa3f04b96792d">local_mesh</a>(ie);</div>
<div class="line"><a name="l02147"></a><span class="lineno"> 2147</span>&#160;  <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a> ref_coord[2];</div>
<div class="line"><a name="l02148"></a><span class="lineno"> 2148</span>&#160;  <a class="code" href="structsiqk_1_1sqr_1_1_info.html">siqk::sqr::Info</a> info;</div>
<div class="line"><a name="l02149"></a><span class="lineno"> 2149</span>&#160;  <span class="keyword">const</span> <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a> <a class="code" href="namespacecontrol__mod.html#a19f70697971fe3e6502be3097865437a">tol</a> = s2r_.<a class="code" href="structslmm_1_1_sphere_to_ref.html#a617fc3725ecbe170be737594d8928138">tol</a>();</div>
<div class="line"><a name="l02150"></a><span class="lineno"> 2150</span>&#160;  s2r_.<a class="code" href="structslmm_1_1_sphere_to_ref.html#aaad555824cc81462aa94165d11702bc9">calc_sphere_to_ref</a>(ie, m, p_homme, ref_coord[0], ref_coord[1], &amp;info);</div>
<div class="line"><a name="l02151"></a><span class="lineno"> 2151</span>&#160;  <span class="keyword">const</span> <a class="code" href="structslmm_1_1_basis.html">slmm::Basis</a> basis(4, 0);</div>
<div class="line"><a name="l02152"></a><span class="lineno"> 2152</span>&#160;  <span class="keyword">const</span> <a class="code" href="classslmm_1_1_g_l_l.html">slmm::GLL</a> gll;</div>
<div class="line"><a name="l02153"></a><span class="lineno"> 2153</span>&#160;  <span class="keyword">const</span> <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a>* <a class="code" href="namespacesupercell.html#ae57ef03dc0cb9828dbacc89aac8870c0">x</a>, * wt;</div>
<div class="line"><a name="l02154"></a><span class="lineno"> 2154</span>&#160;  gll.<a class="code" href="classslmm_1_1_g_l_l.html#a54fba27da4d71f6b3bca5964f1ff48b1">get_coef</a>(basis, <a class="code" href="namespacesupercell.html#ae57ef03dc0cb9828dbacc89aac8870c0">x</a>, wt);</div>
<div class="line"><a name="l02155"></a><span class="lineno"> 2155</span>&#160;  <span class="keywordtype">int</span> fnd[2] = {0};</div>
<div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160;  <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a> <a class="code" href="namespacesiqk.html#aa8af675f4123cd3ef73b7d549fb84324">min</a>[2] = {1,1};</div>
<div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 4; ++i)</div>
<div class="line"><a name="l02158"></a><span class="lineno"> 2158</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; 2; ++j) {</div>
<div class="line"><a name="l02159"></a><span class="lineno"> 2159</span>&#160;      <span class="keyword">const</span> <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a> d = std::abs(ref_coord[j] - <a class="code" href="namespacesupercell.html#ae57ef03dc0cb9828dbacc89aac8870c0">x</a>[i]);</div>
<div class="line"><a name="l02160"></a><span class="lineno"> 2160</span>&#160;      <a class="code" href="namespacesiqk.html#aa8af675f4123cd3ef73b7d549fb84324">min</a>[j] = <a class="code" href="namespacesiqk.html#aa8af675f4123cd3ef73b7d549fb84324">std::min</a>(<a class="code" href="namespacesiqk.html#aa8af675f4123cd3ef73b7d549fb84324">min</a>[j], d);</div>
<div class="line"><a name="l02161"></a><span class="lineno"> 2161</span>&#160;      <span class="keywordflow">if</span> (d &lt; <a class="code" href="namespacecontrol__mod.html#a19f70697971fe3e6502be3097865437a">tol</a>)</div>
<div class="line"><a name="l02162"></a><span class="lineno"> 2162</span>&#160;        fnd[j] = 1;</div>
<div class="line"><a name="l02163"></a><span class="lineno"> 2163</span>&#160;    }</div>
<div class="line"><a name="l02164"></a><span class="lineno"> 2164</span>&#160;  <span class="keywordflow">if</span> ( ! fnd[0] || ! fnd[1])</div>
<div class="line"><a name="l02165"></a><span class="lineno"> 2165</span>&#160;    printf(<span class="stringliteral">&quot;COMPOSE check_ref2sphere: %1.15e %1.15e (%1.2e %1.2e) %d %d\n&quot;</span>,</div>
<div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160;           ref_coord[0], ref_coord[1], <a class="code" href="namespacesiqk.html#aa8af675f4123cd3ef73b7d549fb84324">min</a>[0], <a class="code" href="namespacesiqk.html#aa8af675f4123cd3ef73b7d549fb84324">min</a>[1],</div>
<div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160;           info.<a class="code" href="structsiqk_1_1sqr_1_1_info.html#a9a01d651b2e286335a208f672c8dbf0c">success</a>, info.<a class="code" href="structsiqk_1_1sqr_1_1_info.html#aae7126c703242df2f17f566307ed4e5a">n_iterations</a>);</div>
<div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160;  <span class="keywordflow">if</span> ( ! s2r_.<a class="code" href="structslmm_1_1_sphere_to_ref.html#aad9870de578831b4c97c7a1d9916533c">check</a>(ie, m))</div>
<div class="line"><a name="l02169"></a><span class="lineno"> 2169</span>&#160;    printf(<span class="stringliteral">&quot;COMPOSE SphereToRef::check return false: ie = %d\n&quot;</span>, ie);</div>
<div class="line"><a name="l02170"></a><span class="lineno"> 2170</span>&#160;}</div>
<div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160;} <span class="comment">// namespace slmm</span></div>
<div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160; </div>
<div class="line"><a name="l02173"></a><span class="lineno"> 2173</span>&#160;<span class="preprocessor">#ifdef SLMM_MAIN</span></div>
<div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l02175"></a><span class="lineno"> 2175</span>&#160;<span class="comment">  mpicxx -O3 -g -DSLMM_MAIN -Wall -pedantic -fopenmp -std=c++11 -I/home/ambradl/lib/kokkos/cpu/include slmm.cpp -L/home/ambradl/lib/kokkos/cpu/lib -lkokkos -ldl -llapack -lblas; if [ $? == 0 ]; then OMP_PROC_BIND=false OMP_NUM_THREADS=2 mpirun -np 14 ./a.out; fi</span></div>
<div class="line"><a name="l02176"></a><span class="lineno"> 2176</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l02177"></a><span class="lineno"> 2177</span>&#160;<span class="keywordtype">int</span> <a class="code" href="main_8_f90.html#a8ec2266d83cd6c0b762cbcbc92c0af3d">main</a> (<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span>** argv) {</div>
<div class="line"><a name="l02178"></a><span class="lineno"> 2178</span>&#160;  <span class="keywordtype">int</span> ret = 0;</div>
<div class="line"><a name="l02179"></a><span class="lineno"> 2179</span>&#160;  <a class="code" href="namespacearkode__mod.html#a876a1cb648d7a4173b7b5532624b2743">Kokkos::initialize</a>(argc, argv);</div>
<div class="line"><a name="l02180"></a><span class="lineno"> 2180</span>&#160;  <span class="keywordflow">try</span> {</div>
<div class="line"><a name="l02181"></a><span class="lineno"> 2181</span>&#160;    <span class="keywordtype">int</span> nerr = 0;</div>
<div class="line"><a name="l02182"></a><span class="lineno"> 2182</span>&#160;    nerr += <a class="code" href="namespaceslmm.html#a7a1095b904c8047101a58045c12f867c">slmm::unittest</a>();</div>
<div class="line"><a name="l02183"></a><span class="lineno"> 2183</span>&#160;    std::cerr &lt;&lt; (nerr ? <span class="stringliteral">&quot;FAIL&quot;</span> : <span class="stringliteral">&quot;PASS&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;ED\n&quot;</span>;</div>
<div class="line"><a name="l02184"></a><span class="lineno"> 2184</span>&#160;  } <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception&amp; e) {</div>
<div class="line"><a name="l02185"></a><span class="lineno"> 2185</span>&#160;    std::cerr &lt;&lt; e.what();</div>
<div class="line"><a name="l02186"></a><span class="lineno"> 2186</span>&#160;  }</div>
<div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160;  Kokkos::finalize();</div>
<div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160;  <span class="keywordflow">return</span> ret;</div>
<div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160;}</div>
<div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160; </div>
<div class="line"><a name="l02192"></a><span class="lineno"> 2192</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespacehomme.html">homme</a> {</div>
<div class="line"><a name="l02193"></a><span class="lineno"><a class="line" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee"> 2193</a></span>&#160;<span class="keyword">typedef</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">slmm::Int</a> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a>;</div>
<div class="line"><a name="l02194"></a><span class="lineno"><a class="line" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d"> 2194</a></span>&#160;<span class="keyword">typedef</span> <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">slmm::Real</a> <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a>;</div>
<div class="line"><a name="l02195"></a><span class="lineno"> 2195</span>&#160; </div>
<div class="line"><a name="l02196"></a><span class="lineno"> 2196</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespace_kokkos.html">ko</a> = <a class="code" href="namespace_kokkos.html">Kokkos</a>;</div>
<div class="line"><a name="l02197"></a><span class="lineno"> 2197</span>&#160; </div>
<div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160;<span class="comment">// Fortran array wrappers.</span></div>
<div class="line"><a name="l02199"></a><span class="lineno"><a class="line" href="namespacehomme.html#ac98706588408697743e06647261f5ffa"> 2199</a></span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt; <span class="keyword">using</span> <a class="code" href="namespacehomme.html#ac98706588408697743e06647261f5ffa">FA2</a> =</div>
<div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160;  Kokkos::View&lt;T**,    Kokkos::LayoutLeft, Kokkos::HostSpace&gt;;</div>
<div class="line"><a name="l02201"></a><span class="lineno"><a class="line" href="namespacehomme.html#a9798590dfa671ded8ffd2295e714df11"> 2201</a></span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt; <span class="keyword">using</span> <a class="code" href="namespacehomme.html#a9798590dfa671ded8ffd2295e714df11">FA3</a> =</div>
<div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160;  Kokkos::View&lt;T***,   Kokkos::LayoutLeft, Kokkos::HostSpace&gt;;</div>
<div class="line"><a name="l02203"></a><span class="lineno"><a class="line" href="namespacehomme.html#a854e69de78ccf3e48d7f20d364114b4d"> 2203</a></span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt; <span class="keyword">using</span> <a class="code" href="namespacehomme.html#a854e69de78ccf3e48d7f20d364114b4d">FA4</a> =</div>
<div class="line"><a name="l02204"></a><span class="lineno"> 2204</span>&#160;  Kokkos::View&lt;T****,  Kokkos::LayoutLeft, Kokkos::HostSpace&gt;;</div>
<div class="line"><a name="l02205"></a><span class="lineno"><a class="line" href="namespacehomme.html#a209d68f2b13c312588926b5c0493106f"> 2205</a></span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt; <span class="keyword">using</span> <a class="code" href="namespacehomme.html#a209d68f2b13c312588926b5c0493106f">FA5</a> =</div>
<div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160;  Kokkos::View&lt;T*****, Kokkos::LayoutLeft, Kokkos::HostSpace&gt;;</div>
<div class="line"><a name="l02207"></a><span class="lineno"> 2207</span>&#160; </div>
<div class="line"><a name="l02208"></a><span class="lineno"><a class="line" href="structhomme_1_1_cartesian3_d.html#ab1880bacfc3039e97d704cc5c1a32197"> 2208</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structhomme_1_1_cartesian3_d.html">Cartesian3D</a> { <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a> <a class="code" href="structhomme_1_1_cartesian3_d.html#ab1880bacfc3039e97d704cc5c1a32197">x</a>, <a class="code" href="structhomme_1_1_cartesian3_d.html#a55b40736d06eed35782abd00d8543093">y</a>, <a class="code" href="structhomme_1_1_cartesian3_d.html#a903d732a7aa6deb90742ec2f67fec8cf">z</a>; };</div>
<div class="line"><a name="l02209"></a><span class="lineno"> 2209</span>&#160; </div>
<div class="line"><a name="l02210"></a><span class="lineno"> 2210</span>&#160;<span class="keyword">static</span> <a class="code" href="structslmm_1_1_advecter.html#a6aee13815de2f218c92599d2e145f7f9">slmm::Advecter::Ptr</a> g_advecter;</div>
<div class="line"><a name="l02211"></a><span class="lineno"> 2211</span>&#160; </div>
<div class="line"><a name="l02212"></a><span class="lineno"><a class="line" href="namespacehomme.html#a362172619ed099872f216687207d453d"> 2212</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespacehomme.html#a362172619ed099872f216687207d453d">slmm_init</a> (<span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> <a class="code" href="namespacedimensions__mod.html#a8648e26ae0e474ccf69d32a8148520c9">np</a>, <span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> <a class="code" href="namespacedimensions__mod.html#a64817c8f3506c463c896d202d237025e">nelem</a>, <span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> <a class="code" href="namespacedimensions__mod.html#af2bd2c00f3bbb316bc19c0b7964b18c4">nelemd</a>,</div>
<div class="line"><a name="l02213"></a><span class="lineno"> 2213</span>&#160;                <span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> <a class="code" href="namespacecontrol__mod.html#a7843d1e9a4379154a53150027e49f43b">transport_alg</a>, <span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> <a class="code" href="namespacecontrol__mod.html#aff62de0026bd6ea7c244564a9cbf1c03">cubed_sphere_map</a>,</div>
<div class="line"><a name="l02214"></a><span class="lineno"> 2214</span>&#160;                <span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> sl_nearest_point_lev, <span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a>* lid2facenum) {</div>
<div class="line"><a name="l02215"></a><span class="lineno"> 2215</span>&#160;  g_advecter = std::make_shared&lt;slmm::Advecter&gt;(</div>
<div class="line"><a name="l02216"></a><span class="lineno"> 2216</span>&#160;    <a class="code" href="namespacedimensions__mod.html#a8648e26ae0e474ccf69d32a8148520c9">np</a>, <a class="code" href="namespacedimensions__mod.html#af2bd2c00f3bbb316bc19c0b7964b18c4">nelemd</a>, <a class="code" href="namespacecontrol__mod.html#a7843d1e9a4379154a53150027e49f43b">transport_alg</a>, <a class="code" href="namespacecontrol__mod.html#aff62de0026bd6ea7c244564a9cbf1c03">cubed_sphere_map</a>, sl_nearest_point_lev);</div>
<div class="line"><a name="l02217"></a><span class="lineno"> 2217</span>&#160;  g_advecter-&gt;init_meta_data(<a class="code" href="namespacedimensions__mod.html#a64817c8f3506c463c896d202d237025e">nelem</a>, lid2facenum);</div>
<div class="line"><a name="l02218"></a><span class="lineno"> 2218</span>&#160;}</div>
<div class="line"><a name="l02219"></a><span class="lineno"> 2219</span>&#160; </div>
<div class="line"><a name="l02220"></a><span class="lineno"><a class="line" href="namespacehomme_1_1mpi.html"> 2220</a></span>&#160;<span class="keyword">namespace </span>mpi { <span class="comment">//todo Share with cedr.</span></div>
<div class="line"><a name="l02221"></a><span class="lineno"><a class="line" href="classhomme_1_1mpi_1_1_parallel.html"> 2221</a></span>&#160;<span class="keyword">class </span><a class="code" href="classhomme_1_1mpi_1_1_parallel.html">Parallel</a> {</div>
<div class="line"><a name="l02222"></a><span class="lineno"> 2222</span>&#160;  MPI_Comm comm_;</div>
<div class="line"><a name="l02223"></a><span class="lineno"> 2223</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l02224"></a><span class="lineno"><a class="line" href="classhomme_1_1mpi_1_1_parallel.html#aff1fe34dd95083421911cd1a89f7191d"> 2224</a></span>&#160;  <span class="keyword">typedef</span> std::shared_ptr&lt;Parallel&gt; <a class="code" href="classhomme_1_1mpi_1_1_parallel.html#aff1fe34dd95083421911cd1a89f7191d">Ptr</a>;</div>
<div class="line"><a name="l02225"></a><span class="lineno"><a class="line" href="classhomme_1_1mpi_1_1_parallel.html#a066a51d5968db32f8741c4680066a3b0"> 2225</a></span>&#160;  <a class="code" href="classhomme_1_1mpi_1_1_parallel.html#a066a51d5968db32f8741c4680066a3b0">Parallel</a>(MPI_Comm <a class="code" href="classhomme_1_1mpi_1_1_parallel.html#a81b0c32ea24c8c484290bff734023f8e">comm</a>) : comm_(<a class="code" href="classhomme_1_1mpi_1_1_parallel.html#a81b0c32ea24c8c484290bff734023f8e">comm</a>) {}</div>
<div class="line"><a name="l02226"></a><span class="lineno"><a class="line" href="classhomme_1_1mpi_1_1_parallel.html#a81b0c32ea24c8c484290bff734023f8e"> 2226</a></span>&#160;  MPI_Comm <a class="code" href="classhomme_1_1mpi_1_1_parallel.html#a81b0c32ea24c8c484290bff734023f8e">comm</a> ()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> comm_; }</div>
<div class="line"><a name="l02227"></a><span class="lineno"><a class="line" href="classhomme_1_1mpi_1_1_parallel.html#a9251fa1de119f66172b16fbf8e28c005"> 2227</a></span>&#160;  <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> <a class="code" href="classhomme_1_1mpi_1_1_parallel.html#a9251fa1de119f66172b16fbf8e28c005">size</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l02228"></a><span class="lineno"> 2228</span>&#160;    <span class="keywordtype">int</span> sz = 0;</div>
<div class="line"><a name="l02229"></a><span class="lineno"> 2229</span>&#160;    MPI_Comm_size(comm_, &amp;sz);</div>
<div class="line"><a name="l02230"></a><span class="lineno"> 2230</span>&#160;    <span class="keywordflow">return</span> sz;</div>
<div class="line"><a name="l02231"></a><span class="lineno"> 2231</span>&#160;  }</div>
<div class="line"><a name="l02232"></a><span class="lineno"><a class="line" href="classhomme_1_1mpi_1_1_parallel.html#ac068d8e0f526dbd3b49c4bcdc23a3c90"> 2232</a></span>&#160;  <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> <a class="code" href="classhomme_1_1mpi_1_1_parallel.html#ac068d8e0f526dbd3b49c4bcdc23a3c90">rank</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l02233"></a><span class="lineno"> 2233</span>&#160;    <span class="keywordtype">int</span> pid = 0;</div>
<div class="line"><a name="l02234"></a><span class="lineno"> 2234</span>&#160;    MPI_Comm_rank(comm_, &amp;pid);</div>
<div class="line"><a name="l02235"></a><span class="lineno"> 2235</span>&#160;    <span class="keywordflow">return</span> pid;</div>
<div class="line"><a name="l02236"></a><span class="lineno"> 2236</span>&#160;  }</div>
<div class="line"><a name="l02237"></a><span class="lineno"><a class="line" href="classhomme_1_1mpi_1_1_parallel.html#ab0930494b6f23feb868356cfeb380115"> 2237</a></span>&#160;  <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> <a class="code" href="classhomme_1_1mpi_1_1_parallel.html#ab0930494b6f23feb868356cfeb380115">root</a> ()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> 0; }</div>
<div class="line"><a name="l02238"></a><span class="lineno"><a class="line" href="classhomme_1_1mpi_1_1_parallel.html#a71e65bc5344d0a2988c4a94794aa4489"> 2238</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classhomme_1_1mpi_1_1_parallel.html#a71e65bc5344d0a2988c4a94794aa4489">amroot</a> ()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="classhomme_1_1mpi_1_1_parallel.html#ac068d8e0f526dbd3b49c4bcdc23a3c90">rank</a>() == <a class="code" href="classhomme_1_1mpi_1_1_parallel.html#ab0930494b6f23feb868356cfeb380115">root</a>(); }</div>
<div class="line"><a name="l02239"></a><span class="lineno"> 2239</span>&#160;};</div>
<div class="line"><a name="l02240"></a><span class="lineno"> 2240</span>&#160; </div>
<div class="line"><a name="l02241"></a><span class="lineno"><a class="line" href="namespacehomme_1_1mpi.html#a03a3312a58c03f70dcf34ab09d9399b4"> 2241</a></span>&#160;<a class="code" href="classhomme_1_1mpi_1_1_parallel.html#aff1fe34dd95083421911cd1a89f7191d">Parallel::Ptr</a> <a class="code" href="namespacehomme_1_1mpi.html#a03a3312a58c03f70dcf34ab09d9399b4">make_parallel</a> (MPI_Comm comm) {</div>
<div class="line"><a name="l02242"></a><span class="lineno"> 2242</span>&#160;  <span class="keywordflow">return</span> std::make_shared&lt;Parallel&gt;(comm);</div>
<div class="line"><a name="l02243"></a><span class="lineno"> 2243</span>&#160;}</div>
<div class="line"><a name="l02244"></a><span class="lineno"> 2244</span>&#160; </div>
<div class="line"><a name="l02245"></a><span class="lineno"><a class="line" href="structhomme_1_1mpi_1_1_request.html"> 2245</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structhomme_1_1mpi_1_1_request.html">Request</a> {</div>
<div class="line"><a name="l02246"></a><span class="lineno"><a class="line" href="structhomme_1_1mpi_1_1_request.html#afeffd56251f8a51cbda9672fec828d18"> 2246</a></span>&#160;  MPI_Request <a class="code" href="structhomme_1_1mpi_1_1_request.html#afeffd56251f8a51cbda9672fec828d18">request</a>;</div>
<div class="line"><a name="l02247"></a><span class="lineno"> 2247</span>&#160; </div>
<div class="line"><a name="l02248"></a><span class="lineno"> 2248</span>&#160;<span class="preprocessor">#ifdef COMPOSE_DEBUG_MPI</span></div>
<div class="line"><a name="l02249"></a><span class="lineno"> 2249</span>&#160;  <span class="keywordtype">int</span> unfreed;</div>
<div class="line"><a name="l02250"></a><span class="lineno"> 2250</span>&#160;  <a class="code" href="structhomme_1_1mpi_1_1_request.html">Request</a>();</div>
<div class="line"><a name="l02251"></a><span class="lineno"> 2251</span>&#160;  ~<a class="code" href="structhomme_1_1mpi_1_1_request.html">Request</a>();</div>
<div class="line"><a name="l02252"></a><span class="lineno"> 2252</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02253"></a><span class="lineno"> 2253</span>&#160;};</div>
<div class="line"><a name="l02254"></a><span class="lineno"> 2254</span>&#160; </div>
<div class="line"><a name="l02255"></a><span class="lineno"> 2255</span>&#160;<span class="preprocessor">#ifdef COMPOSE_DEBUG_MPI</span></div>
<div class="line"><a name="l02256"></a><span class="lineno"> 2256</span>&#160;Request::Request () : unfreed(0) {}</div>
<div class="line"><a name="l02257"></a><span class="lineno"> 2257</span>&#160;Request::~Request () {</div>
<div class="line"><a name="l02258"></a><span class="lineno"> 2258</span>&#160;  <span class="keywordflow">if</span> (unfreed) {</div>
<div class="line"><a name="l02259"></a><span class="lineno"> 2259</span>&#160;    std::stringstream ss;</div>
<div class="line"><a name="l02260"></a><span class="lineno"> 2260</span>&#160;    ss &lt;&lt; <span class="stringliteral">&quot;Request is being deleted with unfreed = &quot;</span> &lt;&lt; unfreed;</div>
<div class="line"><a name="l02261"></a><span class="lineno"> 2261</span>&#160;    <span class="keywordtype">int</span> fin;</div>
<div class="line"><a name="l02262"></a><span class="lineno"> 2262</span>&#160;    MPI_Finalized(&amp;fin);</div>
<div class="line"><a name="l02263"></a><span class="lineno"> 2263</span>&#160;    <span class="keywordflow">if</span> (fin) {</div>
<div class="line"><a name="l02264"></a><span class="lineno"> 2264</span>&#160;      ss &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l02265"></a><span class="lineno"> 2265</span>&#160;      std::cerr &lt;&lt; ss.str();</div>
<div class="line"><a name="l02266"></a><span class="lineno"> 2266</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02267"></a><span class="lineno"> 2267</span>&#160;      <a class="code" href="compose__slmm_8cpp.html#a62f071f9019b2263ed76a35f753af003">pr</a>(ss.str());</div>
<div class="line"><a name="l02268"></a><span class="lineno"> 2268</span>&#160;    }</div>
<div class="line"><a name="l02269"></a><span class="lineno"> 2269</span>&#160;  }</div>
<div class="line"><a name="l02270"></a><span class="lineno"> 2270</span>&#160;}</div>
<div class="line"><a name="l02271"></a><span class="lineno"> 2271</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02272"></a><span class="lineno"> 2272</span>&#160; </div>
<div class="line"><a name="l02273"></a><span class="lineno"><a class="line" href="namespacehomme_1_1mpi.html#a4b2c02b22e6da57800116d5a3ef07d83"> 2273</a></span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt; MPI_Datatype <a class="code" href="namespacehomme_1_1mpi.html#a4b2c02b22e6da57800116d5a3ef07d83">get_type</a>();</div>
<div class="line"><a name="l02274"></a><span class="lineno"><a class="line" href="namespacehomme_1_1mpi.html#a9d1d599c4b4c778bd06a5c67ee2aa084"> 2274</a></span>&#160;<span class="keyword">template</span> &lt;&gt; <span class="keyword">inline</span> MPI_Datatype <a class="code" href="namespacehomme_1_1mpi.html#a9d1d599c4b4c778bd06a5c67ee2aa084">get_type&lt;int&gt;</a>() { <span class="keywordflow">return</span> MPI_INT; }</div>
<div class="line"><a name="l02275"></a><span class="lineno"><a class="line" href="namespacehomme_1_1mpi.html#a40185ee733d1b24e02d8f73d9bf9868b"> 2275</a></span>&#160;<span class="keyword">template</span> &lt;&gt; <span class="keyword">inline</span> MPI_Datatype <a class="code" href="namespacehomme_1_1mpi.html#a40185ee733d1b24e02d8f73d9bf9868b">get_type&lt;double&gt;</a>() { <span class="keywordflow">return</span> MPI_DOUBLE; }</div>
<div class="line"><a name="l02276"></a><span class="lineno"><a class="line" href="namespacehomme_1_1mpi.html#a162358f1439766288643bddb8a93b52b"> 2276</a></span>&#160;<span class="keyword">template</span> &lt;&gt; <span class="keyword">inline</span> MPI_Datatype <a class="code" href="namespacehomme_1_1mpi.html#a162358f1439766288643bddb8a93b52b">get_type&lt;long&gt;</a>() { <span class="keywordflow">return</span> MPI_LONG_INT; }</div>
<div class="line"><a name="l02277"></a><span class="lineno"> 2277</span>&#160; </div>
<div class="line"><a name="l02278"></a><span class="lineno"> 2278</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</div>
<div class="line"><a name="l02279"></a><span class="lineno"><a class="line" href="namespacehomme_1_1mpi.html#ad8082dcb60fee10aa4100b8bdd436f50"> 2279</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="namespacehomme_1_1mpi.html#ad8082dcb60fee10aa4100b8bdd436f50">isend</a> (<span class="keyword">const</span> <a class="code" href="classhomme_1_1mpi_1_1_parallel.html">Parallel</a>&amp; p, <span class="keyword">const</span> T* buf, <span class="keywordtype">int</span> count, <span class="keywordtype">int</span> dest, <span class="keywordtype">int</span> tag,</div>
<div class="line"><a name="l02280"></a><span class="lineno"> 2280</span>&#160;           <a class="code" href="structhomme_1_1mpi_1_1_request.html">Request</a>* ireq) {</div>
<div class="line"><a name="l02281"></a><span class="lineno"> 2281</span>&#160;  MPI_Datatype dt = get_type&lt;T&gt;();</div>
<div class="line"><a name="l02282"></a><span class="lineno"> 2282</span>&#160;  MPI_Request ureq;</div>
<div class="line"><a name="l02283"></a><span class="lineno"> 2283</span>&#160;  MPI_Request* req = ireq ? &amp;ireq-&gt;<a class="code" href="structhomme_1_1mpi_1_1_request.html#afeffd56251f8a51cbda9672fec828d18">request</a> : &amp;ureq;</div>
<div class="line"><a name="l02284"></a><span class="lineno"> 2284</span>&#160;  <span class="keywordtype">int</span> ret = MPI_Isend(<span class="keyword">const_cast&lt;</span>T*<span class="keyword">&gt;</span>(buf), count, dt, dest, tag, p.<a class="code" href="classhomme_1_1mpi_1_1_parallel.html#a81b0c32ea24c8c484290bff734023f8e">comm</a>(), req);</div>
<div class="line"><a name="l02285"></a><span class="lineno"> 2285</span>&#160;  <span class="keywordflow">if</span> ( ! ireq) MPI_Request_free(req);</div>
<div class="line"><a name="l02286"></a><span class="lineno"> 2286</span>&#160;<span class="preprocessor">#ifdef COMPOSE_DEBUG_MPI</span></div>
<div class="line"><a name="l02287"></a><span class="lineno"> 2287</span>&#160;  <span class="keywordflow">else</span> ireq-&gt;unfreed++;</div>
<div class="line"><a name="l02288"></a><span class="lineno"> 2288</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02289"></a><span class="lineno"> 2289</span>&#160;  <span class="keywordflow">return</span> ret;</div>
<div class="line"><a name="l02290"></a><span class="lineno"> 2290</span>&#160;}</div>
<div class="line"><a name="l02291"></a><span class="lineno"> 2291</span>&#160; </div>
<div class="line"><a name="l02292"></a><span class="lineno"> 2292</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</div>
<div class="line"><a name="l02293"></a><span class="lineno"><a class="line" href="namespacehomme_1_1mpi.html#ad0286e50c3714e7a55f00f9a87c3637e"> 2293</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="namespacehomme_1_1mpi.html#ad0286e50c3714e7a55f00f9a87c3637e">irecv</a> (<span class="keyword">const</span> <a class="code" href="classhomme_1_1mpi_1_1_parallel.html">Parallel</a>&amp; p, T* buf, <span class="keywordtype">int</span> count, <span class="keywordtype">int</span> src, <span class="keywordtype">int</span> tag, <a class="code" href="structhomme_1_1mpi_1_1_request.html">Request</a>* ireq) {</div>
<div class="line"><a name="l02294"></a><span class="lineno"> 2294</span>&#160;  MPI_Datatype dt = get_type&lt;T&gt;();</div>
<div class="line"><a name="l02295"></a><span class="lineno"> 2295</span>&#160;  MPI_Request ureq;</div>
<div class="line"><a name="l02296"></a><span class="lineno"> 2296</span>&#160;  MPI_Request* req = ireq ? &amp;ireq-&gt;<a class="code" href="structhomme_1_1mpi_1_1_request.html#afeffd56251f8a51cbda9672fec828d18">request</a> : &amp;ureq;</div>
<div class="line"><a name="l02297"></a><span class="lineno"> 2297</span>&#160;  <span class="keywordtype">int</span> ret = MPI_Irecv(buf, count, dt, src, tag, p.<a class="code" href="classhomme_1_1mpi_1_1_parallel.html#a81b0c32ea24c8c484290bff734023f8e">comm</a>(), req);</div>
<div class="line"><a name="l02298"></a><span class="lineno"> 2298</span>&#160;  <span class="keywordflow">if</span> ( ! ireq) MPI_Request_free(req);</div>
<div class="line"><a name="l02299"></a><span class="lineno"> 2299</span>&#160;<span class="preprocessor">#ifdef COMPOSE_DEBUG_MPI</span></div>
<div class="line"><a name="l02300"></a><span class="lineno"> 2300</span>&#160;  <span class="keywordflow">else</span> ireq-&gt;unfreed++;</div>
<div class="line"><a name="l02301"></a><span class="lineno"> 2301</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02302"></a><span class="lineno"> 2302</span>&#160;  <span class="keywordflow">return</span> ret;</div>
<div class="line"><a name="l02303"></a><span class="lineno"> 2303</span>&#160;}</div>
<div class="line"><a name="l02304"></a><span class="lineno"> 2304</span>&#160; </div>
<div class="line"><a name="l02305"></a><span class="lineno"><a class="line" href="namespacehomme_1_1mpi.html#a82d35837b534382faf656df6413b3e23"> 2305</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="namespacehomme_1_1mpi.html#a82d35837b534382faf656df6413b3e23">waitany</a> (<span class="keywordtype">int</span> count, <a class="code" href="structhomme_1_1mpi_1_1_request.html">Request</a>* reqs, <span class="keywordtype">int</span>* index, MPI_Status* stats = <span class="keyword">nullptr</span>) {</div>
<div class="line"><a name="l02306"></a><span class="lineno"> 2306</span>&#160;<span class="preprocessor">#ifdef COMPOSE_DEBUG_MPI</span></div>
<div class="line"><a name="l02307"></a><span class="lineno"> 2307</span>&#160;  std::vector&lt;MPI_Request&gt; vreqs(count);</div>
<div class="line"><a name="l02308"></a><span class="lineno"> 2308</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; count; ++i) vreqs[i] = reqs[i].request;</div>
<div class="line"><a name="l02309"></a><span class="lineno"> 2309</span>&#160;  <span class="keyword">const</span> <span class="keyword">auto</span> out = MPI_Waitany(count, vreqs.data(), index,</div>
<div class="line"><a name="l02310"></a><span class="lineno"> 2310</span>&#160;                               stats ? stats : MPI_STATUS_IGNORE);</div>
<div class="line"><a name="l02311"></a><span class="lineno"> 2311</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; count; ++i) reqs[i].request = vreqs[i];</div>
<div class="line"><a name="l02312"></a><span class="lineno"> 2312</span>&#160;  reqs[*index].unfreed--;</div>
<div class="line"><a name="l02313"></a><span class="lineno"> 2313</span>&#160;  <span class="keywordflow">return</span> out;</div>
<div class="line"><a name="l02314"></a><span class="lineno"> 2314</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l02315"></a><span class="lineno"> 2315</span>&#160;  <span class="keywordflow">return</span> MPI_Waitany(count, <span class="keyword">reinterpret_cast&lt;</span>MPI_Request*<span class="keyword">&gt;</span>(reqs), index,</div>
<div class="line"><a name="l02316"></a><span class="lineno"> 2316</span>&#160;                     stats ? stats : MPI_STATUS_IGNORE);</div>
<div class="line"><a name="l02317"></a><span class="lineno"> 2317</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02318"></a><span class="lineno"> 2318</span>&#160;}</div>
<div class="line"><a name="l02319"></a><span class="lineno"> 2319</span>&#160; </div>
<div class="line"><a name="l02320"></a><span class="lineno"><a class="line" href="namespacehomme_1_1mpi.html#a34f40c3b1676af66d3ee317213118a1a"> 2320</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="namespacehomme_1_1mpi.html#a34f40c3b1676af66d3ee317213118a1a">waitall</a> (<span class="keywordtype">int</span> count, <a class="code" href="structhomme_1_1mpi_1_1_request.html">Request</a>* reqs, MPI_Status* stats = <span class="keyword">nullptr</span>) {</div>
<div class="line"><a name="l02321"></a><span class="lineno"> 2321</span>&#160;<span class="preprocessor">#ifdef COMPOSE_DEBUG_MPI</span></div>
<div class="line"><a name="l02322"></a><span class="lineno"> 2322</span>&#160;  std::vector&lt;MPI_Request&gt; vreqs(count);</div>
<div class="line"><a name="l02323"></a><span class="lineno"> 2323</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; count; ++i) vreqs[i] = reqs[i].request;</div>
<div class="line"><a name="l02324"></a><span class="lineno"> 2324</span>&#160;  <span class="keyword">const</span> <span class="keyword">auto</span> out = MPI_Waitall(count, vreqs.data(),</div>
<div class="line"><a name="l02325"></a><span class="lineno"> 2325</span>&#160;                               stats ? stats : MPI_STATUS_IGNORE);</div>
<div class="line"><a name="l02326"></a><span class="lineno"> 2326</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; count; ++i) {</div>
<div class="line"><a name="l02327"></a><span class="lineno"> 2327</span>&#160;    reqs[i].<a class="code" href="structhomme_1_1mpi_1_1_request.html#afeffd56251f8a51cbda9672fec828d18">request</a> = vreqs[i];</div>
<div class="line"><a name="l02328"></a><span class="lineno"> 2328</span>&#160;    reqs[i].unfreed--;</div>
<div class="line"><a name="l02329"></a><span class="lineno"> 2329</span>&#160;  }</div>
<div class="line"><a name="l02330"></a><span class="lineno"> 2330</span>&#160;  <span class="keywordflow">return</span> out;</div>
<div class="line"><a name="l02331"></a><span class="lineno"> 2331</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l02332"></a><span class="lineno"> 2332</span>&#160;  <span class="keywordflow">return</span> MPI_Waitall(count, <span class="keyword">reinterpret_cast&lt;</span>MPI_Request*<span class="keyword">&gt;</span>(reqs),</div>
<div class="line"><a name="l02333"></a><span class="lineno"> 2333</span>&#160;                     stats ? stats : MPI_STATUS_IGNORE);</div>
<div class="line"><a name="l02334"></a><span class="lineno"> 2334</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02335"></a><span class="lineno"> 2335</span>&#160;}</div>
<div class="line"><a name="l02336"></a><span class="lineno"> 2336</span>&#160; </div>
<div class="line"><a name="l02337"></a><span class="lineno"><a class="line" href="namespacehomme_1_1mpi.html#a3313f408c8edb7f88dbdc06d754841d3"> 2337</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="namespacehomme_1_1mpi.html#a3313f408c8edb7f88dbdc06d754841d3">wait</a> (<a class="code" href="structhomme_1_1mpi_1_1_request.html">Request</a>* req, MPI_Status* stat = <span class="keyword">nullptr</span>) {</div>
<div class="line"><a name="l02338"></a><span class="lineno"> 2338</span>&#160;<span class="preprocessor">#ifdef COMPOSE_DEBUG_MPI</span></div>
<div class="line"><a name="l02339"></a><span class="lineno"> 2339</span>&#160;  <span class="keyword">const</span> <span class="keyword">auto</span> out = MPI_Wait(&amp;req-&gt;<a class="code" href="structhomme_1_1mpi_1_1_request.html#afeffd56251f8a51cbda9672fec828d18">request</a>, stat ? stat : MPI_STATUS_IGNORE);</div>
<div class="line"><a name="l02340"></a><span class="lineno"> 2340</span>&#160;  req-&gt;unfreed--;</div>
<div class="line"><a name="l02341"></a><span class="lineno"> 2341</span>&#160;  <span class="keywordflow">return</span> out;</div>
<div class="line"><a name="l02342"></a><span class="lineno"> 2342</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l02343"></a><span class="lineno"> 2343</span>&#160;  <span class="keywordflow">return</span> MPI_Wait(<span class="keyword">reinterpret_cast&lt;</span>MPI_Request*<span class="keyword">&gt;</span>(req), stat ? stat : MPI_STATUS_IGNORE);</div>
<div class="line"><a name="l02344"></a><span class="lineno"> 2344</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02345"></a><span class="lineno"> 2345</span>&#160;}</div>
<div class="line"><a name="l02346"></a><span class="lineno"> 2346</span>&#160;} <span class="comment">// namespace mpi</span></div>
<div class="line"><a name="l02347"></a><span class="lineno"> 2347</span>&#160; </div>
<div class="line"><a name="l02348"></a><span class="lineno"><a class="line" href="namespacehomme_1_1cslmpi.html"> 2348</a></span>&#160;<span class="keyword">namespace </span>cslmpi {</div>
<div class="line"><a name="l02349"></a><span class="lineno"> 2349</span>&#160;<span class="comment">// Meta and bulk data for the classical (interpolation) SL method with special</span></div>
<div class="line"><a name="l02350"></a><span class="lineno"> 2350</span>&#160;<span class="comment">// comm pattern.</span></div>
<div class="line"><a name="l02351"></a><span class="lineno"> 2351</span>&#160; </div>
<div class="line"><a name="l02352"></a><span class="lineno"><a class="line" href="compose__slmm_8cpp.html#a4047b41bd6bf017d90044644fff1a654"> 2352</a></span>&#160;<span class="preprocessor">#define SLMM_BOUNDS_CHECK</span></div>
<div class="line"><a name="l02353"></a><span class="lineno"> 2353</span>&#160;<span class="preprocessor">#ifdef SLMM_BOUNDS_CHECK</span></div>
<div class="line"><a name="l02354"></a><span class="lineno"><a class="line" href="compose__slmm_8cpp.html#a96f8d18b38ee102e3197014e54f3b457"> 2354</a></span>&#160;<span class="preprocessor"># define slmm_assert_high(condition) slmm_assert(condition)</span></div>
<div class="line"><a name="l02355"></a><span class="lineno"> 2355</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l02356"></a><span class="lineno"> 2356</span>&#160;<span class="preprocessor"># define slmm_assert_high(condition)</span></div>
<div class="line"><a name="l02357"></a><span class="lineno"> 2357</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02358"></a><span class="lineno"> 2358</span>&#160; </div>
<div class="line"><a name="l02359"></a><span class="lineno"> 2359</span>&#160;<span class="comment">// FixedCapList, ListOfLists, and BufferLayoutArray are simple and somewhat</span></div>
<div class="line"><a name="l02360"></a><span class="lineno"> 2360</span>&#160;<span class="comment">// problem-specific array data structures for use in CslMpi.</span></div>
<div class="line"><a name="l02361"></a><span class="lineno"> 2361</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</div>
<div class="line"><a name="l02362"></a><span class="lineno"><a class="line" href="structhomme_1_1cslmpi_1_1_fixed_cap_list.html"> 2362</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structhomme_1_1cslmpi_1_1_fixed_cap_list.html">FixedCapList</a> {</div>
<div class="line"><a name="l02363"></a><span class="lineno"><a class="line" href="structhomme_1_1cslmpi_1_1_fixed_cap_list.html#ac1a2f14ff00bf93ba5290ff9377eda69"> 2363</a></span>&#160;  <a class="code" href="structhomme_1_1cslmpi_1_1_fixed_cap_list.html#ac1a2f14ff00bf93ba5290ff9377eda69">FixedCapList</a> () : n_(0) {}</div>
<div class="line"><a name="l02364"></a><span class="lineno"><a class="line" href="structhomme_1_1cslmpi_1_1_fixed_cap_list.html#ad1954a826b38abe88aa5c4eb05ec9cdb"> 2364</a></span>&#160;  <a class="code" href="structhomme_1_1cslmpi_1_1_fixed_cap_list.html#ad1954a826b38abe88aa5c4eb05ec9cdb">FixedCapList</a> (<span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a>&amp; cap) { <a class="code" href="compose__slmm_8cpp.html#a96f8d18b38ee102e3197014e54f3b457">slmm_assert_high</a>(cap &gt;= 0); <a class="code" href="structhomme_1_1cslmpi_1_1_fixed_cap_list.html#a3e9b033769f333ba49055706c62961e8">reset_capacity</a>(cap); }</div>
<div class="line"><a name="l02365"></a><span class="lineno"><a class="line" href="structhomme_1_1cslmpi_1_1_fixed_cap_list.html#a3e9b033769f333ba49055706c62961e8"> 2365</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="structhomme_1_1cslmpi_1_1_fixed_cap_list.html#a3e9b033769f333ba49055706c62961e8">reset_capacity</a> (<span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a>&amp; cap, <span class="keyword">const</span> <span class="keywordtype">bool</span> also_size = <span class="keyword">false</span>) {</div>
<div class="line"><a name="l02366"></a><span class="lineno"> 2366</span>&#160;    <a class="code" href="compose__slmm_8cpp.html#a2912a5cf7e76e41c2ecf69b5c610479d">slmm_assert</a>(cap &gt;= 0);</div>
<div class="line"><a name="l02367"></a><span class="lineno"> 2367</span>&#160;    d_.resize(cap);</div>
<div class="line"><a name="l02368"></a><span class="lineno"> 2368</span>&#160;    n_ = also_size ? cap : 0;</div>
<div class="line"><a name="l02369"></a><span class="lineno"> 2369</span>&#160;  }</div>
<div class="line"><a name="l02370"></a><span class="lineno"><a class="line" href="structhomme_1_1cslmpi_1_1_fixed_cap_list.html#ab8e972993f8c917e95107b125163f0c0"> 2370</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="structhomme_1_1cslmpi_1_1_fixed_cap_list.html#ab8e972993f8c917e95107b125163f0c0">clear</a> () { n_ = 0; }</div>
<div class="line"><a name="l02371"></a><span class="lineno"> 2371</span>&#160; </div>
<div class="line"><a name="l02372"></a><span class="lineno"><a class="line" href="structhomme_1_1cslmpi_1_1_fixed_cap_list.html#aad4f28cbbbe5499b8e1a60e8d984aa18"> 2372</a></span>&#160;  <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> <a class="code" href="structhomme_1_1cslmpi_1_1_fixed_cap_list.html#aad4f28cbbbe5499b8e1a60e8d984aa18">n</a> ()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> n_; }</div>
<div class="line"><a name="l02373"></a><span class="lineno"><a class="line" href="structhomme_1_1cslmpi_1_1_fixed_cap_list.html#ad5ac1ee99fc2091a5425a3d4dfade068"> 2373</a></span>&#160;  <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> <a class="code" href="structhomme_1_1cslmpi_1_1_fixed_cap_list.html#ad5ac1ee99fc2091a5425a3d4dfade068">size</a> ()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> n_; }</div>
<div class="line"><a name="l02374"></a><span class="lineno"><a class="line" href="structhomme_1_1cslmpi_1_1_fixed_cap_list.html#a568d836fc566d263a5aa12a807d47e75"> 2374</a></span>&#160;  <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> <a class="code" href="structhomme_1_1cslmpi_1_1_fixed_cap_list.html#a568d836fc566d263a5aa12a807d47e75">capacity</a> ()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> d_.size(); }</div>
<div class="line"><a name="l02375"></a><span class="lineno"><a class="line" href="structhomme_1_1cslmpi_1_1_fixed_cap_list.html#a201b2c44da196bccf882911274c227c7"> 2375</a></span>&#160;  <span class="keyword">const</span> T&amp; <a class="code" href="structhomme_1_1cslmpi_1_1_fixed_cap_list.html#a201b2c44da196bccf882911274c227c7">operator() </a>(<span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a>&amp; i)<span class="keyword"> const </span>{ <a class="code" href="compose__slmm_8cpp.html#a96f8d18b38ee102e3197014e54f3b457">slmm_assert_high</a>(i &gt;= 0 &amp;&amp; i &lt; n_); <span class="keywordflow">return</span> d_[i]; }</div>
<div class="line"><a name="l02376"></a><span class="lineno"><a class="line" href="structhomme_1_1cslmpi_1_1_fixed_cap_list.html#ab528be01602ed8f256d31f21d5e4954f"> 2376</a></span>&#160;  T&amp; <a class="code" href="structhomme_1_1cslmpi_1_1_fixed_cap_list.html#a201b2c44da196bccf882911274c227c7">operator() </a>(<span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a>&amp; i) { <a class="code" href="compose__slmm_8cpp.html#a96f8d18b38ee102e3197014e54f3b457">slmm_assert_high</a>(i &gt;= 0 &amp;&amp; i &lt; n_); <span class="keywordflow">return</span> d_[i]; }</div>
<div class="line"><a name="l02377"></a><span class="lineno"><a class="line" href="structhomme_1_1cslmpi_1_1_fixed_cap_list.html#ae2b8645820433b9777ddbed87eb5daf0"> 2377</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="structhomme_1_1cslmpi_1_1_fixed_cap_list.html#ae2b8645820433b9777ddbed87eb5daf0">inc</a> () { ++n_; <a class="code" href="compose__slmm_8cpp.html#a96f8d18b38ee102e3197014e54f3b457">slmm_assert_high</a>(n_ &lt;= <span class="keyword">static_cast&lt;</span><a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a><span class="keyword">&gt;</span>(d_.size())); }</div>
<div class="line"><a name="l02378"></a><span class="lineno"><a class="line" href="structhomme_1_1cslmpi_1_1_fixed_cap_list.html#aa5648aaf20e3e28707f797288ab945f1"> 2378</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="structhomme_1_1cslmpi_1_1_fixed_cap_list.html#aa5648aaf20e3e28707f797288ab945f1">inc</a> (<span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a>&amp; dn) { n_ += dn; <a class="code" href="compose__slmm_8cpp.html#a96f8d18b38ee102e3197014e54f3b457">slmm_assert_high</a>(n_ &lt;= <span class="keyword">static_cast&lt;</span><a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a><span class="keyword">&gt;</span>(d_.size())); }</div>
<div class="line"><a name="l02379"></a><span class="lineno"> 2379</span>&#160; </div>
<div class="line"><a name="l02380"></a><span class="lineno"><a class="line" href="structhomme_1_1cslmpi_1_1_fixed_cap_list.html#a697b98514512be0e0d821406216216c4"> 2380</a></span>&#160;  <span class="keyword">const</span> T* <a class="code" href="structhomme_1_1cslmpi_1_1_fixed_cap_list.html#a697b98514512be0e0d821406216216c4">data</a> ()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> d_.data(); }</div>
<div class="line"><a name="l02381"></a><span class="lineno"><a class="line" href="structhomme_1_1cslmpi_1_1_fixed_cap_list.html#ab8fa2048d078e34eb7911f51bd83e5a4"> 2381</a></span>&#160;  T* <a class="code" href="structhomme_1_1cslmpi_1_1_fixed_cap_list.html#ab8fa2048d078e34eb7911f51bd83e5a4">data</a> () { <span class="keywordflow">return</span> d_.data(); }  </div>
<div class="line"><a name="l02382"></a><span class="lineno"><a class="line" href="structhomme_1_1cslmpi_1_1_fixed_cap_list.html#ada310da68364580af2420776e7d54a32"> 2382</a></span>&#160;  <span class="keyword">const</span> T&amp; <a class="code" href="structhomme_1_1cslmpi_1_1_fixed_cap_list.html#ada310da68364580af2420776e7d54a32">back</a> ()<span class="keyword"> const </span>{ <a class="code" href="compose__slmm_8cpp.html#a96f8d18b38ee102e3197014e54f3b457">slmm_assert_high</a>(n_ &gt; 0); <span class="keywordflow">return</span> d_[n_-1]; }</div>
<div class="line"><a name="l02383"></a><span class="lineno"><a class="line" href="structhomme_1_1cslmpi_1_1_fixed_cap_list.html#a95eda4a044bcc685a22740df5611ba3e"> 2383</a></span>&#160;  T&amp; <a class="code" href="structhomme_1_1cslmpi_1_1_fixed_cap_list.html#a95eda4a044bcc685a22740df5611ba3e">back</a> () { <a class="code" href="compose__slmm_8cpp.html#a96f8d18b38ee102e3197014e54f3b457">slmm_assert_high</a>(n_ &gt; 0); <span class="keywordflow">return</span> d_[n_-1]; }</div>
<div class="line"><a name="l02384"></a><span class="lineno"><a class="line" href="structhomme_1_1cslmpi_1_1_fixed_cap_list.html#adcf681a89e5b8db48d9268d35e6f0544"> 2384</a></span>&#160;  <span class="keyword">const</span> T* <a class="code" href="structhomme_1_1cslmpi_1_1_fixed_cap_list.html#adcf681a89e5b8db48d9268d35e6f0544">begin</a> ()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> d_.data(); }</div>
<div class="line"><a name="l02385"></a><span class="lineno"><a class="line" href="structhomme_1_1cslmpi_1_1_fixed_cap_list.html#a51d614326a8de7c16f9e667a6a643fc0"> 2385</a></span>&#160;  T* <a class="code" href="structhomme_1_1cslmpi_1_1_fixed_cap_list.html#a51d614326a8de7c16f9e667a6a643fc0">begin</a> () { <span class="keywordflow">return</span> d_.data(); }</div>
<div class="line"><a name="l02386"></a><span class="lineno"><a class="line" href="structhomme_1_1cslmpi_1_1_fixed_cap_list.html#a1cecc082c0d47805347a17f78fd78bb6"> 2386</a></span>&#160;  <span class="keyword">const</span> T* <a class="code" href="structhomme_1_1cslmpi_1_1_fixed_cap_list.html#a1cecc082c0d47805347a17f78fd78bb6">end</a> ()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> d_.data() + n_; }</div>
<div class="line"><a name="l02387"></a><span class="lineno"><a class="line" href="structhomme_1_1cslmpi_1_1_fixed_cap_list.html#ad602c949367c66276068f68d48b64717"> 2387</a></span>&#160;  T* <a class="code" href="structhomme_1_1cslmpi_1_1_fixed_cap_list.html#ad602c949367c66276068f68d48b64717">end</a> () { <span class="keywordflow">return</span> d_.data() + n_; }</div>
<div class="line"><a name="l02388"></a><span class="lineno"> 2388</span>&#160; </div>
<div class="line"><a name="l02389"></a><span class="lineno"> 2389</span>&#160; <span class="keyword">private</span>:</div>
<div class="line"><a name="l02390"></a><span class="lineno"> 2390</span>&#160;  std::vector&lt;T&gt; d_;</div>
<div class="line"><a name="l02391"></a><span class="lineno"> 2391</span>&#160;  <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> n_;</div>
<div class="line"><a name="l02392"></a><span class="lineno"> 2392</span>&#160;};</div>
<div class="line"><a name="l02393"></a><span class="lineno"> 2393</span>&#160; </div>
<div class="line"><a name="l02394"></a><span class="lineno"> 2394</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</div>
<div class="line"><a name="l02395"></a><span class="lineno"><a class="line" href="structhomme_1_1cslmpi_1_1_list_of_lists.html"> 2395</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structhomme_1_1cslmpi_1_1_list_of_lists.html">ListOfLists</a> {</div>
<div class="line"><a name="l02396"></a><span class="lineno"><a class="line" href="structhomme_1_1cslmpi_1_1_list_of_lists_1_1_list.html"> 2396</a></span>&#160;  <span class="keyword">struct </span><a class="code" href="structhomme_1_1cslmpi_1_1_list_of_lists_1_1_list.html">List</a> {</div>
<div class="line"><a name="l02397"></a><span class="lineno"><a class="line" href="structhomme_1_1cslmpi_1_1_list_of_lists_1_1_list.html#a715c7f2b1e90f0d2e5c3d2eeb08bdec4"> 2397</a></span>&#160;    <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> <a class="code" href="structhomme_1_1cslmpi_1_1_list_of_lists_1_1_list.html#a715c7f2b1e90f0d2e5c3d2eeb08bdec4">n</a> ()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> n_; }</div>
<div class="line"><a name="l02398"></a><span class="lineno"> 2398</span>&#160; </div>
<div class="line"><a name="l02399"></a><span class="lineno"><a class="line" href="structhomme_1_1cslmpi_1_1_list_of_lists_1_1_list.html#a33306b1f6695dd0d3781501148d834a7"> 2399</a></span>&#160;    T&amp; <a class="code" href="structhomme_1_1cslmpi_1_1_list_of_lists_1_1_list.html#a33306b1f6695dd0d3781501148d834a7">operator() </a>(<span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a>&amp; i) { <a class="code" href="compose__slmm_8cpp.html#a96f8d18b38ee102e3197014e54f3b457">slmm_assert_high</a>(i &gt;= 0 &amp;&amp; i &lt; n_); <span class="keywordflow">return</span> d_[i]; }</div>
<div class="line"><a name="l02400"></a><span class="lineno"><a class="line" href="structhomme_1_1cslmpi_1_1_list_of_lists_1_1_list.html#a84cba4aad2bb6f22e119422ad0535014"> 2400</a></span>&#160;    <span class="keyword">const</span> T&amp; <a class="code" href="structhomme_1_1cslmpi_1_1_list_of_lists_1_1_list.html#a33306b1f6695dd0d3781501148d834a7">operator() </a>(<span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a>&amp; i)<span class="keyword"> const </span>{ <a class="code" href="compose__slmm_8cpp.html#a96f8d18b38ee102e3197014e54f3b457">slmm_assert_high</a>(i &gt;= 0 &amp;&amp; i &lt; n_); <span class="keywordflow">return</span> d_[i]; }</div>
<div class="line"><a name="l02401"></a><span class="lineno"> 2401</span>&#160; </div>
<div class="line"><a name="l02402"></a><span class="lineno"><a class="line" href="structhomme_1_1cslmpi_1_1_list_of_lists_1_1_list.html#ac41446418bc47fb81408bd2e96ad88b5"> 2402</a></span>&#160;    <span class="keyword">const</span> T* <a class="code" href="structhomme_1_1cslmpi_1_1_list_of_lists_1_1_list.html#ac41446418bc47fb81408bd2e96ad88b5">data</a> ()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> d_; }</div>
<div class="line"><a name="l02403"></a><span class="lineno"><a class="line" href="structhomme_1_1cslmpi_1_1_list_of_lists_1_1_list.html#a456323eb53bb8511c7069baba1870a76"> 2403</a></span>&#160;    T* <a class="code" href="structhomme_1_1cslmpi_1_1_list_of_lists_1_1_list.html#a456323eb53bb8511c7069baba1870a76">data</a> () { <span class="keywordflow">return</span> d_; }</div>
<div class="line"><a name="l02404"></a><span class="lineno"><a class="line" href="structhomme_1_1cslmpi_1_1_list_of_lists_1_1_list.html#a63d84e934ca16f226d278a7d061fa61d"> 2404</a></span>&#160;    <span class="keyword">const</span> T* <a class="code" href="structhomme_1_1cslmpi_1_1_list_of_lists_1_1_list.html#a63d84e934ca16f226d278a7d061fa61d">begin</a> ()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> d_; }</div>
<div class="line"><a name="l02405"></a><span class="lineno"><a class="line" href="structhomme_1_1cslmpi_1_1_list_of_lists_1_1_list.html#a295bce2446a8ef408a410c1a9f9518ba"> 2405</a></span>&#160;    T* <a class="code" href="structhomme_1_1cslmpi_1_1_list_of_lists_1_1_list.html#a295bce2446a8ef408a410c1a9f9518ba">begin</a> () { <span class="keywordflow">return</span> d_; }</div>
<div class="line"><a name="l02406"></a><span class="lineno"><a class="line" href="structhomme_1_1cslmpi_1_1_list_of_lists_1_1_list.html#a6513236aee6083abcea798365cdd87a1"> 2406</a></span>&#160;    <span class="keyword">const</span> T* <a class="code" href="structhomme_1_1cslmpi_1_1_list_of_lists_1_1_list.html#a6513236aee6083abcea798365cdd87a1">end</a> ()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> d_ + n_; }</div>
<div class="line"><a name="l02407"></a><span class="lineno"><a class="line" href="structhomme_1_1cslmpi_1_1_list_of_lists_1_1_list.html#a194b4c859156676706e9bb68dc7a9261"> 2407</a></span>&#160;    T* <a class="code" href="structhomme_1_1cslmpi_1_1_list_of_lists_1_1_list.html#a194b4c859156676706e9bb68dc7a9261">end</a> () { <span class="keywordflow">return</span> d_ + n_; }</div>
<div class="line"><a name="l02408"></a><span class="lineno"> 2408</span>&#160; </div>
<div class="line"><a name="l02409"></a><span class="lineno"><a class="line" href="structhomme_1_1cslmpi_1_1_list_of_lists_1_1_list.html#a12698fc7796e3d4549985c2c8cd6c1d9"> 2409</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="structhomme_1_1cslmpi_1_1_list_of_lists_1_1_list.html#a64c98937bfc2c3fcac44fb26ffe52b48">zero</a> () { <span class="keywordflow">for</span> (<a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> i = 0; i &lt; n_; ++i) d_[i] = 0; }</div>
<div class="line"><a name="l02410"></a><span class="lineno"> 2410</span>&#160; </div>
<div class="line"><a name="l02411"></a><span class="lineno"> 2411</span>&#160;  <span class="keyword">private</span>:</div>
<div class="line"><a name="l02412"></a><span class="lineno"> 2412</span>&#160;    <span class="keyword">friend</span> <span class="keyword">class </span><a class="code" href="structhomme_1_1cslmpi_1_1_list_of_lists.html">ListOfLists</a>&lt;T&gt;;</div>
<div class="line"><a name="l02413"></a><span class="lineno"> 2413</span>&#160;    <a class="code" href="structhomme_1_1cslmpi_1_1_list_of_lists_1_1_list.html">List</a> (T* d, <span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a>&amp; <a class="code" href="structhomme_1_1cslmpi_1_1_list_of_lists_1_1_list.html#a715c7f2b1e90f0d2e5c3d2eeb08bdec4">n</a>) : d_(d), n_(<a class="code" href="structhomme_1_1cslmpi_1_1_list_of_lists_1_1_list.html#a715c7f2b1e90f0d2e5c3d2eeb08bdec4">n</a>) { <a class="code" href="compose__slmm_8cpp.html#a96f8d18b38ee102e3197014e54f3b457">slmm_assert_high</a>(n_ &gt;= 0); }</div>
<div class="line"><a name="l02414"></a><span class="lineno"> 2414</span>&#160;    T* <span class="keyword">const</span> d_;</div>
<div class="line"><a name="l02415"></a><span class="lineno"> 2415</span>&#160;    <span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> n_;</div>
<div class="line"><a name="l02416"></a><span class="lineno"> 2416</span>&#160;  };</div>
<div class="line"><a name="l02417"></a><span class="lineno"> 2417</span>&#160; </div>
<div class="line"><a name="l02418"></a><span class="lineno"><a class="line" href="structhomme_1_1cslmpi_1_1_list_of_lists.html#a87de27b3c77aadeed3b24f4c7365d675"> 2418</a></span>&#160;  <a class="code" href="structhomme_1_1cslmpi_1_1_list_of_lists.html#a87de27b3c77aadeed3b24f4c7365d675">ListOfLists</a> () {}</div>
<div class="line"><a name="l02419"></a><span class="lineno"><a class="line" href="structhomme_1_1cslmpi_1_1_list_of_lists.html#a148e5115425454d913ebf0efdc31117e"> 2419</a></span>&#160;  <a class="code" href="structhomme_1_1cslmpi_1_1_list_of_lists.html#a148e5115425454d913ebf0efdc31117e">ListOfLists</a> (<span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> nlist, <span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a>* nlist_per_list) { <a class="code" href="structhomme_1_1cslmpi_1_1_list_of_lists.html#aa6d35555467b2286472dd6862b9b8cc3">init</a>(nlist, nlist_per_list); }</div>
<div class="line"><a name="l02420"></a><span class="lineno"><a class="line" href="structhomme_1_1cslmpi_1_1_list_of_lists.html#aa6d35555467b2286472dd6862b9b8cc3"> 2420</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="structhomme_1_1cslmpi_1_1_list_of_lists.html#aa6d35555467b2286472dd6862b9b8cc3">init</a> (<span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> nlist, <span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a>* nlist_per_list, T* buf = <span class="keyword">nullptr</span>) {</div>
<div class="line"><a name="l02421"></a><span class="lineno"> 2421</span>&#160;    <a class="code" href="compose__slmm_8cpp.html#a2912a5cf7e76e41c2ecf69b5c610479d">slmm_assert</a>(nlist &gt;= 0); </div>
<div class="line"><a name="l02422"></a><span class="lineno"> 2422</span>&#160;    ptr_.resize(nlist+1);</div>
<div class="line"><a name="l02423"></a><span class="lineno"> 2423</span>&#160;    ptr_[0] = 0;</div>
<div class="line"><a name="l02424"></a><span class="lineno"> 2424</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> i = 0; i &lt; nlist; ++i) {</div>
<div class="line"><a name="l02425"></a><span class="lineno"> 2425</span>&#160;      <a class="code" href="compose__slmm_8cpp.html#a2912a5cf7e76e41c2ecf69b5c610479d">slmm_assert</a>(nlist_per_list[i] &gt;= 0);</div>
<div class="line"><a name="l02426"></a><span class="lineno"> 2426</span>&#160;      ptr_[i+1] = ptr_[i] + nlist_per_list[i];</div>
<div class="line"><a name="l02427"></a><span class="lineno"> 2427</span>&#160;    }</div>
<div class="line"><a name="l02428"></a><span class="lineno"> 2428</span>&#160;    <span class="keywordflow">if</span> (buf) {</div>
<div class="line"><a name="l02429"></a><span class="lineno"> 2429</span>&#160;      d_ = buf;</div>
<div class="line"><a name="l02430"></a><span class="lineno"> 2430</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02431"></a><span class="lineno"> 2431</span>&#160;      v_.resize(ptr_.back());</div>
<div class="line"><a name="l02432"></a><span class="lineno"> 2432</span>&#160;      d_ = v_.data();</div>
<div class="line"><a name="l02433"></a><span class="lineno"> 2433</span>&#160;    }</div>
<div class="line"><a name="l02434"></a><span class="lineno"> 2434</span>&#160;  }</div>
<div class="line"><a name="l02435"></a><span class="lineno"> 2435</span>&#160; </div>
<div class="line"><a name="l02436"></a><span class="lineno"><a class="line" href="structhomme_1_1cslmpi_1_1_list_of_lists.html#a6711fa719e03ffad7df6afe223f9ea23"> 2436</a></span>&#160;  <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> <a class="code" href="structhomme_1_1cslmpi_1_1_list_of_lists.html#a6711fa719e03ffad7df6afe223f9ea23">n</a> ()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <span class="keyword">static_cast&lt;</span><a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a><span class="keyword">&gt;</span>(ptr_.size()) - 1; }</div>
<div class="line"><a name="l02437"></a><span class="lineno"><a class="line" href="structhomme_1_1cslmpi_1_1_list_of_lists.html#a1a334a3602be27a8c1e64701b9dea1b9"> 2437</a></span>&#160;  <a class="code" href="structhomme_1_1cslmpi_1_1_list_of_lists_1_1_list.html">List</a> <a class="code" href="structhomme_1_1cslmpi_1_1_list_of_lists.html#a1a334a3602be27a8c1e64701b9dea1b9">operator() </a>(<span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a>&amp; i) {</div>
<div class="line"><a name="l02438"></a><span class="lineno"> 2438</span>&#160;    <a class="code" href="compose__slmm_8cpp.html#a96f8d18b38ee102e3197014e54f3b457">slmm_assert_high</a>(i &gt;= 0 &amp;&amp; i &lt; <span class="keyword">static_cast&lt;</span><a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a><span class="keyword">&gt;</span>(ptr_.size()) - 1);</div>
<div class="line"><a name="l02439"></a><span class="lineno"> 2439</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="structhomme_1_1cslmpi_1_1_list_of_lists_1_1_list.html">List</a>(&amp;d_[ptr_[i]], ptr_[i+1] - ptr_[i]);</div>
<div class="line"><a name="l02440"></a><span class="lineno"> 2440</span>&#160;  }</div>
<div class="line"><a name="l02441"></a><span class="lineno"><a class="line" href="structhomme_1_1cslmpi_1_1_list_of_lists.html#a85196f34f820445074693c50fdec8720"> 2441</a></span>&#160;  <span class="keyword">const</span> <a class="code" href="structhomme_1_1cslmpi_1_1_list_of_lists_1_1_list.html">List</a> <a class="code" href="structhomme_1_1cslmpi_1_1_list_of_lists.html#a1a334a3602be27a8c1e64701b9dea1b9">operator() </a>(<span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a>&amp; i)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l02442"></a><span class="lineno"> 2442</span>&#160;    <a class="code" href="compose__slmm_8cpp.html#a96f8d18b38ee102e3197014e54f3b457">slmm_assert_high</a>(i &gt;= 0 &amp;&amp; i &lt; <span class="keyword">static_cast&lt;</span><a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a><span class="keyword">&gt;</span>(ptr_.size()) - 1);</div>
<div class="line"><a name="l02443"></a><span class="lineno"> 2443</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="structhomme_1_1cslmpi_1_1_list_of_lists_1_1_list.html">List</a>(<span class="keyword">const_cast&lt;</span>T*<span class="keyword">&gt;</span>(&amp;d_[ptr_[i]]), ptr_[i+1] - ptr_[i]);</div>
<div class="line"><a name="l02444"></a><span class="lineno"> 2444</span>&#160;  }</div>
<div class="line"><a name="l02445"></a><span class="lineno"><a class="line" href="structhomme_1_1cslmpi_1_1_list_of_lists.html#a6030fda3c51788c6554ff87102541ee3"> 2445</a></span>&#160;  T&amp; <a class="code" href="structhomme_1_1cslmpi_1_1_list_of_lists.html#a1a334a3602be27a8c1e64701b9dea1b9">operator() </a>(<span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a>&amp; i, <span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a>&amp; j) {</div>
<div class="line"><a name="l02446"></a><span class="lineno"> 2446</span>&#160;    <a class="code" href="compose__slmm_8cpp.html#a96f8d18b38ee102e3197014e54f3b457">slmm_assert_high</a>(i &gt;= 0 &amp;&amp; i &lt; <span class="keyword">static_cast&lt;</span><a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a><span class="keyword">&gt;</span>(ptr_.size()) - 1 &amp;&amp;</div>
<div class="line"><a name="l02447"></a><span class="lineno"> 2447</span>&#160;                     j &gt;= 0 &amp;&amp; j &lt; ptr_[i+1] - ptr_[i]);</div>
<div class="line"><a name="l02448"></a><span class="lineno"> 2448</span>&#160;    <span class="keywordflow">return</span> d_[ptr_[i] + j];</div>
<div class="line"><a name="l02449"></a><span class="lineno"> 2449</span>&#160;  }</div>
<div class="line"><a name="l02450"></a><span class="lineno"><a class="line" href="structhomme_1_1cslmpi_1_1_list_of_lists.html#acd4e2539bae695e6ddb246cdd0b5c912"> 2450</a></span>&#160;  <span class="keyword">const</span> T&amp; <a class="code" href="structhomme_1_1cslmpi_1_1_list_of_lists.html#a1a334a3602be27a8c1e64701b9dea1b9">operator() </a>(<span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a>&amp; i, <span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a>&amp; j)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l02451"></a><span class="lineno"> 2451</span>&#160;    <a class="code" href="compose__slmm_8cpp.html#a96f8d18b38ee102e3197014e54f3b457">slmm_assert_high</a>(i &gt;= 0 &amp;&amp; i &lt; <span class="keyword">static_cast&lt;</span><a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a><span class="keyword">&gt;</span>(ptr_.size()) - 1 &amp;&amp;</div>
<div class="line"><a name="l02452"></a><span class="lineno"> 2452</span>&#160;                     j &gt;= 0 &amp;&amp; j &lt; ptr_[i+1] - ptr_[i]);</div>
<div class="line"><a name="l02453"></a><span class="lineno"> 2453</span>&#160;    <span class="keywordflow">return</span> d_[ptr_[i] + j];</div>
<div class="line"><a name="l02454"></a><span class="lineno"> 2454</span>&#160;  }</div>
<div class="line"><a name="l02455"></a><span class="lineno"> 2455</span>&#160; </div>
<div class="line"><a name="l02456"></a><span class="lineno"> 2456</span>&#160;<span class="keyword">private</span>:</div>
<div class="line"><a name="l02457"></a><span class="lineno"><a class="line" href="structhomme_1_1cslmpi_1_1_list_of_lists.html#a718aa8808a740305ccf5b821ff2663c6"> 2457</a></span>&#160;  <span class="keyword">friend</span> <span class="keyword">class </span><a class="code" href="structhomme_1_1cslmpi_1_1_buffer_layout_array.html">BufferLayoutArray</a>;</div>
<div class="line"><a name="l02458"></a><span class="lineno"> 2458</span>&#160;  std::vector&lt;T&gt; v_;</div>
<div class="line"><a name="l02459"></a><span class="lineno"> 2459</span>&#160;  std::vector&lt;Int&gt; ptr_;</div>
<div class="line"><a name="l02460"></a><span class="lineno"> 2460</span>&#160;  T* d_;</div>
<div class="line"><a name="l02461"></a><span class="lineno"> 2461</span>&#160;  T* data () { <span class="keywordflow">return</span> d_; }</div>
<div class="line"><a name="l02462"></a><span class="lineno"> 2462</span>&#160;  <span class="keyword">const</span> T* data ()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> d_; }</div>
<div class="line"><a name="l02463"></a><span class="lineno"> 2463</span>&#160;};</div>
<div class="line"><a name="l02464"></a><span class="lineno"> 2464</span>&#160; </div>
<div class="line"><a name="l02465"></a><span class="lineno"><a class="line" href="structhomme_1_1cslmpi_1_1_layout_triple.html"> 2465</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structhomme_1_1cslmpi_1_1_layout_triple.html">LayoutTriple</a> {</div>
<div class="line"><a name="l02466"></a><span class="lineno"><a class="line" href="structhomme_1_1cslmpi_1_1_layout_triple.html#a96ce50bddefff51db0dea7cfddf4b6f1"> 2466</a></span>&#160;  <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> <a class="code" href="structhomme_1_1cslmpi_1_1_layout_triple.html#a30122012b909033f0439e43772932c80">xptr</a>, <a class="code" href="structhomme_1_1cslmpi_1_1_layout_triple.html#a9147af30052aa1a35892d8b92d1b7a45">qptr</a>, <a class="code" href="structhomme_1_1cslmpi_1_1_layout_triple.html#a96ce50bddefff51db0dea7cfddf4b6f1">cnt</a>;</div>
<div class="line"><a name="l02467"></a><span class="lineno"><a class="line" href="structhomme_1_1cslmpi_1_1_layout_triple.html#af79beb7bc68fbabec48cc4e5e495ca6d"> 2467</a></span>&#160;  <a class="code" href="structhomme_1_1cslmpi_1_1_layout_triple.html#af79beb7bc68fbabec48cc4e5e495ca6d">LayoutTriple</a> () : <a class="code" href="structhomme_1_1cslmpi_1_1_layout_triple.html">LayoutTriple</a>(0) {}</div>
<div class="line"><a name="l02468"></a><span class="lineno"><a class="line" href="structhomme_1_1cslmpi_1_1_layout_triple.html#a954b9c68414bdf327b607ec9ff3b73e6"> 2468</a></span>&#160;  <a class="code" href="structhomme_1_1cslmpi_1_1_layout_triple.html#a954b9c68414bdf327b607ec9ff3b73e6">LayoutTriple</a> (<span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a>&amp; val) { <a class="code" href="structhomme_1_1cslmpi_1_1_layout_triple.html#a30122012b909033f0439e43772932c80">xptr</a> = <a class="code" href="structhomme_1_1cslmpi_1_1_layout_triple.html#a9147af30052aa1a35892d8b92d1b7a45">qptr</a> = <a class="code" href="structhomme_1_1cslmpi_1_1_layout_triple.html#a96ce50bddefff51db0dea7cfddf4b6f1">cnt</a> = 0; }</div>
<div class="line"><a name="l02469"></a><span class="lineno"> 2469</span>&#160;};</div>
<div class="line"><a name="l02470"></a><span class="lineno"> 2470</span>&#160; </div>
<div class="line"><a name="l02471"></a><span class="lineno"><a class="line" href="structhomme_1_1cslmpi_1_1_buffer_layout_array.html"> 2471</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structhomme_1_1cslmpi_1_1_buffer_layout_array.html">BufferLayoutArray</a> {</div>
<div class="line"><a name="l02472"></a><span class="lineno"><a class="line" href="structhomme_1_1cslmpi_1_1_buffer_layout_array_1_1_buffer_rank_layout_array.html"> 2472</a></span>&#160;  <span class="keyword">struct </span><a class="code" href="structhomme_1_1cslmpi_1_1_buffer_layout_array_1_1_buffer_rank_layout_array.html">BufferRankLayoutArray</a> {</div>
<div class="line"><a name="l02473"></a><span class="lineno"><a class="line" href="structhomme_1_1cslmpi_1_1_buffer_layout_array_1_1_buffer_rank_layout_array.html#ab49114fe74466f7001067d03fa16c358"> 2473</a></span>&#160;    <a class="code" href="structhomme_1_1cslmpi_1_1_layout_triple.html">LayoutTriple</a>&amp; <a class="code" href="structhomme_1_1cslmpi_1_1_buffer_layout_array_1_1_buffer_rank_layout_array.html#ab49114fe74466f7001067d03fa16c358">operator() </a>(<span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a>&amp; lidi, <span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a>&amp; lev) {</div>
<div class="line"><a name="l02474"></a><span class="lineno"> 2474</span>&#160;      <a class="code" href="compose__slmm_8cpp.html#a96f8d18b38ee102e3197014e54f3b457">slmm_assert_high</a>(lidi &gt;= 0 &amp;&amp; lev &gt;= 0 &amp;&amp; lidi*nlev_ + lev &lt; d_.n());</div>
<div class="line"><a name="l02475"></a><span class="lineno"> 2475</span>&#160;      <span class="keywordflow">return</span> d_(lidi*nlev_ + lev);</div>
<div class="line"><a name="l02476"></a><span class="lineno"> 2476</span>&#160;    }</div>
<div class="line"><a name="l02477"></a><span class="lineno"><a class="line" href="structhomme_1_1cslmpi_1_1_buffer_layout_array_1_1_buffer_rank_layout_array.html#a7fd1843d11a95415cef49bd45c6a131a"> 2477</a></span>&#160;    <span class="keyword">const</span> <a class="code" href="structhomme_1_1cslmpi_1_1_layout_triple.html">LayoutTriple</a>&amp; <a class="code" href="structhomme_1_1cslmpi_1_1_buffer_layout_array_1_1_buffer_rank_layout_array.html#ab49114fe74466f7001067d03fa16c358">operator() </a>(<span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a>&amp; lidi, <span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a>&amp; lev)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l02478"></a><span class="lineno"> 2478</span>&#160;      <a class="code" href="compose__slmm_8cpp.html#a96f8d18b38ee102e3197014e54f3b457">slmm_assert_high</a>(lidi &gt;= 0 &amp;&amp; lev &gt;= 0 &amp;&amp; lidi*nlev_ + lev &lt; d_.n());</div>
<div class="line"><a name="l02479"></a><span class="lineno"> 2479</span>&#160;      <span class="keywordflow">return</span> d_(lidi*nlev_ + lev);</div>
<div class="line"><a name="l02480"></a><span class="lineno"> 2480</span>&#160;    }</div>
<div class="line"><a name="l02481"></a><span class="lineno"> 2481</span>&#160; </div>
<div class="line"><a name="l02482"></a><span class="lineno"> 2482</span>&#160;  <span class="keyword">private</span>:</div>
<div class="line"><a name="l02483"></a><span class="lineno"><a class="line" href="structhomme_1_1cslmpi_1_1_buffer_layout_array_1_1_buffer_rank_layout_array.html#a718aa8808a740305ccf5b821ff2663c6"> 2483</a></span>&#160;    <span class="keyword">friend</span> <span class="keyword">class </span><a class="code" href="structhomme_1_1cslmpi_1_1_buffer_layout_array.html">BufferLayoutArray</a>;</div>
<div class="line"><a name="l02484"></a><span class="lineno"> 2484</span>&#160;    <a class="code" href="structhomme_1_1cslmpi_1_1_buffer_layout_array_1_1_buffer_rank_layout_array.html">BufferRankLayoutArray</a> (<span class="keyword">const</span> <a class="code" href="structhomme_1_1cslmpi_1_1_list_of_lists_1_1_list.html">ListOfLists&lt;LayoutTriple&gt;::List</a>&amp; d, <span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a>&amp; <a class="code" href="namespacedimensions__mod.html#a6baa218e1683465acc4f37fcea8e30d5">nlev</a>)</div>
<div class="line"><a name="l02485"></a><span class="lineno"> 2485</span>&#160;      : d_(d), nlev_(<a class="code" href="namespacedimensions__mod.html#a6baa218e1683465acc4f37fcea8e30d5">nlev</a>) {}</div>
<div class="line"><a name="l02486"></a><span class="lineno"> 2486</span>&#160;    <a class="code" href="structhomme_1_1cslmpi_1_1_list_of_lists_1_1_list.html">ListOfLists&lt;LayoutTriple&gt;::List</a> d_;</div>
<div class="line"><a name="l02487"></a><span class="lineno"> 2487</span>&#160;    <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> nlev_;</div>
<div class="line"><a name="l02488"></a><span class="lineno"> 2488</span>&#160;  };</div>
<div class="line"><a name="l02489"></a><span class="lineno"> 2489</span>&#160; </div>
<div class="line"><a name="l02490"></a><span class="lineno"><a class="line" href="structhomme_1_1cslmpi_1_1_buffer_layout_array.html#a4730e5d52892ddfac670ddd962966fa3"> 2490</a></span>&#160;  <a class="code" href="structhomme_1_1cslmpi_1_1_buffer_layout_array.html#a4730e5d52892ddfac670ddd962966fa3">BufferLayoutArray</a> () : nlev_(0) {}</div>
<div class="line"><a name="l02491"></a><span class="lineno"><a class="line" href="structhomme_1_1cslmpi_1_1_buffer_layout_array.html#a43c8656052cf82986bff40b28177ec22"> 2491</a></span>&#160;  <a class="code" href="structhomme_1_1cslmpi_1_1_buffer_layout_array.html#a43c8656052cf82986bff40b28177ec22">BufferLayoutArray</a> (<span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a>&amp; nrank, <span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a>* nlid_per_rank, <span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a>&amp; <a class="code" href="namespacedimensions__mod.html#a6baa218e1683465acc4f37fcea8e30d5">nlev</a>)</div>
<div class="line"><a name="l02492"></a><span class="lineno"> 2492</span>&#160;    { <a class="code" href="structhomme_1_1cslmpi_1_1_buffer_layout_array.html#a6762aeac900ca71b5857b0f441b5a66b">init</a>(nrank, nlid_per_rank, <a class="code" href="namespacedimensions__mod.html#a6baa218e1683465acc4f37fcea8e30d5">nlev</a>); }</div>
<div class="line"><a name="l02493"></a><span class="lineno"><a class="line" href="structhomme_1_1cslmpi_1_1_buffer_layout_array.html#a6762aeac900ca71b5857b0f441b5a66b"> 2493</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="structhomme_1_1cslmpi_1_1_buffer_layout_array.html#a6762aeac900ca71b5857b0f441b5a66b">init</a> (<span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a>&amp; nrank, <span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a>* nlid_per_rank, <span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a>&amp; <a class="code" href="namespacedimensions__mod.html#a6baa218e1683465acc4f37fcea8e30d5">nlev</a>) {</div>
<div class="line"><a name="l02494"></a><span class="lineno"> 2494</span>&#160;    <a class="code" href="compose__slmm_8cpp.html#a2912a5cf7e76e41c2ecf69b5c610479d">slmm_assert</a>(nrank &gt;= 0 &amp;&amp; <a class="code" href="namespacedimensions__mod.html#a6baa218e1683465acc4f37fcea8e30d5">nlev</a> &gt; 0);</div>
<div class="line"><a name="l02495"></a><span class="lineno"> 2495</span>&#160;    nlev_ = <a class="code" href="namespacedimensions__mod.html#a6baa218e1683465acc4f37fcea8e30d5">nlev</a>;</div>
<div class="line"><a name="l02496"></a><span class="lineno"> 2496</span>&#160;    std::vector&lt;Int&gt; ns(nrank);</div>
<div class="line"><a name="l02497"></a><span class="lineno"> 2497</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> i = 0; i &lt; nrank; ++i) {</div>
<div class="line"><a name="l02498"></a><span class="lineno"> 2498</span>&#160;      <a class="code" href="compose__slmm_8cpp.html#a2912a5cf7e76e41c2ecf69b5c610479d">slmm_assert</a>(nlid_per_rank[i] &gt; 0);</div>
<div class="line"><a name="l02499"></a><span class="lineno"> 2499</span>&#160;      ns[i] = nlid_per_rank[i] * <a class="code" href="namespacedimensions__mod.html#a6baa218e1683465acc4f37fcea8e30d5">nlev</a>;</div>
<div class="line"><a name="l02500"></a><span class="lineno"> 2500</span>&#160;    }</div>
<div class="line"><a name="l02501"></a><span class="lineno"> 2501</span>&#160;    d_.init(nrank, ns.data());</div>
<div class="line"><a name="l02502"></a><span class="lineno"> 2502</span>&#160;  }</div>
<div class="line"><a name="l02503"></a><span class="lineno"> 2503</span>&#160; </div>
<div class="line"><a name="l02504"></a><span class="lineno"><a class="line" href="structhomme_1_1cslmpi_1_1_buffer_layout_array.html#a7fc9a9e08333dbb6af828bc80c3496a7"> 2504</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="structhomme_1_1cslmpi_1_1_buffer_layout_array.html#a7fc9a9e08333dbb6af828bc80c3496a7">zero</a> () {</div>
<div class="line"><a name="l02505"></a><span class="lineno"> 2505</span>&#160;    <span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> ni = d_.n();</div>
<div class="line"><a name="l02506"></a><span class="lineno"> 2506</span>&#160;<span class="preprocessor">#ifdef HORIZ_OPENMP</span></div>
<div class="line"><a name="l02507"></a><span class="lineno"> 2507</span>&#160;<span class="preprocessor">#   pragma omp for</span></div>
<div class="line"><a name="l02508"></a><span class="lineno"> 2508</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02509"></a><span class="lineno"> 2509</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> i = 0; i &lt; ni; ++i) {</div>
<div class="line"><a name="l02510"></a><span class="lineno"> 2510</span>&#160;      <span class="keyword">auto</span>&amp;&amp; l = d_(i);</div>
<div class="line"><a name="l02511"></a><span class="lineno"> 2511</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> j = 0, nj = l.n(); j &lt; nj; ++j)</div>
<div class="line"><a name="l02512"></a><span class="lineno"> 2512</span>&#160;        l(j) = 0;</div>
<div class="line"><a name="l02513"></a><span class="lineno"> 2513</span>&#160;    }</div>
<div class="line"><a name="l02514"></a><span class="lineno"> 2514</span>&#160;  }</div>
<div class="line"><a name="l02515"></a><span class="lineno"> 2515</span>&#160; </div>
<div class="line"><a name="l02516"></a><span class="lineno"><a class="line" href="structhomme_1_1cslmpi_1_1_buffer_layout_array.html#afaebb3e7c5eb7daa639dc892258961eb"> 2516</a></span>&#160;  <a class="code" href="structhomme_1_1cslmpi_1_1_layout_triple.html">LayoutTriple</a>&amp; <a class="code" href="structhomme_1_1cslmpi_1_1_buffer_layout_array.html#afaebb3e7c5eb7daa639dc892258961eb">operator() </a>(<span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a>&amp; ri, <span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a>&amp; lidi, <span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a>&amp; lev) {</div>
<div class="line"><a name="l02517"></a><span class="lineno"> 2517</span>&#160;    <a class="code" href="compose__slmm_8cpp.html#a96f8d18b38ee102e3197014e54f3b457">slmm_assert_high</a>(ri &gt;= 0 &amp;&amp; ri &lt; d_.n() &amp;&amp;</div>
<div class="line"><a name="l02518"></a><span class="lineno"> 2518</span>&#160;                     lidi &gt;= 0 &amp;&amp; lev &gt;= 0 &amp;&amp;</div>
<div class="line"><a name="l02519"></a><span class="lineno"> 2519</span>&#160;                     lidi*nlev_ + lev &lt; d_(ri).n());</div>
<div class="line"><a name="l02520"></a><span class="lineno"> 2520</span>&#160;    <span class="keywordflow">return</span> d_.data()[d_.ptr_[ri] + lidi*nlev_ + lev];</div>
<div class="line"><a name="l02521"></a><span class="lineno"> 2521</span>&#160;  }</div>
<div class="line"><a name="l02522"></a><span class="lineno"><a class="line" href="structhomme_1_1cslmpi_1_1_buffer_layout_array.html#aae755ad590dccc6f2212a51a5ca3ef1b"> 2522</a></span>&#160;  <span class="keyword">const</span> <a class="code" href="structhomme_1_1cslmpi_1_1_layout_triple.html">LayoutTriple</a>&amp; <a class="code" href="structhomme_1_1cslmpi_1_1_buffer_layout_array.html#afaebb3e7c5eb7daa639dc892258961eb">operator() </a>(<span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a>&amp; ri, <span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a>&amp; lidi, <span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a>&amp; lev)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l02523"></a><span class="lineno"> 2523</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">const_cast&lt;</span><a class="code" href="structhomme_1_1cslmpi_1_1_buffer_layout_array.html">BufferLayoutArray</a>*<span class="keyword">&gt;</span>(<span class="keyword">this</span>)-&gt;<span class="keyword">operator</span>()(ri, lidi, lev);</div>
<div class="line"><a name="l02524"></a><span class="lineno"> 2524</span>&#160;  }</div>
<div class="line"><a name="l02525"></a><span class="lineno"><a class="line" href="structhomme_1_1cslmpi_1_1_buffer_layout_array.html#a2107017af4e1dc05c0553d2efaa113e7"> 2525</a></span>&#160;  <a class="code" href="structhomme_1_1cslmpi_1_1_buffer_layout_array_1_1_buffer_rank_layout_array.html">BufferRankLayoutArray</a> <a class="code" href="structhomme_1_1cslmpi_1_1_buffer_layout_array.html#afaebb3e7c5eb7daa639dc892258961eb">operator() </a>(<span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a>&amp; ri) {</div>
<div class="line"><a name="l02526"></a><span class="lineno"> 2526</span>&#160;    <a class="code" href="compose__slmm_8cpp.html#a96f8d18b38ee102e3197014e54f3b457">slmm_assert_high</a>(ri &gt;= 0 &amp;&amp; ri &lt; d_.n());</div>
<div class="line"><a name="l02527"></a><span class="lineno"> 2527</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="structhomme_1_1cslmpi_1_1_buffer_layout_array_1_1_buffer_rank_layout_array.html">BufferRankLayoutArray</a>(d_(ri), nlev_);</div>
<div class="line"><a name="l02528"></a><span class="lineno"> 2528</span>&#160;  }</div>
<div class="line"><a name="l02529"></a><span class="lineno"><a class="line" href="structhomme_1_1cslmpi_1_1_buffer_layout_array.html#a8d141aaa3379b7ef5ca0326b7cbbfb69"> 2529</a></span>&#160;  <span class="keyword">const</span> <a class="code" href="structhomme_1_1cslmpi_1_1_buffer_layout_array_1_1_buffer_rank_layout_array.html">BufferRankLayoutArray</a> <a class="code" href="structhomme_1_1cslmpi_1_1_buffer_layout_array.html#afaebb3e7c5eb7daa639dc892258961eb">operator() </a>(<span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a>&amp; ri)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l02530"></a><span class="lineno"> 2530</span>&#160;    <a class="code" href="compose__slmm_8cpp.html#a96f8d18b38ee102e3197014e54f3b457">slmm_assert_high</a>(ri &gt;= 0 &amp;&amp; ri &lt; d_.n());</div>
<div class="line"><a name="l02531"></a><span class="lineno"> 2531</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="structhomme_1_1cslmpi_1_1_buffer_layout_array_1_1_buffer_rank_layout_array.html">BufferRankLayoutArray</a>(d_(ri), nlev_);</div>
<div class="line"><a name="l02532"></a><span class="lineno"> 2532</span>&#160;  }</div>
<div class="line"><a name="l02533"></a><span class="lineno"> 2533</span>&#160; </div>
<div class="line"><a name="l02534"></a><span class="lineno"> 2534</span>&#160;<span class="keyword">private</span>:</div>
<div class="line"><a name="l02535"></a><span class="lineno"> 2535</span>&#160;  <a class="code" href="structhomme_1_1cslmpi_1_1_list_of_lists.html">ListOfLists&lt;LayoutTriple&gt;</a> d_;</div>
<div class="line"><a name="l02536"></a><span class="lineno"> 2536</span>&#160;  <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> nlev_;</div>
<div class="line"><a name="l02537"></a><span class="lineno"> 2537</span>&#160;};</div>
<div class="line"><a name="l02538"></a><span class="lineno"> 2538</span>&#160; </div>
<div class="line"><a name="l02539"></a><span class="lineno"><a class="line" href="namespacehomme_1_1cslmpi.html#a7c49b694c0edee08b4ddb61b2b700867"> 2539</a></span>&#160;<span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="namespacehomme_1_1cslmpi.html#a7c49b694c0edee08b4ddb61b2b700867">get_tid</a> () {</div>
<div class="line"><a name="l02540"></a><span class="lineno"> 2540</span>&#160;<span class="preprocessor">#ifdef HORIZ_OPENMP</span></div>
<div class="line"><a name="l02541"></a><span class="lineno"> 2541</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespacethread__mod.html#a9a637164272859f06057a8224b5308d9">omp_get_thread_num</a>();</div>
<div class="line"><a name="l02542"></a><span class="lineno"> 2542</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l02543"></a><span class="lineno"> 2543</span>&#160;  <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l02544"></a><span class="lineno"> 2544</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02545"></a><span class="lineno"> 2545</span>&#160;}</div>
<div class="line"><a name="l02546"></a><span class="lineno"> 2546</span>&#160; </div>
<div class="line"><a name="l02547"></a><span class="lineno"><a class="line" href="namespacehomme_1_1cslmpi.html#a256ba3e25f45bad09c7ccdbbfbc5b520"> 2547</a></span>&#160;<span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="namespacehomme_1_1cslmpi.html#a256ba3e25f45bad09c7ccdbbfbc5b520">get_num_threads</a> () {</div>
<div class="line"><a name="l02548"></a><span class="lineno"> 2548</span>&#160;<span class="preprocessor">#ifdef HORIZ_OPENMP</span></div>
<div class="line"><a name="l02549"></a><span class="lineno"> 2549</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespacethread__mod.html#a3cfb271c6e26c035a846d90733d7b0db">omp_get_num_threads</a>();</div>
<div class="line"><a name="l02550"></a><span class="lineno"> 2550</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l02551"></a><span class="lineno"> 2551</span>&#160;  <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l02552"></a><span class="lineno"> 2552</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02553"></a><span class="lineno"> 2553</span>&#160;}</div>
<div class="line"><a name="l02554"></a><span class="lineno"> 2554</span>&#160; </div>
<div class="line"><a name="l02555"></a><span class="lineno"> 2555</span>&#160;<span class="comment">// Meta and bulk data for the interpolation SL MPI communication pattern.</span></div>
<div class="line"><a name="l02556"></a><span class="lineno"><a class="line" href="structhomme_1_1cslmpi_1_1_csl_mpi.html"> 2556</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html">CslMpi</a> {</div>
<div class="line"><a name="l02557"></a><span class="lineno"><a class="line" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#ae05655fc7966bb7cb695bc3933bc212d"> 2557</a></span>&#160;  <span class="keyword">typedef</span> std::shared_ptr&lt;CslMpi&gt; <a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#ae05655fc7966bb7cb695bc3933bc212d">Ptr</a>;</div>
<div class="line"><a name="l02558"></a><span class="lineno"> 2558</span>&#160; </div>
<div class="line"><a name="l02559"></a><span class="lineno"> 2559</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Datatype&gt;</div>
<div class="line"><a name="l02560"></a><span class="lineno"><a class="line" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a139aec4ef20fe08ceb0d29fa65f10941"> 2560</a></span>&#160;  <span class="keyword">using</span> <a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a139aec4ef20fe08ceb0d29fa65f10941">Array</a> = ko::View&lt;Datatype, ko::LayoutRight, ko::HostSpace&gt;;</div>
<div class="line"><a name="l02561"></a><span class="lineno"><a class="line" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#ad93c0e96ca487335f1ed7c474e7e5fd7"> 2561</a></span>&#160;  <span class="keyword">typedef</span> <a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a139aec4ef20fe08ceb0d29fa65f10941">Array&lt;Int**&gt;</a> <a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#ad93c0e96ca487335f1ed7c474e7e5fd7">IntArray2D</a>;</div>
<div class="line"><a name="l02562"></a><span class="lineno"> 2562</span>&#160; </div>
<div class="line"><a name="l02563"></a><span class="lineno"><a class="line" href="structhomme_1_1cslmpi_1_1_csl_mpi_1_1_gid_rank.html"> 2563</a></span>&#160;  <span class="keyword">struct </span><a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi_1_1_gid_rank.html">GidRank</a> {</div>
<div class="line"><a name="l02564"></a><span class="lineno"> 2564</span>&#160;    <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a></div>
<div class="line"><a name="l02565"></a><span class="lineno"><a class="line" href="structhomme_1_1cslmpi_1_1_csl_mpi_1_1_gid_rank.html#a392cfaad3f848b837a3d493a916f5e60"> 2565</a></span>&#160;      <a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi_1_1_gid_rank.html#a392cfaad3f848b837a3d493a916f5e60">gid</a>,      <span class="comment">// cell global ID</span></div>
<div class="line"><a name="l02566"></a><span class="lineno"><a class="line" href="structhomme_1_1cslmpi_1_1_csl_mpi_1_1_gid_rank.html#ac8cdce149a7dc8cc18aaa3336a0eef5e"> 2566</a></span>&#160;      <a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi_1_1_gid_rank.html#ac8cdce149a7dc8cc18aaa3336a0eef5e">rank</a>,     <span class="comment">// the rank that owns the cell</span></div>
<div class="line"><a name="l02567"></a><span class="lineno"><a class="line" href="structhomme_1_1cslmpi_1_1_csl_mpi_1_1_gid_rank.html#ac1123a52efe3ae6ff2a5f3103a2ffc32"> 2567</a></span>&#160;      <a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi_1_1_gid_rank.html#ac1123a52efe3ae6ff2a5f3103a2ffc32">rank_idx</a>, <span class="comment">// index into list of ranks with whom I communicate, including me</span></div>
<div class="line"><a name="l02568"></a><span class="lineno"><a class="line" href="structhomme_1_1cslmpi_1_1_csl_mpi_1_1_gid_rank.html#a492c556544992da097413532ff4c1b43"> 2568</a></span>&#160;      <a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi_1_1_gid_rank.html#a492c556544992da097413532ff4c1b43">lid_on_rank</a>,     <span class="comment">// the local ID of the cell on the owning rank</span></div>
<div class="line"><a name="l02569"></a><span class="lineno"><a class="line" href="structhomme_1_1cslmpi_1_1_csl_mpi_1_1_gid_rank.html#a1b6f790aeee2b1fafd4d681e5b5752b6"> 2569</a></span>&#160;      <a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi_1_1_gid_rank.html#a1b6f790aeee2b1fafd4d681e5b5752b6">lid_on_rank_idx</a>; <span class="comment">// index into list of LIDs on the rank</span></div>
<div class="line"><a name="l02570"></a><span class="lineno"> 2570</span>&#160;  };</div>
<div class="line"><a name="l02571"></a><span class="lineno"> 2571</span>&#160;  <span class="comment">// The comm and real data associated with an element patch, the set of</span></div>
<div class="line"><a name="l02572"></a><span class="lineno"> 2572</span>&#160;  <span class="comment">// elements surrounding an owned cell.</span></div>
<div class="line"><a name="l02573"></a><span class="lineno"><a class="line" href="structhomme_1_1cslmpi_1_1_csl_mpi_1_1_elem_data.html"> 2573</a></span>&#160;  <span class="keyword">struct </span><a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi_1_1_elem_data.html">ElemData</a> {</div>
<div class="line"><a name="l02574"></a><span class="lineno"><a class="line" href="structhomme_1_1cslmpi_1_1_csl_mpi_1_1_elem_data_1_1_own_item.html"> 2574</a></span>&#160;    <span class="keyword">struct </span><a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi_1_1_elem_data_1_1_own_item.html">OwnItem</a> {</div>
<div class="line"><a name="l02575"></a><span class="lineno"><a class="line" href="structhomme_1_1cslmpi_1_1_csl_mpi_1_1_elem_data_1_1_own_item.html#aa5ff4f24cb98e87f4fa6b448de11be9c"> 2575</a></span>&#160;      <span class="keywordtype">short</span> <a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi_1_1_elem_data_1_1_own_item.html#aa5ff4f24cb98e87f4fa6b448de11be9c">lev</a>;   <span class="comment">// level index</span></div>
<div class="line"><a name="l02576"></a><span class="lineno"><a class="line" href="structhomme_1_1cslmpi_1_1_csl_mpi_1_1_elem_data_1_1_own_item.html#a75a855f379c77e32265e027cdfb58873"> 2576</a></span>&#160;      <span class="keywordtype">short</span> <a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi_1_1_elem_data_1_1_own_item.html#a75a855f379c77e32265e027cdfb58873">k</a>;     <span class="comment">// linearized GLL index</span></div>
<div class="line"><a name="l02577"></a><span class="lineno"> 2577</span>&#160;    };</div>
<div class="line"><a name="l02578"></a><span class="lineno"><a class="line" href="structhomme_1_1cslmpi_1_1_csl_mpi_1_1_elem_data_1_1_remote_item.html"> 2578</a></span>&#160;    <span class="keyword">struct </span><a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi_1_1_elem_data_1_1_remote_item.html">RemoteItem</a> {</div>
<div class="line"><a name="l02579"></a><span class="lineno"><a class="line" href="structhomme_1_1cslmpi_1_1_csl_mpi_1_1_elem_data_1_1_remote_item.html#acfcf7975e82cc072c59165eca36d2b41"> 2579</a></span>&#160;      <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> <a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi_1_1_elem_data_1_1_remote_item.html#acfcf7975e82cc072c59165eca36d2b41">q_extrema_ptr</a>, <a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi_1_1_elem_data_1_1_remote_item.html#af1c437264df10182ffd9145ffab79dbe">q_ptr</a>; <span class="comment">// pointers into recvbuf</span></div>
<div class="line"><a name="l02580"></a><span class="lineno"><a class="line" href="structhomme_1_1cslmpi_1_1_csl_mpi_1_1_elem_data_1_1_remote_item.html#a1338cef88da416f09ba7b84b06a66413"> 2580</a></span>&#160;      <span class="keywordtype">short</span> <a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi_1_1_elem_data_1_1_remote_item.html#abf74ecb6824adf51e6c2a946377ab0b3">lev</a>, <a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi_1_1_elem_data_1_1_remote_item.html#a1338cef88da416f09ba7b84b06a66413">k</a>;</div>
<div class="line"><a name="l02581"></a><span class="lineno"> 2581</span>&#160;    };</div>
<div class="line"><a name="l02582"></a><span class="lineno"><a class="line" href="structhomme_1_1cslmpi_1_1_csl_mpi_1_1_elem_data.html#a20d179528b738eafd6fc0683446f27b2"> 2582</a></span>&#160;    <a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi_1_1_gid_rank.html">GidRank</a>* <a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi_1_1_elem_data.html#a20d179528b738eafd6fc0683446f27b2">me</a>;                     <span class="comment">// the owned cell</span></div>
<div class="line"><a name="l02583"></a><span class="lineno"><a class="line" href="structhomme_1_1cslmpi_1_1_csl_mpi_1_1_elem_data.html#ad59be946e2883f78cebc3baeb79f0e85"> 2583</a></span>&#160;    <a class="code" href="structhomme_1_1cslmpi_1_1_fixed_cap_list.html">FixedCapList&lt;GidRank&gt;</a> <a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi_1_1_elem_data.html#ad59be946e2883f78cebc3baeb79f0e85">nbrs</a>;      <span class="comment">// the cell&#39;s neighbors (but including me)</span></div>
<div class="line"><a name="l02584"></a><span class="lineno"><a class="line" href="structhomme_1_1cslmpi_1_1_csl_mpi_1_1_elem_data.html#a9807a79ddca5b60f8731f0a2dacb8f4d"> 2584</a></span>&#160;    <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> <a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi_1_1_elem_data.html#a9807a79ddca5b60f8731f0a2dacb8f4d">nin1halo</a>;                    <span class="comment">// nbrs[0:n]</span></div>
<div class="line"><a name="l02585"></a><span class="lineno"><a class="line" href="structhomme_1_1cslmpi_1_1_csl_mpi_1_1_elem_data.html#a64dd85494d0cabdfb6705b4a8c6ddbd3"> 2585</a></span>&#160;    <a class="code" href="structhomme_1_1cslmpi_1_1_fixed_cap_list.html">FixedCapList&lt;OwnItem&gt;</a> <a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi_1_1_elem_data.html#a64dd85494d0cabdfb6705b4a8c6ddbd3">own</a>;       <span class="comment">// points whose q are computed with own rank&#39;s data</span></div>
<div class="line"><a name="l02586"></a><span class="lineno"><a class="line" href="structhomme_1_1cslmpi_1_1_csl_mpi_1_1_elem_data.html#a7a59ae6edeb20124677aca3f8f384fae"> 2586</a></span>&#160;    <a class="code" href="structhomme_1_1cslmpi_1_1_fixed_cap_list.html">FixedCapList&lt;RemoteItem&gt;</a> <a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi_1_1_elem_data.html#a7a59ae6edeb20124677aca3f8f384fae">rmt</a>;    <span class="comment">// points computed by a remote rank&#39;s data</span></div>
<div class="line"><a name="l02587"></a><span class="lineno"><a class="line" href="structhomme_1_1cslmpi_1_1_csl_mpi_1_1_elem_data.html#af4aea612eaa763d5204a7b0ea8efff51"> 2587</a></span>&#160;    <a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#ad93c0e96ca487335f1ed7c474e7e5fd7">IntArray2D</a> <a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi_1_1_elem_data.html#af4aea612eaa763d5204a7b0ea8efff51">src</a>;                  <span class="comment">// src(lev,k) = get_src_cell</span></div>
<div class="line"><a name="l02588"></a><span class="lineno"><a class="line" href="structhomme_1_1cslmpi_1_1_csl_mpi_1_1_elem_data.html#a9aaeebb9910c867d80abb4f688502e5e"> 2588</a></span>&#160;    <a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a139aec4ef20fe08ceb0d29fa65f10941">Array&lt;Real**[2]&gt;</a> <a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi_1_1_elem_data.html#a9aaeebb9910c867d80abb4f688502e5e">q_extrema</a>;</div>
<div class="line"><a name="l02589"></a><span class="lineno"><a class="line" href="structhomme_1_1cslmpi_1_1_csl_mpi_1_1_elem_data.html#a2081c109afff870a5e1de0c87a0e56ca"> 2589</a></span>&#160;    <span class="keyword">const</span> <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a>* <a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi_1_1_elem_data.html#a5b2832d644f5d6ccde1d72e5bb851a09">metdet</a>, * <a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi_1_1_elem_data.html#a904bb892891e8f54b27eb762d3d549df">qdp</a>, * <a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi_1_1_elem_data.html#a2081c109afff870a5e1de0c87a0e56ca">dp</a>; <span class="comment">// the owned cell&#39;s data</span></div>
<div class="line"><a name="l02590"></a><span class="lineno"><a class="line" href="structhomme_1_1cslmpi_1_1_csl_mpi_1_1_elem_data.html#a7c7572e59e980d4715e863294ccb03a9"> 2590</a></span>&#160;    <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a>* <a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi_1_1_elem_data.html#a7c7572e59e980d4715e863294ccb03a9">q</a>;</div>
<div class="line"><a name="l02591"></a><span class="lineno"> 2591</span>&#160;  };</div>
<div class="line"><a name="l02592"></a><span class="lineno"> 2592</span>&#160; </div>
<div class="line"><a name="l02593"></a><span class="lineno"><a class="line" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a09395c121510c776158739ce6fba7c31"> 2593</a></span>&#160;  <span class="keyword">const</span> <a class="code" href="classhomme_1_1mpi_1_1_parallel.html#aff1fe34dd95083421911cd1a89f7191d">mpi::Parallel::Ptr</a> <a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a09395c121510c776158739ce6fba7c31">p</a>;</div>
<div class="line"><a name="l02594"></a><span class="lineno"><a class="line" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#ab10638ab6b28d2d99faf5835ce842a5d"> 2594</a></span>&#160;  <span class="keyword">const</span> <a class="code" href="structslmm_1_1_advecter.html#a14d43ce08c47ea1df937dc1703d195f3">slmm::Advecter::ConstPtr</a> <a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#ab10638ab6b28d2d99faf5835ce842a5d">advecter</a>;</div>
<div class="line"><a name="l02595"></a><span class="lineno"><a class="line" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a27a93b756e637dd27f8383706bf6fa63"> 2595</a></span>&#160;  <span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> <a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#ae61b8439c5232dc4cdcd885d6a6510c2">np</a>, <a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#ac64568d9b4b802315f2228beccaaac70">np2</a>, <a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a3386735d284e9924db14acad99319d25">nlev</a>, <a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a3d22abacf7bd37f0897d406f7566eb3f">qsize</a>, <a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a71baac5c6f1ea673cd37504dd38b7630">qsized</a>, <a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a8d3ead06518816f0985a84be689b0b85">nelemd</a>, <a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a27a93b756e637dd27f8383706bf6fa63">halo</a>;</div>
<div class="line"><a name="l02596"></a><span class="lineno"> 2596</span>&#160; </div>
<div class="line"><a name="l02597"></a><span class="lineno"><a class="line" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a4c8e08ae7a21ce60733abff37c9c5058"> 2597</a></span>&#160;  <a class="code" href="structhomme_1_1cslmpi_1_1_fixed_cap_list.html">FixedCapList&lt;ElemData&gt;</a> <a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a4c8e08ae7a21ce60733abff37c9c5058">ed</a>; <span class="comment">// this rank&#39;s owned cells, indexed by LID</span></div>
<div class="line"><a name="l02598"></a><span class="lineno"> 2598</span>&#160; </div>
<div class="line"><a name="l02599"></a><span class="lineno"> 2599</span>&#160;  <span class="comment">// IDs.</span></div>
<div class="line"><a name="l02600"></a><span class="lineno"><a class="line" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a3f7d02fbb1bf0589c931e6526802c266"> 2600</a></span>&#160;  <a class="code" href="structhomme_1_1cslmpi_1_1_fixed_cap_list.html">FixedCapList&lt;Int&gt;</a> <a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a5402ced381c42ff2808665611c4cc0e0">ranks</a>, <a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#acc05bcbacc077773d31a44fb2900d9f7">nx_in_rank</a>, <a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a3f7d02fbb1bf0589c931e6526802c266">mylid_with_comm</a>, <a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#aac097e860798e529cbc07ea2e643d266">mylid_with_comm_tid_ptr</a>;</div>
<div class="line"><a name="l02601"></a><span class="lineno"><a class="line" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a2bc103fcf1b1213dec73c720334e80a4"> 2601</a></span>&#160;  <a class="code" href="structhomme_1_1cslmpi_1_1_list_of_lists.html">ListOfLists &lt;Int&gt;</a> <a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#aa9071b0582a3ac177ced0dc521e124ad">nx_in_lid</a>, <a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a2bc103fcf1b1213dec73c720334e80a4">lid_on_rank</a>;</div>
<div class="line"><a name="l02602"></a><span class="lineno"><a class="line" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#ac8fa1afe06db413e6dfb8bcd37dec1a7"> 2602</a></span>&#160;  <a class="code" href="structhomme_1_1cslmpi_1_1_buffer_layout_array.html">BufferLayoutArray</a> <a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#ac8fa1afe06db413e6dfb8bcd37dec1a7">bla</a>;</div>
<div class="line"><a name="l02603"></a><span class="lineno"> 2603</span>&#160; </div>
<div class="line"><a name="l02604"></a><span class="lineno"> 2604</span>&#160;  <span class="comment">// MPI comm data.</span></div>
<div class="line"><a name="l02605"></a><span class="lineno"><a class="line" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#ae992f1c83abeae202aa8bbf4010b26bc"> 2605</a></span>&#160;  <a class="code" href="structhomme_1_1cslmpi_1_1_list_of_lists.html">ListOfLists&lt;Real&gt;</a> <a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#adaffbb9ca8a843233389aa2c8b8c5826">sendbuf</a>, <a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#ae992f1c83abeae202aa8bbf4010b26bc">recvbuf</a>;</div>
<div class="line"><a name="l02606"></a><span class="lineno"><a class="line" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#ab52f53a78f20b5ff0d0ad14439eb3bec"> 2606</a></span>&#160;  <a class="code" href="structhomme_1_1cslmpi_1_1_fixed_cap_list.html">FixedCapList&lt;Int&gt;</a> <a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#ab52f53a78f20b5ff0d0ad14439eb3bec">sendcount</a>;</div>
<div class="line"><a name="l02607"></a><span class="lineno"><a class="line" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a610b60e516b4b287caae09bf8834f233"> 2607</a></span>&#160;  <a class="code" href="structhomme_1_1cslmpi_1_1_fixed_cap_list.html">FixedCapList&lt;mpi::Request&gt;</a> <a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a3de780cac76d3359bd90a33c189ea622">sendreq</a>, <a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a610b60e516b4b287caae09bf8834f233">recvreq</a>;</div>
<div class="line"><a name="l02608"></a><span class="lineno"><a class="line" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#ae80c9ada751aa4e59974d6277c56952b"> 2608</a></span>&#160;  <a class="code" href="structhomme_1_1cslmpi_1_1_fixed_cap_list.html">FixedCapList&lt;Int&gt;</a> <a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a370d8de04a4cc9d9e64cf4a3d3b28f94">rmt_xs</a>, <a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#ae80c9ada751aa4e59974d6277c56952b">rmt_qs_extrema</a>, <a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a04bec07079fb55ceea64db025fa69c9c">x_bulkdata_offset</a>;</div>
<div class="line"><a name="l02609"></a><span class="lineno"><a class="line" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a5ed9e9c46d8d446b474544a70bb45622"> 2609</a></span>&#160;  <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> <a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a0eacf20e4f92f3748c742f8360c1e760">nrmt_xs</a>, <a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a5ed9e9c46d8d446b474544a70bb45622">nrmt_qs_extrema</a>;</div>
<div class="line"><a name="l02610"></a><span class="lineno"> 2610</span>&#160; </div>
<div class="line"><a name="l02611"></a><span class="lineno"><a class="line" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a255bf16730546cd00b75a932b8569670"> 2611</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a255bf16730546cd00b75a932b8569670">horiz_openmp</a>;</div>
<div class="line"><a name="l02612"></a><span class="lineno"> 2612</span>&#160;<span class="preprocessor">#ifdef HORIZ_OPENMP</span></div>
<div class="line"><a name="l02613"></a><span class="lineno"> 2613</span>&#160;  <a class="code" href="structhomme_1_1cslmpi_1_1_list_of_lists.html">ListOfLists&lt;omp_lock_t&gt;</a> ri_lidi_locks;</div>
<div class="line"><a name="l02614"></a><span class="lineno"> 2614</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02615"></a><span class="lineno"> 2615</span>&#160; </div>
<div class="line"><a name="l02616"></a><span class="lineno"> 2616</span>&#160;  <span class="comment">// temporary work space</span></div>
<div class="line"><a name="l02617"></a><span class="lineno"><a class="line" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#ae6362eba877446b15f51dc5d6d4ed37e"> 2617</a></span>&#160;  std::vector&lt;Int&gt; <a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#ae6362eba877446b15f51dc5d6d4ed37e">nlid_per_rank</a>, <a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#abdef54045d56d191f36b9fdaf8707f67">sendsz</a>, <a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a9f7fc421d09c34cbcf8f2d2a45b6b0dd">recvsz</a>;</div>
<div class="line"><a name="l02618"></a><span class="lineno"><a class="line" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a5ada77f6e71e2258d711ea2037ad7f47"> 2618</a></span>&#160;  <a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a139aec4ef20fe08ceb0d29fa65f10941">Array&lt;Real**&gt;</a> <a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a5ada77f6e71e2258d711ea2037ad7f47">rwork</a>;</div>
<div class="line"><a name="l02619"></a><span class="lineno"> 2619</span>&#160; </div>
<div class="line"><a name="l02620"></a><span class="lineno"><a class="line" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a4d4cef47264cc7acfc7545cd1be4196e"> 2620</a></span>&#160;  <a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a4d4cef47264cc7acfc7545cd1be4196e">CslMpi</a> (<span class="keyword">const</span> <a class="code" href="classhomme_1_1mpi_1_1_parallel.html#aff1fe34dd95083421911cd1a89f7191d">mpi::Parallel::Ptr</a>&amp; ip, <span class="keyword">const</span> <a class="code" href="structslmm_1_1_advecter.html#a14d43ce08c47ea1df937dc1703d195f3">slmm::Advecter::ConstPtr</a>&amp; <a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#ab10638ab6b28d2d99faf5835ce842a5d">advecter</a>,</div>
<div class="line"><a name="l02621"></a><span class="lineno"> 2621</span>&#160;          <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> inp, <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> inlev, <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> iqsize, <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> iqsized, <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> inelemd, <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> ihalo)</div>
<div class="line"><a name="l02622"></a><span class="lineno"> 2622</span>&#160;    : <a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a09395c121510c776158739ce6fba7c31">p</a>(ip), <a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#ab10638ab6b28d2d99faf5835ce842a5d">advecter</a>(<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#ab10638ab6b28d2d99faf5835ce842a5d">advecter</a>),</div>
<div class="line"><a name="l02623"></a><span class="lineno"> 2623</span>&#160;      <a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#ae61b8439c5232dc4cdcd885d6a6510c2">np</a>(inp), <a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#ac64568d9b4b802315f2228beccaaac70">np2</a>(<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#ae61b8439c5232dc4cdcd885d6a6510c2">np</a>*<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#ae61b8439c5232dc4cdcd885d6a6510c2">np</a>), <a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a3386735d284e9924db14acad99319d25">nlev</a>(inlev), <a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a3d22abacf7bd37f0897d406f7566eb3f">qsize</a>(iqsize), <a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a71baac5c6f1ea673cd37504dd38b7630">qsized</a>(iqsized), <a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a8d3ead06518816f0985a84be689b0b85">nelemd</a>(inelemd),</div>
<div class="line"><a name="l02624"></a><span class="lineno"> 2624</span>&#160;      <a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a27a93b756e637dd27f8383706bf6fa63">halo</a>(ihalo)</div>
<div class="line"><a name="l02625"></a><span class="lineno"> 2625</span>&#160;  {}</div>
<div class="line"><a name="l02626"></a><span class="lineno"> 2626</span>&#160; </div>
<div class="line"><a name="l02627"></a><span class="lineno"><a class="line" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#aba38cec734c8bce04f9b6af93c3788e2"> 2627</a></span>&#160;  <a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#aba38cec734c8bce04f9b6af93c3788e2">~CslMpi</a> () {</div>
<div class="line"><a name="l02628"></a><span class="lineno"> 2628</span>&#160;<span class="preprocessor">#ifdef HORIZ_OPENMP</span></div>
<div class="line"><a name="l02629"></a><span class="lineno"> 2629</span>&#160;    <span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> nrmtrank = <span class="keyword">static_cast&lt;</span><a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a><span class="keyword">&gt;</span>(<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a5402ced381c42ff2808665611c4cc0e0">ranks</a>.<a class="code" href="structhomme_1_1cslmpi_1_1_fixed_cap_list.html#aad4f28cbbbe5499b8e1a60e8d984aa18">n</a>()) - 1;</div>
<div class="line"><a name="l02630"></a><span class="lineno"> 2630</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> ri = 0; ri &lt; nrmtrank; ++ri) {</div>
<div class="line"><a name="l02631"></a><span class="lineno"> 2631</span>&#160;      <span class="keyword">auto</span>&amp;&amp; locks = ri_lidi_locks(ri);</div>
<div class="line"><a name="l02632"></a><span class="lineno"> 2632</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; lock: locks) {</div>
<div class="line"><a name="l02633"></a><span class="lineno"> 2633</span>&#160;        <span class="comment">// The following call is causing a seg fault on at least one Cray KNL</span></div>
<div class="line"><a name="l02634"></a><span class="lineno"> 2634</span>&#160;        <span class="comment">// system. It doesn&#39;t kill the run b/c it occurs after main exits. Not</span></div>
<div class="line"><a name="l02635"></a><span class="lineno"> 2635</span>&#160;        <span class="comment">// calling this is a memory leak, but it&#39;s innocuous in this case. Thus,</span></div>
<div class="line"><a name="l02636"></a><span class="lineno"> 2636</span>&#160;        <span class="comment">// comment it out:</span></div>
<div class="line"><a name="l02637"></a><span class="lineno"> 2637</span>&#160;        <span class="comment">//omp_destroy_lock(&amp;lock);</span></div>
<div class="line"><a name="l02638"></a><span class="lineno"> 2638</span>&#160;        <span class="comment">// It&#39;s possible that something in the OpenMP runtime shuts down before</span></div>
<div class="line"><a name="l02639"></a><span class="lineno"> 2639</span>&#160;        <span class="comment">// this call, and that&#39;s the problem. If that turns out to be it, I</span></div>
<div class="line"><a name="l02640"></a><span class="lineno"> 2640</span>&#160;        <span class="comment">// should make a compose_finalize() call somewhere.</span></div>
<div class="line"><a name="l02641"></a><span class="lineno"> 2641</span>&#160;      }</div>
<div class="line"><a name="l02642"></a><span class="lineno"> 2642</span>&#160;    }</div>
<div class="line"><a name="l02643"></a><span class="lineno"> 2643</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02644"></a><span class="lineno"> 2644</span>&#160;  }</div>
<div class="line"><a name="l02645"></a><span class="lineno"> 2645</span>&#160;};</div>
<div class="line"><a name="l02646"></a><span class="lineno"> 2646</span>&#160; </div>
<div class="line"><a name="l02647"></a><span class="lineno"><a class="line" href="namespacehomme_1_1cslmpi_1_1extend__halo.html"> 2647</a></span>&#160;<span class="keyword">namespace </span>extend_halo {</div>
<div class="line"><a name="l02648"></a><span class="lineno"> 2648</span>&#160;<span class="comment">// Extend halo by one layer. This has two parts: finding neighbor (gid, rank) in</span></div>
<div class="line"><a name="l02649"></a><span class="lineno"> 2649</span>&#160;<span class="comment">// collect_gid_rank, and extending the Advecter local mesh geometry in</span></div>
<div class="line"><a name="l02650"></a><span class="lineno"> 2650</span>&#160;<span class="comment">// extend_local_meshes. The two parts have the same comm pattern: in round 1,</span></div>
<div class="line"><a name="l02651"></a><span class="lineno"> 2651</span>&#160;<span class="comment">// request data for lists of GIDs; in round 2, fulfill these requests.</span></div>
<div class="line"><a name="l02652"></a><span class="lineno"> 2652</span>&#160; </div>
<div class="line"><a name="l02653"></a><span class="lineno"><a class="line" href="namespacehomme_1_1cslmpi_1_1extend__halo.html#a7062e760256f731fb032101dfefd4b84"> 2653</a></span>&#160;<span class="keyword">typedef</span> <a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi_1_1_elem_data.html">CslMpi::ElemData</a> <a class="code" href="namespacehomme_1_1cslmpi_1_1extend__halo.html#a7062e760256f731fb032101dfefd4b84">ElemData</a>;</div>
<div class="line"><a name="l02654"></a><span class="lineno"><a class="line" href="namespacehomme_1_1cslmpi_1_1extend__halo.html#af74e0f8fab9daccac42745e70b4ed933"> 2654</a></span>&#160;<span class="keyword">typedef</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> <a class="code" href="namespacehomme_1_1cslmpi_1_1extend__halo.html#af74e0f8fab9daccac42745e70b4ed933">Gid</a>;</div>
<div class="line"><a name="l02655"></a><span class="lineno"><a class="line" href="namespacehomme_1_1cslmpi_1_1extend__halo.html#a7a12af5e0cfecd81cc5b89f7f0eb5789"> 2655</a></span>&#160;<span class="keyword">typedef</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> <a class="code" href="namespacehomme_1_1cslmpi_1_1extend__halo.html#a7a12af5e0cfecd81cc5b89f7f0eb5789">Rank</a>;</div>
<div class="line"><a name="l02656"></a><span class="lineno"><a class="line" href="structhomme_1_1cslmpi_1_1extend__halo_1_1_gid_rank_pair.html"> 2656</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structhomme_1_1cslmpi_1_1extend__halo_1_1_gid_rank_pair.html">GidRankPair</a> {</div>
<div class="line"><a name="l02657"></a><span class="lineno"><a class="line" href="structhomme_1_1cslmpi_1_1extend__halo_1_1_gid_rank_pair.html#aeb1ccc086803f08a986ae3d9e4c0645a"> 2657</a></span>&#160;  <span class="keyword">const</span> <a class="code" href="namespacehomme_1_1cslmpi_1_1extend__halo.html#af74e0f8fab9daccac42745e70b4ed933">Gid</a> <a class="code" href="structhomme_1_1cslmpi_1_1extend__halo_1_1_gid_rank_pair.html#aeb1ccc086803f08a986ae3d9e4c0645a">gid</a>;</div>
<div class="line"><a name="l02658"></a><span class="lineno"><a class="line" href="structhomme_1_1cslmpi_1_1extend__halo_1_1_gid_rank_pair.html#a4f2d150c137cbf6903826ea04a8998f8"> 2658</a></span>&#160;  <span class="keyword">const</span> <a class="code" href="namespacehomme_1_1cslmpi_1_1extend__halo.html#a7a12af5e0cfecd81cc5b89f7f0eb5789">Rank</a> <a class="code" href="structhomme_1_1cslmpi_1_1extend__halo_1_1_gid_rank_pair.html#a4f2d150c137cbf6903826ea04a8998f8">rank</a>;</div>
<div class="line"><a name="l02659"></a><span class="lineno"><a class="line" href="structhomme_1_1cslmpi_1_1extend__halo_1_1_gid_rank_pair.html#aac48ea68ece7a2824bacdf0687fa0ebf"> 2659</a></span>&#160;  <a class="code" href="structhomme_1_1cslmpi_1_1extend__halo_1_1_gid_rank_pair.html#aac48ea68ece7a2824bacdf0687fa0ebf">GidRankPair</a>(<span class="keyword">const</span> <a class="code" href="namespacehomme_1_1cslmpi_1_1extend__halo.html#af74e0f8fab9daccac42745e70b4ed933">Gid</a>&amp; gid_, <span class="keyword">const</span> <a class="code" href="namespacehomme_1_1cslmpi_1_1extend__halo.html#a7a12af5e0cfecd81cc5b89f7f0eb5789">Rank</a>&amp; rank_) : <a class="code" href="structhomme_1_1cslmpi_1_1extend__halo_1_1_gid_rank_pair.html#aeb1ccc086803f08a986ae3d9e4c0645a">gid</a>(gid_), <a class="code" href="structhomme_1_1cslmpi_1_1extend__halo_1_1_gid_rank_pair.html#a4f2d150c137cbf6903826ea04a8998f8">rank</a>(rank_) {}</div>
<div class="line"><a name="l02660"></a><span class="lineno"><a class="line" href="structhomme_1_1cslmpi_1_1extend__halo_1_1_gid_rank_pair.html#aaa8b9701575e54532bdbf1732827c49a"> 2660</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="structhomme_1_1cslmpi_1_1extend__halo_1_1_gid_rank_pair.html#aaa8b9701575e54532bdbf1732827c49a">operator&lt; </a>(<span class="keyword">const</span> <a class="code" href="structhomme_1_1cslmpi_1_1extend__halo_1_1_gid_rank_pair.html">GidRankPair</a>&amp; o)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l02661"></a><span class="lineno"> 2661</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="structhomme_1_1cslmpi_1_1extend__halo_1_1_gid_rank_pair.html#aeb1ccc086803f08a986ae3d9e4c0645a">gid</a> &lt; o.<a class="code" href="structhomme_1_1cslmpi_1_1extend__halo_1_1_gid_rank_pair.html#aeb1ccc086803f08a986ae3d9e4c0645a">gid</a>) <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02662"></a><span class="lineno"> 2662</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="structhomme_1_1cslmpi_1_1extend__halo_1_1_gid_rank_pair.html#aeb1ccc086803f08a986ae3d9e4c0645a">gid</a> &gt; o.<a class="code" href="structhomme_1_1cslmpi_1_1extend__halo_1_1_gid_rank_pair.html#aeb1ccc086803f08a986ae3d9e4c0645a">gid</a>) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02663"></a><span class="lineno"> 2663</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="structhomme_1_1cslmpi_1_1extend__halo_1_1_gid_rank_pair.html#a4f2d150c137cbf6903826ea04a8998f8">rank</a> &lt; o.<a class="code" href="structhomme_1_1cslmpi_1_1extend__halo_1_1_gid_rank_pair.html#a4f2d150c137cbf6903826ea04a8998f8">rank</a>;</div>
<div class="line"><a name="l02664"></a><span class="lineno"> 2664</span>&#160;  }</div>
<div class="line"><a name="l02665"></a><span class="lineno"> 2665</span>&#160;};</div>
<div class="line"><a name="l02666"></a><span class="lineno"><a class="line" href="namespacehomme_1_1cslmpi_1_1extend__halo.html#a21f7b026fd02325c7eb3c68548ae229e"> 2666</a></span>&#160;<span class="keyword">typedef</span> std::vector&lt;GidRankPair&gt; <a class="code" href="namespacehomme_1_1cslmpi_1_1extend__halo.html#a21f7b026fd02325c7eb3c68548ae229e">GidRankPairs</a>;</div>
<div class="line"><a name="l02667"></a><span class="lineno"><a class="line" href="namespacehomme_1_1cslmpi_1_1extend__halo.html#acaa03db2914deec44a6b375c90731bff"> 2667</a></span>&#160;<span class="keyword">typedef</span> std::map&lt;Gid, GidRankPairs&gt; <a class="code" href="namespacehomme_1_1cslmpi_1_1extend__halo.html#acaa03db2914deec44a6b375c90731bff">Gid2Nbrs</a>;</div>
<div class="line"><a name="l02668"></a><span class="lineno"><a class="line" href="namespacehomme_1_1cslmpi_1_1extend__halo.html#a2de5a7ce5d7b1464dd13aa43727cfab8"> 2668</a></span>&#160;<span class="keyword">typedef</span> std::vector&lt;Int&gt; <a class="code" href="namespacehomme_1_1cslmpi_1_1extend__halo.html#a2de5a7ce5d7b1464dd13aa43727cfab8">IntBuf</a>;</div>
<div class="line"><a name="l02669"></a><span class="lineno"><a class="line" href="namespacehomme_1_1cslmpi_1_1extend__halo.html#a181b8883d547fec1599fce463691e1c9"> 2669</a></span>&#160;<span class="keyword">typedef</span> std::vector&lt;Real&gt; <a class="code" href="namespacehomme_1_1cslmpi_1_1extend__halo.html#a181b8883d547fec1599fce463691e1c9">RealBuf</a>;</div>
<div class="line"><a name="l02670"></a><span class="lineno"> 2670</span>&#160; </div>
<div class="line"><a name="l02671"></a><span class="lineno"><a class="line" href="namespacehomme_1_1cslmpi_1_1extend__halo.html#abfcbff07665accf825719ffd1216844e"> 2671</a></span>&#160;<a class="code" href="namespacehomme_1_1cslmpi_1_1extend__halo.html#a21f7b026fd02325c7eb3c68548ae229e">GidRankPairs</a> <a class="code" href="namespacehomme_1_1cslmpi_1_1extend__halo.html#abfcbff07665accf825719ffd1216844e">all_nbrs_but_me</a> (<span class="keyword">const</span> <a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi_1_1_elem_data.html">ElemData</a>&amp; ed) {</div>
<div class="line"><a name="l02672"></a><span class="lineno"> 2672</span>&#160;  <a class="code" href="namespacehomme_1_1cslmpi_1_1extend__halo.html#a21f7b026fd02325c7eb3c68548ae229e">GidRankPairs</a> gs;</div>
<div class="line"><a name="l02673"></a><span class="lineno"> 2673</span>&#160;  gs.reserve(ed.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi_1_1_elem_data.html#ad59be946e2883f78cebc3baeb79f0e85">nbrs</a>.size() - 1);</div>
<div class="line"><a name="l02674"></a><span class="lineno"> 2674</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; n : ed.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi_1_1_elem_data.html#ad59be946e2883f78cebc3baeb79f0e85">nbrs</a>)</div>
<div class="line"><a name="l02675"></a><span class="lineno"> 2675</span>&#160;    <span class="keywordflow">if</span> (&amp;n != ed.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi_1_1_elem_data.html#a20d179528b738eafd6fc0683446f27b2">me</a>)</div>
<div class="line"><a name="l02676"></a><span class="lineno"> 2676</span>&#160;      gs.push_back(<a class="code" href="structhomme_1_1cslmpi_1_1extend__halo_1_1_gid_rank_pair.html">GidRankPair</a>(n.gid, n.rank));</div>
<div class="line"><a name="l02677"></a><span class="lineno"> 2677</span>&#160;  <span class="keywordflow">return</span> gs;</div>
<div class="line"><a name="l02678"></a><span class="lineno"> 2678</span>&#160;}</div>
<div class="line"><a name="l02679"></a><span class="lineno"> 2679</span>&#160; </div>
<div class="line"><a name="l02680"></a><span class="lineno"><a class="line" href="namespacehomme_1_1cslmpi_1_1extend__halo.html#a23401317c095aa03d286cabe77d4e476"> 2680</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespacehomme_1_1cslmpi_1_1extend__halo.html#a23401317c095aa03d286cabe77d4e476">fill_gid2nbrs</a> (<span class="keyword">const</span> <a class="code" href="classhomme_1_1mpi_1_1_parallel.html">mpi::Parallel</a>&amp; p, <span class="keyword">const</span> <a class="code" href="structhomme_1_1cslmpi_1_1_fixed_cap_list.html">FixedCapList&lt;ElemData&gt;</a>&amp; eds,</div>
<div class="line"><a name="l02681"></a><span class="lineno"> 2681</span>&#160;                    <a class="code" href="namespacehomme_1_1cslmpi_1_1extend__halo.html#acaa03db2914deec44a6b375c90731bff">Gid2Nbrs</a>&amp; gid2nbrs) {</div>
<div class="line"><a name="l02682"></a><span class="lineno"> 2682</span>&#160;  <span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> tag = 6;</div>
<div class="line"><a name="l02683"></a><span class="lineno"> 2683</span>&#160;  <span class="keyword">const</span> <a class="code" href="namespacehomme_1_1cslmpi_1_1extend__halo.html#a7a12af5e0cfecd81cc5b89f7f0eb5789">Rank</a> my_rank = p.<a class="code" href="classhomme_1_1mpi_1_1_parallel.html#ac068d8e0f526dbd3b49c4bcdc23a3c90">rank</a>();</div>
<div class="line"><a name="l02684"></a><span class="lineno"> 2684</span>&#160;  <span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> n_owned = eds.<a class="code" href="structhomme_1_1cslmpi_1_1_fixed_cap_list.html#ad5ac1ee99fc2091a5425a3d4dfade068">size</a>();</div>
<div class="line"><a name="l02685"></a><span class="lineno"> 2685</span>&#160; </div>
<div class="line"><a name="l02686"></a><span class="lineno"> 2686</span>&#160;  <span class="comment">// Fill in the ones we know.</span></div>
<div class="line"><a name="l02687"></a><span class="lineno"> 2687</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; ed : eds) {</div>
<div class="line"><a name="l02688"></a><span class="lineno"> 2688</span>&#160;    <a class="code" href="compose__slmm_8cpp.html#a2912a5cf7e76e41c2ecf69b5c610479d">slmm_assert</a>(ed.me-&gt;rank == my_rank);</div>
<div class="line"><a name="l02689"></a><span class="lineno"> 2689</span>&#160;    gid2nbrs[ed.me-&gt;gid] = <a class="code" href="namespacehomme_1_1cslmpi_1_1extend__halo.html#abfcbff07665accf825719ffd1216844e">all_nbrs_but_me</a>(ed);</div>
<div class="line"><a name="l02690"></a><span class="lineno"> 2690</span>&#160;  }</div>
<div class="line"><a name="l02691"></a><span class="lineno"> 2691</span>&#160; </div>
<div class="line"><a name="l02692"></a><span class="lineno"> 2692</span>&#160;  std::vector&lt;Rank&gt; ranks;</div>
<div class="line"><a name="l02693"></a><span class="lineno"> 2693</span>&#160;  <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> nrank;</div>
<div class="line"><a name="l02694"></a><span class="lineno"> 2694</span>&#160;  std::vector&lt;IntBuf&gt; req_sends, req_recvs;</div>
<div class="line"><a name="l02695"></a><span class="lineno"> 2695</span>&#160;  std::vector&lt;mpi::Request&gt; req_recv_reqs;</div>
<div class="line"><a name="l02696"></a><span class="lineno"> 2696</span>&#160;  {</div>
<div class="line"><a name="l02697"></a><span class="lineno"> 2697</span>&#160;    <span class="comment">// Find the ranks that know the rest.</span></div>
<div class="line"><a name="l02698"></a><span class="lineno"> 2698</span>&#160;    std::map&lt;Rank,Int&gt; rank2rankidx;</div>
<div class="line"><a name="l02699"></a><span class="lineno"> 2699</span>&#160;    std::map&lt;Gid,Rank&gt; needgid2rank;</div>
<div class="line"><a name="l02700"></a><span class="lineno"> 2700</span>&#160;    {</div>
<div class="line"><a name="l02701"></a><span class="lineno"> 2701</span>&#160;      std::set&lt;Rank&gt; unique_ranks;</div>
<div class="line"><a name="l02702"></a><span class="lineno"> 2702</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; item : gid2nbrs)</div>
<div class="line"><a name="l02703"></a><span class="lineno"> 2703</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; n : item.second)</div>
<div class="line"><a name="l02704"></a><span class="lineno"> 2704</span>&#160;          <span class="keywordflow">if</span> (n.rank != my_rank) {</div>
<div class="line"><a name="l02705"></a><span class="lineno"> 2705</span>&#160;            <a class="code" href="compose__slmm_8cpp.html#a2912a5cf7e76e41c2ecf69b5c610479d">slmm_assert</a>(gid2nbrs.find(n.gid) == gid2nbrs.end());</div>
<div class="line"><a name="l02706"></a><span class="lineno"> 2706</span>&#160;            needgid2rank.insert(std::make_pair(n.gid, n.rank));</div>
<div class="line"><a name="l02707"></a><span class="lineno"> 2707</span>&#160;            unique_ranks.insert(n.rank);</div>
<div class="line"><a name="l02708"></a><span class="lineno"> 2708</span>&#160;          }</div>
<div class="line"><a name="l02709"></a><span class="lineno"> 2709</span>&#160;      nrank = unique_ranks.size();</div>
<div class="line"><a name="l02710"></a><span class="lineno"> 2710</span>&#160;      ranks.insert(ranks.begin(), unique_ranks.begin(), unique_ranks.end());</div>
<div class="line"><a name="l02711"></a><span class="lineno"> 2711</span>&#160;      <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> i = 0;</div>
<div class="line"><a name="l02712"></a><span class="lineno"> 2712</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; rank : ranks)</div>
<div class="line"><a name="l02713"></a><span class="lineno"> 2713</span>&#160;        rank2rankidx[rank] = i++;</div>
<div class="line"><a name="l02714"></a><span class="lineno"> 2714</span>&#160;    }</div>
<div class="line"><a name="l02715"></a><span class="lineno"> 2715</span>&#160; </div>
<div class="line"><a name="l02716"></a><span class="lineno"> 2716</span>&#160;    <span class="comment">// Send and receive neighbor queries.</span></div>
<div class="line"><a name="l02717"></a><span class="lineno"> 2717</span>&#160;    <a class="code" href="compose__slmm_8cpp.html#a2912a5cf7e76e41c2ecf69b5c610479d">slmm_assert</a>(ranks.size() == <span class="keyword">static_cast&lt;</span><span class="keywordtype">size_t</span><span class="keyword">&gt;</span>(nrank));</div>
<div class="line"><a name="l02718"></a><span class="lineno"> 2718</span>&#160;    req_sends.resize(nrank);</div>
<div class="line"><a name="l02719"></a><span class="lineno"> 2719</span>&#160;    req_recvs.resize(nrank); req_recv_reqs.resize(nrank);</div>
<div class="line"><a name="l02720"></a><span class="lineno"> 2720</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> i = 0; i &lt; nrank; ++i) {</div>
<div class="line"><a name="l02721"></a><span class="lineno"> 2721</span>&#160;      <span class="keyword">auto</span>&amp; r = req_recvs[i];</div>
<div class="line"><a name="l02722"></a><span class="lineno"> 2722</span>&#160;      r.resize(n_owned+1); <span class="comment">// upper bound on #requests, plus 1 for size datum</span></div>
<div class="line"><a name="l02723"></a><span class="lineno"> 2723</span>&#160;      <a class="code" href="namespacehomme_1_1mpi.html#ad0286e50c3714e7a55f00f9a87c3637e">mpi::irecv</a>(p, r.data(), r.<a class="code" href="classhomme_1_1mpi_1_1_parallel.html#a9251fa1de119f66172b16fbf8e28c005">size</a>(), ranks[i], tag, &amp;req_recv_reqs[i]);</div>
<div class="line"><a name="l02724"></a><span class="lineno"> 2724</span>&#160;      req_sends[i].push_back(0);</div>
<div class="line"><a name="l02725"></a><span class="lineno"> 2725</span>&#160;    }</div>
<div class="line"><a name="l02726"></a><span class="lineno"> 2726</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; item : needgid2rank) {</div>
<div class="line"><a name="l02727"></a><span class="lineno"> 2727</span>&#160;      <span class="keyword">const</span> <span class="keyword">auto</span>&amp; gid = item.first;</div>
<div class="line"><a name="l02728"></a><span class="lineno"> 2728</span>&#160;      <span class="keyword">const</span> <span class="keyword">auto</span>&amp; rank = item.second;</div>
<div class="line"><a name="l02729"></a><span class="lineno"> 2729</span>&#160;      <span class="keyword">const</span> <span class="keyword">auto</span>&amp; it = rank2rankidx.find(rank);</div>
<div class="line"><a name="l02730"></a><span class="lineno"> 2730</span>&#160;      <a class="code" href="compose__slmm_8cpp.html#a2912a5cf7e76e41c2ecf69b5c610479d">slmm_assert</a>(it != rank2rankidx.end());</div>
<div class="line"><a name="l02731"></a><span class="lineno"> 2731</span>&#160;      <span class="keyword">const</span> <span class="keyword">auto</span>&amp; rank_idx = it-&gt;second;</div>
<div class="line"><a name="l02732"></a><span class="lineno"> 2732</span>&#160;      <a class="code" href="compose__slmm_8cpp.html#a2912a5cf7e76e41c2ecf69b5c610479d">slmm_assert</a>(gid2nbrs.find(gid) == gid2nbrs.end());</div>
<div class="line"><a name="l02733"></a><span class="lineno"> 2733</span>&#160;      req_sends[rank_idx].push_back(gid);</div>
<div class="line"><a name="l02734"></a><span class="lineno"> 2734</span>&#160;    }</div>
<div class="line"><a name="l02735"></a><span class="lineno"> 2735</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> i = 0; i &lt; nrank; ++i) {</div>
<div class="line"><a name="l02736"></a><span class="lineno"> 2736</span>&#160;      <span class="keyword">auto</span>&amp; s = req_sends[i];</div>
<div class="line"><a name="l02737"></a><span class="lineno"> 2737</span>&#160;      s[0] = s.size() - 1; <span class="comment">// #gids in request</span></div>
<div class="line"><a name="l02738"></a><span class="lineno"> 2738</span>&#160;      <a class="code" href="namespacehomme_1_1mpi.html#ad8082dcb60fee10aa4100b8bdd436f50">mpi::isend</a>(p, s.data(), s.<a class="code" href="classhomme_1_1mpi_1_1_parallel.html#a9251fa1de119f66172b16fbf8e28c005">size</a>(), ranks[i], tag, <span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l02739"></a><span class="lineno"> 2739</span>&#160;    }</div>
<div class="line"><a name="l02740"></a><span class="lineno"> 2740</span>&#160;  }</div>
<div class="line"><a name="l02741"></a><span class="lineno"> 2741</span>&#160; </div>
<div class="line"><a name="l02742"></a><span class="lineno"> 2742</span>&#160;  <span class="comment">// Fullfill queries and receive answers to our queries.</span></div>
<div class="line"><a name="l02743"></a><span class="lineno"> 2743</span>&#160;  std::vector&lt;IntBuf&gt; nbr_sends(nrank), nbr_recvs(nrank);</div>
<div class="line"><a name="l02744"></a><span class="lineno"> 2744</span>&#160;  std::vector&lt;mpi::Request&gt; nbr_send_reqs(nrank), nbr_recv_reqs(nrank);</div>
<div class="line"><a name="l02745"></a><span class="lineno"> 2745</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> i = 0; i &lt; nrank; ++i) {</div>
<div class="line"><a name="l02746"></a><span class="lineno"> 2746</span>&#160;    <span class="keyword">auto</span>&amp; r = nbr_recvs[i];</div>
<div class="line"><a name="l02747"></a><span class="lineno"> 2747</span>&#160;    <span class="comment">// 20 is from dimensions_mod::set_mesh_dimensions; factor of 2 is to get</span></div>
<div class="line"><a name="l02748"></a><span class="lineno"> 2748</span>&#160;    <span class="comment">// (gid,rank); 1 is for size datum.</span></div>
<div class="line"><a name="l02749"></a><span class="lineno"> 2749</span>&#160;    r.resize((20*2 + 1)*(req_sends[i].size() - 1));</div>
<div class="line"><a name="l02750"></a><span class="lineno"> 2750</span>&#160;    <a class="code" href="namespacehomme_1_1mpi.html#ad0286e50c3714e7a55f00f9a87c3637e">mpi::irecv</a>(p, r.data(), r.<a class="code" href="classhomme_1_1mpi_1_1_parallel.html#a9251fa1de119f66172b16fbf8e28c005">size</a>(), ranks[i], tag, &amp;nbr_recv_reqs[i]);</div>
<div class="line"><a name="l02751"></a><span class="lineno"> 2751</span>&#160;  }</div>
<div class="line"><a name="l02752"></a><span class="lineno"> 2752</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> <a class="code" href="namespacebaroclinic__wave.html#a8619f63e6dd6db1077c1a18788afa359">k</a> = 0; <a class="code" href="namespacebaroclinic__wave.html#a8619f63e6dd6db1077c1a18788afa359">k</a> &lt; nrank; ++<a class="code" href="namespacebaroclinic__wave.html#a8619f63e6dd6db1077c1a18788afa359">k</a>) {</div>
<div class="line"><a name="l02753"></a><span class="lineno"> 2753</span>&#160;    <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> i;</div>
<div class="line"><a name="l02754"></a><span class="lineno"> 2754</span>&#160;    <a class="code" href="namespacehomme_1_1mpi.html#a82d35837b534382faf656df6413b3e23">mpi::waitany</a>(nrank, req_recv_reqs.data(), &amp;i);</div>
<div class="line"><a name="l02755"></a><span class="lineno"> 2755</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span>&amp; r = req_recvs[i];</div>
<div class="line"><a name="l02756"></a><span class="lineno"> 2756</span>&#160;    <span class="keyword">auto</span>&amp; s = nbr_sends[i];</div>
<div class="line"><a name="l02757"></a><span class="lineno"> 2757</span>&#160;    <span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> ngid = r[0];</div>
<div class="line"><a name="l02758"></a><span class="lineno"> 2758</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> j = 0; j &lt; ngid; ++j) {</div>
<div class="line"><a name="l02759"></a><span class="lineno"> 2759</span>&#160;      <span class="keyword">const</span> <span class="keyword">auto</span> gid = r[j+1];</div>
<div class="line"><a name="l02760"></a><span class="lineno"> 2760</span>&#160;      <span class="keyword">const</span> <span class="keyword">auto</span> it = gid2nbrs.find(gid);</div>
<div class="line"><a name="l02761"></a><span class="lineno"> 2761</span>&#160;      <a class="code" href="compose__slmm_8cpp.html#a2912a5cf7e76e41c2ecf69b5c610479d">slmm_assert</a>(it != gid2nbrs.end());</div>
<div class="line"><a name="l02762"></a><span class="lineno"> 2762</span>&#160;      <span class="keyword">const</span> <span class="keyword">auto</span>&amp; nbrs = it-&gt;second;</div>
<div class="line"><a name="l02763"></a><span class="lineno"> 2763</span>&#160;      s.push_back(nbrs.size());</div>
<div class="line"><a name="l02764"></a><span class="lineno"> 2764</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; n : nbrs) {</div>
<div class="line"><a name="l02765"></a><span class="lineno"> 2765</span>&#160;        s.push_back(n.gid);</div>
<div class="line"><a name="l02766"></a><span class="lineno"> 2766</span>&#160;        s.push_back(n.rank);</div>
<div class="line"><a name="l02767"></a><span class="lineno"> 2767</span>&#160;      }</div>
<div class="line"><a name="l02768"></a><span class="lineno"> 2768</span>&#160;    }</div>
<div class="line"><a name="l02769"></a><span class="lineno"> 2769</span>&#160;    <a class="code" href="namespacehomme_1_1mpi.html#ad8082dcb60fee10aa4100b8bdd436f50">mpi::isend</a>(p, s.data(), s.<a class="code" href="classhomme_1_1mpi_1_1_parallel.html#a9251fa1de119f66172b16fbf8e28c005">size</a>(), ranks[i], tag, &amp;nbr_send_reqs[i]);</div>
<div class="line"><a name="l02770"></a><span class="lineno"> 2770</span>&#160;  }</div>
<div class="line"><a name="l02771"></a><span class="lineno"> 2771</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> j = 0; j &lt; nrank; ++j) {</div>
<div class="line"><a name="l02772"></a><span class="lineno"> 2772</span>&#160;    <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> i;</div>
<div class="line"><a name="l02773"></a><span class="lineno"> 2773</span>&#160;    <a class="code" href="namespacehomme_1_1mpi.html#a82d35837b534382faf656df6413b3e23">mpi::waitany</a>(nrank, nbr_recv_reqs.data(), &amp;i);</div>
<div class="line"><a name="l02774"></a><span class="lineno"> 2774</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span>&amp; s = req_sends[i];</div>
<div class="line"><a name="l02775"></a><span class="lineno"> 2775</span>&#160;    <span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> nrequested = s.size() - 1;</div>
<div class="line"><a name="l02776"></a><span class="lineno"> 2776</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span>&amp; r = nbr_recvs[i];</div>
<div class="line"><a name="l02777"></a><span class="lineno"> 2777</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> si = 0, ri = 0; si &lt; nrequested; ++si) {</div>
<div class="line"><a name="l02778"></a><span class="lineno"> 2778</span>&#160;      <span class="keyword">const</span> <a class="code" href="namespacehomme_1_1cslmpi_1_1extend__halo.html#af74e0f8fab9daccac42745e70b4ed933">Gid</a> gid = s[si+1];</div>
<div class="line"><a name="l02779"></a><span class="lineno"> 2779</span>&#160;      <span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> nnbr = r[ri++];</div>
<div class="line"><a name="l02780"></a><span class="lineno"> 2780</span>&#160;      <a class="code" href="namespacehomme_1_1cslmpi_1_1extend__halo.html#a21f7b026fd02325c7eb3c68548ae229e">GidRankPairs</a> nbrs;</div>
<div class="line"><a name="l02781"></a><span class="lineno"> 2781</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> ni = 0; ni &lt; nnbr; ++ni, ri += 2)</div>
<div class="line"><a name="l02782"></a><span class="lineno"> 2782</span>&#160;        nbrs.push_back(<a class="code" href="structhomme_1_1cslmpi_1_1extend__halo_1_1_gid_rank_pair.html">GidRankPair</a>(r[ri], r[ri+1]));</div>
<div class="line"><a name="l02783"></a><span class="lineno"> 2783</span>&#160;      <a class="code" href="compose__slmm_8cpp.html#a2912a5cf7e76e41c2ecf69b5c610479d">slmm_assert</a>(gid2nbrs.find(gid) == gid2nbrs.end());</div>
<div class="line"><a name="l02784"></a><span class="lineno"> 2784</span>&#160;      gid2nbrs.insert(std::make_pair(gid, nbrs));</div>
<div class="line"><a name="l02785"></a><span class="lineno"> 2785</span>&#160;    }</div>
<div class="line"><a name="l02786"></a><span class="lineno"> 2786</span>&#160;  }</div>
<div class="line"><a name="l02787"></a><span class="lineno"> 2787</span>&#160;  <a class="code" href="namespacehomme_1_1mpi.html#a34f40c3b1676af66d3ee317213118a1a">mpi::waitall</a>(nbr_send_reqs.size(), nbr_send_reqs.data());</div>
<div class="line"><a name="l02788"></a><span class="lineno"> 2788</span>&#160;}</div>
<div class="line"><a name="l02789"></a><span class="lineno"> 2789</span>&#160; </div>
<div class="line"><a name="l02790"></a><span class="lineno"><a class="line" href="namespacehomme_1_1cslmpi_1_1extend__halo.html#ae58d6b3452c7322905e678d0af436744"> 2790</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespacehomme_1_1cslmpi_1_1extend__halo.html#ae58d6b3452c7322905e678d0af436744">extend_nbrs</a> (<span class="keyword">const</span> <a class="code" href="namespacehomme_1_1cslmpi_1_1extend__halo.html#acaa03db2914deec44a6b375c90731bff">Gid2Nbrs</a>&amp; gid2nbrs, <a class="code" href="structhomme_1_1cslmpi_1_1_fixed_cap_list.html">FixedCapList&lt;ElemData&gt;</a>&amp; eds) {</div>
<div class="line"><a name="l02791"></a><span class="lineno"> 2791</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; ed : eds) {</div>
<div class="line"><a name="l02792"></a><span class="lineno"> 2792</span>&#160;    <span class="comment">// Get all &lt;=2-halo neighbors.</span></div>
<div class="line"><a name="l02793"></a><span class="lineno"> 2793</span>&#160;    std::set&lt;GidRankPair&gt; new_nbrs;</div>
<div class="line"><a name="l02794"></a><span class="lineno"> 2794</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; n : ed.nbrs) {</div>
<div class="line"><a name="l02795"></a><span class="lineno"> 2795</span>&#160;      <span class="keywordflow">if</span> (&amp;n == ed.me) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02796"></a><span class="lineno"> 2796</span>&#160;      <span class="keyword">const</span> <span class="keyword">auto</span>&amp; it = gid2nbrs.find(n.gid);</div>
<div class="line"><a name="l02797"></a><span class="lineno"> 2797</span>&#160;      <a class="code" href="compose__slmm_8cpp.html#a2912a5cf7e76e41c2ecf69b5c610479d">slmm_assert</a>(it != gid2nbrs.end());</div>
<div class="line"><a name="l02798"></a><span class="lineno"> 2798</span>&#160;      <span class="keyword">const</span> <span class="keyword">auto</span>&amp; gid_nbrs = it-&gt;second;</div>
<div class="line"><a name="l02799"></a><span class="lineno"> 2799</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; gn : gid_nbrs)</div>
<div class="line"><a name="l02800"></a><span class="lineno"> 2800</span>&#160;        new_nbrs.insert(gn);</div>
<div class="line"><a name="l02801"></a><span class="lineno"> 2801</span>&#160;    }</div>
<div class="line"><a name="l02802"></a><span class="lineno"> 2802</span>&#160;    <span class="comment">// Remove the already known ones.</span></div>
<div class="line"><a name="l02803"></a><span class="lineno"> 2803</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; n : ed.nbrs)</div>
<div class="line"><a name="l02804"></a><span class="lineno"> 2804</span>&#160;      new_nbrs.erase(<a class="code" href="structhomme_1_1cslmpi_1_1extend__halo_1_1_gid_rank_pair.html">GidRankPair</a>(n.gid, n.rank));</div>
<div class="line"><a name="l02805"></a><span class="lineno"> 2805</span>&#160;    <span class="comment">// Find me b/c of the pointer reset.</span></div>
<div class="line"><a name="l02806"></a><span class="lineno"> 2806</span>&#160;    <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> me = -1;</div>
<div class="line"><a name="l02807"></a><span class="lineno"> 2807</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> i = 0; i &lt; ed.nbrs.size(); ++i)</div>
<div class="line"><a name="l02808"></a><span class="lineno"> 2808</span>&#160;      <span class="keywordflow">if</span> (&amp;ed.nbrs(i) == ed.me) {</div>
<div class="line"><a name="l02809"></a><span class="lineno"> 2809</span>&#160;        me = i;</div>
<div class="line"><a name="l02810"></a><span class="lineno"> 2810</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02811"></a><span class="lineno"> 2811</span>&#160;      }</div>
<div class="line"><a name="l02812"></a><span class="lineno"> 2812</span>&#160;    <a class="code" href="compose__slmm_8cpp.html#a2912a5cf7e76e41c2ecf69b5c610479d">slmm_assert</a>(me &gt;= 0);</div>
<div class="line"><a name="l02813"></a><span class="lineno"> 2813</span>&#160;    <span class="comment">// Append the, now only new, 2-halo ones.</span></div>
<div class="line"><a name="l02814"></a><span class="lineno"> 2814</span>&#160;    <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> i = ed.nbrs.size();</div>
<div class="line"><a name="l02815"></a><span class="lineno"> 2815</span>&#160;    ed.nbrs.reset_capacity(i + new_nbrs.size(), <span class="keyword">true</span>);</div>
<div class="line"><a name="l02816"></a><span class="lineno"> 2816</span>&#160;    ed.me = &amp;ed.nbrs(me);</div>
<div class="line"><a name="l02817"></a><span class="lineno"> 2817</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; n : new_nbrs) {</div>
<div class="line"><a name="l02818"></a><span class="lineno"> 2818</span>&#160;      <span class="keyword">auto</span>&amp; en = ed.nbrs(i++);</div>
<div class="line"><a name="l02819"></a><span class="lineno"> 2819</span>&#160;      en.gid = n.gid;</div>
<div class="line"><a name="l02820"></a><span class="lineno"> 2820</span>&#160;      en.rank = n.rank;</div>
<div class="line"><a name="l02821"></a><span class="lineno"> 2821</span>&#160;      en.rank_idx = -1;</div>
<div class="line"><a name="l02822"></a><span class="lineno"> 2822</span>&#160;      en.lid_on_rank = -1;</div>
<div class="line"><a name="l02823"></a><span class="lineno"> 2823</span>&#160;      en.lid_on_rank_idx = -1;</div>
<div class="line"><a name="l02824"></a><span class="lineno"> 2824</span>&#160;    }</div>
<div class="line"><a name="l02825"></a><span class="lineno"> 2825</span>&#160;  }</div>
<div class="line"><a name="l02826"></a><span class="lineno"> 2826</span>&#160;}</div>
<div class="line"><a name="l02827"></a><span class="lineno"> 2827</span>&#160; </div>
<div class="line"><a name="l02828"></a><span class="lineno"><a class="line" href="namespacehomme_1_1cslmpi_1_1extend__halo.html#a0b28bfb437f4357677305e49b682e9b6"> 2828</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespacehomme_1_1cslmpi_1_1extend__halo.html#a0b28bfb437f4357677305e49b682e9b6">collect_gid_rank</a> (<span class="keyword">const</span> <a class="code" href="classhomme_1_1mpi_1_1_parallel.html">mpi::Parallel</a>&amp; p, <a class="code" href="structhomme_1_1cslmpi_1_1_fixed_cap_list.html">FixedCapList&lt;ElemData&gt;</a>&amp; eds) {</div>
<div class="line"><a name="l02829"></a><span class="lineno"> 2829</span>&#160;  <a class="code" href="namespacehomme_1_1cslmpi_1_1extend__halo.html#acaa03db2914deec44a6b375c90731bff">Gid2Nbrs</a> gid2nbrs;</div>
<div class="line"><a name="l02830"></a><span class="lineno"> 2830</span>&#160;  <a class="code" href="namespacehomme_1_1cslmpi_1_1extend__halo.html#a23401317c095aa03d286cabe77d4e476">fill_gid2nbrs</a>(p, eds, gid2nbrs);</div>
<div class="line"><a name="l02831"></a><span class="lineno"> 2831</span>&#160;  <a class="code" href="namespacehomme_1_1cslmpi_1_1extend__halo.html#ae58d6b3452c7322905e678d0af436744">extend_nbrs</a>(gid2nbrs, eds);</div>
<div class="line"><a name="l02832"></a><span class="lineno"> 2832</span>&#160;}</div>
<div class="line"><a name="l02833"></a><span class="lineno"> 2833</span>&#160; </div>
<div class="line"><a name="l02834"></a><span class="lineno"><a class="line" href="namespacehomme_1_1cslmpi_1_1extend__halo.html#a16cf7ddbd04658463839e82fb8244824"> 2834</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespacehomme_1_1cslmpi_1_1extend__halo.html#a16cf7ddbd04658463839e82fb8244824">extend_local_meshes</a> (<span class="keyword">const</span> <a class="code" href="classhomme_1_1mpi_1_1_parallel.html">mpi::Parallel</a>&amp; p, <span class="keyword">const</span> <a class="code" href="structhomme_1_1cslmpi_1_1_fixed_cap_list.html">FixedCapList&lt;ElemData&gt;</a>&amp; eds,</div>
<div class="line"><a name="l02835"></a><span class="lineno"> 2835</span>&#160;                          <a class="code" href="structslmm_1_1_advecter.html">slmm::Advecter</a>&amp; advecter) {</div>
<div class="line"><a name="l02836"></a><span class="lineno"> 2836</span>&#160;  <span class="keyword">using</span> <a class="code" href="namespacesiqk.html#aef983887889243999a1d7ddea864ad1f">slmm::slice</a>;</div>
<div class="line"><a name="l02837"></a><span class="lineno"> 2837</span>&#160;  <span class="keyword">using</span> <a class="code" href="namespacesiqk.html#a3f1b5069fc1ac06e18aa603b592403e6">slmm::nslices</a>;</div>
<div class="line"><a name="l02838"></a><span class="lineno"> 2838</span>&#160;  <span class="keyword">using</span> <a class="code" href="namespacesiqk.html#a6c43ff2c83ad6b7d0dc61c2c5e83a680">slmm::szslice</a>;</div>
<div class="line"><a name="l02839"></a><span class="lineno"> 2839</span>&#160;  <span class="keyword">using</span> <a class="code" href="namespaceslmm.html#aae47f57e3c25fdbca5ac4c99101905c0">slmm::len</a>;</div>
<div class="line"><a name="l02840"></a><span class="lineno"> 2840</span>&#160;  <span class="keyword">using</span> <a class="code" href="structslmm_1_1_local_mesh.html">slmm::LocalMesh</a>;</div>
<div class="line"><a name="l02841"></a><span class="lineno"> 2841</span>&#160;  <span class="keyword">using</span> RealArray3 = ko::View&lt;Real***, ko::HostSpace&gt;;</div>
<div class="line"><a name="l02842"></a><span class="lineno"> 2842</span>&#160; </div>
<div class="line"><a name="l02843"></a><span class="lineno"> 2843</span>&#160;  <span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> tag = 24;</div>
<div class="line"><a name="l02844"></a><span class="lineno"> 2844</span>&#160;  <span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> my_rank = p.<a class="code" href="classhomme_1_1mpi_1_1_parallel.html#ac068d8e0f526dbd3b49c4bcdc23a3c90">rank</a>();</div>
<div class="line"><a name="l02845"></a><span class="lineno"> 2845</span>&#160;  <span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> n_owned = eds.<a class="code" href="structhomme_1_1cslmpi_1_1_fixed_cap_list.html#ad5ac1ee99fc2091a5425a3d4dfade068">size</a>();</div>
<div class="line"><a name="l02846"></a><span class="lineno"> 2846</span>&#160; </div>
<div class="line"><a name="l02847"></a><span class="lineno"> 2847</span>&#160;  RealArray3 corners;</div>
<div class="line"><a name="l02848"></a><span class="lineno"> 2848</span>&#160;  std::map&lt;Gid,Int&gt; owngid2lid, rmtgid2idx;</div>
<div class="line"><a name="l02849"></a><span class="lineno"> 2849</span>&#160;  {</div>
<div class="line"><a name="l02850"></a><span class="lineno"> 2850</span>&#160;    <span class="comment">// Find relevant ranks.</span></div>
<div class="line"><a name="l02851"></a><span class="lineno"> 2851</span>&#160;    std::vector&lt;Int&gt; ranks;</div>
<div class="line"><a name="l02852"></a><span class="lineno"> 2852</span>&#160;    <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> nrank;</div>
<div class="line"><a name="l02853"></a><span class="lineno"> 2853</span>&#160;    std::vector&lt;IntBuf&gt; req_sends, req_recvs;</div>
<div class="line"><a name="l02854"></a><span class="lineno"> 2854</span>&#160;    std::vector&lt;mpi::Request&gt; req_recv_reqs;</div>
<div class="line"><a name="l02855"></a><span class="lineno"> 2855</span>&#160;    {</div>
<div class="line"><a name="l02856"></a><span class="lineno"> 2856</span>&#160;      std::map&lt;Int,Int&gt; rank2rankidx;</div>
<div class="line"><a name="l02857"></a><span class="lineno"> 2857</span>&#160;      {</div>
<div class="line"><a name="l02858"></a><span class="lineno"> 2858</span>&#160;        std::set&lt;Int&gt; uranks;</div>
<div class="line"><a name="l02859"></a><span class="lineno"> 2859</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; ed : eds)</div>
<div class="line"><a name="l02860"></a><span class="lineno"> 2860</span>&#160;          <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; n : ed.nbrs)</div>
<div class="line"><a name="l02861"></a><span class="lineno"> 2861</span>&#160;            uranks.insert(n.rank);</div>
<div class="line"><a name="l02862"></a><span class="lineno"> 2862</span>&#160;        uranks.erase(my_rank);</div>
<div class="line"><a name="l02863"></a><span class="lineno"> 2863</span>&#160;        ranks.insert(ranks.begin(), uranks.begin(), uranks.end());</div>
<div class="line"><a name="l02864"></a><span class="lineno"> 2864</span>&#160;        nrank = ranks.size();</div>
<div class="line"><a name="l02865"></a><span class="lineno"> 2865</span>&#160;        <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> i = 0;</div>
<div class="line"><a name="l02866"></a><span class="lineno"> 2866</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; rank : ranks)</div>
<div class="line"><a name="l02867"></a><span class="lineno"> 2867</span>&#160;          rank2rankidx[rank] = i++;</div>
<div class="line"><a name="l02868"></a><span class="lineno"> 2868</span>&#160;      }</div>
<div class="line"><a name="l02869"></a><span class="lineno"> 2869</span>&#160; </div>
<div class="line"><a name="l02870"></a><span class="lineno"> 2870</span>&#160;      <span class="comment">// Trade requests.</span></div>
<div class="line"><a name="l02871"></a><span class="lineno"> 2871</span>&#160;      req_sends.resize(nrank); req_recvs.resize(nrank);</div>
<div class="line"><a name="l02872"></a><span class="lineno"> 2872</span>&#160;      req_recv_reqs.resize(nrank);</div>
<div class="line"><a name="l02873"></a><span class="lineno"> 2873</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> i = 0; i &lt; nrank; ++i) { <span class="comment">// Set up recvs.</span></div>
<div class="line"><a name="l02874"></a><span class="lineno"> 2874</span>&#160;        <span class="keyword">auto</span>&amp; r = req_recvs[i];</div>
<div class="line"><a name="l02875"></a><span class="lineno"> 2875</span>&#160;        r.resize(n_owned+1);</div>
<div class="line"><a name="l02876"></a><span class="lineno"> 2876</span>&#160;        <a class="code" href="namespacehomme_1_1mpi.html#ad0286e50c3714e7a55f00f9a87c3637e">mpi::irecv</a>(p, r.data(), r.<a class="code" href="classhomme_1_1mpi_1_1_parallel.html#a9251fa1de119f66172b16fbf8e28c005">size</a>(), ranks[i], tag, &amp;req_recv_reqs[i]);</div>
<div class="line"><a name="l02877"></a><span class="lineno"> 2877</span>&#160;      }</div>
<div class="line"><a name="l02878"></a><span class="lineno"> 2878</span>&#160;      std::set&lt;Gid&gt; unique_rmtgids;</div>
<div class="line"><a name="l02879"></a><span class="lineno"> 2879</span>&#160;      { <span class="comment">// Collect the remote GIDs by rank.</span></div>
<div class="line"><a name="l02880"></a><span class="lineno"> 2880</span>&#160;        std::vector&lt;std::set&lt;Gid&gt; &gt; req_gids(nrank);</div>
<div class="line"><a name="l02881"></a><span class="lineno"> 2881</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; ed : eds)</div>
<div class="line"><a name="l02882"></a><span class="lineno"> 2882</span>&#160;          <span class="keywordflow">for</span> (<a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> i = ed.nin1halo; i &lt; ed.nbrs.size(); ++i) {</div>
<div class="line"><a name="l02883"></a><span class="lineno"> 2883</span>&#160;            <span class="keyword">const</span> <span class="keyword">auto</span>&amp; n = ed.nbrs(i);</div>
<div class="line"><a name="l02884"></a><span class="lineno"> 2884</span>&#160;            <span class="keywordflow">if</span> (n.rank != my_rank) {</div>
<div class="line"><a name="l02885"></a><span class="lineno"> 2885</span>&#160;              req_gids[rank2rankidx[n.rank]].insert(n.gid);</div>
<div class="line"><a name="l02886"></a><span class="lineno"> 2886</span>&#160;              unique_rmtgids.insert(n.gid);</div>
<div class="line"><a name="l02887"></a><span class="lineno"> 2887</span>&#160;            }</div>
<div class="line"><a name="l02888"></a><span class="lineno"> 2888</span>&#160;          }</div>
<div class="line"><a name="l02889"></a><span class="lineno"> 2889</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> i = 0; i &lt; nrank; ++i) { <span class="comment">// Set up sends.</span></div>
<div class="line"><a name="l02890"></a><span class="lineno"> 2890</span>&#160;          <span class="keyword">auto</span>&amp; s = req_sends[i];</div>
<div class="line"><a name="l02891"></a><span class="lineno"> 2891</span>&#160;          s.push_back(0);</div>
<div class="line"><a name="l02892"></a><span class="lineno"> 2892</span>&#160;          s.insert(s.end(), req_gids[i].begin(), req_gids[i].end());</div>
<div class="line"><a name="l02893"></a><span class="lineno"> 2893</span>&#160;          s[0] = s.size() - 1;</div>
<div class="line"><a name="l02894"></a><span class="lineno"> 2894</span>&#160;          <a class="code" href="namespacehomme_1_1mpi.html#ad8082dcb60fee10aa4100b8bdd436f50">mpi::isend</a>(p, s.data(), s.<a class="code" href="classhomme_1_1mpi_1_1_parallel.html#a9251fa1de119f66172b16fbf8e28c005">size</a>(), ranks[i], tag, <span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l02895"></a><span class="lineno"> 2895</span>&#160;        }</div>
<div class="line"><a name="l02896"></a><span class="lineno"> 2896</span>&#160;        <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> i = 0;</div>
<div class="line"><a name="l02897"></a><span class="lineno"> 2897</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; gid : unique_rmtgids)</div>
<div class="line"><a name="l02898"></a><span class="lineno"> 2898</span>&#160;          rmtgid2idx[gid] = i++;</div>
<div class="line"><a name="l02899"></a><span class="lineno"> 2899</span>&#160;      }</div>
<div class="line"><a name="l02900"></a><span class="lineno"> 2900</span>&#160;    }</div>
<div class="line"><a name="l02901"></a><span class="lineno"> 2901</span>&#160; </div>
<div class="line"><a name="l02902"></a><span class="lineno"> 2902</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> i = 0; i &lt; eds.<a class="code" href="structhomme_1_1cslmpi_1_1_fixed_cap_list.html#ad5ac1ee99fc2091a5425a3d4dfade068">size</a>(); ++i) {</div>
<div class="line"><a name="l02903"></a><span class="lineno"> 2903</span>&#160;      <span class="keyword">const</span> <a class="code" href="namespacehomme_1_1cslmpi_1_1extend__halo.html#af74e0f8fab9daccac42745e70b4ed933">Gid</a> gid = eds(i).me-&gt;gid;</div>
<div class="line"><a name="l02904"></a><span class="lineno"> 2904</span>&#160;      owngid2lid[gid] = i;</div>
<div class="line"><a name="l02905"></a><span class="lineno"> 2905</span>&#160;    }</div>
<div class="line"><a name="l02906"></a><span class="lineno"> 2906</span>&#160; </div>
<div class="line"><a name="l02907"></a><span class="lineno"> 2907</span>&#160;    <span class="comment">// Fulfill our requests and obtain the data in reply to ours.</span></div>
<div class="line"><a name="l02908"></a><span class="lineno"> 2908</span>&#160;    std::vector&lt;RealBuf&gt; geo_recvs(nrank), geo_sends(nrank);</div>
<div class="line"><a name="l02909"></a><span class="lineno"> 2909</span>&#160;    std::vector&lt;mpi::Request&gt; geo_recv_reqs(nrank), geo_send_reqs(nrank);</div>
<div class="line"><a name="l02910"></a><span class="lineno"> 2910</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> i = 0; i &lt; nrank; ++i) {</div>
<div class="line"><a name="l02911"></a><span class="lineno"> 2911</span>&#160;      <span class="keyword">auto</span>&amp; r = geo_recvs[i];</div>
<div class="line"><a name="l02912"></a><span class="lineno"> 2912</span>&#160;      r.resize(12*(req_sends[i].size() - 1)); <span class="comment">// 4 vertices x 3 dimensions</span></div>
<div class="line"><a name="l02913"></a><span class="lineno"> 2913</span>&#160;      <a class="code" href="namespacehomme_1_1mpi.html#ad0286e50c3714e7a55f00f9a87c3637e">mpi::irecv</a>(p, r.data(), r.<a class="code" href="classhomme_1_1mpi_1_1_parallel.html#a9251fa1de119f66172b16fbf8e28c005">size</a>(), ranks[i], tag, &amp;geo_recv_reqs[i]);</div>
<div class="line"><a name="l02914"></a><span class="lineno"> 2914</span>&#160;    }</div>
<div class="line"><a name="l02915"></a><span class="lineno"> 2915</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> <a class="code" href="namespacebaroclinic__wave.html#a8619f63e6dd6db1077c1a18788afa359">k</a> = 0; <a class="code" href="namespacebaroclinic__wave.html#a8619f63e6dd6db1077c1a18788afa359">k</a> &lt; nrank; ++<a class="code" href="namespacebaroclinic__wave.html#a8619f63e6dd6db1077c1a18788afa359">k</a>) { <span class="comment">// Pack cell corner points for requesters.</span></div>
<div class="line"><a name="l02916"></a><span class="lineno"> 2916</span>&#160;      <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> i;</div>
<div class="line"><a name="l02917"></a><span class="lineno"> 2917</span>&#160;      <a class="code" href="namespacehomme_1_1mpi.html#a82d35837b534382faf656df6413b3e23">mpi::waitany</a>(nrank, req_recv_reqs.data(), &amp;i);</div>
<div class="line"><a name="l02918"></a><span class="lineno"> 2918</span>&#160;      <span class="keyword">const</span> <span class="keyword">auto</span>&amp; r = req_recvs[i];</div>
<div class="line"><a name="l02919"></a><span class="lineno"> 2919</span>&#160;      <span class="keyword">auto</span>&amp; s = geo_sends[i];</div>
<div class="line"><a name="l02920"></a><span class="lineno"> 2920</span>&#160;      <span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> ngid = r[0];</div>
<div class="line"><a name="l02921"></a><span class="lineno"> 2921</span>&#160;      s.resize(12*ngid);</div>
<div class="line"><a name="l02922"></a><span class="lineno"> 2922</span>&#160;      <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> si = 0;</div>
<div class="line"><a name="l02923"></a><span class="lineno"> 2923</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> j = 0; j &lt; ngid; ++j) {</div>
<div class="line"><a name="l02924"></a><span class="lineno"> 2924</span>&#160;        <span class="keyword">const</span> <span class="keyword">auto</span> gid = r[j+1];</div>
<div class="line"><a name="l02925"></a><span class="lineno"> 2925</span>&#160;        <span class="keyword">const</span> <span class="keyword">auto</span> it = owngid2lid.find(gid);</div>
<div class="line"><a name="l02926"></a><span class="lineno"> 2926</span>&#160;        <a class="code" href="compose__slmm_8cpp.html#a2912a5cf7e76e41c2ecf69b5c610479d">slmm_assert</a>(it != owngid2lid.end());</div>
<div class="line"><a name="l02927"></a><span class="lineno"> 2927</span>&#160;        <span class="keyword">const</span> <span class="keyword">auto</span> lid = it-&gt;second;</div>
<div class="line"><a name="l02928"></a><span class="lineno"> 2928</span>&#160;        <span class="keyword">const</span> <span class="keyword">auto</span>&amp; local_mesh = advecter.<a class="code" href="structslmm_1_1_advecter.html#af0e7e647ca4de5abe97fa3f04b96792d">local_mesh</a>(lid);</div>
<div class="line"><a name="l02929"></a><span class="lineno"> 2929</span>&#160;        <span class="keyword">const</span> <span class="keyword">auto</span> cell = <a class="code" href="namespacesiqk.html#aef983887889243999a1d7ddea864ad1f">slice</a>(local_mesh.e, local_mesh.tgt_elem);</div>
<div class="line"><a name="l02930"></a><span class="lineno"> 2930</span>&#160;        <a class="code" href="compose__slmm_8cpp.html#a2912a5cf7e76e41c2ecf69b5c610479d">slmm_assert</a>(<a class="code" href="namespacesiqk.html#a6c43ff2c83ad6b7d0dc61c2c5e83a680">szslice</a>(local_mesh.e) == 4 &amp;&amp; cell[3] != -1);</div>
<div class="line"><a name="l02931"></a><span class="lineno"> 2931</span>&#160;        <span class="keyword">const</span> <span class="keyword">auto</span>&amp; p = local_mesh.p;</div>
<div class="line"><a name="l02932"></a><span class="lineno"> 2932</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> v = 0; v &lt; 4; ++v)</div>
<div class="line"><a name="l02933"></a><span class="lineno"> 2933</span>&#160;          <span class="keywordflow">for</span> (<a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> d = 0; d &lt; 3; ++d)</div>
<div class="line"><a name="l02934"></a><span class="lineno"> 2934</span>&#160;            s[si++] = p(cell[v],d);</div>
<div class="line"><a name="l02935"></a><span class="lineno"> 2935</span>&#160;      }</div>
<div class="line"><a name="l02936"></a><span class="lineno"> 2936</span>&#160;      <a class="code" href="compose__slmm_8cpp.html#a2912a5cf7e76e41c2ecf69b5c610479d">slmm_assert</a>(si == <span class="keyword">static_cast&lt;</span><a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a><span class="keyword">&gt;</span>(s.size()));</div>
<div class="line"><a name="l02937"></a><span class="lineno"> 2937</span>&#160;      <a class="code" href="namespacehomme_1_1mpi.html#ad8082dcb60fee10aa4100b8bdd436f50">mpi::isend</a>(p, s.data(), s.<a class="code" href="classhomme_1_1mpi_1_1_parallel.html#a9251fa1de119f66172b16fbf8e28c005">size</a>(), ranks[i], tag, &amp;geo_send_reqs[i]);</div>
<div class="line"><a name="l02938"></a><span class="lineno"> 2938</span>&#160;    }</div>
<div class="line"><a name="l02939"></a><span class="lineno"> 2939</span>&#160;    corners = RealArray3(<span class="stringliteral">&quot;corners&quot;</span>, rmtgid2idx.size(), 4, 3);</div>
<div class="line"><a name="l02940"></a><span class="lineno"> 2940</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> j = 0; j &lt; nrank; ++j) { <span class="comment">// Pack cell corner points for me.</span></div>
<div class="line"><a name="l02941"></a><span class="lineno"> 2941</span>&#160;      <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> i;</div>
<div class="line"><a name="l02942"></a><span class="lineno"> 2942</span>&#160;      <a class="code" href="namespacehomme_1_1mpi.html#a82d35837b534382faf656df6413b3e23">mpi::waitany</a>(nrank, geo_recv_reqs.data(), &amp;i);</div>
<div class="line"><a name="l02943"></a><span class="lineno"> 2943</span>&#160;      <span class="keyword">const</span> <span class="keyword">auto</span>&amp; s = req_sends[i];</div>
<div class="line"><a name="l02944"></a><span class="lineno"> 2944</span>&#160;      <span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> nrequested = s.size() - 1;</div>
<div class="line"><a name="l02945"></a><span class="lineno"> 2945</span>&#160;      <span class="keyword">const</span> <span class="keyword">auto</span>&amp; r = geo_recvs[i];</div>
<div class="line"><a name="l02946"></a><span class="lineno"> 2946</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> si = 0, ri = 0; si &lt; nrequested; ++si) {</div>
<div class="line"><a name="l02947"></a><span class="lineno"> 2947</span>&#160;        <span class="keyword">const</span> <a class="code" href="namespacehomme_1_1cslmpi_1_1extend__halo.html#af74e0f8fab9daccac42745e70b4ed933">Gid</a> gid = s[si+1];</div>
<div class="line"><a name="l02948"></a><span class="lineno"> 2948</span>&#160;        <span class="keyword">const</span> <span class="keyword">auto</span> it = rmtgid2idx.find(gid);</div>
<div class="line"><a name="l02949"></a><span class="lineno"> 2949</span>&#160;        <a class="code" href="compose__slmm_8cpp.html#a2912a5cf7e76e41c2ecf69b5c610479d">slmm_assert</a>(it != rmtgid2idx.end());</div>
<div class="line"><a name="l02950"></a><span class="lineno"> 2950</span>&#160;        <span class="keyword">const</span> <span class="keyword">auto</span> idx = it-&gt;second;</div>
<div class="line"><a name="l02951"></a><span class="lineno"> 2951</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> v = 0; v &lt; 4; ++v)</div>
<div class="line"><a name="l02952"></a><span class="lineno"> 2952</span>&#160;          <span class="keywordflow">for</span> (<a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> d = 0; d &lt; 3; ++d)</div>
<div class="line"><a name="l02953"></a><span class="lineno"> 2953</span>&#160;            corners(idx,v,d) = r[ri++];</div>
<div class="line"><a name="l02954"></a><span class="lineno"> 2954</span>&#160;      }</div>
<div class="line"><a name="l02955"></a><span class="lineno"> 2955</span>&#160;    }</div>
<div class="line"><a name="l02956"></a><span class="lineno"> 2956</span>&#160;    <span class="comment">// Do this here so we can release the memory.</span></div>
<div class="line"><a name="l02957"></a><span class="lineno"> 2957</span>&#160;    <a class="code" href="namespacehomme_1_1mpi.html#a34f40c3b1676af66d3ee317213118a1a">mpi::waitall</a>(geo_send_reqs.size(), geo_send_reqs.data());</div>
<div class="line"><a name="l02958"></a><span class="lineno"> 2958</span>&#160;  }</div>
<div class="line"><a name="l02959"></a><span class="lineno"> 2959</span>&#160; </div>
<div class="line"><a name="l02960"></a><span class="lineno"> 2960</span>&#160;  <span class="comment">// Extend the local meshes.</span></div>
<div class="line"><a name="l02961"></a><span class="lineno"> 2961</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> lid = 0; lid &lt; eds.<a class="code" href="structhomme_1_1cslmpi_1_1_fixed_cap_list.html#ad5ac1ee99fc2091a5425a3d4dfade068">size</a>(); ++lid) {</div>
<div class="line"><a name="l02962"></a><span class="lineno"> 2962</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span>&amp; ed = eds(lid);</div>
<div class="line"><a name="l02963"></a><span class="lineno"> 2963</span>&#160;    <span class="keyword">auto</span>&amp; local_mesh = advecter.<a class="code" href="structslmm_1_1_advecter.html#af0e7e647ca4de5abe97fa3f04b96792d">local_mesh</a>(lid);</div>
<div class="line"><a name="l02964"></a><span class="lineno"> 2964</span>&#160;    <span class="keyword">auto</span> <a class="code" href="namespace_homme_1_1_physical_constants.html#af1c6ba44dbdc6bf279635f8ef11b6862">p0</a> = local_mesh.p;</div>
<div class="line"><a name="l02965"></a><span class="lineno"> 2965</span>&#160;    <span class="keyword">auto</span> e0 = local_mesh.e;</div>
<div class="line"><a name="l02966"></a><span class="lineno"> 2966</span>&#160;    <span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> ncell = ed.nbrs.size();</div>
<div class="line"><a name="l02967"></a><span class="lineno"> 2967</span>&#160;    <a class="code" href="compose__slmm_8cpp.html#a2912a5cf7e76e41c2ecf69b5c610479d">slmm_assert</a>(<a class="code" href="namespacesiqk.html#a6c43ff2c83ad6b7d0dc61c2c5e83a680">szslice</a>(<a class="code" href="namespace_homme_1_1_physical_constants.html#af1c6ba44dbdc6bf279635f8ef11b6862">p0</a>) == 3 &amp;&amp; <a class="code" href="namespacesiqk.html#a6c43ff2c83ad6b7d0dc61c2c5e83a680">szslice</a>(e0) == 4);</div>
<div class="line"><a name="l02968"></a><span class="lineno"> 2968</span>&#160;    local_mesh.p = LocalMesh::RealArray(<span class="stringliteral">&quot;p&quot;</span>, 4*ncell);</div>
<div class="line"><a name="l02969"></a><span class="lineno"> 2969</span>&#160;    <span class="keyword">auto</span>&amp; p = local_mesh.p;</div>
<div class="line"><a name="l02970"></a><span class="lineno"> 2970</span>&#160;    local_mesh.e = LocalMesh::IntArray(<span class="stringliteral">&quot;e&quot;</span>, ncell, 4);</div>
<div class="line"><a name="l02971"></a><span class="lineno"> 2971</span>&#160;    <span class="keyword">auto</span>&amp; e = local_mesh.e;</div>
<div class="line"><a name="l02972"></a><span class="lineno"> 2972</span>&#160;    <span class="comment">// Copy in old data.</span></div>
<div class="line"><a name="l02973"></a><span class="lineno"> 2973</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> <a class="code" href="namespacejw.html#a655cdd60136294f8259068e09d1307ff">pi</a> = 0; <a class="code" href="namespacejw.html#a655cdd60136294f8259068e09d1307ff">pi</a> &lt; <a class="code" href="namespacesiqk.html#a3f1b5069fc1ac06e18aa603b592403e6">nslices</a>(<a class="code" href="namespace_homme_1_1_physical_constants.html#af1c6ba44dbdc6bf279635f8ef11b6862">p0</a>); ++<a class="code" href="namespacejw.html#a655cdd60136294f8259068e09d1307ff">pi</a>)</div>
<div class="line"><a name="l02974"></a><span class="lineno"> 2974</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> d = 0; d &lt; 3; ++d)</div>
<div class="line"><a name="l02975"></a><span class="lineno"> 2975</span>&#160;        p(<a class="code" href="namespacejw.html#a655cdd60136294f8259068e09d1307ff">pi</a>,d) = <a class="code" href="namespace_homme_1_1_physical_constants.html#af1c6ba44dbdc6bf279635f8ef11b6862">p0</a>(<a class="code" href="namespacejw.html#a655cdd60136294f8259068e09d1307ff">pi</a>,d);</div>
<div class="line"><a name="l02976"></a><span class="lineno"> 2976</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> ei = 0; ei &lt; <a class="code" href="namespacesiqk.html#a3f1b5069fc1ac06e18aa603b592403e6">nslices</a>(e0); ++ei)</div>
<div class="line"><a name="l02977"></a><span class="lineno"> 2977</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> d = 0; d &lt; 4; ++d)</div>
<div class="line"><a name="l02978"></a><span class="lineno"> 2978</span>&#160;        e(ei,d) = e0(ei,d);</div>
<div class="line"><a name="l02979"></a><span class="lineno"> 2979</span>&#160;    <span class="comment">// Fill in new data.</span></div>
<div class="line"><a name="l02980"></a><span class="lineno"> 2980</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> ni = ed.nin1halo; ni &lt; ed.nbrs.size(); ++ni) {</div>
<div class="line"><a name="l02981"></a><span class="lineno"> 2981</span>&#160;      <span class="keyword">const</span> <span class="keyword">auto</span>&amp; n = ed.nbrs(ni);</div>
<div class="line"><a name="l02982"></a><span class="lineno"> 2982</span>&#160;      <span class="keyword">const</span> <a class="code" href="namespacehomme_1_1cslmpi_1_1extend__halo.html#af74e0f8fab9daccac42745e70b4ed933">Gid</a> gid = n.gid;</div>
<div class="line"><a name="l02983"></a><span class="lineno"> 2983</span>&#160;      <span class="keywordflow">if</span> (n.rank != my_rank) {</div>
<div class="line"><a name="l02984"></a><span class="lineno"> 2984</span>&#160;        <span class="keyword">const</span> <span class="keyword">auto</span> it = rmtgid2idx.find(gid);</div>
<div class="line"><a name="l02985"></a><span class="lineno"> 2985</span>&#160;        <a class="code" href="compose__slmm_8cpp.html#a2912a5cf7e76e41c2ecf69b5c610479d">slmm_assert</a>(it != rmtgid2idx.end());</div>
<div class="line"><a name="l02986"></a><span class="lineno"> 2986</span>&#160;        <span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> idx = it-&gt;second;</div>
<div class="line"><a name="l02987"></a><span class="lineno"> 2987</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> v = 0; v &lt; 4; ++v) {</div>
<div class="line"><a name="l02988"></a><span class="lineno"> 2988</span>&#160;          <span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> slot = 4*ni+v;</div>
<div class="line"><a name="l02989"></a><span class="lineno"> 2989</span>&#160;          e(ni,v) = slot;</div>
<div class="line"><a name="l02990"></a><span class="lineno"> 2990</span>&#160;          <a class="code" href="compose__slmm_8cpp.html#a2912a5cf7e76e41c2ecf69b5c610479d">slmm_assert</a>(slot &lt; <a class="code" href="namespacesiqk.html#a3f1b5069fc1ac06e18aa603b592403e6">nslices</a>(p));</div>
<div class="line"><a name="l02991"></a><span class="lineno"> 2991</span>&#160;          <span class="keywordflow">for</span> (<a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> d = 0; d &lt; 3; ++d) p(slot,d) = corners(idx,v,d);</div>
<div class="line"><a name="l02992"></a><span class="lineno"> 2992</span>&#160;        }</div>
<div class="line"><a name="l02993"></a><span class="lineno"> 2993</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02994"></a><span class="lineno"> 2994</span>&#160;        <span class="keyword">const</span> <span class="keyword">auto</span> it = owngid2lid.find(gid);</div>
<div class="line"><a name="l02995"></a><span class="lineno"> 2995</span>&#160;        <a class="code" href="compose__slmm_8cpp.html#a2912a5cf7e76e41c2ecf69b5c610479d">slmm_assert</a>(it != owngid2lid.end());</div>
<div class="line"><a name="l02996"></a><span class="lineno"> 2996</span>&#160;        <span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> lid = it-&gt;second;</div>
<div class="line"><a name="l02997"></a><span class="lineno"> 2997</span>&#160;        <span class="keyword">const</span> <span class="keyword">auto</span>&amp; local_mesh_other = advecter.<a class="code" href="structslmm_1_1_advecter.html#af0e7e647ca4de5abe97fa3f04b96792d">local_mesh</a>(lid);</div>
<div class="line"><a name="l02998"></a><span class="lineno"> 2998</span>&#160;        <span class="keyword">const</span> <span class="keyword">auto</span> cell_other = <a class="code" href="namespacesiqk.html#aef983887889243999a1d7ddea864ad1f">slice</a>(local_mesh_other.e, local_mesh_other.tgt_elem);</div>
<div class="line"><a name="l02999"></a><span class="lineno"> 2999</span>&#160;        <span class="keyword">const</span> <span class="keyword">auto</span>&amp; p_other = local_mesh_other.p;</div>
<div class="line"><a name="l03000"></a><span class="lineno"> 3000</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> v = 0; v &lt; 4; ++v) {</div>
<div class="line"><a name="l03001"></a><span class="lineno"> 3001</span>&#160;          <span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> slot = 4*ni+v;</div>
<div class="line"><a name="l03002"></a><span class="lineno"> 3002</span>&#160;          e(ni,v) = slot;</div>
<div class="line"><a name="l03003"></a><span class="lineno"> 3003</span>&#160;          <a class="code" href="compose__slmm_8cpp.html#a2912a5cf7e76e41c2ecf69b5c610479d">slmm_assert</a>(slot &lt; <a class="code" href="namespacesiqk.html#a3f1b5069fc1ac06e18aa603b592403e6">nslices</a>(p));</div>
<div class="line"><a name="l03004"></a><span class="lineno"> 3004</span>&#160;          <span class="keywordflow">for</span> (<a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> d = 0; d &lt; 3; ++d) p(slot,d) = p_other(cell_other[v],d);</div>
<div class="line"><a name="l03005"></a><span class="lineno"> 3005</span>&#160;        }</div>
<div class="line"><a name="l03006"></a><span class="lineno"> 3006</span>&#160;      }</div>
<div class="line"><a name="l03007"></a><span class="lineno"> 3007</span>&#160;    }</div>
<div class="line"><a name="l03008"></a><span class="lineno"> 3008</span>&#160;    <span class="comment">// Recompute all normals.</span></div>
<div class="line"><a name="l03009"></a><span class="lineno"> 3009</span>&#160;    siqk::test::fill_normals&lt;siqk::SphereGeometry&gt;(local_mesh);</div>
<div class="line"><a name="l03010"></a><span class="lineno"> 3010</span>&#160;  }</div>
<div class="line"><a name="l03011"></a><span class="lineno"> 3011</span>&#160;}</div>
<div class="line"><a name="l03012"></a><span class="lineno"> 3012</span>&#160;} <span class="comment">// namespace extend_halo</span></div>
<div class="line"><a name="l03013"></a><span class="lineno"> 3013</span>&#160; </div>
<div class="line"><a name="l03014"></a><span class="lineno"> 3014</span>&#160;<span class="comment">// Fill in (gid, rank), the list of owning rank per gid.</span></div>
<div class="line"><a name="l03015"></a><span class="lineno"><a class="line" href="namespacehomme_1_1cslmpi.html#af584967327f65221fc9f7707fde769bf"> 3015</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespacehomme_1_1cslmpi.html#af584967327f65221fc9f7707fde769bf">collect_gid_rank</a> (<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html">CslMpi</a>&amp; cm, <span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a>* nbr_id_rank, <span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a>* nirptr) {</div>
<div class="line"><a name="l03016"></a><span class="lineno"> 3016</span>&#160;  cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a4c8e08ae7a21ce60733abff37c9c5058">ed</a>.reset_capacity(cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a8d3ead06518816f0985a84be689b0b85">nelemd</a>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l03017"></a><span class="lineno"> 3017</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> i = 0; i &lt; cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a8d3ead06518816f0985a84be689b0b85">nelemd</a>; ++i) {</div>
<div class="line"><a name="l03018"></a><span class="lineno"> 3018</span>&#160;    <span class="keyword">auto</span>&amp; ed = cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a4c8e08ae7a21ce60733abff37c9c5058">ed</a>(i);</div>
<div class="line"><a name="l03019"></a><span class="lineno"> 3019</span>&#160;    <span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a>* nir = nbr_id_rank + nirptr[i];</div>
<div class="line"><a name="l03020"></a><span class="lineno"> 3020</span>&#160;    <span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> nnir = (nirptr[i+1] - nirptr[i]) / 2;</div>
<div class="line"><a name="l03021"></a><span class="lineno"> 3021</span>&#160;    <span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> mygid = nir[0];</div>
<div class="line"><a name="l03022"></a><span class="lineno"> 3022</span>&#160;    ed.me = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l03023"></a><span class="lineno"> 3023</span>&#160;    ed.nin1halo = nnir-1;</div>
<div class="line"><a name="l03024"></a><span class="lineno"> 3024</span>&#160;    ed.nbrs.reset_capacity(ed.nin1halo, <span class="keyword">true</span>);</div>
<div class="line"><a name="l03025"></a><span class="lineno"> 3025</span>&#160;    ed.own.reset_capacity(cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a3386735d284e9924db14acad99319d25">nlev</a> * cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#ac64568d9b4b802315f2228beccaaac70">np2</a>);</div>
<div class="line"><a name="l03026"></a><span class="lineno"> 3026</span>&#160;    ed.rmt.reset_capacity(cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a3386735d284e9924db14acad99319d25">nlev</a> * cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#ac64568d9b4b802315f2228beccaaac70">np2</a>);</div>
<div class="line"><a name="l03027"></a><span class="lineno"> 3027</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> j = 1; j &lt; nnir; ++j) {</div>
<div class="line"><a name="l03028"></a><span class="lineno"> 3028</span>&#160;      <span class="keyword">auto</span>&amp; n = ed.nbrs(j-1);</div>
<div class="line"><a name="l03029"></a><span class="lineno"> 3029</span>&#160;      n.gid = nir[2*j];</div>
<div class="line"><a name="l03030"></a><span class="lineno"> 3030</span>&#160;      <span class="keywordflow">if</span> (n.gid == mygid) {</div>
<div class="line"><a name="l03031"></a><span class="lineno"> 3031</span>&#160;        <a class="code" href="compose__slmm_8cpp.html#a2912a5cf7e76e41c2ecf69b5c610479d">slmm_assert</a>( ! ed.me);</div>
<div class="line"><a name="l03032"></a><span class="lineno"> 3032</span>&#160;        ed.me = &amp;n;</div>
<div class="line"><a name="l03033"></a><span class="lineno"> 3033</span>&#160;      }</div>
<div class="line"><a name="l03034"></a><span class="lineno"> 3034</span>&#160;      n.rank = nir[2*j+1];</div>
<div class="line"><a name="l03035"></a><span class="lineno"> 3035</span>&#160;      n.rank_idx = -1;</div>
<div class="line"><a name="l03036"></a><span class="lineno"> 3036</span>&#160;      n.lid_on_rank = -1;</div>
<div class="line"><a name="l03037"></a><span class="lineno"> 3037</span>&#160;      n.lid_on_rank_idx = -1;</div>
<div class="line"><a name="l03038"></a><span class="lineno"> 3038</span>&#160;    }</div>
<div class="line"><a name="l03039"></a><span class="lineno"> 3039</span>&#160;    <a class="code" href="compose__slmm_8cpp.html#a2912a5cf7e76e41c2ecf69b5c610479d">slmm_assert</a>(ed.me);</div>
<div class="line"><a name="l03040"></a><span class="lineno"> 3040</span>&#160;  }</div>
<div class="line"><a name="l03041"></a><span class="lineno"> 3041</span>&#160;  <span class="keywordflow">if</span> (cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a27a93b756e637dd27f8383706bf6fa63">halo</a> == 2) <a class="code" href="namespacehomme_1_1cslmpi_1_1extend__halo.html#a0b28bfb437f4357677305e49b682e9b6">extend_halo::collect_gid_rank</a>(*cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a09395c121510c776158739ce6fba7c31">p</a>, cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a4c8e08ae7a21ce60733abff37c9c5058">ed</a>);</div>
<div class="line"><a name="l03042"></a><span class="lineno"> 3042</span>&#160;}</div>
<div class="line"><a name="l03043"></a><span class="lineno"> 3043</span>&#160; </div>
<div class="line"><a name="l03044"></a><span class="lineno"><a class="line" href="namespacehomme_1_1cslmpi.html#a7ade007724eed5ac50831ef77f3c4431"> 3044</a></span>&#160;<span class="keyword">typedef</span> std::map&lt;Int, std::set&lt;Int&gt; &gt; <a class="code" href="namespacehomme_1_1cslmpi.html#a7ade007724eed5ac50831ef77f3c4431">Rank2Gids</a>;</div>
<div class="line"><a name="l03045"></a><span class="lineno"> 3045</span>&#160; </div>
<div class="line"><a name="l03046"></a><span class="lineno"><a class="line" href="namespacehomme_1_1cslmpi.html#a0d6deb13b24f57c3d1942a8b3162d246"> 3046</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespacehomme_1_1cslmpi.html#a0d6deb13b24f57c3d1942a8b3162d246">get_rank2gids</a> (<span class="keyword">const</span> <a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html">CslMpi</a>&amp; cm, <a class="code" href="namespacehomme_1_1cslmpi.html#a7ade007724eed5ac50831ef77f3c4431">Rank2Gids</a>&amp; rank2rmtgids,</div>
<div class="line"><a name="l03047"></a><span class="lineno"> 3047</span>&#160;                    <a class="code" href="namespacehomme_1_1cslmpi.html#a7ade007724eed5ac50831ef77f3c4431">Rank2Gids</a>&amp; rank2owngids) {</div>
<div class="line"><a name="l03048"></a><span class="lineno"> 3048</span>&#160;  <span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> myrank = cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a09395c121510c776158739ce6fba7c31">p</a>-&gt;rank();</div>
<div class="line"><a name="l03049"></a><span class="lineno"> 3049</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> i = 0; i &lt; cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a8d3ead06518816f0985a84be689b0b85">nelemd</a>; ++i) {</div>
<div class="line"><a name="l03050"></a><span class="lineno"> 3050</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span>&amp; ed = cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a4c8e08ae7a21ce60733abff37c9c5058">ed</a>(i);</div>
<div class="line"><a name="l03051"></a><span class="lineno"> 3051</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; n: ed.nbrs) {</div>
<div class="line"><a name="l03052"></a><span class="lineno"> 3052</span>&#160;      <span class="keywordflow">if</span> (n.rank == myrank) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l03053"></a><span class="lineno"> 3053</span>&#160;      <span class="comment">// I need this rmt gid&#39;s lid.</span></div>
<div class="line"><a name="l03054"></a><span class="lineno"> 3054</span>&#160;      rank2rmtgids[n.rank].insert(n.gid);</div>
<div class="line"><a name="l03055"></a><span class="lineno"> 3055</span>&#160;      <span class="comment">// This rank needs this gid&#39;s lid.</span></div>
<div class="line"><a name="l03056"></a><span class="lineno"> 3056</span>&#160;      rank2owngids[n.rank].insert(ed.me-&gt;gid);</div>
<div class="line"><a name="l03057"></a><span class="lineno"> 3057</span>&#160;    }</div>
<div class="line"><a name="l03058"></a><span class="lineno"> 3058</span>&#160;  }</div>
<div class="line"><a name="l03059"></a><span class="lineno"> 3059</span>&#160;}</div>
<div class="line"><a name="l03060"></a><span class="lineno"> 3060</span>&#160; </div>
<div class="line"><a name="l03061"></a><span class="lineno"> 3061</span>&#160;<span class="comment">// Fill in nbrs.lid_on_rank, the lid on the remote rank corresponding to the gid</span></div>
<div class="line"><a name="l03062"></a><span class="lineno"> 3062</span>&#160;<span class="comment">// I share but do not own.</span></div>
<div class="line"><a name="l03063"></a><span class="lineno"><a class="line" href="namespacehomme_1_1cslmpi.html#ae779fc75a201a595ff26fb3496c7d91f"> 3063</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespacehomme_1_1cslmpi.html#ae779fc75a201a595ff26fb3496c7d91f">comm_lid_on_rank</a> (<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html">CslMpi</a>&amp; cm, <span class="keyword">const</span> <a class="code" href="namespacehomme_1_1cslmpi.html#a7ade007724eed5ac50831ef77f3c4431">Rank2Gids</a>&amp; rank2rmtgids,</div>
<div class="line"><a name="l03064"></a><span class="lineno"> 3064</span>&#160;                       <span class="keyword">const</span> <a class="code" href="namespacehomme_1_1cslmpi.html#a7ade007724eed5ac50831ef77f3c4431">Rank2Gids</a>&amp; rank2owngids,</div>
<div class="line"><a name="l03065"></a><span class="lineno"> 3065</span>&#160;                       std::map&lt;Int, Int&gt;&amp; gid2rmt_owning_lid) {</div>
<div class="line"><a name="l03066"></a><span class="lineno"> 3066</span>&#160;  <span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> myrank = cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a09395c121510c776158739ce6fba7c31">p</a>-&gt;rank();</div>
<div class="line"><a name="l03067"></a><span class="lineno"> 3067</span>&#160; </div>
<div class="line"><a name="l03068"></a><span class="lineno"> 3068</span>&#160;  std::map&lt;Int, Int&gt; gid2mylid;</div>
<div class="line"><a name="l03069"></a><span class="lineno"> 3069</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> i = 0; i &lt; cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a8d3ead06518816f0985a84be689b0b85">nelemd</a>; ++i)</div>
<div class="line"><a name="l03070"></a><span class="lineno"> 3070</span>&#160;    gid2mylid[cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a4c8e08ae7a21ce60733abff37c9c5058">ed</a>(i).me-&gt;gid] = i;</div>
<div class="line"><a name="l03071"></a><span class="lineno"> 3071</span>&#160;  </div>
<div class="line"><a name="l03072"></a><span class="lineno"> 3072</span>&#160;  <span class="comment">// Set up to recv remote (gid, lid) lists.</span></div>
<div class="line"><a name="l03073"></a><span class="lineno"> 3073</span>&#160;  <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> rn = 0;</div>
<div class="line"><a name="l03074"></a><span class="lineno"> 3074</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; e: rank2rmtgids)</div>
<div class="line"><a name="l03075"></a><span class="lineno"> 3075</span>&#160;    rn += e.second.size();</div>
<div class="line"><a name="l03076"></a><span class="lineno"> 3076</span>&#160;  <span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> nrecv = rank2rmtgids.size();</div>
<div class="line"><a name="l03077"></a><span class="lineno"> 3077</span>&#160;  std::vector&lt;Int&gt; <a class="code" href="namespacehomme_1_1cslmpi.html#a2b713e2734729354e7c6f52f90ec64d6">recv</a>(rn), recvptr(nrecv+1), recvrank(nrecv);</div>
<div class="line"><a name="l03078"></a><span class="lineno"> 3078</span>&#160;  std::vector&lt;mpi::Request&gt; reqs(nrecv);</div>
<div class="line"><a name="l03079"></a><span class="lineno"> 3079</span>&#160;  recvptr[0] = 0;</div>
<div class="line"><a name="l03080"></a><span class="lineno"> 3080</span>&#160;  <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> ir = 0;</div>
<div class="line"><a name="l03081"></a><span class="lineno"> 3081</span>&#160;  rn = 0;</div>
<div class="line"><a name="l03082"></a><span class="lineno"> 3082</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; e: rank2rmtgids) {</div>
<div class="line"><a name="l03083"></a><span class="lineno"> 3083</span>&#160;    <span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> <a class="code" href="namespacedimensions__mod.html#af137394c40531d5d6f0daa64351372e7">ne</a> = e.second.size();</div>
<div class="line"><a name="l03084"></a><span class="lineno"> 3084</span>&#160;    <span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> rank = e.first;</div>
<div class="line"><a name="l03085"></a><span class="lineno"> 3085</span>&#160;    <a class="code" href="compose__slmm_8cpp.html#a2912a5cf7e76e41c2ecf69b5c610479d">slmm_assert</a>(rank != myrank);</div>
<div class="line"><a name="l03086"></a><span class="lineno"> 3086</span>&#160;    recvrank[ir] = rank;</div>
<div class="line"><a name="l03087"></a><span class="lineno"> 3087</span>&#160;    <a class="code" href="namespacehomme_1_1mpi.html#ad0286e50c3714e7a55f00f9a87c3637e">mpi::irecv</a>(*cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a09395c121510c776158739ce6fba7c31">p</a>, <a class="code" href="namespacehomme_1_1cslmpi.html#a2b713e2734729354e7c6f52f90ec64d6">recv</a>.data() + rn, <a class="code" href="namespacedimensions__mod.html#af137394c40531d5d6f0daa64351372e7">ne</a>, rank, 42, &amp;reqs[ir++]);</div>
<div class="line"><a name="l03088"></a><span class="lineno"> 3088</span>&#160;    rn += <a class="code" href="namespacedimensions__mod.html#af137394c40531d5d6f0daa64351372e7">ne</a>;</div>
<div class="line"><a name="l03089"></a><span class="lineno"> 3089</span>&#160;    recvptr[ir] = rn;</div>
<div class="line"><a name="l03090"></a><span class="lineno"> 3090</span>&#160;  }</div>
<div class="line"><a name="l03091"></a><span class="lineno"> 3091</span>&#160; </div>
<div class="line"><a name="l03092"></a><span class="lineno"> 3092</span>&#160;  <span class="comment">// Send my (gid, lid) lists.</span></div>
<div class="line"><a name="l03093"></a><span class="lineno"> 3093</span>&#160;  <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> sn = 0, i = 0;</div>
<div class="line"><a name="l03094"></a><span class="lineno"> 3094</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; e: rank2owngids)</div>
<div class="line"><a name="l03095"></a><span class="lineno"> 3095</span>&#160;    sn += e.second.size();</div>
<div class="line"><a name="l03096"></a><span class="lineno"> 3096</span>&#160;  std::vector&lt;Int&gt; send(sn);</div>
<div class="line"><a name="l03097"></a><span class="lineno"> 3097</span>&#160;  std::vector&lt;mpi::Request&gt; sendreqs(rank2owngids.size());</div>
<div class="line"><a name="l03098"></a><span class="lineno"> 3098</span>&#160;  sn = 0;</div>
<div class="line"><a name="l03099"></a><span class="lineno"> 3099</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; e: rank2owngids) {</div>
<div class="line"><a name="l03100"></a><span class="lineno"> 3100</span>&#160;    <span class="comment">// Iteration through a set gives increasing GID, which means the LID list is</span></div>
<div class="line"><a name="l03101"></a><span class="lineno"> 3101</span>&#160;    <span class="comment">// consistent between communicating ranks.</span></div>
<div class="line"><a name="l03102"></a><span class="lineno"> 3102</span>&#160;    <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> slot = sn, pgid = -1;</div>
<div class="line"><a name="l03103"></a><span class="lineno"> 3103</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> gid: e.second) {</div>
<div class="line"><a name="l03104"></a><span class="lineno"> 3104</span>&#160;      <a class="code" href="compose__slmm_8cpp.html#a2912a5cf7e76e41c2ecf69b5c610479d">slmm_assert</a>(gid &gt; pgid);</div>
<div class="line"><a name="l03105"></a><span class="lineno"> 3105</span>&#160;      pgid = gid;</div>
<div class="line"><a name="l03106"></a><span class="lineno"> 3106</span>&#160;      send[slot++] = gid2mylid[gid];</div>
<div class="line"><a name="l03107"></a><span class="lineno"> 3107</span>&#160;    }</div>
<div class="line"><a name="l03108"></a><span class="lineno"> 3108</span>&#160;    <span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> <a class="code" href="namespacedimensions__mod.html#af137394c40531d5d6f0daa64351372e7">ne</a> = e.second.size();</div>
<div class="line"><a name="l03109"></a><span class="lineno"> 3109</span>&#160;    <span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> rank = e.first;</div>
<div class="line"><a name="l03110"></a><span class="lineno"> 3110</span>&#160;    <a class="code" href="namespacehomme_1_1mpi.html#ad8082dcb60fee10aa4100b8bdd436f50">mpi::isend</a>(*cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a09395c121510c776158739ce6fba7c31">p</a>, send.data() + sn, <a class="code" href="namespacedimensions__mod.html#af137394c40531d5d6f0daa64351372e7">ne</a>, rank, 42, &amp;sendreqs[i++]);</div>
<div class="line"><a name="l03111"></a><span class="lineno"> 3111</span>&#160;    sn += <a class="code" href="namespacedimensions__mod.html#af137394c40531d5d6f0daa64351372e7">ne</a>;</div>
<div class="line"><a name="l03112"></a><span class="lineno"> 3112</span>&#160;  }</div>
<div class="line"><a name="l03113"></a><span class="lineno"> 3113</span>&#160; </div>
<div class="line"><a name="l03114"></a><span class="lineno"> 3114</span>&#160;  <span class="comment">// Actually recv.</span></div>
<div class="line"><a name="l03115"></a><span class="lineno"> 3115</span>&#160;  <span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> count = rank2owngids.size();</div>
<div class="line"><a name="l03116"></a><span class="lineno"> 3116</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> c = 0; c &lt; count; ++c) {</div>
<div class="line"><a name="l03117"></a><span class="lineno"> 3117</span>&#160;    <span class="keywordtype">int</span> idx;</div>
<div class="line"><a name="l03118"></a><span class="lineno"> 3118</span>&#160;    <a class="code" href="namespacehomme_1_1mpi.html#a82d35837b534382faf656df6413b3e23">mpi::waitany</a>(count, reqs.data(), &amp;idx);</div>
<div class="line"><a name="l03119"></a><span class="lineno"> 3119</span>&#160;    <span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a>* rmtlids = <a class="code" href="namespacehomme_1_1cslmpi.html#a2b713e2734729354e7c6f52f90ec64d6">recv</a>.data() + recvptr[idx];</div>
<div class="line"><a name="l03120"></a><span class="lineno"> 3120</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span>&amp; gids = rank2rmtgids.at(recvrank[idx]);</div>
<div class="line"><a name="l03121"></a><span class="lineno"> 3121</span>&#160;    <a class="code" href="compose__slmm_8cpp.html#a2912a5cf7e76e41c2ecf69b5c610479d">slmm_assert</a>(recvptr[idx+1] - recvptr[idx] == gids.size());</div>
<div class="line"><a name="l03122"></a><span class="lineno"> 3122</span>&#160;    <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> i = 0;</div>
<div class="line"><a name="l03123"></a><span class="lineno"> 3123</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> gid: gids)</div>
<div class="line"><a name="l03124"></a><span class="lineno"> 3124</span>&#160;      gid2rmt_owning_lid[gid] = rmtlids[i++];</div>
<div class="line"><a name="l03125"></a><span class="lineno"> 3125</span>&#160;  }</div>
<div class="line"><a name="l03126"></a><span class="lineno"> 3126</span>&#160; </div>
<div class="line"><a name="l03127"></a><span class="lineno"> 3127</span>&#160;  <span class="comment">// Fill lid_on_rank and mylid_with_comm.</span></div>
<div class="line"><a name="l03128"></a><span class="lineno"> 3128</span>&#160;  std::vector&lt;Int&gt; mylid_with_comm;</div>
<div class="line"><a name="l03129"></a><span class="lineno"> 3129</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> i = 0; i &lt; cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a8d3ead06518816f0985a84be689b0b85">nelemd</a>; ++i) {</div>
<div class="line"><a name="l03130"></a><span class="lineno"> 3130</span>&#160;    <span class="keyword">auto</span>&amp; ed = cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a4c8e08ae7a21ce60733abff37c9c5058">ed</a>(i);</div>
<div class="line"><a name="l03131"></a><span class="lineno"> 3131</span>&#160;    <span class="keywordtype">bool</span> has_comm = <span class="keyword">false</span>;</div>
<div class="line"><a name="l03132"></a><span class="lineno"> 3132</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; n: ed.nbrs)</div>
<div class="line"><a name="l03133"></a><span class="lineno"> 3133</span>&#160;      <span class="keywordflow">if</span> (n.rank == myrank) {</div>
<div class="line"><a name="l03134"></a><span class="lineno"> 3134</span>&#160;        <span class="keyword">const</span> <span class="keyword">auto</span> it = gid2mylid.find(n.gid);</div>
<div class="line"><a name="l03135"></a><span class="lineno"> 3135</span>&#160;        <a class="code" href="compose__slmm_8cpp.html#a7290a1aabe779e162c8d6a36b3abec04">slmm_throw_if</a>(it == gid2mylid.end(),</div>
<div class="line"><a name="l03136"></a><span class="lineno"> 3136</span>&#160;                      <span class="stringliteral">&quot;comm_lid_on_rank: On rank &quot;</span> &lt;&lt; myrank &lt;&lt; <span class="stringliteral">&quot;, gid &quot;</span> &lt;&lt; n.gid</div>
<div class="line"><a name="l03137"></a><span class="lineno"> 3137</span>&#160;                      &lt;&lt; <span class="stringliteral">&quot; is not in gid2mylid.&quot;</span>);</div>
<div class="line"><a name="l03138"></a><span class="lineno"> 3138</span>&#160;        n.lid_on_rank = it-&gt;second;</div>
<div class="line"><a name="l03139"></a><span class="lineno"> 3139</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l03140"></a><span class="lineno"> 3140</span>&#160;        has_comm = <span class="keyword">true</span>;</div>
<div class="line"><a name="l03141"></a><span class="lineno"> 3141</span>&#160;        <span class="keyword">const</span> <span class="keyword">auto</span> it = gid2rmt_owning_lid.find(n.gid);</div>
<div class="line"><a name="l03142"></a><span class="lineno"> 3142</span>&#160;        <a class="code" href="compose__slmm_8cpp.html#a7290a1aabe779e162c8d6a36b3abec04">slmm_throw_if</a>(it == gid2rmt_owning_lid.end(),</div>
<div class="line"><a name="l03143"></a><span class="lineno"> 3143</span>&#160;                      <span class="stringliteral">&quot;comm_lid_on_rank: On rank &quot;</span> &lt;&lt; myrank &lt;&lt; <span class="stringliteral">&quot;, gid &quot;</span> &lt;&lt; n.gid</div>
<div class="line"><a name="l03144"></a><span class="lineno"> 3144</span>&#160;                      &lt;&lt; <span class="stringliteral">&quot;, which I believe to be owned by rank &quot;</span> &lt;&lt; n.rank</div>
<div class="line"><a name="l03145"></a><span class="lineno"> 3145</span>&#160;                      &lt;&lt; <span class="stringliteral">&quot;, is not in gid2rmt_owning_lid.&quot;</span>);</div>
<div class="line"><a name="l03146"></a><span class="lineno"> 3146</span>&#160;        n.lid_on_rank = it-&gt;second;</div>
<div class="line"><a name="l03147"></a><span class="lineno"> 3147</span>&#160;      }</div>
<div class="line"><a name="l03148"></a><span class="lineno"> 3148</span>&#160;    <span class="keywordflow">if</span> (has_comm)</div>
<div class="line"><a name="l03149"></a><span class="lineno"> 3149</span>&#160;      mylid_with_comm.push_back(i);</div>
<div class="line"><a name="l03150"></a><span class="lineno"> 3150</span>&#160;  }</div>
<div class="line"><a name="l03151"></a><span class="lineno"> 3151</span>&#160;  cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a3f7d02fbb1bf0589c931e6526802c266">mylid_with_comm</a>.<a class="code" href="structhomme_1_1cslmpi_1_1_fixed_cap_list.html#a3e9b033769f333ba49055706c62961e8">reset_capacity</a>(mylid_with_comm.size(), <span class="keyword">true</span>);</div>
<div class="line"><a name="l03152"></a><span class="lineno"> 3152</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> i = 0; i &lt; cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a3f7d02fbb1bf0589c931e6526802c266">mylid_with_comm</a>.<a class="code" href="structhomme_1_1cslmpi_1_1_fixed_cap_list.html#aad4f28cbbbe5499b8e1a60e8d984aa18">n</a>(); ++i)</div>
<div class="line"><a name="l03153"></a><span class="lineno"> 3153</span>&#160;    cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a3f7d02fbb1bf0589c931e6526802c266">mylid_with_comm</a>(i) = mylid_with_comm[i];</div>
<div class="line"><a name="l03154"></a><span class="lineno"> 3154</span>&#160; </div>
<div class="line"><a name="l03155"></a><span class="lineno"> 3155</span>&#160;  <a class="code" href="namespacehomme_1_1mpi.html#a34f40c3b1676af66d3ee317213118a1a">mpi::waitall</a>(sendreqs.size(), sendreqs.data());</div>
<div class="line"><a name="l03156"></a><span class="lineno"> 3156</span>&#160;}</div>
<div class="line"><a name="l03157"></a><span class="lineno"> 3157</span>&#160; </div>
<div class="line"><a name="l03158"></a><span class="lineno"> 3158</span>&#160;<span class="comment">// Useful maps between a linear index space 1:K to a set of K unique</span></div>
<div class="line"><a name="l03159"></a><span class="lineno"> 3159</span>&#160;<span class="comment">// integers. These obviate sorts and use of hash or binary maps during time</span></div>
<div class="line"><a name="l03160"></a><span class="lineno"> 3160</span>&#160;<span class="comment">// stepping.</span></div>
<div class="line"><a name="l03161"></a><span class="lineno"><a class="line" href="namespacehomme_1_1cslmpi.html#aacaed757e415d59a7d9e6f843f5fe026"> 3161</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespacehomme_1_1cslmpi.html#aacaed757e415d59a7d9e6f843f5fe026">set_idx2_maps</a> (<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html">CslMpi</a>&amp; cm, <span class="keyword">const</span> <a class="code" href="namespacehomme_1_1cslmpi.html#a7ade007724eed5ac50831ef77f3c4431">Rank2Gids</a>&amp; rank2rmtgids,</div>
<div class="line"><a name="l03162"></a><span class="lineno"> 3162</span>&#160;                    <span class="keyword">const</span> std::map&lt;Int, Int&gt;&amp; gid2rmt_owning_lid) {</div>
<div class="line"><a name="l03163"></a><span class="lineno"> 3163</span>&#160;  <span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> myrank = cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a09395c121510c776158739ce6fba7c31">p</a>-&gt;rank();</div>
<div class="line"><a name="l03164"></a><span class="lineno"> 3164</span>&#160;  std::map&lt;Int, Int&gt; ranks;</div>
<div class="line"><a name="l03165"></a><span class="lineno"> 3165</span>&#160;  <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> i = 0;</div>
<div class="line"><a name="l03166"></a><span class="lineno"> 3166</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; e: rank2rmtgids)</div>
<div class="line"><a name="l03167"></a><span class="lineno"> 3167</span>&#160;    <span class="keywordflow">if</span> (ranks.find(e.first) == ranks.end())</div>
<div class="line"><a name="l03168"></a><span class="lineno"> 3168</span>&#160;      ranks[e.first] = i++;</div>
<div class="line"><a name="l03169"></a><span class="lineno"> 3169</span>&#160;  ranks[myrank] = i;</div>
<div class="line"><a name="l03170"></a><span class="lineno"> 3170</span>&#160; </div>
<div class="line"><a name="l03171"></a><span class="lineno"> 3171</span>&#160;  cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a5402ced381c42ff2808665611c4cc0e0">ranks</a>.<a class="code" href="structhomme_1_1cslmpi_1_1_fixed_cap_list.html#a3e9b033769f333ba49055706c62961e8">reset_capacity</a>(i+1, <span class="keyword">true</span>);</div>
<div class="line"><a name="l03172"></a><span class="lineno"> 3172</span>&#160;  cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a5402ced381c42ff2808665611c4cc0e0">ranks</a>(i) = myrank;</div>
<div class="line"><a name="l03173"></a><span class="lineno"> 3173</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; e: ranks)</div>
<div class="line"><a name="l03174"></a><span class="lineno"> 3174</span>&#160;    cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a5402ced381c42ff2808665611c4cc0e0">ranks</a>(e.second) = e.first;</div>
<div class="line"><a name="l03175"></a><span class="lineno"> 3175</span>&#160;  cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#ab52f53a78f20b5ff0d0ad14439eb3bec">sendcount</a>.<a class="code" href="structhomme_1_1cslmpi_1_1_fixed_cap_list.html#a3e9b033769f333ba49055706c62961e8">reset_capacity</a>(i, <span class="keyword">true</span>);</div>
<div class="line"><a name="l03176"></a><span class="lineno"> 3176</span>&#160;  cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a3de780cac76d3359bd90a33c189ea622">sendreq</a>.reset_capacity(i, <span class="keyword">true</span>);</div>
<div class="line"><a name="l03177"></a><span class="lineno"> 3177</span>&#160;  cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a610b60e516b4b287caae09bf8834f233">recvreq</a>.reset_capacity(i, <span class="keyword">true</span>);</div>
<div class="line"><a name="l03178"></a><span class="lineno"> 3178</span>&#160;  cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a04bec07079fb55ceea64db025fa69c9c">x_bulkdata_offset</a>.<a class="code" href="structhomme_1_1cslmpi_1_1_fixed_cap_list.html#a3e9b033769f333ba49055706c62961e8">reset_capacity</a>(i, <span class="keyword">true</span>);</div>
<div class="line"><a name="l03179"></a><span class="lineno"> 3179</span>&#160; </div>
<div class="line"><a name="l03180"></a><span class="lineno"> 3180</span>&#160;  <span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> nrmtrank = <span class="keyword">static_cast&lt;</span><a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a><span class="keyword">&gt;</span>(cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a5402ced381c42ff2808665611c4cc0e0">ranks</a>.<a class="code" href="structhomme_1_1cslmpi_1_1_fixed_cap_list.html#ad5ac1ee99fc2091a5425a3d4dfade068">size</a>()) - 1;</div>
<div class="line"><a name="l03181"></a><span class="lineno"> 3181</span>&#160;  std::vector&lt;std::map&lt;Int, Int&gt; &gt; lor2idx(nrmtrank);</div>
<div class="line"><a name="l03182"></a><span class="lineno"> 3182</span>&#160;  std::vector&lt;Int&gt; nlid_on_rank(nrmtrank);</div>
<div class="line"><a name="l03183"></a><span class="lineno"> 3183</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> ri = 0; ri &lt; nrmtrank; ++ri) {</div>
<div class="line"><a name="l03184"></a><span class="lineno"> 3184</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span>&amp; rmtgids = rank2rmtgids.at(cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a5402ced381c42ff2808665611c4cc0e0">ranks</a>(ri));</div>
<div class="line"><a name="l03185"></a><span class="lineno"> 3185</span>&#160;    nlid_on_rank[ri] = rmtgids.size();</div>
<div class="line"><a name="l03186"></a><span class="lineno"> 3186</span>&#160;  }</div>
<div class="line"><a name="l03187"></a><span class="lineno"> 3187</span>&#160;  cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a2bc103fcf1b1213dec73c720334e80a4">lid_on_rank</a>.<a class="code" href="structhomme_1_1cslmpi_1_1_list_of_lists.html#aa6d35555467b2286472dd6862b9b8cc3">init</a>(nrmtrank, nlid_on_rank.data());</div>
<div class="line"><a name="l03188"></a><span class="lineno"> 3188</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> ri = 0; ri &lt; nrmtrank; ++ri) {</div>
<div class="line"><a name="l03189"></a><span class="lineno"> 3189</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span>&amp; rmtgids = rank2rmtgids.at(cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a5402ced381c42ff2808665611c4cc0e0">ranks</a>(ri));</div>
<div class="line"><a name="l03190"></a><span class="lineno"> 3190</span>&#160;    <span class="keyword">auto</span>&amp; lor2idxri = lor2idx[ri];</div>
<div class="line"><a name="l03191"></a><span class="lineno"> 3191</span>&#160;    <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> idx = 0;</div>
<div class="line"><a name="l03192"></a><span class="lineno"> 3192</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; gid: rmtgids) {</div>
<div class="line"><a name="l03193"></a><span class="lineno"> 3193</span>&#160;      <span class="keyword">const</span> <span class="keyword">auto</span> lid = gid2rmt_owning_lid.at(gid);</div>
<div class="line"><a name="l03194"></a><span class="lineno"> 3194</span>&#160;      lor2idxri[lid] = idx;</div>
<div class="line"><a name="l03195"></a><span class="lineno"> 3195</span>&#160;      cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a2bc103fcf1b1213dec73c720334e80a4">lid_on_rank</a>(ri,idx) = lid;</div>
<div class="line"><a name="l03196"></a><span class="lineno"> 3196</span>&#160;      ++idx;</div>
<div class="line"><a name="l03197"></a><span class="lineno"> 3197</span>&#160;    }</div>
<div class="line"><a name="l03198"></a><span class="lineno"> 3198</span>&#160;    <a class="code" href="compose__slmm_8cpp.html#a2912a5cf7e76e41c2ecf69b5c610479d">slmm_assert</a>(idx == nlid_on_rank[ri]);</div>
<div class="line"><a name="l03199"></a><span class="lineno"> 3199</span>&#160;  }</div>
<div class="line"><a name="l03200"></a><span class="lineno"> 3200</span>&#160; </div>
<div class="line"><a name="l03201"></a><span class="lineno"> 3201</span>&#160;  <span class="keywordflow">for</span> (i = 0; i &lt; cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a8d3ead06518816f0985a84be689b0b85">nelemd</a>; ++i) {</div>
<div class="line"><a name="l03202"></a><span class="lineno"> 3202</span>&#160;    <span class="keyword">auto</span>&amp; ed = cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a4c8e08ae7a21ce60733abff37c9c5058">ed</a>(i);</div>
<div class="line"><a name="l03203"></a><span class="lineno"> 3203</span>&#160;    ed.me-&gt;rank_idx = ranks.at(ed.me-&gt;rank);</div>
<div class="line"><a name="l03204"></a><span class="lineno"> 3204</span>&#160;    ed.me-&gt;lid_on_rank_idx = i;</div>
<div class="line"><a name="l03205"></a><span class="lineno"> 3205</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; n: ed.nbrs) {</div>
<div class="line"><a name="l03206"></a><span class="lineno"> 3206</span>&#160;      n.rank_idx = ranks.at(n.rank);</div>
<div class="line"><a name="l03207"></a><span class="lineno"> 3207</span>&#160;      n.lid_on_rank_idx = n.rank == myrank ?</div>
<div class="line"><a name="l03208"></a><span class="lineno"> 3208</span>&#160;        i :</div>
<div class="line"><a name="l03209"></a><span class="lineno"> 3209</span>&#160;        lor2idx[n.rank_idx].at(n.lid_on_rank);</div>
<div class="line"><a name="l03210"></a><span class="lineno"> 3210</span>&#160;    }</div>
<div class="line"><a name="l03211"></a><span class="lineno"> 3211</span>&#160;    ed.src = <a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#ad93c0e96ca487335f1ed7c474e7e5fd7">CslMpi::IntArray2D</a>(<span class="stringliteral">&quot;src&quot;</span>, cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a3386735d284e9924db14acad99319d25">nlev</a>, cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#ac64568d9b4b802315f2228beccaaac70">np2</a>);</div>
<div class="line"><a name="l03212"></a><span class="lineno"> 3212</span>&#160;    ed.q_extrema = <a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a139aec4ef20fe08ceb0d29fa65f10941">CslMpi::Array&lt;Real**[2]&gt;</a>(<span class="stringliteral">&quot;q_extrema&quot;</span>, cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a3d22abacf7bd37f0897d406f7566eb3f">qsize</a>, cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a3386735d284e9924db14acad99319d25">nlev</a>);</div>
<div class="line"><a name="l03213"></a><span class="lineno"> 3213</span>&#160;  }</div>
<div class="line"><a name="l03214"></a><span class="lineno"> 3214</span>&#160;}</div>
<div class="line"><a name="l03215"></a><span class="lineno"> 3215</span>&#160; </div>
<div class="line"><a name="l03216"></a><span class="lineno"> 3216</span>&#160;<span class="comment">// In the original MPI pattern that has been in HOMME for years, each owned cell</span></div>
<div class="line"><a name="l03217"></a><span class="lineno"> 3217</span>&#160;<span class="comment">// has a 1-halo patch of bulk data. For a 1-halo, allocations in this routine</span></div>
<div class="line"><a name="l03218"></a><span class="lineno"> 3218</span>&#160;<span class="comment">// use essentially the same amount of memory, but not more. We could use less if</span></div>
<div class="line"><a name="l03219"></a><span class="lineno"> 3219</span>&#160;<span class="comment">// we were willing to realloc space at each SL time step.</span></div>
<div class="line"><a name="l03220"></a><span class="lineno"><a class="line" href="namespacehomme_1_1cslmpi.html#a77abbc438e30f8cb28d694a58f93fa0d"> 3220</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespacehomme_1_1cslmpi.html#a77abbc438e30f8cb28d694a58f93fa0d">size_mpi_buffers</a> (<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html">CslMpi</a>&amp; cm, <span class="keyword">const</span> <a class="code" href="namespacehomme_1_1cslmpi.html#a7ade007724eed5ac50831ef77f3c4431">Rank2Gids</a>&amp; rank2rmtgids,</div>
<div class="line"><a name="l03221"></a><span class="lineno"> 3221</span>&#160;                       <span class="keyword">const</span> <a class="code" href="namespacehomme_1_1cslmpi.html#a7ade007724eed5ac50831ef77f3c4431">Rank2Gids</a>&amp; rank2owngids) {</div>
<div class="line"><a name="l03222"></a><span class="lineno"> 3222</span>&#160;  <span class="keyword">const</span> <span class="keyword">auto</span> myrank = cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a09395c121510c776158739ce6fba7c31">p</a>-&gt;rank();</div>
<div class="line"><a name="l03223"></a><span class="lineno"> 3223</span>&#160;  <span class="comment">// sizeof real, int, single int (b/c of alignment)</span></div>
<div class="line"><a name="l03224"></a><span class="lineno"> 3224</span>&#160;  <span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> sor = <span class="keyword">sizeof</span>(<a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a>), soi = <span class="keyword">sizeof</span>(<a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a>), sosi = sor;</div>
<div class="line"><a name="l03225"></a><span class="lineno"> 3225</span>&#160;  static_assert(<span class="keyword">sizeof</span>(<a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a>) &gt;= <span class="keyword">sizeof</span>(<a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a>),</div>
<div class="line"><a name="l03226"></a><span class="lineno"> 3226</span>&#160;                <span class="stringliteral">&quot;For buffer packing, we require sizeof(Real) &gt;= sizeof(Int)&quot;</span>);</div>
<div class="line"><a name="l03227"></a><span class="lineno"> 3227</span>&#160;  <span class="keyword">const</span> <span class="keyword">auto</span> xbufcnt = [&amp;] (<span class="keyword">const</span> std::set&lt;Int&gt;&amp; rmtgids,</div>
<div class="line"><a name="l03228"></a><span class="lineno"> 3228</span>&#160;                            <span class="keyword">const</span> std::set&lt;Int&gt;&amp; owngids) -&gt; <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> {</div>
<div class="line"><a name="l03229"></a><span class="lineno"> 3229</span>&#160;    <span class="keywordflow">return</span> (sosi + (2*soi + (2*soi)*cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a3386735d284e9924db14acad99319d25">nlev</a>)*rmtgids.size() + <span class="comment">// meta data</span></div>
<div class="line"><a name="l03230"></a><span class="lineno"> 3230</span>&#160;            owngids.size()*cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a3386735d284e9924db14acad99319d25">nlev</a>*cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#ac64568d9b4b802315f2228beccaaac70">np2</a>*3*sor);             <span class="comment">// bulk data</span></div>
<div class="line"><a name="l03231"></a><span class="lineno"> 3231</span>&#160;  };</div>
<div class="line"><a name="l03232"></a><span class="lineno"> 3232</span>&#160;  <span class="keyword">const</span> <span class="keyword">auto</span> qbufcnt = [&amp;] (<span class="keyword">const</span> std::set&lt;Int&gt;&amp; rmtgids,</div>
<div class="line"><a name="l03233"></a><span class="lineno"> 3233</span>&#160;                            <span class="keyword">const</span> std::set&lt;Int&gt;&amp; owngids) -&gt; <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> {</div>
<div class="line"><a name="l03234"></a><span class="lineno"> 3234</span>&#160;    <span class="keywordflow">return</span> ((rmtgids.size()*2 +      <span class="comment">// min/max q</span></div>
<div class="line"><a name="l03235"></a><span class="lineno"> 3235</span>&#160;             owngids.size()*cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#ac64568d9b4b802315f2228beccaaac70">np2</a>)* <span class="comment">// q</span></div>
<div class="line"><a name="l03236"></a><span class="lineno"> 3236</span>&#160;            cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a3d22abacf7bd37f0897d406f7566eb3f">qsize</a>*cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a3386735d284e9924db14acad99319d25">nlev</a>*sor);</div>
<div class="line"><a name="l03237"></a><span class="lineno"> 3237</span>&#160;  };</div>
<div class="line"><a name="l03238"></a><span class="lineno"> 3238</span>&#160;  <span class="keyword">const</span> <span class="keyword">auto</span> bytes2real = [&amp;] (<span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a>&amp; bytes) {</div>
<div class="line"><a name="l03239"></a><span class="lineno"> 3239</span>&#160;    <span class="keywordflow">return</span> (bytes + sor - 1)/sor;</div>
<div class="line"><a name="l03240"></a><span class="lineno"> 3240</span>&#160;  };</div>
<div class="line"><a name="l03241"></a><span class="lineno"> 3241</span>&#160; </div>
<div class="line"><a name="l03242"></a><span class="lineno"> 3242</span>&#160;  <a class="code" href="compose__slmm_8cpp.html#a2912a5cf7e76e41c2ecf69b5c610479d">slmm_assert</a>(cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a5402ced381c42ff2808665611c4cc0e0">ranks</a>.<a class="code" href="structhomme_1_1cslmpi_1_1_fixed_cap_list.html#ada310da68364580af2420776e7d54a32">back</a>() == myrank);</div>
<div class="line"><a name="l03243"></a><span class="lineno"> 3243</span>&#160;  <span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> nrmtrank = <span class="keyword">static_cast&lt;</span><a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a><span class="keyword">&gt;</span>(cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a5402ced381c42ff2808665611c4cc0e0">ranks</a>.<a class="code" href="structhomme_1_1cslmpi_1_1_fixed_cap_list.html#ad5ac1ee99fc2091a5425a3d4dfade068">size</a>()) - 1;</div>
<div class="line"><a name="l03244"></a><span class="lineno"> 3244</span>&#160;  cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#ae6362eba877446b15f51dc5d6d4ed37e">nlid_per_rank</a>.resize(nrmtrank);</div>
<div class="line"><a name="l03245"></a><span class="lineno"> 3245</span>&#160;  cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#abdef54045d56d191f36b9fdaf8707f67">sendsz</a>.resize(nrmtrank);</div>
<div class="line"><a name="l03246"></a><span class="lineno"> 3246</span>&#160;  cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a9f7fc421d09c34cbcf8f2d2a45b6b0dd">recvsz</a>.resize(nrmtrank);</div>
<div class="line"><a name="l03247"></a><span class="lineno"> 3247</span>&#160;  <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> rmt_xs_sz = 0, rmt_qse_sz = 0;</div>
<div class="line"><a name="l03248"></a><span class="lineno"> 3248</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> ri = 0; ri &lt; nrmtrank; ++ri) {</div>
<div class="line"><a name="l03249"></a><span class="lineno"> 3249</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span>&amp; rmtgids = rank2rmtgids.at(cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a5402ced381c42ff2808665611c4cc0e0">ranks</a>(ri));</div>
<div class="line"><a name="l03250"></a><span class="lineno"> 3250</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span>&amp; owngids = rank2owngids.at(cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a5402ced381c42ff2808665611c4cc0e0">ranks</a>(ri));</div>
<div class="line"><a name="l03251"></a><span class="lineno"> 3251</span>&#160;    cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#ae6362eba877446b15f51dc5d6d4ed37e">nlid_per_rank</a>[ri] = rmtgids.size();</div>
<div class="line"><a name="l03252"></a><span class="lineno"> 3252</span>&#160;    cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#abdef54045d56d191f36b9fdaf8707f67">sendsz</a>[ri] = bytes2real(<a class="code" href="namespacesiqk.html#a984fe7f0fc55d1f004981d9b6ffac4f7">std::max</a>(xbufcnt(rmtgids, owngids),</div>
<div class="line"><a name="l03253"></a><span class="lineno"> 3253</span>&#160;                                        qbufcnt(owngids, rmtgids)));</div>
<div class="line"><a name="l03254"></a><span class="lineno"> 3254</span>&#160;    cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a9f7fc421d09c34cbcf8f2d2a45b6b0dd">recvsz</a>[ri] = bytes2real(<a class="code" href="namespacesiqk.html#a984fe7f0fc55d1f004981d9b6ffac4f7">std::max</a>(xbufcnt(owngids, rmtgids),</div>
<div class="line"><a name="l03255"></a><span class="lineno"> 3255</span>&#160;                                        qbufcnt(rmtgids, owngids)));</div>
<div class="line"><a name="l03256"></a><span class="lineno"> 3256</span>&#160;    rmt_xs_sz  += 5*cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#ac64568d9b4b802315f2228beccaaac70">np2</a>*cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a3386735d284e9924db14acad99319d25">nlev</a>*rmtgids.size();</div>
<div class="line"><a name="l03257"></a><span class="lineno"> 3257</span>&#160;    rmt_qse_sz += 4       *cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a3386735d284e9924db14acad99319d25">nlev</a>*rmtgids.size();</div>
<div class="line"><a name="l03258"></a><span class="lineno"> 3258</span>&#160;  }</div>
<div class="line"><a name="l03259"></a><span class="lineno"> 3259</span>&#160;  cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a370d8de04a4cc9d9e64cf4a3d3b28f94">rmt_xs</a>.<a class="code" href="structhomme_1_1cslmpi_1_1_fixed_cap_list.html#a3e9b033769f333ba49055706c62961e8">reset_capacity</a>(rmt_xs_sz, <span class="keyword">true</span>);</div>
<div class="line"><a name="l03260"></a><span class="lineno"> 3260</span>&#160;  cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#ae80c9ada751aa4e59974d6277c56952b">rmt_qs_extrema</a>.<a class="code" href="structhomme_1_1cslmpi_1_1_fixed_cap_list.html#a3e9b033769f333ba49055706c62961e8">reset_capacity</a>(rmt_qse_sz, <span class="keyword">true</span>);</div>
<div class="line"><a name="l03261"></a><span class="lineno"> 3261</span>&#160;}</div>
<div class="line"><a name="l03262"></a><span class="lineno"> 3262</span>&#160; </div>
<div class="line"><a name="l03263"></a><span class="lineno"><a class="line" href="namespacehomme_1_1cslmpi.html#a8a5f75d82247e0c4dc633f7f1987d161"> 3263</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespacehomme_1_1cslmpi.html#a8a5f75d82247e0c4dc633f7f1987d161">alloc_mpi_buffers</a> (<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html">CslMpi</a>&amp; cm, <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a>* sendbuf = <span class="keyword">nullptr</span>, <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a>* recvbuf = <span class="keyword">nullptr</span>) {</div>
<div class="line"><a name="l03264"></a><span class="lineno"> 3264</span>&#160;  <span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> nrmtrank = <span class="keyword">static_cast&lt;</span><a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a><span class="keyword">&gt;</span>(cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a5402ced381c42ff2808665611c4cc0e0">ranks</a>.<a class="code" href="structhomme_1_1cslmpi_1_1_fixed_cap_list.html#ad5ac1ee99fc2091a5425a3d4dfade068">size</a>()) - 1;</div>
<div class="line"><a name="l03265"></a><span class="lineno"> 3265</span>&#160;  cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#acc05bcbacc077773d31a44fb2900d9f7">nx_in_rank</a>.<a class="code" href="structhomme_1_1cslmpi_1_1_fixed_cap_list.html#a3e9b033769f333ba49055706c62961e8">reset_capacity</a>(nrmtrank, <span class="keyword">true</span>);</div>
<div class="line"><a name="l03266"></a><span class="lineno"> 3266</span>&#160;  cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#aa9071b0582a3ac177ced0dc521e124ad">nx_in_lid</a>.<a class="code" href="structhomme_1_1cslmpi_1_1_list_of_lists.html#aa6d35555467b2286472dd6862b9b8cc3">init</a>(nrmtrank, cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#ae6362eba877446b15f51dc5d6d4ed37e">nlid_per_rank</a>.data());</div>
<div class="line"><a name="l03267"></a><span class="lineno"> 3267</span>&#160;  cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#ac8fa1afe06db413e6dfb8bcd37dec1a7">bla</a>.<a class="code" href="structhomme_1_1cslmpi_1_1_buffer_layout_array.html#a6762aeac900ca71b5857b0f441b5a66b">init</a>(nrmtrank, cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#ae6362eba877446b15f51dc5d6d4ed37e">nlid_per_rank</a>.data(), cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a3386735d284e9924db14acad99319d25">nlev</a>);</div>
<div class="line"><a name="l03268"></a><span class="lineno"> 3268</span>&#160;  cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#adaffbb9ca8a843233389aa2c8b8c5826">sendbuf</a>.<a class="code" href="structhomme_1_1cslmpi_1_1_list_of_lists.html#aa6d35555467b2286472dd6862b9b8cc3">init</a>(nrmtrank, cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#abdef54045d56d191f36b9fdaf8707f67">sendsz</a>.data(), sendbuf);</div>
<div class="line"><a name="l03269"></a><span class="lineno"> 3269</span>&#160;  cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#ae992f1c83abeae202aa8bbf4010b26bc">recvbuf</a>.<a class="code" href="structhomme_1_1cslmpi_1_1_list_of_lists.html#aa6d35555467b2286472dd6862b9b8cc3">init</a>(nrmtrank, cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a9f7fc421d09c34cbcf8f2d2a45b6b0dd">recvsz</a>.data(), recvbuf);</div>
<div class="line"><a name="l03270"></a><span class="lineno"> 3270</span>&#160;  cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#ae6362eba877446b15f51dc5d6d4ed37e">nlid_per_rank</a>.clear();</div>
<div class="line"><a name="l03271"></a><span class="lineno"> 3271</span>&#160;  cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#abdef54045d56d191f36b9fdaf8707f67">sendsz</a>.clear();</div>
<div class="line"><a name="l03272"></a><span class="lineno"> 3272</span>&#160;  cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a9f7fc421d09c34cbcf8f2d2a45b6b0dd">recvsz</a>.clear();</div>
<div class="line"><a name="l03273"></a><span class="lineno"> 3273</span>&#160;<span class="preprocessor">#ifdef HORIZ_OPENMP</span></div>
<div class="line"><a name="l03274"></a><span class="lineno"> 3274</span>&#160;  cm.ri_lidi_locks.init(nrmtrank, cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#ae6362eba877446b15f51dc5d6d4ed37e">nlid_per_rank</a>.data());</div>
<div class="line"><a name="l03275"></a><span class="lineno"> 3275</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> ri = 0; ri &lt; nrmtrank; ++ri) {</div>
<div class="line"><a name="l03276"></a><span class="lineno"> 3276</span>&#160;    <span class="keyword">auto</span>&amp;&amp; locks = cm.ri_lidi_locks(ri);</div>
<div class="line"><a name="l03277"></a><span class="lineno"> 3277</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; lock: locks)</div>
<div class="line"><a name="l03278"></a><span class="lineno"> 3278</span>&#160;      omp_init_lock(&amp;lock);</div>
<div class="line"><a name="l03279"></a><span class="lineno"> 3279</span>&#160;  }</div>
<div class="line"><a name="l03280"></a><span class="lineno"> 3280</span>&#160;<span class="preprocessor">#endif  </span></div>
<div class="line"><a name="l03281"></a><span class="lineno"> 3281</span>&#160;}</div>
<div class="line"><a name="l03282"></a><span class="lineno"> 3282</span>&#160; </div>
<div class="line"><a name="l03283"></a><span class="lineno"> 3283</span>&#160;<span class="comment">// At simulation initialization, set up a bunch of stuff to make the work at</span></div>
<div class="line"><a name="l03284"></a><span class="lineno"> 3284</span>&#160;<span class="comment">// each step as small as possible.</span></div>
<div class="line"><a name="l03285"></a><span class="lineno"><a class="line" href="namespacehomme_1_1cslmpi.html#abe9d1dd9e3c5e823f5ca4910aef91819"> 3285</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespacehomme_1_1cslmpi.html#abe9d1dd9e3c5e823f5ca4910aef91819">setup_comm_pattern</a> (<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html">CslMpi</a>&amp; cm, <span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a>* nbr_id_rank, <span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a>* nirptr) {</div>
<div class="line"><a name="l03286"></a><span class="lineno"> 3286</span>&#160;  <a class="code" href="namespacehomme_1_1cslmpi.html#af584967327f65221fc9f7707fde769bf">collect_gid_rank</a>(cm, nbr_id_rank, nirptr);</div>
<div class="line"><a name="l03287"></a><span class="lineno"> 3287</span>&#160;  <a class="code" href="namespacehomme_1_1cslmpi.html#a7ade007724eed5ac50831ef77f3c4431">Rank2Gids</a> rank2rmtgids, rank2owngids;</div>
<div class="line"><a name="l03288"></a><span class="lineno"> 3288</span>&#160;  <a class="code" href="namespacehomme_1_1cslmpi.html#a0d6deb13b24f57c3d1942a8b3162d246">get_rank2gids</a>(cm, rank2rmtgids, rank2owngids);</div>
<div class="line"><a name="l03289"></a><span class="lineno"> 3289</span>&#160;  {</div>
<div class="line"><a name="l03290"></a><span class="lineno"> 3290</span>&#160;    std::map&lt;Int, Int&gt; gid2rmt_owning_lid;</div>
<div class="line"><a name="l03291"></a><span class="lineno"> 3291</span>&#160;    <a class="code" href="namespacehomme_1_1cslmpi.html#ae779fc75a201a595ff26fb3496c7d91f">comm_lid_on_rank</a>(cm, rank2rmtgids, rank2owngids, gid2rmt_owning_lid);</div>
<div class="line"><a name="l03292"></a><span class="lineno"> 3292</span>&#160;    <a class="code" href="namespacehomme_1_1cslmpi.html#aacaed757e415d59a7d9e6f843f5fe026">set_idx2_maps</a>(cm, rank2rmtgids, gid2rmt_owning_lid);</div>
<div class="line"><a name="l03293"></a><span class="lineno"> 3293</span>&#160;  }</div>
<div class="line"><a name="l03294"></a><span class="lineno"> 3294</span>&#160;  <a class="code" href="namespacehomme_1_1cslmpi.html#a77abbc438e30f8cb28d694a58f93fa0d">size_mpi_buffers</a>(cm, rank2rmtgids, rank2owngids);</div>
<div class="line"><a name="l03295"></a><span class="lineno"> 3295</span>&#160;}</div>
<div class="line"><a name="l03296"></a><span class="lineno"> 3296</span>&#160; </div>
<div class="line"><a name="l03297"></a><span class="lineno"> 3297</span>&#160;<span class="comment">// mylid_with_comm(rankidx) is a list of element LIDs that have relations with</span></div>
<div class="line"><a name="l03298"></a><span class="lineno"> 3298</span>&#160;<span class="comment">// other elements on other ranks. For horizontal threading, need to find the</span></div>
<div class="line"><a name="l03299"></a><span class="lineno"> 3299</span>&#160;<span class="comment">// subsets that fit within the usual horizontal-threading nets:nete ranges.</span></div>
<div class="line"><a name="l03300"></a><span class="lineno"><a class="line" href="namespacehomme_1_1cslmpi.html#a871d0115e909fcb69d0afe3b9ce9c6c5"> 3300</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespacehomme_1_1cslmpi.html#a871d0115e909fcb69d0afe3b9ce9c6c5">init_mylid_with_comm_threaded</a> (<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html">CslMpi</a>&amp; cm, <span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a>&amp; nets, <span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a>&amp; nete) {</div>
<div class="line"><a name="l03301"></a><span class="lineno"> 3301</span>&#160;<span class="preprocessor">#ifdef HORIZ_OPENMP</span></div>
<div class="line"><a name="l03302"></a><span class="lineno"> 3302</span>&#160;<span class="preprocessor"># pragma omp barrier</span></div>
<div class="line"><a name="l03303"></a><span class="lineno"> 3303</span>&#160;<span class="preprocessor"># pragma omp master</span></div>
<div class="line"><a name="l03304"></a><span class="lineno"> 3304</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03305"></a><span class="lineno"> 3305</span>&#160;  {</div>
<div class="line"><a name="l03306"></a><span class="lineno"> 3306</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> nthr = <a class="code" href="namespacehomme_1_1cslmpi.html#a256ba3e25f45bad09c7ccdbbfbc5b520">get_num_threads</a>();</div>
<div class="line"><a name="l03307"></a><span class="lineno"> 3307</span>&#160;    cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a5ada77f6e71e2258d711ea2037ad7f47">rwork</a> = <a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a139aec4ef20fe08ceb0d29fa65f10941">CslMpi::Array&lt;Real**&gt;</a>(<span class="stringliteral">&quot;rwork&quot;</span>, nthr, cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a3d22abacf7bd37f0897d406f7566eb3f">qsize</a>);</div>
<div class="line"><a name="l03308"></a><span class="lineno"> 3308</span>&#160;    cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#aac097e860798e529cbc07ea2e643d266">mylid_with_comm_tid_ptr</a>.<a class="code" href="structhomme_1_1cslmpi_1_1_fixed_cap_list.html#a3e9b033769f333ba49055706c62961e8">reset_capacity</a>(nthr+1, <span class="keyword">true</span>);</div>
<div class="line"><a name="l03309"></a><span class="lineno"> 3309</span>&#160;    cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a255bf16730546cd00b75a932b8569670">horiz_openmp</a> = <a class="code" href="namespacehomme_1_1cslmpi.html#a256ba3e25f45bad09c7ccdbbfbc5b520">get_num_threads</a>() &gt; 1;</div>
<div class="line"><a name="l03310"></a><span class="lineno"> 3310</span>&#160;  }</div>
<div class="line"><a name="l03311"></a><span class="lineno"> 3311</span>&#160;<span class="preprocessor">#ifdef HORIZ_OPENMP</span></div>
<div class="line"><a name="l03312"></a><span class="lineno"> 3312</span>&#160;<span class="preprocessor"># pragma omp barrier</span></div>
<div class="line"><a name="l03313"></a><span class="lineno"> 3313</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03314"></a><span class="lineno"> 3314</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> tid = <a class="code" href="namespacehomme_1_1cslmpi.html#a7c49b694c0edee08b4ddb61b2b700867">get_tid</a>();</div>
<div class="line"><a name="l03315"></a><span class="lineno"> 3315</span>&#160;  <span class="keyword">const</span> <span class="keyword">auto</span>&amp; beg = std::lower_bound(cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a3f7d02fbb1bf0589c931e6526802c266">mylid_with_comm</a>.<a class="code" href="structhomme_1_1cslmpi_1_1_fixed_cap_list.html#adcf681a89e5b8db48d9268d35e6f0544">begin</a>(),</div>
<div class="line"><a name="l03316"></a><span class="lineno"> 3316</span>&#160;                                     cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a3f7d02fbb1bf0589c931e6526802c266">mylid_with_comm</a>.<a class="code" href="structhomme_1_1cslmpi_1_1_fixed_cap_list.html#a1cecc082c0d47805347a17f78fd78bb6">end</a>(), nets);</div>
<div class="line"><a name="l03317"></a><span class="lineno"> 3317</span>&#160;  <a class="code" href="compose__slmm_8cpp.html#a2912a5cf7e76e41c2ecf69b5c610479d">slmm_assert</a>(cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a09395c121510c776158739ce6fba7c31">p</a>-&gt;size() == 1 || beg != cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a3f7d02fbb1bf0589c931e6526802c266">mylid_with_comm</a>.<a class="code" href="structhomme_1_1cslmpi_1_1_fixed_cap_list.html#a1cecc082c0d47805347a17f78fd78bb6">end</a>());</div>
<div class="line"><a name="l03318"></a><span class="lineno"> 3318</span>&#160;  cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#aac097e860798e529cbc07ea2e643d266">mylid_with_comm_tid_ptr</a>(tid) = beg - cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a3f7d02fbb1bf0589c931e6526802c266">mylid_with_comm</a>.<a class="code" href="structhomme_1_1cslmpi_1_1_fixed_cap_list.html#adcf681a89e5b8db48d9268d35e6f0544">begin</a>();</div>
<div class="line"><a name="l03319"></a><span class="lineno"> 3319</span>&#160;  <span class="keywordflow">if</span> (tid == cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#aac097e860798e529cbc07ea2e643d266">mylid_with_comm_tid_ptr</a>.<a class="code" href="structhomme_1_1cslmpi_1_1_fixed_cap_list.html#aad4f28cbbbe5499b8e1a60e8d984aa18">n</a>() - 2) {</div>
<div class="line"><a name="l03320"></a><span class="lineno"> 3320</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span>&amp; end = std::lower_bound(cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a3f7d02fbb1bf0589c931e6526802c266">mylid_with_comm</a>.<a class="code" href="structhomme_1_1cslmpi_1_1_fixed_cap_list.html#adcf681a89e5b8db48d9268d35e6f0544">begin</a>(),</div>
<div class="line"><a name="l03321"></a><span class="lineno"> 3321</span>&#160;                                       cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a3f7d02fbb1bf0589c931e6526802c266">mylid_with_comm</a>.<a class="code" href="structhomme_1_1cslmpi_1_1_fixed_cap_list.html#a1cecc082c0d47805347a17f78fd78bb6">end</a>(), nete+1);</div>
<div class="line"><a name="l03322"></a><span class="lineno"> 3322</span>&#160;    cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#aac097e860798e529cbc07ea2e643d266">mylid_with_comm_tid_ptr</a>(tid+1) = end - cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a3f7d02fbb1bf0589c931e6526802c266">mylid_with_comm</a>.<a class="code" href="structhomme_1_1cslmpi_1_1_fixed_cap_list.html#adcf681a89e5b8db48d9268d35e6f0544">begin</a>();</div>
<div class="line"><a name="l03323"></a><span class="lineno"> 3323</span>&#160;  }</div>
<div class="line"><a name="l03324"></a><span class="lineno"> 3324</span>&#160;<span class="preprocessor">#ifdef HORIZ_OPENMP</span></div>
<div class="line"><a name="l03325"></a><span class="lineno"> 3325</span>&#160;<span class="preprocessor"># pragma omp barrier</span></div>
<div class="line"><a name="l03326"></a><span class="lineno"> 3326</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03327"></a><span class="lineno"> 3327</span>&#160;}</div>
<div class="line"><a name="l03328"></a><span class="lineno"> 3328</span>&#160; </div>
<div class="line"><a name="l03329"></a><span class="lineno"><a class="line" href="namespacehomme_1_1cslmpi.html#af40d7ea4fe4185cea6fc7c0e4f17133b"> 3329</a></span>&#160;<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#ae05655fc7966bb7cb695bc3933bc212d">CslMpi::Ptr</a> <a class="code" href="namespacehomme_1_1cslmpi.html#af40d7ea4fe4185cea6fc7c0e4f17133b">init</a> (<span class="keyword">const</span> <a class="code" href="structslmm_1_1_advecter.html#a14d43ce08c47ea1df937dc1703d195f3">slmm::Advecter::ConstPtr</a>&amp; advecter,</div>
<div class="line"><a name="l03330"></a><span class="lineno"> 3330</span>&#160;                  <span class="keyword">const</span> <a class="code" href="classhomme_1_1mpi_1_1_parallel.html#aff1fe34dd95083421911cd1a89f7191d">mpi::Parallel::Ptr</a>&amp; p,</div>
<div class="line"><a name="l03331"></a><span class="lineno"> 3331</span>&#160;                  <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> <a class="code" href="namespacedimensions__mod.html#a8648e26ae0e474ccf69d32a8148520c9">np</a>, <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> <a class="code" href="namespacedimensions__mod.html#a6baa218e1683465acc4f37fcea8e30d5">nlev</a>, <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> <a class="code" href="namespacedimensions__mod.html#a0070848a40ac48379601d9a8a183c83b">qsize</a>, <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> qsized, <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> <a class="code" href="namespacedimensions__mod.html#af2bd2c00f3bbb316bc19c0b7964b18c4">nelemd</a>,</div>
<div class="line"><a name="l03332"></a><span class="lineno"> 3332</span>&#160;                  <span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a>* nbr_id_rank, <span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a>* nirptr,</div>
<div class="line"><a name="l03333"></a><span class="lineno"> 3333</span>&#160;                  <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> halo) {</div>
<div class="line"><a name="l03334"></a><span class="lineno"> 3334</span>&#160;  <a class="code" href="compose__slmm_8cpp.html#a7290a1aabe779e162c8d6a36b3abec04">slmm_throw_if</a>(halo &lt; 1 || halo &gt; 2, <span class="stringliteral">&quot;halo must be 1 (default) or 2.&quot;</span>);</div>
<div class="line"><a name="l03335"></a><span class="lineno"> 3335</span>&#160;  <span class="keyword">auto</span> cm = std::make_shared&lt;CslMpi&gt;(p, advecter, <a class="code" href="namespacedimensions__mod.html#a8648e26ae0e474ccf69d32a8148520c9">np</a>, <a class="code" href="namespacedimensions__mod.html#a6baa218e1683465acc4f37fcea8e30d5">nlev</a>, <a class="code" href="namespacedimensions__mod.html#a0070848a40ac48379601d9a8a183c83b">qsize</a>, qsized,</div>
<div class="line"><a name="l03336"></a><span class="lineno"> 3336</span>&#160;                                     <a class="code" href="namespacedimensions__mod.html#af2bd2c00f3bbb316bc19c0b7964b18c4">nelemd</a>, halo);</div>
<div class="line"><a name="l03337"></a><span class="lineno"> 3337</span>&#160;  <a class="code" href="namespacehomme_1_1cslmpi.html#abe9d1dd9e3c5e823f5ca4910aef91819">setup_comm_pattern</a>(*cm, nbr_id_rank, nirptr);</div>
<div class="line"><a name="l03338"></a><span class="lineno"> 3338</span>&#160;  <span class="keywordflow">return</span> cm;</div>
<div class="line"><a name="l03339"></a><span class="lineno"> 3339</span>&#160;}</div>
<div class="line"><a name="l03340"></a><span class="lineno"> 3340</span>&#160; </div>
<div class="line"><a name="l03341"></a><span class="lineno"> 3341</span>&#160;<span class="comment">// For const clarity, take the non-const advecter as an arg, even though cm</span></div>
<div class="line"><a name="l03342"></a><span class="lineno"> 3342</span>&#160;<span class="comment">// already has a ref to the const&#39;ed one.</span></div>
<div class="line"><a name="l03343"></a><span class="lineno"><a class="line" href="namespacehomme_1_1cslmpi.html#ace72e34c6a3042506aac8ef481cddcec"> 3343</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespacehomme_1_1cslmpi.html#ace72e34c6a3042506aac8ef481cddcec">finalize_local_meshes</a> (<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html">CslMpi</a>&amp; cm, <a class="code" href="structslmm_1_1_advecter.html">slmm::Advecter</a>&amp; advecter) {</div>
<div class="line"><a name="l03344"></a><span class="lineno"> 3344</span>&#160;  <span class="keywordflow">if</span> (cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a27a93b756e637dd27f8383706bf6fa63">halo</a> == 2) <a class="code" href="namespacehomme_1_1cslmpi_1_1extend__halo.html#a16cf7ddbd04658463839e82fb8244824">extend_halo::extend_local_meshes</a>(*cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a09395c121510c776158739ce6fba7c31">p</a>, cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a4c8e08ae7a21ce60733abff37c9c5058">ed</a>, advecter);</div>
<div class="line"><a name="l03345"></a><span class="lineno"> 3345</span>&#160;  advecter.<a class="code" href="structslmm_1_1_advecter.html#aca02b2cf0c258e41f36f324159f5d0a8">fill_nearest_points_if_needed</a>();</div>
<div class="line"><a name="l03346"></a><span class="lineno"> 3346</span>&#160;}</div>
<div class="line"><a name="l03347"></a><span class="lineno"> 3347</span>&#160; </div>
<div class="line"><a name="l03348"></a><span class="lineno"> 3348</span>&#160;<span class="comment">// Set pointers to HOMME data arrays.</span></div>
<div class="line"><a name="l03349"></a><span class="lineno"><a class="line" href="namespacehomme_1_1cslmpi.html#a046d297dfd93e01977f02dac72bf35cc"> 3349</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespacehomme_1_1cslmpi.html#a046d297dfd93e01977f02dac72bf35cc">set_elem_data</a> (<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html">CslMpi</a>&amp; cm, <span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> ie, <span class="keyword">const</span> <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a>* metdet, <span class="keyword">const</span> <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a>* qdp,</div>
<div class="line"><a name="l03350"></a><span class="lineno"> 3350</span>&#160;                    <span class="keyword">const</span> <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a>* <a class="code" href="namespacedcmip2012__test5.html#ad259dec8945b10d8b2c6226e53589de5">dp</a>, <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a>* q, <span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> nelem_in_patch) {</div>
<div class="line"><a name="l03351"></a><span class="lineno"> 3351</span>&#160;  <a class="code" href="compose__slmm_8cpp.html#a2912a5cf7e76e41c2ecf69b5c610479d">slmm_assert</a>(ie &lt; cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a4c8e08ae7a21ce60733abff37c9c5058">ed</a>.size());</div>
<div class="line"><a name="l03352"></a><span class="lineno"> 3352</span>&#160;  <a class="code" href="compose__slmm_8cpp.html#a2912a5cf7e76e41c2ecf69b5c610479d">slmm_assert</a>(cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a27a93b756e637dd27f8383706bf6fa63">halo</a> &gt; 1 || cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a4c8e08ae7a21ce60733abff37c9c5058">ed</a>(ie).nbrs.size() == nelem_in_patch);</div>
<div class="line"><a name="l03353"></a><span class="lineno"> 3353</span>&#160;  <span class="keyword">auto</span>&amp; e = cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a4c8e08ae7a21ce60733abff37c9c5058">ed</a>(ie);</div>
<div class="line"><a name="l03354"></a><span class="lineno"> 3354</span>&#160;  e.metdet = metdet;</div>
<div class="line"><a name="l03355"></a><span class="lineno"> 3355</span>&#160;  e.qdp = qdp;</div>
<div class="line"><a name="l03356"></a><span class="lineno"> 3356</span>&#160;  e.dp = <a class="code" href="namespacedcmip2012__test5.html#ad259dec8945b10d8b2c6226e53589de5">dp</a>;</div>
<div class="line"><a name="l03357"></a><span class="lineno"> 3357</span>&#160;  e.q = q;</div>
<div class="line"><a name="l03358"></a><span class="lineno"> 3358</span>&#160;}</div>
<div class="line"><a name="l03359"></a><span class="lineno"> 3359</span>&#160; </div>
<div class="line"><a name="l03360"></a><span class="lineno"><a class="line" href="namespacehomme_1_1cslmpi.html#aacdc9acd8b3757395cefeae350460628"> 3360</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespacehomme_1_1cslmpi.html#aacdc9acd8b3757395cefeae350460628">setup_irecv</a> (<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html">CslMpi</a>&amp; cm, <span class="keyword">const</span> <span class="keywordtype">bool</span> skip_if_empty = <span class="keyword">false</span>) {</div>
<div class="line"><a name="l03361"></a><span class="lineno"> 3361</span>&#160;<span class="preprocessor">#ifdef HORIZ_OPENMP</span></div>
<div class="line"><a name="l03362"></a><span class="lineno"> 3362</span>&#160;<span class="preprocessor"># pragma omp master</span></div>
<div class="line"><a name="l03363"></a><span class="lineno"> 3363</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03364"></a><span class="lineno"> 3364</span>&#160;  {</div>
<div class="line"><a name="l03365"></a><span class="lineno"> 3365</span>&#160;    <span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> nrmtrank = <span class="keyword">static_cast&lt;</span><a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a><span class="keyword">&gt;</span>(cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a5402ced381c42ff2808665611c4cc0e0">ranks</a>.<a class="code" href="structhomme_1_1cslmpi_1_1_fixed_cap_list.html#ad5ac1ee99fc2091a5425a3d4dfade068">size</a>()) - 1;</div>
<div class="line"><a name="l03366"></a><span class="lineno"> 3366</span>&#160;    cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a610b60e516b4b287caae09bf8834f233">recvreq</a>.clear();</div>
<div class="line"><a name="l03367"></a><span class="lineno"> 3367</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> ri = 0; ri &lt; nrmtrank; ++ri) {</div>
<div class="line"><a name="l03368"></a><span class="lineno"> 3368</span>&#160;      <span class="keywordflow">if</span> (skip_if_empty &amp;&amp; cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#acc05bcbacc077773d31a44fb2900d9f7">nx_in_rank</a>(ri) == 0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l03369"></a><span class="lineno"> 3369</span>&#160;      <span class="keyword">auto</span>&amp;&amp; recvbuf = cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#ae992f1c83abeae202aa8bbf4010b26bc">recvbuf</a>(ri);</div>
<div class="line"><a name="l03370"></a><span class="lineno"> 3370</span>&#160;      <span class="comment">// The count is just the number of slots available, which can be larger</span></div>
<div class="line"><a name="l03371"></a><span class="lineno"> 3371</span>&#160;      <span class="comment">// than what is actually being received.</span></div>
<div class="line"><a name="l03372"></a><span class="lineno"> 3372</span>&#160;      cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a610b60e516b4b287caae09bf8834f233">recvreq</a>.inc();</div>
<div class="line"><a name="l03373"></a><span class="lineno"> 3373</span>&#160;      <a class="code" href="namespacehomme_1_1mpi.html#ad0286e50c3714e7a55f00f9a87c3637e">mpi::irecv</a>(*cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a09395c121510c776158739ce6fba7c31">p</a>, recvbuf.data(), recvbuf.n(), cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a5402ced381c42ff2808665611c4cc0e0">ranks</a>(ri), 42,</div>
<div class="line"><a name="l03374"></a><span class="lineno"> 3374</span>&#160;                 &amp;cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a610b60e516b4b287caae09bf8834f233">recvreq</a>.back());</div>
<div class="line"><a name="l03375"></a><span class="lineno"> 3375</span>&#160;    }</div>
<div class="line"><a name="l03376"></a><span class="lineno"> 3376</span>&#160;  }</div>
<div class="line"><a name="l03377"></a><span class="lineno"> 3377</span>&#160;}</div>
<div class="line"><a name="l03378"></a><span class="lineno"> 3378</span>&#160; </div>
<div class="line"><a name="l03379"></a><span class="lineno"><a class="line" href="namespacehomme_1_1cslmpi.html#a3022054afadca5fa11fa65363437cd72"> 3379</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespacehomme_1_1cslmpi.html#a3022054afadca5fa11fa65363437cd72">isend</a> (<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html">CslMpi</a>&amp; cm, <span class="keyword">const</span> <span class="keywordtype">bool</span> want_req = <span class="keyword">true</span>, <span class="keyword">const</span> <span class="keywordtype">bool</span> skip_if_empty = <span class="keyword">false</span>) {</div>
<div class="line"><a name="l03380"></a><span class="lineno"> 3380</span>&#160;<span class="preprocessor">#ifdef HORIZ_OPENMP</span></div>
<div class="line"><a name="l03381"></a><span class="lineno"> 3381</span>&#160;<span class="preprocessor"># pragma omp barrier</span></div>
<div class="line"><a name="l03382"></a><span class="lineno"> 3382</span>&#160;<span class="preprocessor"># pragma omp master</span></div>
<div class="line"><a name="l03383"></a><span class="lineno"> 3383</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03384"></a><span class="lineno"> 3384</span>&#160;  {</div>
<div class="line"><a name="l03385"></a><span class="lineno"> 3385</span>&#160;    <span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> nrmtrank = <span class="keyword">static_cast&lt;</span><a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a><span class="keyword">&gt;</span>(cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a5402ced381c42ff2808665611c4cc0e0">ranks</a>.<a class="code" href="structhomme_1_1cslmpi_1_1_fixed_cap_list.html#ad5ac1ee99fc2091a5425a3d4dfade068">size</a>()) - 1;</div>
<div class="line"><a name="l03386"></a><span class="lineno"> 3386</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> ri = 0; ri &lt; nrmtrank; ++ri) {</div>
<div class="line"><a name="l03387"></a><span class="lineno"> 3387</span>&#160;      <span class="keywordflow">if</span> (skip_if_empty &amp;&amp; cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#ab52f53a78f20b5ff0d0ad14439eb3bec">sendcount</a>(ri) == 0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l03388"></a><span class="lineno"> 3388</span>&#160;      <a class="code" href="namespacehomme_1_1mpi.html#ad8082dcb60fee10aa4100b8bdd436f50">mpi::isend</a>(*cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a09395c121510c776158739ce6fba7c31">p</a>, cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#adaffbb9ca8a843233389aa2c8b8c5826">sendbuf</a>(ri).data(), cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#ab52f53a78f20b5ff0d0ad14439eb3bec">sendcount</a>(ri),</div>
<div class="line"><a name="l03389"></a><span class="lineno"> 3389</span>&#160;                 cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a5402ced381c42ff2808665611c4cc0e0">ranks</a>(ri), 42, want_req ? &amp;cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a3de780cac76d3359bd90a33c189ea622">sendreq</a>(ri) : <span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l03390"></a><span class="lineno"> 3390</span>&#160;    }</div>
<div class="line"><a name="l03391"></a><span class="lineno"> 3391</span>&#160;  }</div>
<div class="line"><a name="l03392"></a><span class="lineno"> 3392</span>&#160;}</div>
<div class="line"><a name="l03393"></a><span class="lineno"> 3393</span>&#160; </div>
<div class="line"><a name="l03394"></a><span class="lineno"><a class="line" href="namespacehomme_1_1cslmpi.html#aef296f5b9c1f04eaf474e67814a27ee2"> 3394</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespacehomme_1_1cslmpi.html#aef296f5b9c1f04eaf474e67814a27ee2">recv_and_wait_on_send</a> (<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html">CslMpi</a>&amp; cm) {</div>
<div class="line"><a name="l03395"></a><span class="lineno"> 3395</span>&#160;<span class="preprocessor">#ifdef HORIZ_OPENMP</span></div>
<div class="line"><a name="l03396"></a><span class="lineno"> 3396</span>&#160;<span class="preprocessor"># pragma omp master</span></div>
<div class="line"><a name="l03397"></a><span class="lineno"> 3397</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03398"></a><span class="lineno"> 3398</span>&#160;  {</div>
<div class="line"><a name="l03399"></a><span class="lineno"> 3399</span>&#160;    <a class="code" href="namespacehomme_1_1mpi.html#a34f40c3b1676af66d3ee317213118a1a">mpi::waitall</a>(cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a3de780cac76d3359bd90a33c189ea622">sendreq</a>.n(), cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a3de780cac76d3359bd90a33c189ea622">sendreq</a>.data());</div>
<div class="line"><a name="l03400"></a><span class="lineno"> 3400</span>&#160;    <a class="code" href="namespacehomme_1_1mpi.html#a34f40c3b1676af66d3ee317213118a1a">mpi::waitall</a>(cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a610b60e516b4b287caae09bf8834f233">recvreq</a>.n(), cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a610b60e516b4b287caae09bf8834f233">recvreq</a>.data());</div>
<div class="line"><a name="l03401"></a><span class="lineno"> 3401</span>&#160;  }</div>
<div class="line"><a name="l03402"></a><span class="lineno"> 3402</span>&#160;<span class="preprocessor">#ifdef HORIZ_OPENMP</span></div>
<div class="line"><a name="l03403"></a><span class="lineno"> 3403</span>&#160;<span class="preprocessor"># pragma omp barrier</span></div>
<div class="line"><a name="l03404"></a><span class="lineno"> 3404</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03405"></a><span class="lineno"> 3405</span>&#160;}</div>
<div class="line"><a name="l03406"></a><span class="lineno"> 3406</span>&#160; </div>
<div class="line"><a name="l03407"></a><span class="lineno"><a class="line" href="namespacehomme_1_1cslmpi.html#ac51ce11648fb404be04ee0fdda9a409e"> 3407</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespacehomme_1_1cslmpi.html#ac51ce11648fb404be04ee0fdda9a409e">wait_on_send</a> (<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html">CslMpi</a>&amp; cm, <span class="keyword">const</span> <span class="keywordtype">bool</span> skip_if_empty = <span class="keyword">false</span>) {</div>
<div class="line"><a name="l03408"></a><span class="lineno"> 3408</span>&#160;<span class="preprocessor">#ifdef HORIZ_OPENMP</span></div>
<div class="line"><a name="l03409"></a><span class="lineno"> 3409</span>&#160;<span class="preprocessor"># pragma omp master</span></div>
<div class="line"><a name="l03410"></a><span class="lineno"> 3410</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03411"></a><span class="lineno"> 3411</span>&#160;  {</div>
<div class="line"><a name="l03412"></a><span class="lineno"> 3412</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> ri = 0; ri &lt; cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a3de780cac76d3359bd90a33c189ea622">sendreq</a>.n(); ++ri) {</div>
<div class="line"><a name="l03413"></a><span class="lineno"> 3413</span>&#160;      <span class="keywordflow">if</span> (skip_if_empty &amp;&amp; cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#ab52f53a78f20b5ff0d0ad14439eb3bec">sendcount</a>(ri) == 0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l03414"></a><span class="lineno"> 3414</span>&#160;      <a class="code" href="namespacehomme_1_1mpi.html#a3313f408c8edb7f88dbdc06d754841d3">mpi::wait</a>(&amp;cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a3de780cac76d3359bd90a33c189ea622">sendreq</a>(ri));</div>
<div class="line"><a name="l03415"></a><span class="lineno"> 3415</span>&#160;    }</div>
<div class="line"><a name="l03416"></a><span class="lineno"> 3416</span>&#160;  }</div>
<div class="line"><a name="l03417"></a><span class="lineno"> 3417</span>&#160;<span class="preprocessor">#ifdef HORIZ_OPENMP</span></div>
<div class="line"><a name="l03418"></a><span class="lineno"> 3418</span>&#160;<span class="preprocessor"># pragma omp barrier</span></div>
<div class="line"><a name="l03419"></a><span class="lineno"> 3419</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03420"></a><span class="lineno"> 3420</span>&#160;}</div>
<div class="line"><a name="l03421"></a><span class="lineno"> 3421</span>&#160; </div>
<div class="line"><a name="l03422"></a><span class="lineno"><a class="line" href="namespacehomme_1_1cslmpi.html#a2b713e2734729354e7c6f52f90ec64d6"> 3422</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespacehomme_1_1cslmpi.html#a2b713e2734729354e7c6f52f90ec64d6">recv</a> (<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html">CslMpi</a>&amp; cm, <span class="keyword">const</span> <span class="keywordtype">bool</span> skip_if_empty = <span class="keyword">false</span>) {</div>
<div class="line"><a name="l03423"></a><span class="lineno"> 3423</span>&#160;<span class="preprocessor">#ifdef HORIZ_OPENMP</span></div>
<div class="line"><a name="l03424"></a><span class="lineno"> 3424</span>&#160;<span class="preprocessor"># pragma omp master</span></div>
<div class="line"><a name="l03425"></a><span class="lineno"> 3425</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03426"></a><span class="lineno"> 3426</span>&#160;  {</div>
<div class="line"><a name="l03427"></a><span class="lineno"> 3427</span>&#160;    <a class="code" href="namespacehomme_1_1mpi.html#a34f40c3b1676af66d3ee317213118a1a">mpi::waitall</a>(cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a610b60e516b4b287caae09bf8834f233">recvreq</a>.n(), cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a610b60e516b4b287caae09bf8834f233">recvreq</a>.data());</div>
<div class="line"><a name="l03428"></a><span class="lineno"> 3428</span>&#160;  }</div>
<div class="line"><a name="l03429"></a><span class="lineno"> 3429</span>&#160;<span class="preprocessor">#ifdef HORIZ_OPENMP</span></div>
<div class="line"><a name="l03430"></a><span class="lineno"> 3430</span>&#160;<span class="preprocessor"># pragma omp barrier</span></div>
<div class="line"><a name="l03431"></a><span class="lineno"> 3431</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03432"></a><span class="lineno"> 3432</span>&#160;}</div>
<div class="line"><a name="l03433"></a><span class="lineno"> 3433</span>&#160; </div>
<div class="line"><a name="l03434"></a><span class="lineno"> 3434</span>&#160;<span class="comment">// Find where each departure point is.</span></div>
<div class="line"><a name="l03435"></a><span class="lineno"><a class="line" href="namespacehomme_1_1cslmpi.html#aee15eed8b1833f44fd858475eac23eca"> 3435</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespacehomme_1_1cslmpi.html#aee15eed8b1833f44fd858475eac23eca">analyze_dep_points</a> (<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html">CslMpi</a>&amp; cm, <span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a>&amp; nets, <span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a>&amp; nete,</div>
<div class="line"><a name="l03436"></a><span class="lineno"> 3436</span>&#160;                         <span class="keyword">const</span> <a class="code" href="namespacehomme.html#a854e69de78ccf3e48d7f20d364114b4d">FA4&lt;Real&gt;</a>&amp; dep_points) {</div>
<div class="line"><a name="l03437"></a><span class="lineno"> 3437</span>&#160;  <span class="keyword">const</span> <span class="keyword">auto</span> myrank = cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a09395c121510c776158739ce6fba7c31">p</a>-&gt;rank();</div>
<div class="line"><a name="l03438"></a><span class="lineno"> 3438</span>&#160;  <span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> nrmtrank = <span class="keyword">static_cast&lt;</span><a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a><span class="keyword">&gt;</span>(cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a5402ced381c42ff2808665611c4cc0e0">ranks</a>.<a class="code" href="structhomme_1_1cslmpi_1_1_fixed_cap_list.html#ad5ac1ee99fc2091a5425a3d4dfade068">size</a>()) - 1;</div>
<div class="line"><a name="l03439"></a><span class="lineno"> 3439</span>&#160;  cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#ac8fa1afe06db413e6dfb8bcd37dec1a7">bla</a>.<a class="code" href="structhomme_1_1cslmpi_1_1_buffer_layout_array.html#a7fc9a9e08333dbb6af828bc80c3496a7">zero</a>();</div>
<div class="line"><a name="l03440"></a><span class="lineno"> 3440</span>&#160;<span class="preprocessor">#ifdef HORIZ_OPENMP</span></div>
<div class="line"><a name="l03441"></a><span class="lineno"> 3441</span>&#160;<span class="preprocessor"># pragma omp for</span></div>
<div class="line"><a name="l03442"></a><span class="lineno"> 3442</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03443"></a><span class="lineno"> 3443</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> ri = 0; ri &lt; nrmtrank; ++ri)</div>
<div class="line"><a name="l03444"></a><span class="lineno"> 3444</span>&#160;    cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#aa9071b0582a3ac177ced0dc521e124ad">nx_in_lid</a>(ri).zero();</div>
<div class="line"><a name="l03445"></a><span class="lineno"> 3445</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> tci = nets; tci &lt;= nete; ++tci) {</div>
<div class="line"><a name="l03446"></a><span class="lineno"> 3446</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span>&amp; mesh = cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#ab10638ab6b28d2d99faf5835ce842a5d">advecter</a>-&gt;local_mesh(tci);</div>
<div class="line"><a name="l03447"></a><span class="lineno"> 3447</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span> tgt_idx = mesh.tgt_elem;</div>
<div class="line"><a name="l03448"></a><span class="lineno"> 3448</span>&#160;    <span class="keyword">auto</span>&amp; ed = cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a4c8e08ae7a21ce60733abff37c9c5058">ed</a>(tci);</div>
<div class="line"><a name="l03449"></a><span class="lineno"> 3449</span>&#160;    ed.own.clear();</div>
<div class="line"><a name="l03450"></a><span class="lineno"> 3450</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> lev = 0; lev &lt; cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a3386735d284e9924db14acad99319d25">nlev</a>; ++lev)</div>
<div class="line"><a name="l03451"></a><span class="lineno"> 3451</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> <a class="code" href="namespacebaroclinic__wave.html#a8619f63e6dd6db1077c1a18788afa359">k</a> = 0; <a class="code" href="namespacebaroclinic__wave.html#a8619f63e6dd6db1077c1a18788afa359">k</a> &lt; cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#ac64568d9b4b802315f2228beccaaac70">np2</a>; ++<a class="code" href="namespacebaroclinic__wave.html#a8619f63e6dd6db1077c1a18788afa359">k</a>) {</div>
<div class="line"><a name="l03452"></a><span class="lineno"> 3452</span>&#160;        <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> sci = <a class="code" href="namespaceslmm.html#a09c707719e4082afb80a56b15c2db8ac">slmm::get_src_cell</a>(mesh, &amp;dep_points(0,<a class="code" href="namespacebaroclinic__wave.html#a8619f63e6dd6db1077c1a18788afa359">k</a>,lev,tci), tgt_idx);</div>
<div class="line"><a name="l03453"></a><span class="lineno"> 3453</span>&#160;        <span class="keywordflow">if</span> (sci == -1 &amp;&amp; cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#ab10638ab6b28d2d99faf5835ce842a5d">advecter</a>-&gt;nearest_point_permitted(lev))</div>
<div class="line"><a name="l03454"></a><span class="lineno"> 3454</span>&#160;          sci = <a class="code" href="namespaceslmm.html#aa3b5eab9cd0be884ffa31f0f38300fd4">slmm::get_nearest_point</a>(</div>
<div class="line"><a name="l03455"></a><span class="lineno"> 3455</span>&#160;            mesh, cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#ab10638ab6b28d2d99faf5835ce842a5d">advecter</a>-&gt;nearest_point_data(tci),</div>
<div class="line"><a name="l03456"></a><span class="lineno"> 3456</span>&#160;            &amp;dep_points(0,<a class="code" href="namespacebaroclinic__wave.html#a8619f63e6dd6db1077c1a18788afa359">k</a>,lev,tci), tgt_idx);</div>
<div class="line"><a name="l03457"></a><span class="lineno"> 3457</span>&#160;        <span class="keywordflow">if</span> (sci == -1) {</div>
<div class="line"><a name="l03458"></a><span class="lineno"> 3458</span>&#160;          std::stringstream ss;</div>
<div class="line"><a name="l03459"></a><span class="lineno"> 3459</span>&#160;          ss.precision(17);</div>
<div class="line"><a name="l03460"></a><span class="lineno"> 3460</span>&#160;          <span class="keyword">const</span> <span class="keyword">auto</span>* v = &amp;dep_points(0,<a class="code" href="namespacebaroclinic__wave.html#a8619f63e6dd6db1077c1a18788afa359">k</a>,lev,tci);</div>
<div class="line"><a name="l03461"></a><span class="lineno"> 3461</span>&#160;          ss &lt;&lt; <span class="stringliteral">&quot;Departure point is outside of halo:\n&quot;</span></div>
<div class="line"><a name="l03462"></a><span class="lineno"> 3462</span>&#160;             &lt;&lt; <span class="stringliteral">&quot;  nearest point permitted: &quot;</span></div>
<div class="line"><a name="l03463"></a><span class="lineno"> 3463</span>&#160;             &lt;&lt; cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#ab10638ab6b28d2d99faf5835ce842a5d">advecter</a>-&gt;nearest_point_permitted(lev)</div>
<div class="line"><a name="l03464"></a><span class="lineno"> 3464</span>&#160;             &lt;&lt; <span class="stringliteral">&quot;\n  elem LID &quot;</span> &lt;&lt; tci</div>
<div class="line"><a name="l03465"></a><span class="lineno"> 3465</span>&#160;             &lt;&lt; <span class="stringliteral">&quot; elem GID &quot;</span> &lt;&lt; ed.me-&gt;gid</div>
<div class="line"><a name="l03466"></a><span class="lineno"> 3466</span>&#160;             &lt;&lt; <span class="stringliteral">&quot; (lev, k) (&quot;</span> &lt;&lt; lev &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; <a class="code" href="namespacebaroclinic__wave.html#a8619f63e6dd6db1077c1a18788afa359">k</a> &lt;&lt; <span class="stringliteral">&quot;)&quot;</span></div>
<div class="line"><a name="l03467"></a><span class="lineno"> 3467</span>&#160;             &lt;&lt; <span class="stringliteral">&quot; v &quot;</span> &lt;&lt; v[0] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; v[1] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; v[2]</div>
<div class="line"><a name="l03468"></a><span class="lineno"> 3468</span>&#160;             &lt;&lt; <span class="stringliteral">&quot;\n  tgt_idx &quot;</span> &lt;&lt; tgt_idx</div>
<div class="line"><a name="l03469"></a><span class="lineno"> 3469</span>&#160;             &lt;&lt; <span class="stringliteral">&quot; local mesh:\n  &quot;</span> &lt;&lt; <a class="code" href="namespaceslmm.html#abd0cae1accc71492fec5b3a5cfb40d09">slmm::to_string</a>(mesh) &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l03470"></a><span class="lineno"> 3470</span>&#160;          <a class="code" href="compose__slmm_8cpp.html#a7290a1aabe779e162c8d6a36b3abec04">slmm_throw_if</a>(sci == -1, ss.str());</div>
<div class="line"><a name="l03471"></a><span class="lineno"> 3471</span>&#160;        }</div>
<div class="line"><a name="l03472"></a><span class="lineno"> 3472</span>&#160;        ed.src(lev,<a class="code" href="namespacebaroclinic__wave.html#a8619f63e6dd6db1077c1a18788afa359">k</a>) = sci;</div>
<div class="line"><a name="l03473"></a><span class="lineno"> 3473</span>&#160;        <span class="keywordflow">if</span> (ed.nbrs(sci).rank == myrank) {</div>
<div class="line"><a name="l03474"></a><span class="lineno"> 3474</span>&#160;          ed.own.inc();</div>
<div class="line"><a name="l03475"></a><span class="lineno"> 3475</span>&#160;          <span class="keyword">auto</span>&amp; t = ed.own.back();</div>
<div class="line"><a name="l03476"></a><span class="lineno"> 3476</span>&#160;          t.lev = lev; t.k = <a class="code" href="namespacebaroclinic__wave.html#a8619f63e6dd6db1077c1a18788afa359">k</a>;</div>
<div class="line"><a name="l03477"></a><span class="lineno"> 3477</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l03478"></a><span class="lineno"> 3478</span>&#160;          <span class="keyword">const</span> <span class="keyword">auto</span> ri = ed.nbrs(sci).rank_idx;</div>
<div class="line"><a name="l03479"></a><span class="lineno"> 3479</span>&#160;          <span class="keyword">const</span> <span class="keyword">auto</span> lidi = ed.nbrs(sci).lid_on_rank_idx;</div>
<div class="line"><a name="l03480"></a><span class="lineno"> 3480</span>&#160;<span class="preprocessor">#ifdef HORIZ_OPENMP</span></div>
<div class="line"><a name="l03481"></a><span class="lineno"> 3481</span>&#160;          omp_lock_t* lock;</div>
<div class="line"><a name="l03482"></a><span class="lineno"> 3482</span>&#160;          <span class="keywordflow">if</span> (cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a255bf16730546cd00b75a932b8569670">horiz_openmp</a>) {</div>
<div class="line"><a name="l03483"></a><span class="lineno"> 3483</span>&#160;            lock = &amp;cm.ri_lidi_locks(ri,lidi);</div>
<div class="line"><a name="l03484"></a><span class="lineno"> 3484</span>&#160;            omp_set_lock(lock);</div>
<div class="line"><a name="l03485"></a><span class="lineno"> 3485</span>&#160;          }</div>
<div class="line"><a name="l03486"></a><span class="lineno"> 3486</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03487"></a><span class="lineno"> 3487</span>&#160;          {</div>
<div class="line"><a name="l03488"></a><span class="lineno"> 3488</span>&#160;            ++cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#aa9071b0582a3ac177ced0dc521e124ad">nx_in_lid</a>(ri,lidi);</div>
<div class="line"><a name="l03489"></a><span class="lineno"> 3489</span>&#160;            ++cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#ac8fa1afe06db413e6dfb8bcd37dec1a7">bla</a>(ri,lidi,lev).xptr;</div>
<div class="line"><a name="l03490"></a><span class="lineno"> 3490</span>&#160;          }</div>
<div class="line"><a name="l03491"></a><span class="lineno"> 3491</span>&#160;<span class="preprocessor">#ifdef HORIZ_OPENMP</span></div>
<div class="line"><a name="l03492"></a><span class="lineno"> 3492</span>&#160;          <span class="keywordflow">if</span> (cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a255bf16730546cd00b75a932b8569670">horiz_openmp</a>) omp_unset_lock(lock);</div>
<div class="line"><a name="l03493"></a><span class="lineno"> 3493</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03494"></a><span class="lineno"> 3494</span>&#160;        }</div>
<div class="line"><a name="l03495"></a><span class="lineno"> 3495</span>&#160;      }</div>
<div class="line"><a name="l03496"></a><span class="lineno"> 3496</span>&#160;  }</div>
<div class="line"><a name="l03497"></a><span class="lineno"> 3497</span>&#160;<span class="preprocessor">#ifdef HORIZ_OPENMP</span></div>
<div class="line"><a name="l03498"></a><span class="lineno"> 3498</span>&#160;<span class="preprocessor"># pragma omp barrier</span></div>
<div class="line"><a name="l03499"></a><span class="lineno"> 3499</span>&#160;<span class="preprocessor"># pragma omp for</span></div>
<div class="line"><a name="l03500"></a><span class="lineno"> 3500</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03501"></a><span class="lineno"> 3501</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> ri = 0; ri &lt; nrmtrank; ++ri) {</div>
<div class="line"><a name="l03502"></a><span class="lineno"> 3502</span>&#160;    <span class="keyword">auto</span>&amp; nx_in_rank = cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#acc05bcbacc077773d31a44fb2900d9f7">nx_in_rank</a>(ri);</div>
<div class="line"><a name="l03503"></a><span class="lineno"> 3503</span>&#160;    nx_in_rank = 0;</div>
<div class="line"><a name="l03504"></a><span class="lineno"> 3504</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> i = 0, n = cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a2bc103fcf1b1213dec73c720334e80a4">lid_on_rank</a>(ri).<a class="code" href="structhomme_1_1cslmpi_1_1_list_of_lists.html#a6711fa719e03ffad7df6afe223f9ea23">n</a>(); i &lt; n; ++i)</div>
<div class="line"><a name="l03505"></a><span class="lineno"> 3505</span>&#160;      nx_in_rank += cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#aa9071b0582a3ac177ced0dc521e124ad">nx_in_lid</a>(ri,i);</div>
<div class="line"><a name="l03506"></a><span class="lineno"> 3506</span>&#160;  }</div>
<div class="line"><a name="l03507"></a><span class="lineno"> 3507</span>&#160;}</div>
<div class="line"><a name="l03508"></a><span class="lineno"> 3508</span>&#160; </div>
<div class="line"><a name="l03509"></a><span class="lineno"> 3509</span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span> nreal_per_2int = (2*<span class="keyword">sizeof</span>(<a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a>) + <span class="keyword">sizeof</span>(<a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a>) - 1) / <span class="keyword">sizeof</span>(<a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a>);</div>
<div class="line"><a name="l03510"></a><span class="lineno"> 3510</span>&#160; </div>
<div class="line"><a name="l03511"></a><span class="lineno"> 3511</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> Buffer&gt;</div>
<div class="line"><a name="l03512"></a><span class="lineno"><a class="line" href="namespacehomme_1_1cslmpi.html#a052dd4e374a1b3adc306567af50bbf5f"> 3512</a></span>&#160;<a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> <a class="code" href="namespacehomme_1_1cslmpi.html#a052dd4e374a1b3adc306567af50bbf5f">setbuf</a> (Buffer&amp; buf, <span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a>&amp; os, <span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a>&amp; i1, <span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a>&amp; i2) {</div>
<div class="line"><a name="l03513"></a><span class="lineno"> 3513</span>&#160;  <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a>* <span class="keyword">const</span> <a class="code" href="namespacebaroclinic__wave.html#acf8e56bd7dfdfd2c39e16dfa491a5293">b</a> = <span class="keyword">reinterpret_cast&lt;</span><a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a>*<span class="keyword">&gt;</span>(&amp;buf(os));</div>
<div class="line"><a name="l03514"></a><span class="lineno"> 3514</span>&#160;  <a class="code" href="namespacebaroclinic__wave.html#acf8e56bd7dfdfd2c39e16dfa491a5293">b</a>[0] = i1;</div>
<div class="line"><a name="l03515"></a><span class="lineno"> 3515</span>&#160;  <a class="code" href="namespacebaroclinic__wave.html#acf8e56bd7dfdfd2c39e16dfa491a5293">b</a>[1] = i2;</div>
<div class="line"><a name="l03516"></a><span class="lineno"> 3516</span>&#160;  <span class="keywordflow">return</span> nreal_per_2int;</div>
<div class="line"><a name="l03517"></a><span class="lineno"> 3517</span>&#160;}</div>
<div class="line"><a name="l03518"></a><span class="lineno"> 3518</span>&#160; </div>
<div class="line"><a name="l03519"></a><span class="lineno"> 3519</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> Buffer&gt;</div>
<div class="line"><a name="l03520"></a><span class="lineno"><a class="line" href="namespacehomme_1_1cslmpi.html#a6b0c6a7c4b69df2b2a760305451493e4"> 3520</a></span>&#160;<a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> <a class="code" href="namespacehomme_1_1cslmpi.html#a6b0c6a7c4b69df2b2a760305451493e4">getbuf</a> (Buffer&amp; buf, <span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a>&amp; os, <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a>&amp; i1, <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a>&amp; i2) {</div>
<div class="line"><a name="l03521"></a><span class="lineno"> 3521</span>&#160;  <span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a>* <span class="keyword">const</span> <a class="code" href="namespacebaroclinic__wave.html#acf8e56bd7dfdfd2c39e16dfa491a5293">b</a> = <span class="keyword">reinterpret_cast&lt;</span><span class="keyword">const </span><a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a>*<span class="keyword">&gt;</span>(&amp;buf(os));</div>
<div class="line"><a name="l03522"></a><span class="lineno"> 3522</span>&#160;  i1 = <a class="code" href="namespacebaroclinic__wave.html#acf8e56bd7dfdfd2c39e16dfa491a5293">b</a>[0];</div>
<div class="line"><a name="l03523"></a><span class="lineno"> 3523</span>&#160;  i2 = <a class="code" href="namespacebaroclinic__wave.html#acf8e56bd7dfdfd2c39e16dfa491a5293">b</a>[1];</div>
<div class="line"><a name="l03524"></a><span class="lineno"> 3524</span>&#160;  <span class="keywordflow">return</span> nreal_per_2int;</div>
<div class="line"><a name="l03525"></a><span class="lineno"> 3525</span>&#160;}</div>
<div class="line"><a name="l03526"></a><span class="lineno"> 3526</span>&#160; </div>
<div class="line"><a name="l03527"></a><span class="lineno"> 3527</span>&#160;<span class="comment">/* Pack the departure points (x). We use two passes. We also set up the q</span></div>
<div class="line"><a name="l03528"></a><span class="lineno"> 3528</span>&#160;<span class="comment">   metadata. Two passes let us do some efficient tricks that are not available</span></div>
<div class="line"><a name="l03529"></a><span class="lineno"> 3529</span>&#160;<span class="comment">   with one pass. Departure point and q messages are formatted as follows:</span></div>
<div class="line"><a name="l03530"></a><span class="lineno"> 3530</span>&#160;<span class="comment">    xs: (#x-in-rank         int                                     &lt;-</span></div>
<div class="line"><a name="l03531"></a><span class="lineno"> 3531</span>&#160;<span class="comment">         x-bulk-data-offset i                                        |</span></div>
<div class="line"><a name="l03532"></a><span class="lineno"> 3532</span>&#160;<span class="comment">         (lid-on-rank       i     only packed if #x in lid &gt; 0       |</span></div>
<div class="line"><a name="l03533"></a><span class="lineno"> 3533</span>&#160;<span class="comment">          #x-in-lid         i     &gt; 0                                |- meta data</span></div>
<div class="line"><a name="l03534"></a><span class="lineno"> 3534</span>&#160;<span class="comment">          (lev              i     only packed if #x in (lid,lev) &gt; 0 |</span></div>
<div class="line"><a name="l03535"></a><span class="lineno"> 3535</span>&#160;<span class="comment">           #x)              i     &gt; 0                                |</span></div>
<div class="line"><a name="l03536"></a><span class="lineno"> 3536</span>&#160;<span class="comment">              *#lev) *#lid                                          &lt;-</span></div>
<div class="line"><a name="l03537"></a><span class="lineno"> 3537</span>&#160;<span class="comment">         x                  3 real                                  &lt;-- bulk data</span></div>
<div class="line"><a name="l03538"></a><span class="lineno"> 3538</span>&#160;<span class="comment">          *#x-in-rank) *#rank</span></div>
<div class="line"><a name="l03539"></a><span class="lineno"> 3539</span>&#160;<span class="comment">    qs: (q-extrema    2 qsize r   (min, max) packed together</span></div>
<div class="line"><a name="l03540"></a><span class="lineno"> 3540</span>&#160;<span class="comment">         q              qsize r</span></div>
<div class="line"><a name="l03541"></a><span class="lineno"> 3541</span>&#160;<span class="comment">          *#x) *#lev *#lid *#rank</span></div>
<div class="line"><a name="l03542"></a><span class="lineno"> 3542</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l03543"></a><span class="lineno"><a class="line" href="namespacehomme_1_1cslmpi.html#a07099f4d16dd444a00ee5992c322d330"> 3543</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespacehomme_1_1cslmpi.html#a07099f4d16dd444a00ee5992c322d330">pack_dep_points_sendbuf_pass1</a> (<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html">CslMpi</a>&amp; cm) {</div>
<div class="line"><a name="l03544"></a><span class="lineno"> 3544</span>&#160;  <span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> nrmtrank = <span class="keyword">static_cast&lt;</span><a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a><span class="keyword">&gt;</span>(cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a5402ced381c42ff2808665611c4cc0e0">ranks</a>.<a class="code" href="structhomme_1_1cslmpi_1_1_fixed_cap_list.html#ad5ac1ee99fc2091a5425a3d4dfade068">size</a>()) - 1;</div>
<div class="line"><a name="l03545"></a><span class="lineno"> 3545</span>&#160;<span class="preprocessor">#ifdef HORIZ_OPENMP</span></div>
<div class="line"><a name="l03546"></a><span class="lineno"> 3546</span>&#160;<span class="preprocessor"># pragma omp for</span></div>
<div class="line"><a name="l03547"></a><span class="lineno"> 3547</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03548"></a><span class="lineno"> 3548</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> ri = 0; ri &lt; nrmtrank; ++ri) {</div>
<div class="line"><a name="l03549"></a><span class="lineno"> 3549</span>&#160;    <span class="keyword">auto</span>&amp;&amp; sendbuf = cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#adaffbb9ca8a843233389aa2c8b8c5826">sendbuf</a>(ri);</div>
<div class="line"><a name="l03550"></a><span class="lineno"> 3550</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span>&amp;&amp; lid_on_rank = cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a2bc103fcf1b1213dec73c720334e80a4">lid_on_rank</a>(ri);</div>
<div class="line"><a name="l03551"></a><span class="lineno"> 3551</span>&#160;    <span class="comment">// metadata offset, x bulk data offset, q bulk data offset</span></div>
<div class="line"><a name="l03552"></a><span class="lineno"> 3552</span>&#160;    <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> mos = 0, xos = 0, qos = 0, sendcount = 0, cnt;</div>
<div class="line"><a name="l03553"></a><span class="lineno"> 3553</span>&#160;    cnt = <a class="code" href="namespacehomme_1_1cslmpi.html#a052dd4e374a1b3adc306567af50bbf5f">setbuf</a>(sendbuf, mos, 0, 0); <span class="comment">// empty space for later</span></div>
<div class="line"><a name="l03554"></a><span class="lineno"> 3554</span>&#160;    mos += cnt;</div>
<div class="line"><a name="l03555"></a><span class="lineno"> 3555</span>&#160;    sendcount += cnt;</div>
<div class="line"><a name="l03556"></a><span class="lineno"> 3556</span>&#160;    <span class="keywordflow">if</span> (cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#acc05bcbacc077773d31a44fb2900d9f7">nx_in_rank</a>(ri) == 0) {</div>
<div class="line"><a name="l03557"></a><span class="lineno"> 3557</span>&#160;      <a class="code" href="namespacehomme_1_1cslmpi.html#a052dd4e374a1b3adc306567af50bbf5f">setbuf</a>(sendbuf, 0, mos, 0);</div>
<div class="line"><a name="l03558"></a><span class="lineno"> 3558</span>&#160;      cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a04bec07079fb55ceea64db025fa69c9c">x_bulkdata_offset</a>(ri) = mos;</div>
<div class="line"><a name="l03559"></a><span class="lineno"> 3559</span>&#160;      cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#ab52f53a78f20b5ff0d0ad14439eb3bec">sendcount</a>(ri) = sendcount;</div>
<div class="line"><a name="l03560"></a><span class="lineno"> 3560</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l03561"></a><span class="lineno"> 3561</span>&#160;    }</div>
<div class="line"><a name="l03562"></a><span class="lineno"> 3562</span>&#160;    <span class="keyword">auto</span>&amp;&amp; bla = cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#ac8fa1afe06db413e6dfb8bcd37dec1a7">bla</a>(ri);</div>
<div class="line"><a name="l03563"></a><span class="lineno"> 3563</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> lidi = 0, lidn = lid_on_rank.n(); lidi &lt; lidn; ++lidi) {</div>
<div class="line"><a name="l03564"></a><span class="lineno"> 3564</span>&#160;      <span class="keyword">auto</span> nx_in_lid = cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#aa9071b0582a3ac177ced0dc521e124ad">nx_in_lid</a>(ri,lidi);</div>
<div class="line"><a name="l03565"></a><span class="lineno"> 3565</span>&#160;      <span class="keywordflow">if</span> (nx_in_lid == 0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l03566"></a><span class="lineno"> 3566</span>&#160;      cnt = <a class="code" href="namespacehomme_1_1cslmpi.html#a052dd4e374a1b3adc306567af50bbf5f">setbuf</a>(sendbuf, mos, lid_on_rank(lidi), nx_in_lid);</div>
<div class="line"><a name="l03567"></a><span class="lineno"> 3567</span>&#160;      mos += cnt;</div>
<div class="line"><a name="l03568"></a><span class="lineno"> 3568</span>&#160;      sendcount += cnt;</div>
<div class="line"><a name="l03569"></a><span class="lineno"> 3569</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> lev = 0; lev &lt; cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a3386735d284e9924db14acad99319d25">nlev</a>; ++lev) {</div>
<div class="line"><a name="l03570"></a><span class="lineno"> 3570</span>&#160;        <span class="keyword">auto</span>&amp; t = bla(lidi,lev);</div>
<div class="line"><a name="l03571"></a><span class="lineno"> 3571</span>&#160;        t.qptr = qos;</div>
<div class="line"><a name="l03572"></a><span class="lineno"> 3572</span>&#160;        <a class="code" href="compose__slmm_8cpp.html#a96f8d18b38ee102e3197014e54f3b457">slmm_assert_high</a>(t.cnt == 0);</div>
<div class="line"><a name="l03573"></a><span class="lineno"> 3573</span>&#160;        <span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> nx = t.xptr;</div>
<div class="line"><a name="l03574"></a><span class="lineno"> 3574</span>&#160;        <span class="keywordflow">if</span> (nx == 0) {</div>
<div class="line"><a name="l03575"></a><span class="lineno"> 3575</span>&#160;          t.xptr = -1;</div>
<div class="line"><a name="l03576"></a><span class="lineno"> 3576</span>&#160;          <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l03577"></a><span class="lineno"> 3577</span>&#160;        }</div>
<div class="line"><a name="l03578"></a><span class="lineno"> 3578</span>&#160;        <a class="code" href="compose__slmm_8cpp.html#a96f8d18b38ee102e3197014e54f3b457">slmm_assert_high</a>(nx &gt; 0);</div>
<div class="line"><a name="l03579"></a><span class="lineno"> 3579</span>&#160;        <span class="keyword">const</span> <span class="keyword">auto</span> dos = <a class="code" href="namespacehomme_1_1cslmpi.html#a052dd4e374a1b3adc306567af50bbf5f">setbuf</a>(sendbuf, mos, lev, nx);</div>
<div class="line"><a name="l03580"></a><span class="lineno"> 3580</span>&#160;        mos += dos;</div>
<div class="line"><a name="l03581"></a><span class="lineno"> 3581</span>&#160;        sendcount += dos + 3*nx;</div>
<div class="line"><a name="l03582"></a><span class="lineno"> 3582</span>&#160;        t.xptr = xos;</div>
<div class="line"><a name="l03583"></a><span class="lineno"> 3583</span>&#160;        xos += 3*nx;</div>
<div class="line"><a name="l03584"></a><span class="lineno"> 3584</span>&#160;        qos += 2 + nx;</div>
<div class="line"><a name="l03585"></a><span class="lineno"> 3585</span>&#160;        nx_in_lid -= nx;</div>
<div class="line"><a name="l03586"></a><span class="lineno"> 3586</span>&#160;      }</div>
<div class="line"><a name="l03587"></a><span class="lineno"> 3587</span>&#160;      <a class="code" href="compose__slmm_8cpp.html#a2912a5cf7e76e41c2ecf69b5c610479d">slmm_assert</a>(nx_in_lid == 0);</div>
<div class="line"><a name="l03588"></a><span class="lineno"> 3588</span>&#160;    }</div>
<div class="line"><a name="l03589"></a><span class="lineno"> 3589</span>&#160;    <a class="code" href="namespacehomme_1_1cslmpi.html#a052dd4e374a1b3adc306567af50bbf5f">setbuf</a>(sendbuf, 0, mos <span class="comment">/* offset to x bulk data */</span>, cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#acc05bcbacc077773d31a44fb2900d9f7">nx_in_rank</a>(ri));</div>
<div class="line"><a name="l03590"></a><span class="lineno"> 3590</span>&#160;    cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a04bec07079fb55ceea64db025fa69c9c">x_bulkdata_offset</a>(ri) = mos;</div>
<div class="line"><a name="l03591"></a><span class="lineno"> 3591</span>&#160;    cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#ab52f53a78f20b5ff0d0ad14439eb3bec">sendcount</a>(ri) = sendcount;</div>
<div class="line"><a name="l03592"></a><span class="lineno"> 3592</span>&#160;  }</div>
<div class="line"><a name="l03593"></a><span class="lineno"> 3593</span>&#160;}</div>
<div class="line"><a name="l03594"></a><span class="lineno"> 3594</span>&#160; </div>
<div class="line"><a name="l03595"></a><span class="lineno"><a class="line" href="namespacehomme_1_1cslmpi.html#a63db9c4328616160d33ba5a9a7c8af9e"> 3595</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespacehomme_1_1cslmpi.html#a63db9c4328616160d33ba5a9a7c8af9e">pack_dep_points_sendbuf_pass2</a> (<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html">CslMpi</a>&amp; cm, <span class="keyword">const</span> <a class="code" href="namespacehomme.html#a854e69de78ccf3e48d7f20d364114b4d">FA4&lt;const Real&gt;</a>&amp; dep_points) {</div>
<div class="line"><a name="l03596"></a><span class="lineno"> 3596</span>&#160;  <span class="keyword">const</span> <span class="keyword">auto</span> myrank = cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a09395c121510c776158739ce6fba7c31">p</a>-&gt;rank();</div>
<div class="line"><a name="l03597"></a><span class="lineno"> 3597</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> tid = <a class="code" href="namespacehomme_1_1cslmpi.html#a7c49b694c0edee08b4ddb61b2b700867">get_tid</a>();</div>
<div class="line"><a name="l03598"></a><span class="lineno"> 3598</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> ptr = cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#aac097e860798e529cbc07ea2e643d266">mylid_with_comm_tid_ptr</a>(tid),</div>
<div class="line"><a name="l03599"></a><span class="lineno"> 3599</span>&#160;           end = cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#aac097e860798e529cbc07ea2e643d266">mylid_with_comm_tid_ptr</a>(tid+1);</div>
<div class="line"><a name="l03600"></a><span class="lineno"> 3600</span>&#160;       ptr &lt; end; ++ptr) {</div>
<div class="line"><a name="l03601"></a><span class="lineno"> 3601</span>&#160;    <span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> tci = cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a3f7d02fbb1bf0589c931e6526802c266">mylid_with_comm</a>(ptr);</div>
<div class="line"><a name="l03602"></a><span class="lineno"> 3602</span>&#160;    <span class="keyword">auto</span>&amp; ed = cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a4c8e08ae7a21ce60733abff37c9c5058">ed</a>(tci);</div>
<div class="line"><a name="l03603"></a><span class="lineno"> 3603</span>&#160;    ed.rmt.clear();</div>
<div class="line"><a name="l03604"></a><span class="lineno"> 3604</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> lev = 0; lev &lt; cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a3386735d284e9924db14acad99319d25">nlev</a>; ++lev) {</div>
<div class="line"><a name="l03605"></a><span class="lineno"> 3605</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> <a class="code" href="namespacebaroclinic__wave.html#a8619f63e6dd6db1077c1a18788afa359">k</a> = 0; <a class="code" href="namespacebaroclinic__wave.html#a8619f63e6dd6db1077c1a18788afa359">k</a> &lt; cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#ac64568d9b4b802315f2228beccaaac70">np2</a>; ++<a class="code" href="namespacebaroclinic__wave.html#a8619f63e6dd6db1077c1a18788afa359">k</a>) {</div>
<div class="line"><a name="l03606"></a><span class="lineno"> 3606</span>&#160;        <span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> sci = ed.src(lev,<a class="code" href="namespacebaroclinic__wave.html#a8619f63e6dd6db1077c1a18788afa359">k</a>);</div>
<div class="line"><a name="l03607"></a><span class="lineno"> 3607</span>&#160;        <span class="keyword">const</span> <span class="keyword">auto</span>&amp; nbr = ed.nbrs(sci);</div>
<div class="line"><a name="l03608"></a><span class="lineno"> 3608</span>&#160;        <span class="keywordflow">if</span> (nbr.rank == myrank) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l03609"></a><span class="lineno"> 3609</span>&#160;        <span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> ri = nbr.rank_idx;</div>
<div class="line"><a name="l03610"></a><span class="lineno"> 3610</span>&#160;        <span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> lidi = nbr.lid_on_rank_idx;</div>
<div class="line"><a name="l03611"></a><span class="lineno"> 3611</span>&#160;        <span class="keyword">auto</span>&amp;&amp; sb = cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#adaffbb9ca8a843233389aa2c8b8c5826">sendbuf</a>(ri);</div>
<div class="line"><a name="l03612"></a><span class="lineno"> 3612</span>&#160;<span class="preprocessor">#ifdef HORIZ_OPENMP</span></div>
<div class="line"><a name="l03613"></a><span class="lineno"> 3613</span>&#160;        omp_lock_t* lock;</div>
<div class="line"><a name="l03614"></a><span class="lineno"> 3614</span>&#160;        <span class="keywordflow">if</span> (cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a255bf16730546cd00b75a932b8569670">horiz_openmp</a>) {</div>
<div class="line"><a name="l03615"></a><span class="lineno"> 3615</span>&#160;          lock = &amp;cm.ri_lidi_locks(ri,lidi);</div>
<div class="line"><a name="l03616"></a><span class="lineno"> 3616</span>&#160;          omp_set_lock(lock);</div>
<div class="line"><a name="l03617"></a><span class="lineno"> 3617</span>&#160;        }</div>
<div class="line"><a name="l03618"></a><span class="lineno"> 3618</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03619"></a><span class="lineno"> 3619</span>&#160;        <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> xptr, qptr, cnt; {</div>
<div class="line"><a name="l03620"></a><span class="lineno"> 3620</span>&#160;          <span class="keyword">auto</span>&amp; t = cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#ac8fa1afe06db413e6dfb8bcd37dec1a7">bla</a>(ri,lidi,lev);</div>
<div class="line"><a name="l03621"></a><span class="lineno"> 3621</span>&#160;          qptr = t.qptr;</div>
<div class="line"><a name="l03622"></a><span class="lineno"> 3622</span>&#160;          cnt = t.cnt;</div>
<div class="line"><a name="l03623"></a><span class="lineno"> 3623</span>&#160;          xptr = cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a04bec07079fb55ceea64db025fa69c9c">x_bulkdata_offset</a>(ri) + t.xptr + 3*cnt;</div>
<div class="line"><a name="l03624"></a><span class="lineno"> 3624</span>&#160;          ++t.cnt;</div>
<div class="line"><a name="l03625"></a><span class="lineno"> 3625</span>&#160;        }</div>
<div class="line"><a name="l03626"></a><span class="lineno"> 3626</span>&#160;<span class="preprocessor">#ifdef HORIZ_OPENMP</span></div>
<div class="line"><a name="l03627"></a><span class="lineno"> 3627</span>&#160;        <span class="keywordflow">if</span> (cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a255bf16730546cd00b75a932b8569670">horiz_openmp</a>) omp_unset_lock(lock);</div>
<div class="line"><a name="l03628"></a><span class="lineno"> 3628</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03629"></a><span class="lineno"> 3629</span>&#160;        <a class="code" href="compose__slmm_8cpp.html#a96f8d18b38ee102e3197014e54f3b457">slmm_assert_high</a>(xptr &gt; 0);</div>
<div class="line"><a name="l03630"></a><span class="lineno"> 3630</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> i = 0; i &lt; 3; ++i)</div>
<div class="line"><a name="l03631"></a><span class="lineno"> 3631</span>&#160;          sb(xptr + i) = dep_points(i,<a class="code" href="namespacebaroclinic__wave.html#a8619f63e6dd6db1077c1a18788afa359">k</a>,lev,tci);</div>
<div class="line"><a name="l03632"></a><span class="lineno"> 3632</span>&#160;        ed.rmt.inc();</div>
<div class="line"><a name="l03633"></a><span class="lineno"> 3633</span>&#160;        <span class="keyword">auto</span>&amp; item = ed.rmt.back();</div>
<div class="line"><a name="l03634"></a><span class="lineno"> 3634</span>&#160;        item.q_extrema_ptr = cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a3d22abacf7bd37f0897d406f7566eb3f">qsize</a> * qptr;</div>
<div class="line"><a name="l03635"></a><span class="lineno"> 3635</span>&#160;        item.q_ptr = item.q_extrema_ptr + cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a3d22abacf7bd37f0897d406f7566eb3f">qsize</a>*(2 + cnt);</div>
<div class="line"><a name="l03636"></a><span class="lineno"> 3636</span>&#160;        item.lev = lev;</div>
<div class="line"><a name="l03637"></a><span class="lineno"> 3637</span>&#160;        item.k = <a class="code" href="namespacebaroclinic__wave.html#a8619f63e6dd6db1077c1a18788afa359">k</a>;</div>
<div class="line"><a name="l03638"></a><span class="lineno"> 3638</span>&#160;      }</div>
<div class="line"><a name="l03639"></a><span class="lineno"> 3639</span>&#160;    }</div>
<div class="line"><a name="l03640"></a><span class="lineno"> 3640</span>&#160;  }</div>
<div class="line"><a name="l03641"></a><span class="lineno"> 3641</span>&#160;}</div>
<div class="line"><a name="l03642"></a><span class="lineno"> 3642</span>&#160; </div>
<div class="line"><a name="l03643"></a><span class="lineno"> 3643</span>&#160;<span class="keyword">template</span> &lt;Int np&gt;</div>
<div class="line"><a name="l03644"></a><span class="lineno"><a class="line" href="namespacehomme_1_1cslmpi.html#a1ac669e059bf52c0905a8b1be7420b8a"> 3644</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespacehomme_1_1cslmpi.html#a1ac669e059bf52c0905a8b1be7420b8a">calc_q_extrema</a> (<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html">CslMpi</a>&amp; cm, <span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a>&amp; nets, <span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a>&amp; nete) {</div>
<div class="line"><a name="l03645"></a><span class="lineno"> 3645</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> tci = nets; tci &lt;= nete; ++tci) {</div>
<div class="line"><a name="l03646"></a><span class="lineno"> 3646</span>&#160;    <span class="keyword">auto</span>&amp; ed = cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a4c8e08ae7a21ce60733abff37c9c5058">ed</a>(tci);</div>
<div class="line"><a name="l03647"></a><span class="lineno"> 3647</span>&#160;    <span class="keyword">const</span> <a class="code" href="namespacehomme.html#ac98706588408697743e06647261f5ffa">FA2&lt;const Real&gt;</a> <a class="code" href="namespacedcmip2012__test5.html#ad259dec8945b10d8b2c6226e53589de5">dp</a>(ed.dp, cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#ac64568d9b4b802315f2228beccaaac70">np2</a>, cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a3386735d284e9924db14acad99319d25">nlev</a>);</div>
<div class="line"><a name="l03648"></a><span class="lineno"> 3648</span>&#160;    <span class="keyword">const</span> <a class="code" href="namespacehomme.html#a9798590dfa671ded8ffd2295e714df11">FA3&lt;const Real&gt;</a> qdp(ed.qdp, cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#ac64568d9b4b802315f2228beccaaac70">np2</a>, cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a3386735d284e9924db14acad99319d25">nlev</a>, cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a3d22abacf7bd37f0897d406f7566eb3f">qsize</a>);</div>
<div class="line"><a name="l03649"></a><span class="lineno"> 3649</span>&#160;    <span class="keyword">const</span> <a class="code" href="namespacehomme.html#a9798590dfa671ded8ffd2295e714df11">FA3&lt;Real&gt;</a> q(ed.q, cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#ac64568d9b4b802315f2228beccaaac70">np2</a>, cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a3386735d284e9924db14acad99319d25">nlev</a>, cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a3d22abacf7bd37f0897d406f7566eb3f">qsize</a>);</div>
<div class="line"><a name="l03650"></a><span class="lineno"> 3650</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> iq = 0; iq &lt; cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a3d22abacf7bd37f0897d406f7566eb3f">qsize</a>; ++iq)</div>
<div class="line"><a name="l03651"></a><span class="lineno"> 3651</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> lev = 0; lev &lt; cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a3386735d284e9924db14acad99319d25">nlev</a>; ++lev) {</div>
<div class="line"><a name="l03652"></a><span class="lineno"> 3652</span>&#160;        <span class="keyword">const</span> <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a>* <span class="keyword">const</span> dp0 = &amp;<a class="code" href="namespacedcmip2012__test5.html#ad259dec8945b10d8b2c6226e53589de5">dp</a>(0,lev);</div>
<div class="line"><a name="l03653"></a><span class="lineno"> 3653</span>&#160;        <span class="keyword">const</span> <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a>* <span class="keyword">const</span> qdp0 = &amp;qdp(0,lev,iq);</div>
<div class="line"><a name="l03654"></a><span class="lineno"> 3654</span>&#160;        <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a>* <span class="keyword">const</span> <a class="code" href="namespacedcmip2012__test4.html#a17d6d85211f473d9cd440fcaca10820e">q0</a> = &amp;q(0,lev,iq);</div>
<div class="line"><a name="l03655"></a><span class="lineno"> 3655</span>&#160;        <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a> q_min_s, q_max_s;</div>
<div class="line"><a name="l03656"></a><span class="lineno"> 3656</span>&#160;        <a class="code" href="namespacedcmip2012__test4.html#a17d6d85211f473d9cd440fcaca10820e">q0</a>[0] = qdp0[0] / dp0[0];</div>
<div class="line"><a name="l03657"></a><span class="lineno"> 3657</span>&#160;        q_min_s = q_max_s = <a class="code" href="namespacedcmip2012__test4.html#a17d6d85211f473d9cd440fcaca10820e">q0</a>[0];</div>
<div class="line"><a name="l03658"></a><span class="lineno"> 3658</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> <a class="code" href="namespacebaroclinic__wave.html#a8619f63e6dd6db1077c1a18788afa359">k</a> = 1; <a class="code" href="namespacebaroclinic__wave.html#a8619f63e6dd6db1077c1a18788afa359">k</a> &lt; <a class="code" href="namespacedimensions__mod.html#a8648e26ae0e474ccf69d32a8148520c9">np</a>*<a class="code" href="namespacedimensions__mod.html#a8648e26ae0e474ccf69d32a8148520c9">np</a>; ++<a class="code" href="namespacebaroclinic__wave.html#a8619f63e6dd6db1077c1a18788afa359">k</a>) {</div>
<div class="line"><a name="l03659"></a><span class="lineno"> 3659</span>&#160;          <a class="code" href="namespacedcmip2012__test4.html#a17d6d85211f473d9cd440fcaca10820e">q0</a>[<a class="code" href="namespacebaroclinic__wave.html#a8619f63e6dd6db1077c1a18788afa359">k</a>] = qdp0[<a class="code" href="namespacebaroclinic__wave.html#a8619f63e6dd6db1077c1a18788afa359">k</a>] / dp0[<a class="code" href="namespacebaroclinic__wave.html#a8619f63e6dd6db1077c1a18788afa359">k</a>];</div>
<div class="line"><a name="l03660"></a><span class="lineno"> 3660</span>&#160;          q_min_s = <a class="code" href="namespacesiqk.html#aa8af675f4123cd3ef73b7d549fb84324">std::min</a>(q_min_s, <a class="code" href="namespacedcmip2012__test4.html#a17d6d85211f473d9cd440fcaca10820e">q0</a>[<a class="code" href="namespacebaroclinic__wave.html#a8619f63e6dd6db1077c1a18788afa359">k</a>]);</div>
<div class="line"><a name="l03661"></a><span class="lineno"> 3661</span>&#160;          q_max_s = <a class="code" href="namespacesiqk.html#a984fe7f0fc55d1f004981d9b6ffac4f7">std::max</a>(q_max_s, <a class="code" href="namespacedcmip2012__test4.html#a17d6d85211f473d9cd440fcaca10820e">q0</a>[<a class="code" href="namespacebaroclinic__wave.html#a8619f63e6dd6db1077c1a18788afa359">k</a>]);</div>
<div class="line"><a name="l03662"></a><span class="lineno"> 3662</span>&#160;        }</div>
<div class="line"><a name="l03663"></a><span class="lineno"> 3663</span>&#160;        ed.q_extrema(iq,lev,0) = q_min_s;</div>
<div class="line"><a name="l03664"></a><span class="lineno"> 3664</span>&#160;        ed.q_extrema(iq,lev,1) = q_max_s;</div>
<div class="line"><a name="l03665"></a><span class="lineno"> 3665</span>&#160;      }</div>
<div class="line"><a name="l03666"></a><span class="lineno"> 3666</span>&#160;  }  </div>
<div class="line"><a name="l03667"></a><span class="lineno"> 3667</span>&#160;}</div>
<div class="line"><a name="l03668"></a><span class="lineno"> 3668</span>&#160; </div>
<div class="line"><a name="l03669"></a><span class="lineno"> 3669</span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a></div>
<div class="line"><a name="l03670"></a><span class="lineno"> 3670</span>&#160;calc_q_use_q (<span class="keyword">const</span> <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a> rx[4], <span class="keyword">const</span> <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a> ry[4], <span class="keyword">const</span> <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a>* <span class="keyword">const</span> qs) {</div>
<div class="line"><a name="l03671"></a><span class="lineno"> 3671</span>&#160;  <span class="keywordflow">return</span> (ry[0]*(rx[0]*qs[ 0] + rx[1]*qs[ 1] + rx[2]*qs[ 2] + rx[3]*qs[ 3]) +</div>
<div class="line"><a name="l03672"></a><span class="lineno"> 3672</span>&#160;          ry[1]*(rx[0]*qs[ 4] + rx[1]*qs[ 5] + rx[2]*qs[ 6] + rx[3]*qs[ 7]) +</div>
<div class="line"><a name="l03673"></a><span class="lineno"> 3673</span>&#160;          ry[2]*(rx[0]*qs[ 8] + rx[1]*qs[ 9] + rx[2]*qs[10] + rx[3]*qs[11]) +</div>
<div class="line"><a name="l03674"></a><span class="lineno"> 3674</span>&#160;          ry[3]*(rx[0]*qs[12] + rx[1]*qs[13] + rx[2]*qs[14] + rx[3]*qs[15]));</div>
<div class="line"><a name="l03675"></a><span class="lineno"> 3675</span>&#160;}</div>
<div class="line"><a name="l03676"></a><span class="lineno"> 3676</span>&#160; </div>
<div class="line"><a name="l03677"></a><span class="lineno"> 3677</span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a></div>
<div class="line"><a name="l03678"></a><span class="lineno"> 3678</span>&#160;calc_q_use_qdp (<span class="keyword">const</span> <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a> rx[4], <span class="keyword">const</span> <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a> ry[4],</div>
<div class="line"><a name="l03679"></a><span class="lineno"> 3679</span>&#160;                <span class="keyword">const</span> <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a>* <span class="keyword">const</span> <a class="code" href="namespacedcmip2012__test5.html#ad259dec8945b10d8b2c6226e53589de5">dp</a>, <span class="keyword">const</span> <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a>* <span class="keyword">const</span> qdp) {</div>
<div class="line"><a name="l03680"></a><span class="lineno"> 3680</span>&#160;  <span class="keywordflow">return</span> (ry[0]*(rx[0]*(qdp[ 0]/<a class="code" href="namespacedcmip2012__test5.html#ad259dec8945b10d8b2c6226e53589de5">dp</a>[ 0]) + rx[1]*(qdp[ 1]/<a class="code" href="namespacedcmip2012__test5.html#ad259dec8945b10d8b2c6226e53589de5">dp</a>[ 1])  +</div>
<div class="line"><a name="l03681"></a><span class="lineno"> 3681</span>&#160;                 rx[2]*(qdp[ 2]/<a class="code" href="namespacedcmip2012__test5.html#ad259dec8945b10d8b2c6226e53589de5">dp</a>[ 2]) + rx[3]*(qdp[ 3]/<a class="code" href="namespacedcmip2012__test5.html#ad259dec8945b10d8b2c6226e53589de5">dp</a>[ 3])) +</div>
<div class="line"><a name="l03682"></a><span class="lineno"> 3682</span>&#160;          ry[1]*(rx[0]*(qdp[ 4]/<a class="code" href="namespacedcmip2012__test5.html#ad259dec8945b10d8b2c6226e53589de5">dp</a>[ 4]) + rx[1]*(qdp[ 5]/<a class="code" href="namespacedcmip2012__test5.html#ad259dec8945b10d8b2c6226e53589de5">dp</a>[ 5])  +</div>
<div class="line"><a name="l03683"></a><span class="lineno"> 3683</span>&#160;                 rx[2]*(qdp[ 6]/<a class="code" href="namespacedcmip2012__test5.html#ad259dec8945b10d8b2c6226e53589de5">dp</a>[ 6]) + rx[3]*(qdp[ 7]/<a class="code" href="namespacedcmip2012__test5.html#ad259dec8945b10d8b2c6226e53589de5">dp</a>[ 7])) +</div>
<div class="line"><a name="l03684"></a><span class="lineno"> 3684</span>&#160;          ry[2]*(rx[0]*(qdp[ 8]/<a class="code" href="namespacedcmip2012__test5.html#ad259dec8945b10d8b2c6226e53589de5">dp</a>[ 8]) + rx[1]*(qdp[ 9]/<a class="code" href="namespacedcmip2012__test5.html#ad259dec8945b10d8b2c6226e53589de5">dp</a>[ 9])  +</div>
<div class="line"><a name="l03685"></a><span class="lineno"> 3685</span>&#160;                 rx[2]*(qdp[10]/<a class="code" href="namespacedcmip2012__test5.html#ad259dec8945b10d8b2c6226e53589de5">dp</a>[10]) + rx[3]*(qdp[11]/<a class="code" href="namespacedcmip2012__test5.html#ad259dec8945b10d8b2c6226e53589de5">dp</a>[11])) +</div>
<div class="line"><a name="l03686"></a><span class="lineno"> 3686</span>&#160;          ry[3]*(rx[0]*(qdp[12]/<a class="code" href="namespacedcmip2012__test5.html#ad259dec8945b10d8b2c6226e53589de5">dp</a>[12]) + rx[1]*(qdp[13]/<a class="code" href="namespacedcmip2012__test5.html#ad259dec8945b10d8b2c6226e53589de5">dp</a>[13])  +</div>
<div class="line"><a name="l03687"></a><span class="lineno"> 3687</span>&#160;                 rx[2]*(qdp[14]/<a class="code" href="namespacedcmip2012__test5.html#ad259dec8945b10d8b2c6226e53589de5">dp</a>[14]) + rx[3]*(qdp[15]/<a class="code" href="namespacedcmip2012__test5.html#ad259dec8945b10d8b2c6226e53589de5">dp</a>[15])));</div>
<div class="line"><a name="l03688"></a><span class="lineno"> 3688</span>&#160;}</div>
<div class="line"><a name="l03689"></a><span class="lineno"> 3689</span>&#160; </div>
<div class="line"><a name="l03690"></a><span class="lineno"> 3690</span>&#160;<span class="keyword">template</span> &lt;Int np&gt;</div>
<div class="line"><a name="l03691"></a><span class="lineno"><a class="line" href="namespacehomme_1_1cslmpi.html#abbb2510c34ec1efc66ea9a7c40d08d3f"> 3691</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespacehomme_1_1cslmpi.html#abbb2510c34ec1efc66ea9a7c40d08d3f">calc_q</a> (<span class="keyword">const</span> <a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html">CslMpi</a>&amp; cm, <span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a>&amp; src_lid, <span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a>&amp; lev,</div>
<div class="line"><a name="l03692"></a><span class="lineno"> 3692</span>&#160;             <span class="keyword">const</span> <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a>* <span class="keyword">const</span> dep_point, <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a>* <span class="keyword">const</span> q_tgt, <span class="keyword">const</span> <span class="keywordtype">bool</span> use_q) {</div>
<div class="line"><a name="l03693"></a><span class="lineno"> 3693</span>&#160;  <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a> ref_coord[2]; {</div>
<div class="line"><a name="l03694"></a><span class="lineno"> 3694</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span>&amp; m = cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#ab10638ab6b28d2d99faf5835ce842a5d">advecter</a>-&gt;local_mesh(src_lid);</div>
<div class="line"><a name="l03695"></a><span class="lineno"> 3695</span>&#160;    cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#ab10638ab6b28d2d99faf5835ce842a5d">advecter</a>-&gt;s2r().calc_sphere_to_ref(src_lid, m, dep_point,</div>
<div class="line"><a name="l03696"></a><span class="lineno"> 3696</span>&#160;                                          ref_coord[0], ref_coord[1]);</div>
<div class="line"><a name="l03697"></a><span class="lineno"> 3697</span>&#160;  }</div>
<div class="line"><a name="l03698"></a><span class="lineno"> 3698</span>&#160; </div>
<div class="line"><a name="l03699"></a><span class="lineno"> 3699</span>&#160;  <span class="comment">// Interpolate.</span></div>
<div class="line"><a name="l03700"></a><span class="lineno"> 3700</span>&#160;  <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a> rx[4], ry[4];</div>
<div class="line"><a name="l03701"></a><span class="lineno"> 3701</span>&#160;  <span class="keywordflow">switch</span> (cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#ab10638ab6b28d2d99faf5835ce842a5d">advecter</a>-&gt;alg()) {</div>
<div class="line"><a name="l03702"></a><span class="lineno"> 3702</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="structslmm_1_1_advecter_1_1_alg.html#a8d25733af0135add595ca9429d96ae15a04aca1177ddd519ab399ffe663fe5cbb">slmm::Advecter::Alg::csl_gll</a>:</div>
<div class="line"><a name="l03703"></a><span class="lineno"> 3703</span>&#160;    <a class="code" href="namespaceslmm.html#a4d941cd95a177036a863d2f3387db705">slmm::gll_np4_eval</a>(ref_coord[0], rx);</div>
<div class="line"><a name="l03704"></a><span class="lineno"> 3704</span>&#160;    <a class="code" href="namespaceslmm.html#a4d941cd95a177036a863d2f3387db705">slmm::gll_np4_eval</a>(ref_coord[1], ry);</div>
<div class="line"><a name="l03705"></a><span class="lineno"> 3705</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03706"></a><span class="lineno"> 3706</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="structslmm_1_1_advecter_1_1_alg.html#a8d25733af0135add595ca9429d96ae15a4b92e82dd683b8e5e36401c4c417320c">slmm::Advecter::Alg::csl_gll_subgrid</a>:</div>
<div class="line"><a name="l03707"></a><span class="lineno"> 3707</span>&#160;    <a class="code" href="namespaceslmm.html#a6b2f7bea32d0ed791568dd376bc34122">slmm::gll_np4_subgrid_eval</a>(ref_coord[0], rx);</div>
<div class="line"><a name="l03708"></a><span class="lineno"> 3708</span>&#160;    <a class="code" href="namespaceslmm.html#a6b2f7bea32d0ed791568dd376bc34122">slmm::gll_np4_subgrid_eval</a>(ref_coord[1], ry);</div>
<div class="line"><a name="l03709"></a><span class="lineno"> 3709</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03710"></a><span class="lineno"> 3710</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="structslmm_1_1_advecter_1_1_alg.html#a8d25733af0135add595ca9429d96ae15a0fa461bca58d930799338c0dd9b26df2">slmm::Advecter::Alg::csl_gll_exp</a>:</div>
<div class="line"><a name="l03711"></a><span class="lineno"> 3711</span>&#160;    <a class="code" href="namespaceslmm.html#abdee94ea2e7e6d3c8fbeca0ddc821f8d">slmm::gll_np4_subgrid_exp_eval</a>(ref_coord[0], rx);</div>
<div class="line"><a name="l03712"></a><span class="lineno"> 3712</span>&#160;    <a class="code" href="namespaceslmm.html#abdee94ea2e7e6d3c8fbeca0ddc821f8d">slmm::gll_np4_subgrid_exp_eval</a>(ref_coord[1], ry);</div>
<div class="line"><a name="l03713"></a><span class="lineno"> 3713</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03714"></a><span class="lineno"> 3714</span>&#160;  <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l03715"></a><span class="lineno"> 3715</span>&#160;    <a class="code" href="compose__slmm_8cpp.html#a2912a5cf7e76e41c2ecf69b5c610479d">slmm_assert</a>(0);</div>
<div class="line"><a name="l03716"></a><span class="lineno"> 3716</span>&#160;  }</div>
<div class="line"><a name="l03717"></a><span class="lineno"> 3717</span>&#160; </div>
<div class="line"><a name="l03718"></a><span class="lineno"> 3718</span>&#160;  <span class="keyword">const</span> <span class="keyword">auto</span>&amp; ed = cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a4c8e08ae7a21ce60733abff37c9c5058">ed</a>(src_lid);</div>
<div class="line"><a name="l03719"></a><span class="lineno"> 3719</span>&#160;  <span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> levos = <a class="code" href="namespacedimensions__mod.html#a8648e26ae0e474ccf69d32a8148520c9">np</a>*<a class="code" href="namespacedimensions__mod.html#a8648e26ae0e474ccf69d32a8148520c9">np</a>*lev;</div>
<div class="line"><a name="l03720"></a><span class="lineno"> 3720</span>&#160;  <span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> np2nlev = <a class="code" href="namespacedimensions__mod.html#a8648e26ae0e474ccf69d32a8148520c9">np</a>*<a class="code" href="namespacedimensions__mod.html#a8648e26ae0e474ccf69d32a8148520c9">np</a>*cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a3386735d284e9924db14acad99319d25">nlev</a>;</div>
<div class="line"><a name="l03721"></a><span class="lineno"> 3721</span>&#160;  <span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> <a class="code" href="namespacedimensions__mod.html#a0070848a40ac48379601d9a8a183c83b">qsize</a> = cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a3d22abacf7bd37f0897d406f7566eb3f">qsize</a>;</div>
<div class="line"><a name="l03722"></a><span class="lineno"> 3722</span>&#160;  <span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> blocksize = 8;</div>
<div class="line"><a name="l03723"></a><span class="lineno"> 3723</span>&#160;  <span class="keywordflow">if</span> (use_q) {</div>
<div class="line"><a name="l03724"></a><span class="lineno"> 3724</span>&#160;    <span class="comment">// We can use q from calc_q_extrema.</span></div>
<div class="line"><a name="l03725"></a><span class="lineno"> 3725</span>&#160;    <span class="keyword">const</span> <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a>* <span class="keyword">const</span> qs0 = ed.q + levos;</div>
<div class="line"><a name="l03726"></a><span class="lineno"> 3726</span>&#160;    <span class="comment">// It was found that Intel 18 produced code that was not BFB between runs</span></div>
<div class="line"><a name="l03727"></a><span class="lineno"> 3727</span>&#160;    <span class="comment">// due to this pragma.</span></div>
<div class="line"><a name="l03728"></a><span class="lineno"> 3728</span>&#160;    <span class="comment">//#pragma ivdep</span></div>
<div class="line"><a name="l03729"></a><span class="lineno"> 3729</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> iqo = 0; iqo &lt; <a class="code" href="namespacedimensions__mod.html#a0070848a40ac48379601d9a8a183c83b">qsize</a>; iqo += blocksize) {</div>
<div class="line"><a name="l03730"></a><span class="lineno"> 3730</span>&#160;      <span class="comment">// So, instead, provide the compiler with a clear view of</span></div>
<div class="line"><a name="l03731"></a><span class="lineno"> 3731</span>&#160;      <span class="comment">// ivdep-ness. Write to tmp here in chunks of blocksize, then</span></div>
<div class="line"><a name="l03732"></a><span class="lineno"> 3732</span>&#160;      <span class="comment">// move tmp to q_tgt later.</span></div>
<div class="line"><a name="l03733"></a><span class="lineno"> 3733</span>&#160;      <span class="keywordflow">if</span> (iqo + blocksize &lt;= <a class="code" href="namespacedimensions__mod.html#a0070848a40ac48379601d9a8a183c83b">qsize</a>) {</div>
<div class="line"><a name="l03734"></a><span class="lineno"> 3734</span>&#160;        <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a> tmp[blocksize];</div>
<div class="line"><a name="l03735"></a><span class="lineno"> 3735</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> iqi = 0; iqi &lt; blocksize; ++iqi) {</div>
<div class="line"><a name="l03736"></a><span class="lineno"> 3736</span>&#160;          <span class="keyword">const</span> <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a>* <span class="keyword">const</span> qs = qs0 + (iqo + iqi)*np2nlev;</div>
<div class="line"><a name="l03737"></a><span class="lineno"> 3737</span>&#160;          tmp[iqi] = calc_q_use_q(rx, ry, qs);</div>
<div class="line"><a name="l03738"></a><span class="lineno"> 3738</span>&#160;        }</div>
<div class="line"><a name="l03739"></a><span class="lineno"> 3739</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> iqi = 0; iqi &lt; blocksize; ++iqi)</div>
<div class="line"><a name="l03740"></a><span class="lineno"> 3740</span>&#160;          q_tgt[iqo + iqi] = tmp[iqi];</div>
<div class="line"><a name="l03741"></a><span class="lineno"> 3741</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l03742"></a><span class="lineno"> 3742</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> iq = iqo; iq &lt; <a class="code" href="namespacedimensions__mod.html#a0070848a40ac48379601d9a8a183c83b">qsize</a>; ++iq) {</div>
<div class="line"><a name="l03743"></a><span class="lineno"> 3743</span>&#160;          <span class="keyword">const</span> <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a>* <span class="keyword">const</span> qs = qs0 + iq*np2nlev;</div>
<div class="line"><a name="l03744"></a><span class="lineno"> 3744</span>&#160;          q_tgt[iq] = calc_q_use_q(rx, ry, qs);</div>
<div class="line"><a name="l03745"></a><span class="lineno"> 3745</span>&#160;        }</div>
<div class="line"><a name="l03746"></a><span class="lineno"> 3746</span>&#160;      }</div>
<div class="line"><a name="l03747"></a><span class="lineno"> 3747</span>&#160;    }</div>
<div class="line"><a name="l03748"></a><span class="lineno"> 3748</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l03749"></a><span class="lineno"> 3749</span>&#160;    <span class="comment">// q from calc_q_extrema is being overwritten, so have to use qdp/dp.</span></div>
<div class="line"><a name="l03750"></a><span class="lineno"> 3750</span>&#160;    <span class="keyword">const</span> <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a>* <span class="keyword">const</span> <a class="code" href="namespacedcmip2012__test5.html#ad259dec8945b10d8b2c6226e53589de5">dp</a> = ed.dp + levos;</div>
<div class="line"><a name="l03751"></a><span class="lineno"> 3751</span>&#160;    <span class="keyword">const</span> <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a>* <span class="keyword">const</span> qdp0 = ed.qdp + levos;</div>
<div class="line"><a name="l03752"></a><span class="lineno"> 3752</span>&#160;    <span class="comment">// I&#39;m commenting out this pragma, too, to be safe.</span></div>
<div class="line"><a name="l03753"></a><span class="lineno"> 3753</span>&#160;    <span class="comment">//#pragma ivdep</span></div>
<div class="line"><a name="l03754"></a><span class="lineno"> 3754</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> iqo = 0; iqo &lt; <a class="code" href="namespacedimensions__mod.html#a0070848a40ac48379601d9a8a183c83b">qsize</a>; iqo += blocksize) {</div>
<div class="line"><a name="l03755"></a><span class="lineno"> 3755</span>&#160;      <span class="comment">// And I&#39;m using the same technique as above.</span></div>
<div class="line"><a name="l03756"></a><span class="lineno"> 3756</span>&#160;      <span class="keywordflow">if</span> (iqo + blocksize &lt;= <a class="code" href="namespacedimensions__mod.html#a0070848a40ac48379601d9a8a183c83b">qsize</a>) {</div>
<div class="line"><a name="l03757"></a><span class="lineno"> 3757</span>&#160;        <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a> tmp[blocksize];</div>
<div class="line"><a name="l03758"></a><span class="lineno"> 3758</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> iqi = 0; iqi &lt; blocksize; ++iqi) {</div>
<div class="line"><a name="l03759"></a><span class="lineno"> 3759</span>&#160;          <span class="keyword">const</span> <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a>* <span class="keyword">const</span> qdp = qdp0 + (iqo + iqi)*np2nlev;</div>
<div class="line"><a name="l03760"></a><span class="lineno"> 3760</span>&#160;          tmp[iqi] = calc_q_use_qdp(rx, ry, <a class="code" href="namespacedcmip2012__test5.html#ad259dec8945b10d8b2c6226e53589de5">dp</a>, qdp);</div>
<div class="line"><a name="l03761"></a><span class="lineno"> 3761</span>&#160;        }</div>
<div class="line"><a name="l03762"></a><span class="lineno"> 3762</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> iqi = 0; iqi &lt; blocksize; ++iqi)</div>
<div class="line"><a name="l03763"></a><span class="lineno"> 3763</span>&#160;          q_tgt[iqo + iqi] = tmp[iqi];</div>
<div class="line"><a name="l03764"></a><span class="lineno"> 3764</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l03765"></a><span class="lineno"> 3765</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> iq = iqo; iq &lt; <a class="code" href="namespacedimensions__mod.html#a0070848a40ac48379601d9a8a183c83b">qsize</a>; ++iq) {</div>
<div class="line"><a name="l03766"></a><span class="lineno"> 3766</span>&#160;          <span class="keyword">const</span> <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a>* <span class="keyword">const</span> qdp = qdp0 + iq*np2nlev;</div>
<div class="line"><a name="l03767"></a><span class="lineno"> 3767</span>&#160;          q_tgt[iq] = calc_q_use_qdp(rx, ry, <a class="code" href="namespacedcmip2012__test5.html#ad259dec8945b10d8b2c6226e53589de5">dp</a>, qdp);</div>
<div class="line"><a name="l03768"></a><span class="lineno"> 3768</span>&#160;        }</div>
<div class="line"><a name="l03769"></a><span class="lineno"> 3769</span>&#160;      }</div>
<div class="line"><a name="l03770"></a><span class="lineno"> 3770</span>&#160;    }</div>
<div class="line"><a name="l03771"></a><span class="lineno"> 3771</span>&#160;  }</div>
<div class="line"><a name="l03772"></a><span class="lineno"> 3772</span>&#160;}</div>
<div class="line"><a name="l03773"></a><span class="lineno"> 3773</span>&#160; </div>
<div class="line"><a name="l03774"></a><span class="lineno"> 3774</span>&#160;<span class="keyword">template</span> &lt;Int np&gt;</div>
<div class="line"><a name="l03775"></a><span class="lineno"><a class="line" href="namespacehomme_1_1cslmpi.html#ad48822a697a885d832273d545c21f5ce"> 3775</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespacehomme_1_1cslmpi.html#ad48822a697a885d832273d545c21f5ce">calc_rmt_q_pass1</a> (<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html">CslMpi</a>&amp; cm) {</div>
<div class="line"><a name="l03776"></a><span class="lineno"> 3776</span>&#160;<span class="preprocessor">#ifdef HORIZ_OPENMP</span></div>
<div class="line"><a name="l03777"></a><span class="lineno"> 3777</span>&#160;<span class="preprocessor"># pragma omp master</span></div>
<div class="line"><a name="l03778"></a><span class="lineno"> 3778</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03779"></a><span class="lineno"> 3779</span>&#160;  {</div>
<div class="line"><a name="l03780"></a><span class="lineno"> 3780</span>&#160;    <span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> nrmtrank = <span class="keyword">static_cast&lt;</span><a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a><span class="keyword">&gt;</span>(cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a5402ced381c42ff2808665611c4cc0e0">ranks</a>.<a class="code" href="structhomme_1_1cslmpi_1_1_fixed_cap_list.html#ad5ac1ee99fc2091a5425a3d4dfade068">size</a>()) - 1;</div>
<div class="line"><a name="l03781"></a><span class="lineno"> 3781</span>&#160;    <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> cnt = 0, qcnt = 0;</div>
<div class="line"><a name="l03782"></a><span class="lineno"> 3782</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> ri = 0; ri &lt; nrmtrank; ++ri) {</div>
<div class="line"><a name="l03783"></a><span class="lineno"> 3783</span>&#160;      <span class="keyword">const</span> <span class="keyword">auto</span>&amp;&amp; xs = cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#ae992f1c83abeae202aa8bbf4010b26bc">recvbuf</a>(ri);</div>
<div class="line"><a name="l03784"></a><span class="lineno"> 3784</span>&#160;      <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> mos = 0, qos = 0, nx_in_rank, xos;</div>
<div class="line"><a name="l03785"></a><span class="lineno"> 3785</span>&#160;      mos += <a class="code" href="namespacehomme_1_1cslmpi.html#a6b0c6a7c4b69df2b2a760305451493e4">getbuf</a>(xs, mos, xos, nx_in_rank);</div>
<div class="line"><a name="l03786"></a><span class="lineno"> 3786</span>&#160;      <span class="keywordflow">if</span> (nx_in_rank == 0) {</div>
<div class="line"><a name="l03787"></a><span class="lineno"> 3787</span>&#160;        cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#ab52f53a78f20b5ff0d0ad14439eb3bec">sendcount</a>(ri) = 0;</div>
<div class="line"><a name="l03788"></a><span class="lineno"> 3788</span>&#160;        <span class="keywordflow">continue</span>; </div>
<div class="line"><a name="l03789"></a><span class="lineno"> 3789</span>&#160;      }</div>
<div class="line"><a name="l03790"></a><span class="lineno"> 3790</span>&#160;      <span class="comment">// The upper bound is to prevent an inf loop if the msg is corrupted.</span></div>
<div class="line"><a name="l03791"></a><span class="lineno"> 3791</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> lidi = 0; lidi &lt; cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a8d3ead06518816f0985a84be689b0b85">nelemd</a>; ++lidi) {</div>
<div class="line"><a name="l03792"></a><span class="lineno"> 3792</span>&#160;        <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> lid, nx_in_lid;</div>
<div class="line"><a name="l03793"></a><span class="lineno"> 3793</span>&#160;        mos += <a class="code" href="namespacehomme_1_1cslmpi.html#a6b0c6a7c4b69df2b2a760305451493e4">getbuf</a>(xs, mos, lid, nx_in_lid);</div>
<div class="line"><a name="l03794"></a><span class="lineno"> 3794</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> levi = 0; levi &lt; cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a3386735d284e9924db14acad99319d25">nlev</a>; ++levi) { <span class="comment">// same re: inf loop</span></div>
<div class="line"><a name="l03795"></a><span class="lineno"> 3795</span>&#160;          <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> lev, nx;</div>
<div class="line"><a name="l03796"></a><span class="lineno"> 3796</span>&#160;          mos += <a class="code" href="namespacehomme_1_1cslmpi.html#a6b0c6a7c4b69df2b2a760305451493e4">getbuf</a>(xs, mos, lev, nx);</div>
<div class="line"><a name="l03797"></a><span class="lineno"> 3797</span>&#160;          <a class="code" href="compose__slmm_8cpp.html#a2912a5cf7e76e41c2ecf69b5c610479d">slmm_assert</a>(nx &gt; 0);</div>
<div class="line"><a name="l03798"></a><span class="lineno"> 3798</span>&#160;          {</div>
<div class="line"><a name="l03799"></a><span class="lineno"> 3799</span>&#160;            cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#ae80c9ada751aa4e59974d6277c56952b">rmt_qs_extrema</a>(4*qcnt + 0) = ri;</div>
<div class="line"><a name="l03800"></a><span class="lineno"> 3800</span>&#160;            cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#ae80c9ada751aa4e59974d6277c56952b">rmt_qs_extrema</a>(4*qcnt + 1) = lid;</div>
<div class="line"><a name="l03801"></a><span class="lineno"> 3801</span>&#160;            cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#ae80c9ada751aa4e59974d6277c56952b">rmt_qs_extrema</a>(4*qcnt + 2) = lev;</div>
<div class="line"><a name="l03802"></a><span class="lineno"> 3802</span>&#160;            cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#ae80c9ada751aa4e59974d6277c56952b">rmt_qs_extrema</a>(4*qcnt + 3) = qos;</div>
<div class="line"><a name="l03803"></a><span class="lineno"> 3803</span>&#160;            ++qcnt;</div>
<div class="line"><a name="l03804"></a><span class="lineno"> 3804</span>&#160;            qos += 2;</div>
<div class="line"><a name="l03805"></a><span class="lineno"> 3805</span>&#160;          }</div>
<div class="line"><a name="l03806"></a><span class="lineno"> 3806</span>&#160;          <span class="keywordflow">for</span> (<a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> xi = 0; xi &lt; nx; ++xi) {</div>
<div class="line"><a name="l03807"></a><span class="lineno"> 3807</span>&#160;            cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a370d8de04a4cc9d9e64cf4a3d3b28f94">rmt_xs</a>(5*cnt + 0) = ri;</div>
<div class="line"><a name="l03808"></a><span class="lineno"> 3808</span>&#160;            cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a370d8de04a4cc9d9e64cf4a3d3b28f94">rmt_xs</a>(5*cnt + 1) = lid;</div>
<div class="line"><a name="l03809"></a><span class="lineno"> 3809</span>&#160;            cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a370d8de04a4cc9d9e64cf4a3d3b28f94">rmt_xs</a>(5*cnt + 2) = lev;</div>
<div class="line"><a name="l03810"></a><span class="lineno"> 3810</span>&#160;            cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a370d8de04a4cc9d9e64cf4a3d3b28f94">rmt_xs</a>(5*cnt + 3) = xos;</div>
<div class="line"><a name="l03811"></a><span class="lineno"> 3811</span>&#160;            cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a370d8de04a4cc9d9e64cf4a3d3b28f94">rmt_xs</a>(5*cnt + 4) = qos;</div>
<div class="line"><a name="l03812"></a><span class="lineno"> 3812</span>&#160;            ++cnt;</div>
<div class="line"><a name="l03813"></a><span class="lineno"> 3813</span>&#160;            xos += 3;</div>
<div class="line"><a name="l03814"></a><span class="lineno"> 3814</span>&#160;            ++qos;</div>
<div class="line"><a name="l03815"></a><span class="lineno"> 3815</span>&#160;          }</div>
<div class="line"><a name="l03816"></a><span class="lineno"> 3816</span>&#160;          nx_in_lid -= nx;</div>
<div class="line"><a name="l03817"></a><span class="lineno"> 3817</span>&#160;          nx_in_rank -= nx;</div>
<div class="line"><a name="l03818"></a><span class="lineno"> 3818</span>&#160;          <span class="keywordflow">if</span> (nx_in_lid == 0) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03819"></a><span class="lineno"> 3819</span>&#160;        }</div>
<div class="line"><a name="l03820"></a><span class="lineno"> 3820</span>&#160;        <a class="code" href="compose__slmm_8cpp.html#a2912a5cf7e76e41c2ecf69b5c610479d">slmm_assert</a>(nx_in_lid == 0);</div>
<div class="line"><a name="l03821"></a><span class="lineno"> 3821</span>&#160;        <span class="keywordflow">if</span> (nx_in_rank == 0) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03822"></a><span class="lineno"> 3822</span>&#160;      }</div>
<div class="line"><a name="l03823"></a><span class="lineno"> 3823</span>&#160;      <a class="code" href="compose__slmm_8cpp.html#a2912a5cf7e76e41c2ecf69b5c610479d">slmm_assert</a>(nx_in_rank == 0);</div>
<div class="line"><a name="l03824"></a><span class="lineno"> 3824</span>&#160;      cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#ab52f53a78f20b5ff0d0ad14439eb3bec">sendcount</a>(ri) = cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a3d22abacf7bd37f0897d406f7566eb3f">qsize</a>*qos;</div>
<div class="line"><a name="l03825"></a><span class="lineno"> 3825</span>&#160;    }</div>
<div class="line"><a name="l03826"></a><span class="lineno"> 3826</span>&#160;    cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a0eacf20e4f92f3748c742f8360c1e760">nrmt_xs</a> = cnt;</div>
<div class="line"><a name="l03827"></a><span class="lineno"> 3827</span>&#160;    cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a5ed9e9c46d8d446b474544a70bb45622">nrmt_qs_extrema</a> = qcnt;</div>
<div class="line"><a name="l03828"></a><span class="lineno"> 3828</span>&#160;  }</div>
<div class="line"><a name="l03829"></a><span class="lineno"> 3829</span>&#160;<span class="preprocessor">#ifdef HORIZ_OPENMP</span></div>
<div class="line"><a name="l03830"></a><span class="lineno"> 3830</span>&#160;<span class="preprocessor"># pragma omp barrier</span></div>
<div class="line"><a name="l03831"></a><span class="lineno"> 3831</span>&#160;<span class="preprocessor">#endif  </span></div>
<div class="line"><a name="l03832"></a><span class="lineno"> 3832</span>&#160;}</div>
<div class="line"><a name="l03833"></a><span class="lineno"> 3833</span>&#160; </div>
<div class="line"><a name="l03834"></a><span class="lineno"> 3834</span>&#160;<span class="keyword">template</span> &lt;Int np&gt;</div>
<div class="line"><a name="l03835"></a><span class="lineno"><a class="line" href="namespacehomme_1_1cslmpi.html#a4bc85dab30db1c90c07f4f06a386dba3"> 3835</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespacehomme_1_1cslmpi.html#a4bc85dab30db1c90c07f4f06a386dba3">calc_rmt_q_pass2</a> (<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html">CslMpi</a>&amp; cm) {</div>
<div class="line"><a name="l03836"></a><span class="lineno"> 3836</span>&#160;  <span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> <a class="code" href="namespacedimensions__mod.html#a0070848a40ac48379601d9a8a183c83b">qsize</a> = cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a3d22abacf7bd37f0897d406f7566eb3f">qsize</a>;</div>
<div class="line"><a name="l03837"></a><span class="lineno"> 3837</span>&#160; </div>
<div class="line"><a name="l03838"></a><span class="lineno"> 3838</span>&#160;<span class="preprocessor">#ifdef HORIZ_OPENMP</span></div>
<div class="line"><a name="l03839"></a><span class="lineno"> 3839</span>&#160;<span class="preprocessor"># pragma omp for</span></div>
<div class="line"><a name="l03840"></a><span class="lineno"> 3840</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03841"></a><span class="lineno"> 3841</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> it = 0; it &lt; cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a5ed9e9c46d8d446b474544a70bb45622">nrmt_qs_extrema</a>; ++it) {</div>
<div class="line"><a name="l03842"></a><span class="lineno"> 3842</span>&#160;    <span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a></div>
<div class="line"><a name="l03843"></a><span class="lineno"> 3843</span>&#160;      ri = cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#ae80c9ada751aa4e59974d6277c56952b">rmt_qs_extrema</a>(4*it), lid = cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#ae80c9ada751aa4e59974d6277c56952b">rmt_qs_extrema</a>(4*it + 1),</div>
<div class="line"><a name="l03844"></a><span class="lineno"> 3844</span>&#160;      lev = cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#ae80c9ada751aa4e59974d6277c56952b">rmt_qs_extrema</a>(4*it + 2), qos = <a class="code" href="namespacedimensions__mod.html#a0070848a40ac48379601d9a8a183c83b">qsize</a>*cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#ae80c9ada751aa4e59974d6277c56952b">rmt_qs_extrema</a>(4*it + 3);  </div>
<div class="line"><a name="l03845"></a><span class="lineno"> 3845</span>&#160;    <span class="keyword">auto</span>&amp;&amp; qs = cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#adaffbb9ca8a843233389aa2c8b8c5826">sendbuf</a>(ri);</div>
<div class="line"><a name="l03846"></a><span class="lineno"> 3846</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span>&amp; ed = cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a4c8e08ae7a21ce60733abff37c9c5058">ed</a>(lid);</div>
<div class="line"><a name="l03847"></a><span class="lineno"> 3847</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> iq = 0; iq &lt; <a class="code" href="namespacedimensions__mod.html#a0070848a40ac48379601d9a8a183c83b">qsize</a>; ++iq)</div>
<div class="line"><a name="l03848"></a><span class="lineno"> 3848</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 2; ++i)</div>
<div class="line"><a name="l03849"></a><span class="lineno"> 3849</span>&#160;        qs(qos + 2*iq + i) = ed.q_extrema(iq, lev, i);</div>
<div class="line"><a name="l03850"></a><span class="lineno"> 3850</span>&#160;  }</div>
<div class="line"><a name="l03851"></a><span class="lineno"> 3851</span>&#160; </div>
<div class="line"><a name="l03852"></a><span class="lineno"> 3852</span>&#160;<span class="preprocessor">#ifdef HORIZ_OPENMP</span></div>
<div class="line"><a name="l03853"></a><span class="lineno"> 3853</span>&#160;<span class="preprocessor"># pragma omp for</span></div>
<div class="line"><a name="l03854"></a><span class="lineno"> 3854</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03855"></a><span class="lineno"> 3855</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> it = 0; it &lt; cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a0eacf20e4f92f3748c742f8360c1e760">nrmt_xs</a>; ++it) {</div>
<div class="line"><a name="l03856"></a><span class="lineno"> 3856</span>&#160;    <span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a></div>
<div class="line"><a name="l03857"></a><span class="lineno"> 3857</span>&#160;      ri = cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a370d8de04a4cc9d9e64cf4a3d3b28f94">rmt_xs</a>(5*it), lid = cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a370d8de04a4cc9d9e64cf4a3d3b28f94">rmt_xs</a>(5*it + 1), lev = cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a370d8de04a4cc9d9e64cf4a3d3b28f94">rmt_xs</a>(5*it + 2),</div>
<div class="line"><a name="l03858"></a><span class="lineno"> 3858</span>&#160;      xos = cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a370d8de04a4cc9d9e64cf4a3d3b28f94">rmt_xs</a>(5*it + 3), qos = <a class="code" href="namespacedimensions__mod.html#a0070848a40ac48379601d9a8a183c83b">qsize</a>*cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a370d8de04a4cc9d9e64cf4a3d3b28f94">rmt_xs</a>(5*it + 4);</div>
<div class="line"><a name="l03859"></a><span class="lineno"> 3859</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span>&amp;&amp; xs = cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#ae992f1c83abeae202aa8bbf4010b26bc">recvbuf</a>(ri);</div>
<div class="line"><a name="l03860"></a><span class="lineno"> 3860</span>&#160;    <span class="keyword">auto</span>&amp;&amp; qs = cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#adaffbb9ca8a843233389aa2c8b8c5826">sendbuf</a>(ri);</div>
<div class="line"><a name="l03861"></a><span class="lineno"> 3861</span>&#160;    calc_q&lt;np&gt;(cm, lid, lev, &amp;xs(xos), &amp;qs(qos), <span class="keyword">true</span>);</div>
<div class="line"><a name="l03862"></a><span class="lineno"> 3862</span>&#160;  }</div>
<div class="line"><a name="l03863"></a><span class="lineno"> 3863</span>&#160;}</div>
<div class="line"><a name="l03864"></a><span class="lineno"> 3864</span>&#160; </div>
<div class="line"><a name="l03865"></a><span class="lineno"> 3865</span>&#160;<span class="keyword">template</span> &lt;Int np&gt;</div>
<div class="line"><a name="l03866"></a><span class="lineno"><a class="line" href="namespacehomme_1_1cslmpi.html#a2a848539840228420a6645a192dc2dda"> 3866</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespacehomme_1_1cslmpi.html#a2a848539840228420a6645a192dc2dda">calc_rmt_q</a> (<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html">CslMpi</a>&amp; cm) {</div>
<div class="line"><a name="l03867"></a><span class="lineno"> 3867</span>&#160;  calc_rmt_q_pass1&lt;np&gt;(cm);</div>
<div class="line"><a name="l03868"></a><span class="lineno"> 3868</span>&#160;  calc_rmt_q_pass2&lt;np&gt;(cm);</div>
<div class="line"><a name="l03869"></a><span class="lineno"> 3869</span>&#160;}</div>
<div class="line"><a name="l03870"></a><span class="lineno"> 3870</span>&#160; </div>
<div class="line"><a name="l03871"></a><span class="lineno"> 3871</span>&#160;<span class="keyword">template</span> &lt;Int np&gt;</div>
<div class="line"><a name="l03872"></a><span class="lineno"><a class="line" href="namespacehomme_1_1cslmpi.html#a1cb73238389100b0af5524e6bfca9e23"> 3872</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespacehomme_1_1cslmpi.html#a1cb73238389100b0af5524e6bfca9e23">calc_own_q</a> (<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html">CslMpi</a>&amp; cm, <span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a>&amp; nets, <span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a>&amp; nete,</div>
<div class="line"><a name="l03873"></a><span class="lineno"> 3873</span>&#160;                 <span class="keyword">const</span> <a class="code" href="namespacehomme.html#a854e69de78ccf3e48d7f20d364114b4d">FA4&lt;const Real&gt;</a>&amp; dep_points,</div>
<div class="line"><a name="l03874"></a><span class="lineno"> 3874</span>&#160;                 <span class="keyword">const</span> <a class="code" href="namespacehomme.html#a854e69de78ccf3e48d7f20d364114b4d">FA4&lt;Real&gt;</a>&amp; q_min, <span class="keyword">const</span> <a class="code" href="namespacehomme.html#a854e69de78ccf3e48d7f20d364114b4d">FA4&lt;Real&gt;</a>&amp; q_max) {</div>
<div class="line"><a name="l03875"></a><span class="lineno"> 3875</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> tid = <a class="code" href="namespacehomme_1_1cslmpi.html#a7c49b694c0edee08b4ddb61b2b700867">get_tid</a>();</div>
<div class="line"><a name="l03876"></a><span class="lineno"> 3876</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> tci = 0; tci &lt; cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a8d3ead06518816f0985a84be689b0b85">nelemd</a>; ++tci) {</div>
<div class="line"><a name="l03877"></a><span class="lineno"> 3877</span>&#160;    <span class="keyword">auto</span>&amp; ed = cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a4c8e08ae7a21ce60733abff37c9c5058">ed</a>(tci);</div>
<div class="line"><a name="l03878"></a><span class="lineno"> 3878</span>&#160;    <span class="keyword">const</span> <a class="code" href="namespacehomme.html#a9798590dfa671ded8ffd2295e714df11">FA3&lt;Real&gt;</a> q_tgt(ed.q, cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#ac64568d9b4b802315f2228beccaaac70">np2</a>, cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a3386735d284e9924db14acad99319d25">nlev</a>, cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a3d22abacf7bd37f0897d406f7566eb3f">qsize</a>);</div>
<div class="line"><a name="l03879"></a><span class="lineno"> 3879</span>&#160;    <span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> ned = ed.own.n();</div>
<div class="line"><a name="l03880"></a><span class="lineno"> 3880</span>&#160;<span class="preprocessor">#ifdef HORIZ_OPENMP</span></div>
<div class="line"><a name="l03881"></a><span class="lineno"> 3881</span>&#160;<span class="preprocessor">    #pragma omp for</span></div>
<div class="line"><a name="l03882"></a><span class="lineno"> 3882</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03883"></a><span class="lineno"> 3883</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> idx = 0; idx &lt; ned; ++idx) {</div>
<div class="line"><a name="l03884"></a><span class="lineno"> 3884</span>&#160;      <span class="keyword">const</span> <span class="keyword">auto</span>&amp; e = ed.own(idx);</div>
<div class="line"><a name="l03885"></a><span class="lineno"> 3885</span>&#160;      <span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> slid = ed.nbrs(ed.src(e.lev, e.k)).lid_on_rank;</div>
<div class="line"><a name="l03886"></a><span class="lineno"> 3886</span>&#160;      <span class="keyword">const</span> <span class="keyword">auto</span>&amp; sed = cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a4c8e08ae7a21ce60733abff37c9c5058">ed</a>(slid);</div>
<div class="line"><a name="l03887"></a><span class="lineno"> 3887</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> iq = 0; iq &lt; cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a3d22abacf7bd37f0897d406f7566eb3f">qsize</a>; ++iq) {</div>
<div class="line"><a name="l03888"></a><span class="lineno"> 3888</span>&#160;        q_min(e.k, e.lev, iq, tci) = sed.q_extrema(iq, e.lev, 0);</div>
<div class="line"><a name="l03889"></a><span class="lineno"> 3889</span>&#160;        q_max(e.k, e.lev, iq, tci) = sed.q_extrema(iq, e.lev, 1);</div>
<div class="line"><a name="l03890"></a><span class="lineno"> 3890</span>&#160;      }</div>
<div class="line"><a name="l03891"></a><span class="lineno"> 3891</span>&#160;      <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a>* <span class="keyword">const</span> qtmp = &amp;cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a5ada77f6e71e2258d711ea2037ad7f47">rwork</a>(tid, 0);</div>
<div class="line"><a name="l03892"></a><span class="lineno"> 3892</span>&#160;      calc_q&lt;np&gt;(cm, slid, e.lev, &amp;dep_points(0, e.k, e.lev, tci), qtmp, <span class="keyword">false</span>);</div>
<div class="line"><a name="l03893"></a><span class="lineno"> 3893</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> iq = 0; iq &lt; cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a3d22abacf7bd37f0897d406f7566eb3f">qsize</a>; ++iq)</div>
<div class="line"><a name="l03894"></a><span class="lineno"> 3894</span>&#160;        q_tgt(e.k, e.lev, iq) = qtmp[iq];</div>
<div class="line"><a name="l03895"></a><span class="lineno"> 3895</span>&#160;    }</div>
<div class="line"><a name="l03896"></a><span class="lineno"> 3896</span>&#160;  }</div>
<div class="line"><a name="l03897"></a><span class="lineno"> 3897</span>&#160;}</div>
<div class="line"><a name="l03898"></a><span class="lineno"> 3898</span>&#160; </div>
<div class="line"><a name="l03899"></a><span class="lineno"><a class="line" href="namespacehomme_1_1cslmpi.html#a32509c39cdc3a8ba859f7ae3c9548fc9"> 3899</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespacehomme_1_1cslmpi.html#a32509c39cdc3a8ba859f7ae3c9548fc9">copy_q</a> (<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html">CslMpi</a>&amp; cm, <span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a>&amp; nets,</div>
<div class="line"><a name="l03900"></a><span class="lineno"> 3900</span>&#160;             <span class="keyword">const</span> <a class="code" href="namespacehomme.html#a854e69de78ccf3e48d7f20d364114b4d">FA4&lt;Real&gt;</a>&amp; q_min, <span class="keyword">const</span> <a class="code" href="namespacehomme.html#a854e69de78ccf3e48d7f20d364114b4d">FA4&lt;Real&gt;</a>&amp; q_max) {</div>
<div class="line"><a name="l03901"></a><span class="lineno"> 3901</span>&#160;  <span class="keyword">const</span> <span class="keyword">auto</span> myrank = cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a09395c121510c776158739ce6fba7c31">p</a>-&gt;rank();</div>
<div class="line"><a name="l03902"></a><span class="lineno"> 3902</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> tid = <a class="code" href="namespacehomme_1_1cslmpi.html#a7c49b694c0edee08b4ddb61b2b700867">get_tid</a>();</div>
<div class="line"><a name="l03903"></a><span class="lineno"> 3903</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> ptr = cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#aac097e860798e529cbc07ea2e643d266">mylid_with_comm_tid_ptr</a>(tid),</div>
<div class="line"><a name="l03904"></a><span class="lineno"> 3904</span>&#160;           end = cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#aac097e860798e529cbc07ea2e643d266">mylid_with_comm_tid_ptr</a>(tid+1);</div>
<div class="line"><a name="l03905"></a><span class="lineno"> 3905</span>&#160;       ptr &lt; end; ++ptr) {</div>
<div class="line"><a name="l03906"></a><span class="lineno"> 3906</span>&#160;    <span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> tci = cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a3f7d02fbb1bf0589c931e6526802c266">mylid_with_comm</a>(ptr);</div>
<div class="line"><a name="l03907"></a><span class="lineno"> 3907</span>&#160;    <span class="keyword">auto</span>&amp; ed = cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a4c8e08ae7a21ce60733abff37c9c5058">ed</a>(tci);</div>
<div class="line"><a name="l03908"></a><span class="lineno"> 3908</span>&#160;    <span class="keyword">const</span> <a class="code" href="namespacehomme.html#a9798590dfa671ded8ffd2295e714df11">FA3&lt;Real&gt;</a> q_tgt(ed.q, cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#ac64568d9b4b802315f2228beccaaac70">np2</a>, cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a3386735d284e9924db14acad99319d25">nlev</a>, cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a3d22abacf7bd37f0897d406f7566eb3f">qsize</a>);</div>
<div class="line"><a name="l03909"></a><span class="lineno"> 3909</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; e: ed.rmt) {</div>
<div class="line"><a name="l03910"></a><span class="lineno"> 3910</span>&#160;      <a class="code" href="compose__slmm_8cpp.html#a2912a5cf7e76e41c2ecf69b5c610479d">slmm_assert</a>(ed.nbrs(ed.src(e.lev, e.k)).rank != myrank);</div>
<div class="line"><a name="l03911"></a><span class="lineno"> 3911</span>&#160;      <span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> ri = ed.nbrs(ed.src(e.lev, e.k)).rank_idx;</div>
<div class="line"><a name="l03912"></a><span class="lineno"> 3912</span>&#160;      <span class="keyword">const</span> <span class="keyword">auto</span>&amp;&amp; recvbuf = cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#ae992f1c83abeae202aa8bbf4010b26bc">recvbuf</a>(ri);</div>
<div class="line"><a name="l03913"></a><span class="lineno"> 3913</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> iq = 0; iq &lt; cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a3d22abacf7bd37f0897d406f7566eb3f">qsize</a>; ++iq) {</div>
<div class="line"><a name="l03914"></a><span class="lineno"> 3914</span>&#160;        q_min(e.k, e.lev, iq, tci) = recvbuf(e.q_extrema_ptr + 2*iq    );</div>
<div class="line"><a name="l03915"></a><span class="lineno"> 3915</span>&#160;        q_max(e.k, e.lev, iq, tci) = recvbuf(e.q_extrema_ptr + 2*iq + 1);</div>
<div class="line"><a name="l03916"></a><span class="lineno"> 3916</span>&#160;      }</div>
<div class="line"><a name="l03917"></a><span class="lineno"> 3917</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> iq = 0; iq &lt; cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a3d22abacf7bd37f0897d406f7566eb3f">qsize</a>; ++iq) {</div>
<div class="line"><a name="l03918"></a><span class="lineno"> 3918</span>&#160;        <a class="code" href="compose__slmm_8cpp.html#a2912a5cf7e76e41c2ecf69b5c610479d">slmm_assert</a>(recvbuf(e.q_ptr + iq) != -1);</div>
<div class="line"><a name="l03919"></a><span class="lineno"> 3919</span>&#160;        q_tgt(e.k, e.lev, iq) = recvbuf(e.q_ptr + iq);</div>
<div class="line"><a name="l03920"></a><span class="lineno"> 3920</span>&#160;      }</div>
<div class="line"><a name="l03921"></a><span class="lineno"> 3921</span>&#160;    }</div>
<div class="line"><a name="l03922"></a><span class="lineno"> 3922</span>&#160;  }</div>
<div class="line"><a name="l03923"></a><span class="lineno"> 3923</span>&#160;}</div>
<div class="line"><a name="l03924"></a><span class="lineno"> 3924</span>&#160; </div>
<div class="line"><a name="l03925"></a><span class="lineno"> 3925</span>&#160;<span class="comment">/* dep_points is const in principle, but if lev &lt;=</span></div>
<div class="line"><a name="l03926"></a><span class="lineno"> 3926</span>&#160;<span class="comment">   semi_lagrange_nearest_point_lev, a departure point may be altered if the</span></div>
<div class="line"><a name="l03927"></a><span class="lineno"> 3927</span>&#160;<span class="comment">   winds take it outside of the comm halo.</span></div>
<div class="line"><a name="l03928"></a><span class="lineno"> 3928</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l03929"></a><span class="lineno"> 3929</span>&#160;<span class="keyword">template</span> &lt;<span class="keywordtype">int</span> np&gt;</div>
<div class="line"><a name="l03930"></a><span class="lineno"><a class="line" href="namespacehomme_1_1cslmpi.html#a19a9e463b1553c3e6c2995097f5520d5"> 3930</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespacehomme_1_1cslmpi.html#a19a9e463b1553c3e6c2995097f5520d5">step</a> (</div>
<div class="line"><a name="l03931"></a><span class="lineno"> 3931</span>&#160;  <a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html">CslMpi</a>&amp; cm, <span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> nets, <span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> nete,</div>
<div class="line"><a name="l03932"></a><span class="lineno"> 3932</span>&#160;  <a class="code" href="structhomme_1_1_cartesian3_d.html">Cartesian3D</a>* dep_points_r,    <span class="comment">// dep_points(1:3, 1:np, 1:np)</span></div>
<div class="line"><a name="l03933"></a><span class="lineno"> 3933</span>&#160;  <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a>* q_min_r, <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a>* q_max_r) <span class="comment">// q_{min,max}(1:np, 1:np, lev, 1:qsize, ie-nets+1)</span></div>
<div class="line"><a name="l03934"></a><span class="lineno"> 3934</span>&#160;{</div>
<div class="line"><a name="l03935"></a><span class="lineno"> 3935</span>&#160;  static_assert(<a class="code" href="namespacedimensions__mod.html#a8648e26ae0e474ccf69d32a8148520c9">np</a> == 4, <span class="stringliteral">&quot;SLMM CSL with special MPI is supported for np 4 only.&quot;</span>);</div>
<div class="line"><a name="l03936"></a><span class="lineno"> 3936</span>&#160;  <a class="code" href="compose__slmm_8cpp.html#a2912a5cf7e76e41c2ecf69b5c610479d">slmm_assert</a>(cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#ae61b8439c5232dc4cdcd885d6a6510c2">np</a> == 4);</div>
<div class="line"><a name="l03937"></a><span class="lineno"> 3937</span>&#160; </div>
<div class="line"><a name="l03938"></a><span class="lineno"> 3938</span>&#160;  <span class="keyword">const</span> <a class="code" href="namespacehomme.html#a854e69de78ccf3e48d7f20d364114b4d">FA4&lt;Real&gt;</a></div>
<div class="line"><a name="l03939"></a><span class="lineno"> 3939</span>&#160;    dep_points(<span class="keyword">reinterpret_cast&lt;</span><a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">Real</a>*<span class="keyword">&gt;</span>(dep_points_r),</div>
<div class="line"><a name="l03940"></a><span class="lineno"> 3940</span>&#160;               3, cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#ac64568d9b4b802315f2228beccaaac70">np2</a>, cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a3386735d284e9924db14acad99319d25">nlev</a>, cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a8d3ead06518816f0985a84be689b0b85">nelemd</a>);</div>
<div class="line"><a name="l03941"></a><span class="lineno"> 3941</span>&#160;  <span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">Int</a> <a class="code" href="namespacedimensions__mod.html#a64817c8f3506c463c896d202d237025e">nelem</a> = nete - nets + 1;</div>
<div class="line"><a name="l03942"></a><span class="lineno"> 3942</span>&#160;  <span class="keyword">const</span> <a class="code" href="namespacehomme.html#a854e69de78ccf3e48d7f20d364114b4d">FA4&lt;Real&gt;</a></div>
<div class="line"><a name="l03943"></a><span class="lineno"> 3943</span>&#160;    q_min(q_min_r, cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#ac64568d9b4b802315f2228beccaaac70">np2</a>, cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a3386735d284e9924db14acad99319d25">nlev</a>, cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a3d22abacf7bd37f0897d406f7566eb3f">qsize</a>, cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a8d3ead06518816f0985a84be689b0b85">nelemd</a>),</div>
<div class="line"><a name="l03944"></a><span class="lineno"> 3944</span>&#160;    q_max(q_max_r, cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#ac64568d9b4b802315f2228beccaaac70">np2</a>, cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a3386735d284e9924db14acad99319d25">nlev</a>, cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a3d22abacf7bd37f0897d406f7566eb3f">qsize</a>, cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a8d3ead06518816f0985a84be689b0b85">nelemd</a>);</div>
<div class="line"><a name="l03945"></a><span class="lineno"> 3945</span>&#160; </div>
<div class="line"><a name="l03946"></a><span class="lineno"> 3946</span>&#160;  <span class="comment">// Partition my elements that communicate with remotes among threads, if I</span></div>
<div class="line"><a name="l03947"></a><span class="lineno"> 3947</span>&#160;  <span class="comment">// haven&#39;t done that yet.</span></div>
<div class="line"><a name="l03948"></a><span class="lineno"> 3948</span>&#160;  <span class="keywordflow">if</span> (cm.<a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#aac097e860798e529cbc07ea2e643d266">mylid_with_comm_tid_ptr</a>.<a class="code" href="structhomme_1_1cslmpi_1_1_fixed_cap_list.html#aad4f28cbbbe5499b8e1a60e8d984aa18">n</a>() == 0)</div>
<div class="line"><a name="l03949"></a><span class="lineno"> 3949</span>&#160;    <a class="code" href="namespacehomme_1_1cslmpi.html#a871d0115e909fcb69d0afe3b9ce9c6c5">init_mylid_with_comm_threaded</a>(cm, nets, nete);</div>
<div class="line"><a name="l03950"></a><span class="lineno"> 3950</span>&#160;  <span class="comment">// Set up to receive departure point requests from remotes.</span></div>
<div class="line"><a name="l03951"></a><span class="lineno"> 3951</span>&#160;  <a class="code" href="namespacehomme_1_1cslmpi.html#aacdc9acd8b3757395cefeae350460628">setup_irecv</a>(cm);</div>
<div class="line"><a name="l03952"></a><span class="lineno"> 3952</span>&#160;  <span class="comment">// Determine where my departure points are, and set up requests to remotes as</span></div>
<div class="line"><a name="l03953"></a><span class="lineno"> 3953</span>&#160;  <span class="comment">// well as to myself to fulfill these.</span></div>
<div class="line"><a name="l03954"></a><span class="lineno"> 3954</span>&#160;  <a class="code" href="namespacehomme_1_1cslmpi.html#aee15eed8b1833f44fd858475eac23eca">analyze_dep_points</a>(cm, nets, nete, dep_points);</div>
<div class="line"><a name="l03955"></a><span class="lineno"> 3955</span>&#160;  <a class="code" href="namespacehomme_1_1cslmpi.html#a07099f4d16dd444a00ee5992c322d330">pack_dep_points_sendbuf_pass1</a>(cm);</div>
<div class="line"><a name="l03956"></a><span class="lineno"> 3956</span>&#160;  <a class="code" href="namespacehomme_1_1cslmpi.html#a63db9c4328616160d33ba5a9a7c8af9e">pack_dep_points_sendbuf_pass2</a>(cm, dep_points);</div>
<div class="line"><a name="l03957"></a><span class="lineno"> 3957</span>&#160;  <span class="comment">// Send requests.</span></div>
<div class="line"><a name="l03958"></a><span class="lineno"> 3958</span>&#160;  <a class="code" href="namespacehomme_1_1cslmpi.html#a3022054afadca5fa11fa65363437cd72">isend</a>(cm);</div>
<div class="line"><a name="l03959"></a><span class="lineno"> 3959</span>&#160;  <span class="comment">// While waiting, compute q extrema in each of my elements.</span></div>
<div class="line"><a name="l03960"></a><span class="lineno"> 3960</span>&#160;  calc_q_extrema&lt;np&gt;(cm, nets, nete);</div>
<div class="line"><a name="l03961"></a><span class="lineno"> 3961</span>&#160;  <span class="comment">// Wait for the departure point requests. Since this requires a thread</span></div>
<div class="line"><a name="l03962"></a><span class="lineno"> 3962</span>&#160;  <span class="comment">// barrier, at the same time make sure the send buffer is free for use.</span></div>
<div class="line"><a name="l03963"></a><span class="lineno"> 3963</span>&#160;  <a class="code" href="namespacehomme_1_1cslmpi.html#aef296f5b9c1f04eaf474e67814a27ee2">recv_and_wait_on_send</a>(cm);</div>
<div class="line"><a name="l03964"></a><span class="lineno"> 3964</span>&#160;  <span class="comment">// Compute the requested q for departure points from remotes.</span></div>
<div class="line"><a name="l03965"></a><span class="lineno"> 3965</span>&#160;  calc_rmt_q&lt;np&gt;(cm);</div>
<div class="line"><a name="l03966"></a><span class="lineno"> 3966</span>&#160;  <span class="comment">// Send q data.</span></div>
<div class="line"><a name="l03967"></a><span class="lineno"> 3967</span>&#160;  <a class="code" href="namespacehomme_1_1cslmpi.html#a3022054afadca5fa11fa65363437cd72">isend</a>(cm, <span class="keyword">true</span> <span class="comment">/* want_req */</span>, <span class="keyword">true</span> <span class="comment">/* skip_if_empty */</span>);</div>
<div class="line"><a name="l03968"></a><span class="lineno"> 3968</span>&#160;  <span class="comment">// Set up to receive q for each of my departure point requests sent to</span></div>
<div class="line"><a name="l03969"></a><span class="lineno"> 3969</span>&#160;  <span class="comment">// remotes. We can&#39;t do this until the OpenMP barrier in isend assures that</span></div>
<div class="line"><a name="l03970"></a><span class="lineno"> 3970</span>&#160;  <span class="comment">// all threads are done with the receive buffer&#39;s departure points.</span></div>
<div class="line"><a name="l03971"></a><span class="lineno"> 3971</span>&#160;  <a class="code" href="namespacehomme_1_1cslmpi.html#aacdc9acd8b3757395cefeae350460628">setup_irecv</a>(cm, <span class="keyword">true</span> <span class="comment">/* skip_if_empty */</span>);</div>
<div class="line"><a name="l03972"></a><span class="lineno"> 3972</span>&#160;  <span class="comment">// While waiting to get my data from remotes, compute q for departure points</span></div>
<div class="line"><a name="l03973"></a><span class="lineno"> 3973</span>&#160;  <span class="comment">// that have remained in my elements.</span></div>
<div class="line"><a name="l03974"></a><span class="lineno"> 3974</span>&#160;  calc_own_q&lt;np&gt;(cm, nets, nete, dep_points, q_min, q_max);</div>
<div class="line"><a name="l03975"></a><span class="lineno"> 3975</span>&#160;  <span class="comment">// Receive remote q data and use this to fill in the rest of my fields.</span></div>
<div class="line"><a name="l03976"></a><span class="lineno"> 3976</span>&#160;  <a class="code" href="namespacehomme_1_1cslmpi.html#a2b713e2734729354e7c6f52f90ec64d6">recv</a>(cm, <span class="keyword">true</span> <span class="comment">/* skip_if_empty */</span>);</div>
<div class="line"><a name="l03977"></a><span class="lineno"> 3977</span>&#160;  <a class="code" href="namespacehomme_1_1cslmpi.html#a32509c39cdc3a8ba859f7ae3c9548fc9">copy_q</a>(cm, nets, q_min, q_max);</div>
<div class="line"><a name="l03978"></a><span class="lineno"> 3978</span>&#160;  <span class="comment">// Wait on send buffer so it&#39;s free to be used by others.</span></div>
<div class="line"><a name="l03979"></a><span class="lineno"> 3979</span>&#160;  <a class="code" href="namespacehomme_1_1cslmpi.html#ac51ce11648fb404be04ee0fdda9a409e">wait_on_send</a>(cm, <span class="keyword">true</span> <span class="comment">/* skip_if_empty */</span>);</div>
<div class="line"><a name="l03980"></a><span class="lineno"> 3980</span>&#160;}</div>
<div class="line"><a name="l03981"></a><span class="lineno"> 3981</span>&#160; </div>
<div class="line"><a name="l03982"></a><span class="lineno"> 3982</span>&#160;} <span class="comment">// namespace cslmpi</span></div>
<div class="line"><a name="l03983"></a><span class="lineno"> 3983</span>&#160;} <span class="comment">// namespace homme</span></div>
<div class="line"><a name="l03984"></a><span class="lineno"> 3984</span>&#160; </div>
<div class="line"><a name="l03985"></a><span class="lineno"> 3985</span>&#160;<span class="comment">// Valid after slmm_init_local_mesh_ is called.</span></div>
<div class="line"><a name="l03986"></a><span class="lineno"><a class="line" href="compose__slmm_8cpp.html#a3c903a7bc0e949f119d9fe67f9b2a0da"> 3986</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="compose__slmm_8cpp.html#a3c903a7bc0e949f119d9fe67f9b2a0da">slmm_unittest</a> () {</div>
<div class="line"><a name="l03987"></a><span class="lineno"> 3987</span>&#160;  <span class="keywordtype">int</span> nerr = 0, <a class="code" href="namespacedimensions__mod.html#af137394c40531d5d6f0daa64351372e7">ne</a>;</div>
<div class="line"><a name="l03988"></a><span class="lineno"> 3988</span>&#160;  {</div>
<div class="line"><a name="l03989"></a><span class="lineno"> 3989</span>&#160;    <a class="code" href="namespacedimensions__mod.html#af137394c40531d5d6f0daa64351372e7">ne</a> = 0;</div>
<div class="line"><a name="l03990"></a><span class="lineno"> 3990</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; homme::g_advecter-&gt;nelem(); ++i) {</div>
<div class="line"><a name="l03991"></a><span class="lineno"> 3991</span>&#160;      <span class="keyword">const</span> <span class="keyword">auto</span>&amp; m = homme::g_advecter-&gt;local_mesh(i);</div>
<div class="line"><a name="l03992"></a><span class="lineno"> 3992</span>&#160;      <a class="code" href="namespacedimensions__mod.html#af137394c40531d5d6f0daa64351372e7">ne</a> += <a class="code" href="namespaceslmm.html#a7a1095b904c8047101a58045c12f867c">slmm::unittest</a>(m, m.<a class="code" href="structslmm_1_1_local_mesh.html#a84bbd39af98680d8f3441c37db94faa2">tgt_elem</a>);</div>
<div class="line"><a name="l03993"></a><span class="lineno"> 3993</span>&#160;    }</div>
<div class="line"><a name="l03994"></a><span class="lineno"> 3994</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacedimensions__mod.html#af137394c40531d5d6f0daa64351372e7">ne</a>)</div>
<div class="line"><a name="l03995"></a><span class="lineno"> 3995</span>&#160;      fprintf(stderr, <span class="stringliteral">&quot;slmm_unittest: slmm::unittest returned %d\n&quot;</span>, <a class="code" href="namespacedimensions__mod.html#af137394c40531d5d6f0daa64351372e7">ne</a>);</div>
<div class="line"><a name="l03996"></a><span class="lineno"> 3996</span>&#160;    nerr += <a class="code" href="namespacedimensions__mod.html#af137394c40531d5d6f0daa64351372e7">ne</a>;</div>
<div class="line"><a name="l03997"></a><span class="lineno"> 3997</span>&#160;  }</div>
<div class="line"><a name="l03998"></a><span class="lineno"> 3998</span>&#160;  <span class="keywordflow">return</span> nerr;</div>
<div class="line"><a name="l03999"></a><span class="lineno"> 3999</span>&#160;}</div>
<div class="line"><a name="l04000"></a><span class="lineno"> 4000</span>&#160; </div>
<div class="line"><a name="l04001"></a><span class="lineno"> 4001</span>&#160;<span class="preprocessor">#include &lt;cstdlib&gt;</span></div>
<div class="line"><a name="l04002"></a><span class="lineno"> 4002</span>&#160; </div>
<div class="line"><a name="l04003"></a><span class="lineno"><a class="line" href="struct_experiment.html"> 4003</a></span>&#160;<span class="keyword">struct </span><a class="code" href="struct_experiment.html">Experiment</a> {</div>
<div class="line"><a name="l04004"></a><span class="lineno"><a class="line" href="struct_experiment.html#afe14bc3019676171deda217152a021d9"> 4004</a></span>&#160;  <span class="keywordtype">int</span> <a class="code" href="struct_experiment.html#a7c51a3ace4d0de0e22a51935b947a753">sl_mpi</a>, <a class="code" href="struct_experiment.html#afe14bc3019676171deda217152a021d9">halo</a>;</div>
<div class="line"><a name="l04005"></a><span class="lineno"> 4005</span>&#160;};</div>
<div class="line"><a name="l04006"></a><span class="lineno"> 4006</span>&#160; </div>
<div class="line"><a name="l04007"></a><span class="lineno"> 4007</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt; T <a class="code" href="compose__slmm_8cpp.html#a6ab6e9fe314cf712bd31eefbbc13968c">strto</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* s);</div>
<div class="line"><a name="l04008"></a><span class="lineno"><a class="line" href="compose__slmm_8cpp.html#a6ab6e9fe314cf712bd31eefbbc13968c"> 4008</a></span>&#160;<span class="keyword">template</span> &lt;&gt; <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="compose__slmm_8cpp.html#a6ab6e9fe314cf712bd31eefbbc13968c">strto</a> (<span class="keyword">const</span> <span class="keywordtype">char</span>* s) { <span class="keywordflow">return</span> std::atoi(s); }</div>
<div class="line"><a name="l04009"></a><span class="lineno"> 4009</span>&#160;<span class="keyword">template</span> &lt;&gt; <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="compose__slmm_8cpp.html#a6ab6e9fe314cf712bd31eefbbc13968c">strto</a> (<span class="keyword">const</span> <span class="keywordtype">char</span>* s) { <span class="keywordflow">return</span> std::atoi(s); }</div>
<div class="line"><a name="l04010"></a><span class="lineno"> 4010</span>&#160;<span class="keyword">template</span> &lt;&gt; <span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code" href="compose__slmm_8cpp.html#a6ab6e9fe314cf712bd31eefbbc13968c">strto</a> (<span class="keyword">const</span> <span class="keywordtype">char</span>* s) { <span class="keywordflow">return</span> std::atof(s); }</div>
<div class="line"><a name="l04011"></a><span class="lineno"> 4011</span>&#160;<span class="keyword">template</span> &lt;&gt; <span class="keyword">inline</span> std::string <a class="code" href="compose__slmm_8cpp.html#a6ab6e9fe314cf712bd31eefbbc13968c">strto</a> (<span class="keyword">const</span> <span class="keywordtype">char</span>* s) { <span class="keywordflow">return</span> std::string(s); }</div>
<div class="line"><a name="l04012"></a><span class="lineno"> 4012</span>&#160; </div>
<div class="line"><a name="l04013"></a><span class="lineno"> 4013</span>&#160;<span class="keyword">static</span> <a class="code" href="structhomme_1_1cslmpi_1_1_csl_mpi.html#ae05655fc7966bb7cb695bc3933bc212d">homme::cslmpi::CslMpi::Ptr</a> g_csl_mpi;</div>
<div class="line"><a name="l04014"></a><span class="lineno"> 4014</span>&#160; </div>
<div class="line"><a name="l04015"></a><span class="lineno"> 4015</span>&#160;<span class="keyword">extern</span> <span class="stringliteral">&quot;C&quot;</span> {</div>
<div class="line"><a name="l04016"></a><span class="lineno"><a class="line" href="compose__slmm_8cpp.html#a8811b605a971be0a2a4ceeaa40e88907"> 4016</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="compose__slmm_8cpp.html#a8811b605a971be0a2a4ceeaa40e88907">slmm_init_impl</a> (</div>
<div class="line"><a name="l04017"></a><span class="lineno"> 4017</span>&#160;  <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">homme::Int</a> fcomm, <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">homme::Int</a> <a class="code" href="namespacecontrol__mod.html#a7843d1e9a4379154a53150027e49f43b">transport_alg</a>, <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">homme::Int</a> <a class="code" href="namespacedimensions__mod.html#a8648e26ae0e474ccf69d32a8148520c9">np</a>,</div>
<div class="line"><a name="l04018"></a><span class="lineno"> 4018</span>&#160;  <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">homme::Int</a> <a class="code" href="namespacedimensions__mod.html#a6baa218e1683465acc4f37fcea8e30d5">nlev</a>, <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">homme::Int</a> <a class="code" href="namespacedimensions__mod.html#a0070848a40ac48379601d9a8a183c83b">qsize</a>, <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">homme::Int</a> qsized, <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">homme::Int</a> <a class="code" href="namespacedimensions__mod.html#a64817c8f3506c463c896d202d237025e">nelem</a>,</div>
<div class="line"><a name="l04019"></a><span class="lineno"> 4019</span>&#160;  <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">homme::Int</a> <a class="code" href="namespacedimensions__mod.html#af2bd2c00f3bbb316bc19c0b7964b18c4">nelemd</a>, <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">homme::Int</a> <a class="code" href="namespacecontrol__mod.html#aff62de0026bd6ea7c244564a9cbf1c03">cubed_sphere_map</a>,</div>
<div class="line"><a name="l04020"></a><span class="lineno"> 4020</span>&#160;  <span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">homme::Int</a>* lid2gid, <span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">homme::Int</a>* lid2facenum,</div>
<div class="line"><a name="l04021"></a><span class="lineno"> 4021</span>&#160;  <span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">homme::Int</a>* nbr_id_rank, <span class="keyword">const</span> <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">homme::Int</a>* nirptr,</div>
<div class="line"><a name="l04022"></a><span class="lineno"> 4022</span>&#160;  <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">homme::Int</a> sl_nearest_point_lev, <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">homme::Int</a>, <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">homme::Int</a>, <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">homme::Int</a>,</div>
<div class="line"><a name="l04023"></a><span class="lineno"> 4023</span>&#160;  <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">homme::Int</a>)</div>
<div class="line"><a name="l04024"></a><span class="lineno"> 4024</span>&#160;{</div>
<div class="line"><a name="l04025"></a><span class="lineno"> 4025</span>&#160;  <a class="code" href="namespacehomme.html#a362172619ed099872f216687207d453d">homme::slmm_init</a>(<a class="code" href="namespacedimensions__mod.html#a8648e26ae0e474ccf69d32a8148520c9">np</a>, <a class="code" href="namespacedimensions__mod.html#a64817c8f3506c463c896d202d237025e">nelem</a>, <a class="code" href="namespacedimensions__mod.html#af2bd2c00f3bbb316bc19c0b7964b18c4">nelemd</a>, <a class="code" href="namespacecontrol__mod.html#a7843d1e9a4379154a53150027e49f43b">transport_alg</a>, <a class="code" href="namespacecontrol__mod.html#aff62de0026bd6ea7c244564a9cbf1c03">cubed_sphere_map</a>,</div>
<div class="line"><a name="l04026"></a><span class="lineno"> 4026</span>&#160;                   sl_nearest_point_lev - 1, lid2facenum);</div>
<div class="line"><a name="l04027"></a><span class="lineno"> 4027</span>&#160;  <a class="code" href="compose__slmm_8cpp.html#a7290a1aabe779e162c8d6a36b3abec04">slmm_throw_if</a>(homme::g_advecter-&gt;is_cisl(),</div>
<div class="line"><a name="l04028"></a><span class="lineno"> 4028</span>&#160;                <span class="stringliteral">&quot;CISL code was removed.&quot;</span>);</div>
<div class="line"><a name="l04029"></a><span class="lineno"> 4029</span>&#160;  <span class="keyword">const</span> <span class="keyword">auto</span> p = <a class="code" href="namespacehomme_1_1mpi.html#a03a3312a58c03f70dcf34ab09d9399b4">homme::mpi::make_parallel</a>(MPI_Comm_f2c(fcomm));</div>
<div class="line"><a name="l04030"></a><span class="lineno"> 4030</span>&#160;  g_csl_mpi = <a class="code" href="namespacehomme_1_1cslmpi.html#af40d7ea4fe4185cea6fc7c0e4f17133b">homme::cslmpi::init</a>(homme::g_advecter, p, <a class="code" href="namespacedimensions__mod.html#a8648e26ae0e474ccf69d32a8148520c9">np</a>, <a class="code" href="namespacedimensions__mod.html#a6baa218e1683465acc4f37fcea8e30d5">nlev</a>, <a class="code" href="namespacedimensions__mod.html#a0070848a40ac48379601d9a8a183c83b">qsize</a>,</div>
<div class="line"><a name="l04031"></a><span class="lineno"> 4031</span>&#160;                                  qsized, <a class="code" href="namespacedimensions__mod.html#af2bd2c00f3bbb316bc19c0b7964b18c4">nelemd</a>, nbr_id_rank, nirptr,</div>
<div class="line"><a name="l04032"></a><span class="lineno"> 4032</span>&#160;                                  2 <span class="comment">/* halo */</span>);</div>
<div class="line"><a name="l04033"></a><span class="lineno"> 4033</span>&#160;}</div>
<div class="line"><a name="l04034"></a><span class="lineno"> 4034</span>&#160; </div>
<div class="line"><a name="l04035"></a><span class="lineno"><a class="line" href="compose__slmm_8cpp.html#a6faad11cf2cdf54482f7ae9d9fc378e8"> 4035</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="compose__slmm_8cpp.html#a6faad11cf2cdf54482f7ae9d9fc378e8">slmm_query_bufsz</a> (<a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">homme::Int</a>* sendsz, <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">homme::Int</a>* recvsz) {</div>
<div class="line"><a name="l04036"></a><span class="lineno"> 4036</span>&#160;  <a class="code" href="compose__slmm_8cpp.html#a2912a5cf7e76e41c2ecf69b5c610479d">slmm_assert</a>(g_csl_mpi);</div>
<div class="line"><a name="l04037"></a><span class="lineno"> 4037</span>&#160;  <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">homme::Int</a> s = 0, r = 0;</div>
<div class="line"><a name="l04038"></a><span class="lineno"> 4038</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> e : g_csl_mpi-&gt;sendsz) s += e;</div>
<div class="line"><a name="l04039"></a><span class="lineno"> 4039</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> e : g_csl_mpi-&gt;recvsz) r += e;</div>
<div class="line"><a name="l04040"></a><span class="lineno"> 4040</span>&#160;  *sendsz = s;</div>
<div class="line"><a name="l04041"></a><span class="lineno"> 4041</span>&#160;  *recvsz = r;</div>
<div class="line"><a name="l04042"></a><span class="lineno"> 4042</span>&#160;}</div>
<div class="line"><a name="l04043"></a><span class="lineno"> 4043</span>&#160; </div>
<div class="line"><a name="l04044"></a><span class="lineno"><a class="line" href="compose__slmm_8cpp.html#a12d21f36c12baa218839b0795337467d"> 4044</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="compose__slmm_8cpp.html#a12d21f36c12baa218839b0795337467d">slmm_set_bufs</a> (<a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">homme::Real</a>* sendbuf, <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">homme::Real</a>* recvbuf,</div>
<div class="line"><a name="l04045"></a><span class="lineno"> 4045</span>&#160;                    <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">homme::Int</a>, <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">homme::Int</a>) {</div>
<div class="line"><a name="l04046"></a><span class="lineno"> 4046</span>&#160;  <a class="code" href="compose__slmm_8cpp.html#a2912a5cf7e76e41c2ecf69b5c610479d">slmm_assert</a>(g_csl_mpi);</div>
<div class="line"><a name="l04047"></a><span class="lineno"> 4047</span>&#160;  <a class="code" href="namespacehomme_1_1cslmpi.html#a8a5f75d82247e0c4dc633f7f1987d161">homme::cslmpi::alloc_mpi_buffers</a>(*g_csl_mpi, sendbuf, recvbuf);</div>
<div class="line"><a name="l04048"></a><span class="lineno"> 4048</span>&#160;}</div>
<div class="line"><a name="l04049"></a><span class="lineno"> 4049</span>&#160; </div>
<div class="line"><a name="l04050"></a><span class="lineno"><a class="line" href="compose__slmm_8cpp.html#a3f9ab6375e6c3b0625b05febef326825"> 4050</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="compose__slmm_8cpp.html#a3f9ab6375e6c3b0625b05febef326825">slmm_get_mpi_pattern</a> (<a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">homme::Int</a>* sl_mpi) {</div>
<div class="line"><a name="l04051"></a><span class="lineno"> 4051</span>&#160;  *sl_mpi = g_csl_mpi ? 1 : 0;</div>
<div class="line"><a name="l04052"></a><span class="lineno"> 4052</span>&#160;}</div>
<div class="line"><a name="l04053"></a><span class="lineno"> 4053</span>&#160; </div>
<div class="line"><a name="l04054"></a><span class="lineno"><a class="line" href="compose__slmm_8cpp.html#a98fd88feb99433d9ee1ba08414134b3e"> 4054</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="compose__slmm_8cpp.html#a98fd88feb99433d9ee1ba08414134b3e">slmm_init_local_mesh</a> (</div>
<div class="line"><a name="l04055"></a><span class="lineno"> 4055</span>&#160;  <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">homme::Int</a> ie, <a class="code" href="structhomme_1_1_cartesian3_d.html">homme::Cartesian3D</a>* neigh_corners, <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">homme::Int</a> nnc,</div>
<div class="line"><a name="l04056"></a><span class="lineno"> 4056</span>&#160;  <a class="code" href="structhomme_1_1_cartesian3_d.html">homme::Cartesian3D</a>* p_inside, <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">homme::Int</a>)</div>
<div class="line"><a name="l04057"></a><span class="lineno"> 4057</span>&#160;{</div>
<div class="line"><a name="l04058"></a><span class="lineno"> 4058</span>&#160;  homme::g_advecter-&gt;init_local_mesh_if_needed(</div>
<div class="line"><a name="l04059"></a><span class="lineno"> 4059</span>&#160;    ie - 1, <a class="code" href="namespacehomme.html#a9798590dfa671ded8ffd2295e714df11">homme::FA3&lt;const homme::Real&gt;</a>(</div>
<div class="line"><a name="l04060"></a><span class="lineno"> 4060</span>&#160;      <span class="keyword">reinterpret_cast&lt;</span><span class="keyword">const </span><a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">homme::Real</a>*<span class="keyword">&gt;</span>(neigh_corners), 3, 4, nnc),</div>
<div class="line"><a name="l04061"></a><span class="lineno"> 4061</span>&#160;    <span class="keyword">reinterpret_cast&lt;</span><span class="keyword">const </span><a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">homme::Real</a>*<span class="keyword">&gt;</span>(p_inside));</div>
<div class="line"><a name="l04062"></a><span class="lineno"> 4062</span>&#160;}</div>
<div class="line"><a name="l04063"></a><span class="lineno"> 4063</span>&#160; </div>
<div class="line"><a name="l04064"></a><span class="lineno"><a class="line" href="compose__slmm_8cpp.html#ad07d1b06cdd32a08841d0ed836bf8ace"> 4064</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="compose__slmm_8cpp.html#ad07d1b06cdd32a08841d0ed836bf8ace">slmm_init_finalize</a> () {</div>
<div class="line"><a name="l04065"></a><span class="lineno"> 4065</span>&#160;  <span class="keywordflow">if</span> (g_csl_mpi)</div>
<div class="line"><a name="l04066"></a><span class="lineno"> 4066</span>&#160;    <a class="code" href="namespacehomme_1_1cslmpi.html#ace72e34c6a3042506aac8ef481cddcec">homme::cslmpi::finalize_local_meshes</a>(*g_csl_mpi, *homme::g_advecter);</div>
<div class="line"><a name="l04067"></a><span class="lineno"> 4067</span>&#160;}</div>
<div class="line"><a name="l04068"></a><span class="lineno"> 4068</span>&#160; </div>
<div class="line"><a name="l04069"></a><span class="lineno"><a class="line" href="compose__slmm_8cpp.html#a7f1def61c5ac9e4753536215ae1fb3c6"> 4069</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="compose__slmm_8cpp.html#a7f1def61c5ac9e4753536215ae1fb3c6">slmm_check_ref2sphere</a> (<a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">homme::Int</a> ie, <a class="code" href="structhomme_1_1_cartesian3_d.html">homme::Cartesian3D</a>* p) {</div>
<div class="line"><a name="l04070"></a><span class="lineno"> 4070</span>&#160;  homme::g_advecter-&gt;check_ref2sphere(</div>
<div class="line"><a name="l04071"></a><span class="lineno"> 4071</span>&#160;    ie - 1, <span class="keyword">reinterpret_cast&lt;</span><span class="keyword">const </span><a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">homme::Real</a>*<span class="keyword">&gt;</span>(p));</div>
<div class="line"><a name="l04072"></a><span class="lineno"> 4072</span>&#160;}</div>
<div class="line"><a name="l04073"></a><span class="lineno"> 4073</span>&#160; </div>
<div class="line"><a name="l04074"></a><span class="lineno"><a class="line" href="compose__slmm_8cpp.html#a3b3cf3d8c264ccb732bc94edd2b2575b"> 4074</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="compose__slmm_8cpp.html#a3b3cf3d8c264ccb732bc94edd2b2575b">slmm_csl_set_elem_data</a> (</div>
<div class="line"><a name="l04075"></a><span class="lineno"> 4075</span>&#160;  <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">homme::Int</a> ie, <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">homme::Real</a>* metdet, <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">homme::Real</a>* qdp, <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">homme::Real</a>* <a class="code" href="namespacedcmip2012__test5.html#ad259dec8945b10d8b2c6226e53589de5">dp</a>,</div>
<div class="line"><a name="l04076"></a><span class="lineno"> 4076</span>&#160;  <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">homme::Real</a>* q, <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">homme::Int</a> nelem_in_patch)</div>
<div class="line"><a name="l04077"></a><span class="lineno"> 4077</span>&#160;{</div>
<div class="line"><a name="l04078"></a><span class="lineno"> 4078</span>&#160;  <a class="code" href="compose__slmm_8cpp.html#a2912a5cf7e76e41c2ecf69b5c610479d">slmm_assert</a>(g_csl_mpi);</div>
<div class="line"><a name="l04079"></a><span class="lineno"> 4079</span>&#160;  <a class="code" href="namespacehomme_1_1cslmpi.html#a046d297dfd93e01977f02dac72bf35cc">homme::cslmpi::set_elem_data</a>(*g_csl_mpi, ie - 1, metdet, qdp, <a class="code" href="namespacedcmip2012__test5.html#ad259dec8945b10d8b2c6226e53589de5">dp</a>, q,</div>
<div class="line"><a name="l04080"></a><span class="lineno"> 4080</span>&#160;                               nelem_in_patch);</div>
<div class="line"><a name="l04081"></a><span class="lineno"> 4081</span>&#160;}</div>
<div class="line"><a name="l04082"></a><span class="lineno"> 4082</span>&#160; </div>
<div class="line"><a name="l04083"></a><span class="lineno"><a class="line" href="compose__slmm_8cpp.html#aeedef9961e344918a8181917bfdb31ba"> 4083</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="compose__slmm_8cpp.html#aeedef9961e344918a8181917bfdb31ba">slmm_csl</a> (</div>
<div class="line"><a name="l04084"></a><span class="lineno"> 4084</span>&#160;  <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">homme::Int</a> nets, <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">homme::Int</a> nete, <a class="code" href="structhomme_1_1_cartesian3_d.html">homme::Cartesian3D</a>* dep_points,</div>
<div class="line"><a name="l04085"></a><span class="lineno"> 4085</span>&#160;  <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">homme::Real</a>* minq, <a class="code" href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">homme::Real</a>* maxq, <a class="code" href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">homme::Int</a>* info)</div>
<div class="line"><a name="l04086"></a><span class="lineno"> 4086</span>&#160;{</div>
<div class="line"><a name="l04087"></a><span class="lineno"> 4087</span>&#160;  <a class="code" href="compose__slmm_8cpp.html#a2912a5cf7e76e41c2ecf69b5c610479d">slmm_assert</a>(g_csl_mpi);</div>
<div class="line"><a name="l04088"></a><span class="lineno"> 4088</span>&#160;  <a class="code" href="compose__slmm_8cpp.html#a2912a5cf7e76e41c2ecf69b5c610479d">slmm_assert</a>(g_csl_mpi-&gt;sendsz.empty()); <span class="comment">// alloc_mpi_buffers was called</span></div>
<div class="line"><a name="l04089"></a><span class="lineno"> 4089</span>&#160;  *info = 0;</div>
<div class="line"><a name="l04090"></a><span class="lineno"> 4090</span>&#160;  <span class="keywordflow">try</span> {</div>
<div class="line"><a name="l04091"></a><span class="lineno"> 4091</span>&#160;    homme::cslmpi::step&lt;4&gt;(*g_csl_mpi, nets - 1, nete - 1,</div>
<div class="line"><a name="l04092"></a><span class="lineno"> 4092</span>&#160;                           dep_points, minq, maxq);</div>
<div class="line"><a name="l04093"></a><span class="lineno"> 4093</span>&#160;  } <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception&amp; e) {</div>
<div class="line"><a name="l04094"></a><span class="lineno"> 4094</span>&#160;    std::cerr &lt;&lt; e.what();</div>
<div class="line"><a name="l04095"></a><span class="lineno"> 4095</span>&#160;    *info = -1;</div>
<div class="line"><a name="l04096"></a><span class="lineno"> 4096</span>&#160;  }</div>
<div class="line"><a name="l04097"></a><span class="lineno"> 4097</span>&#160;}</div>
<div class="line"><a name="l04098"></a><span class="lineno"> 4098</span>&#160; </div>
<div class="line"><a name="l04099"></a><span class="lineno"><a class="line" href="compose__slmm_8cpp.html#addc47ff9d33a59e563565bb1c07edf19"> 4099</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="compose__slmm_8cpp.html#addc47ff9d33a59e563565bb1c07edf19">slmm_finalize</a> () {</div>
<div class="line"><a name="l04100"></a><span class="lineno"> 4100</span>&#160;  g_csl_mpi = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l04101"></a><span class="lineno"> 4101</span>&#160;  homme::g_advecter = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l04102"></a><span class="lineno"> 4102</span>&#160;}</div>
<div class="line"><a name="l04103"></a><span class="lineno"> 4103</span>&#160;} <span class="comment">// extern &quot;C&quot;</span></div>
<div class="ttc" id="aclasshomme_1_1mpi_1_1_parallel_html"><div class="ttname"><a href="classhomme_1_1mpi_1_1_parallel.html">homme::mpi::Parallel</a></div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02221">compose_slmm.cpp:2221</a></div></div>
<div class="ttc" id="aclasshomme_1_1mpi_1_1_parallel_html_a066a51d5968db32f8741c4680066a3b0"><div class="ttname"><a href="classhomme_1_1mpi_1_1_parallel.html#a066a51d5968db32f8741c4680066a3b0">homme::mpi::Parallel::Parallel</a></div><div class="ttdeci">Parallel(MPI_Comm comm)</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02225">compose_slmm.cpp:2225</a></div></div>
<div class="ttc" id="aclasshomme_1_1mpi_1_1_parallel_html_a71e65bc5344d0a2988c4a94794aa4489"><div class="ttname"><a href="classhomme_1_1mpi_1_1_parallel.html#a71e65bc5344d0a2988c4a94794aa4489">homme::mpi::Parallel::amroot</a></div><div class="ttdeci">bool amroot() const</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02238">compose_slmm.cpp:2238</a></div></div>
<div class="ttc" id="aclasshomme_1_1mpi_1_1_parallel_html_a81b0c32ea24c8c484290bff734023f8e"><div class="ttname"><a href="classhomme_1_1mpi_1_1_parallel.html#a81b0c32ea24c8c484290bff734023f8e">homme::mpi::Parallel::comm</a></div><div class="ttdeci">MPI_Comm comm() const</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02226">compose_slmm.cpp:2226</a></div></div>
<div class="ttc" id="aclasshomme_1_1mpi_1_1_parallel_html_a9251fa1de119f66172b16fbf8e28c005"><div class="ttname"><a href="classhomme_1_1mpi_1_1_parallel.html#a9251fa1de119f66172b16fbf8e28c005">homme::mpi::Parallel::size</a></div><div class="ttdeci">Int size() const</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02227">compose_slmm.cpp:2227</a></div></div>
<div class="ttc" id="aclasshomme_1_1mpi_1_1_parallel_html_ab0930494b6f23feb868356cfeb380115"><div class="ttname"><a href="classhomme_1_1mpi_1_1_parallel.html#ab0930494b6f23feb868356cfeb380115">homme::mpi::Parallel::root</a></div><div class="ttdeci">Int root() const</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02237">compose_slmm.cpp:2237</a></div></div>
<div class="ttc" id="aclasshomme_1_1mpi_1_1_parallel_html_ac068d8e0f526dbd3b49c4bcdc23a3c90"><div class="ttname"><a href="classhomme_1_1mpi_1_1_parallel.html#ac068d8e0f526dbd3b49c4bcdc23a3c90">homme::mpi::Parallel::rank</a></div><div class="ttdeci">Int rank() const</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02232">compose_slmm.cpp:2232</a></div></div>
<div class="ttc" id="aclasshomme_1_1mpi_1_1_parallel_html_aff1fe34dd95083421911cd1a89f7191d"><div class="ttname"><a href="classhomme_1_1mpi_1_1_parallel.html#aff1fe34dd95083421911cd1a89f7191d">homme::mpi::Parallel::Ptr</a></div><div class="ttdeci">std::shared_ptr&lt; Parallel &gt; Ptr</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02224">compose_slmm.cpp:2224</a></div></div>
<div class="ttc" id="aclasssiqk_1_1_triangle_quadrature_html"><div class="ttname"><a href="classsiqk_1_1_triangle_quadrature.html">siqk::TriangleQuadrature</a></div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l00387">compose_slmm.cpp:387</a></div></div>
<div class="ttc" id="aclasssiqk_1_1_triangle_quadrature_html_a3cd181896eb90a4aa5e813b0f1697aec"><div class="ttname"><a href="classsiqk_1_1_triangle_quadrature.html#a3cd181896eb90a4aa5e813b0f1697aec">siqk::TriangleQuadrature::get_coef</a></div><div class="ttdeci">KOKKOS_INLINE_FUNCTION void get_coef(const int order, RawConstVec3s &amp;coord, RawConstArray &amp;weight) const</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l00403">compose_slmm.cpp:403</a></div></div>
<div class="ttc" id="aclasssiqk_1_1_triangle_quadrature_html_a98b6e36083268cd1d09bf00592986c42"><div class="ttname"><a href="classsiqk_1_1_triangle_quadrature.html#a98b6e36083268cd1d09bf00592986c42">siqk::TriangleQuadrature::TriangleQuadrature</a></div><div class="ttdeci">KOKKOS_INLINE_FUNCTION TriangleQuadrature()</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l00400">compose_slmm.cpp:400</a></div></div>
<div class="ttc" id="aclasssiqk_1_1sqr_1_1test_1_1_test_sphere_to_ref_kernel_html"><div class="ttname"><a href="classsiqk_1_1sqr_1_1test_1_1_test_sphere_to_ref_kernel.html">siqk::sqr::test::TestSphereToRefKernel</a></div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l01023">compose_slmm.cpp:1023</a></div></div>
<div class="ttc" id="aclasssiqk_1_1sqr_1_1test_1_1_test_sphere_to_ref_kernel_html_a0dc66e9c787165eecfbdfe698ba8aee6"><div class="ttname"><a href="classsiqk_1_1sqr_1_1test_1_1_test_sphere_to_ref_kernel.html#a0dc66e9c787165eecfbdfe698ba8aee6">siqk::sqr::test::TestSphereToRefKernel::init</a></div><div class="ttdeci">KOKKOS_INLINE_FUNCTION void init(value_type &amp;info)</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l01071">compose_slmm.cpp:1071</a></div></div>
<div class="ttc" id="aclasssiqk_1_1sqr_1_1test_1_1_test_sphere_to_ref_kernel_html_a26cfdf240ac511c0a671eadc5d653045"><div class="ttname"><a href="classsiqk_1_1sqr_1_1test_1_1_test_sphere_to_ref_kernel.html#a26cfdf240ac511c0a671eadc5d653045">siqk::sqr::test::TestSphereToRefKernel::join</a></div><div class="ttdeci">KOKKOS_INLINE_FUNCTION void join(volatile value_type &amp;dst, volatile value_type const &amp;src) const</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l01078">compose_slmm.cpp:1078</a></div></div>
<div class="ttc" id="aclasssiqk_1_1sqr_1_1test_1_1_test_sphere_to_ref_kernel_html_a508abfeec572974dc3374424d383ac36"><div class="ttname"><a href="classsiqk_1_1sqr_1_1test_1_1_test_sphere_to_ref_kernel.html#a508abfeec572974dc3374424d383ac36">siqk::sqr::test::TestSphereToRefKernel::TestSphereToRefKernel</a></div><div class="ttdeci">TestSphereToRefKernel(const ConstVec3s::HostMirror &amp;p_hm, const ConstIdxs::HostMirror &amp;e_hm, const Real tol=1e1 *std::numeric_limits&lt; Real &gt;::epsilon())</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l01034">compose_slmm.cpp:1034</a></div></div>
<div class="ttc" id="aclasssiqk_1_1sqr_1_1test_1_1_test_sphere_to_ref_kernel_html_ad58b936a1d42f02feb13c065ccda87d7"><div class="ttname"><a href="classsiqk_1_1sqr_1_1test_1_1_test_sphere_to_ref_kernel.html#ad58b936a1d42f02feb13c065ccda87d7">siqk::sqr::test::TestSphereToRefKernel::value_type</a></div><div class="ttdeci">Info value_type</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l01032">compose_slmm.cpp:1032</a></div></div>
<div class="ttc" id="aclasssiqk_1_1sqr_1_1test_1_1_test_sphere_to_ref_kernel_html_ad9b6cc015222f088841dbdc47b31751b"><div class="ttname"><a href="classsiqk_1_1sqr_1_1test_1_1_test_sphere_to_ref_kernel.html#ad9b6cc015222f088841dbdc47b31751b">siqk::sqr::test::TestSphereToRefKernel::tol</a></div><div class="ttdeci">const Real &amp; tol() const</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l01044">compose_slmm.cpp:1044</a></div></div>
<div class="ttc" id="aclasssiqk_1_1sqr_1_1test_1_1_test_sphere_to_ref_kernel_html_ae2b7bf8675fbb4d60a4402bf914cfca9"><div class="ttname"><a href="classsiqk_1_1sqr_1_1test_1_1_test_sphere_to_ref_kernel.html#ae2b7bf8675fbb4d60a4402bf914cfca9">siqk::sqr::test::TestSphereToRefKernel::n</a></div><div class="ttdeci">Int n() const</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l01043">compose_slmm.cpp:1043</a></div></div>
<div class="ttc" id="aclasssiqk_1_1sqr_1_1test_1_1_test_sphere_to_ref_kernel_html_af96f6bfba3b45a7323a3cd4a350fffb2"><div class="ttname"><a href="classsiqk_1_1sqr_1_1test_1_1_test_sphere_to_ref_kernel.html#af96f6bfba3b45a7323a3cd4a350fffb2">siqk::sqr::test::TestSphereToRefKernel::operator()</a></div><div class="ttdeci">KOKKOS_INLINE_FUNCTION void operator()(const Int k, value_type &amp;jinfo) const</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l01047">compose_slmm.cpp:1047</a></div></div>
<div class="ttc" id="aclassslmm_1_1_g_l_l_html"><div class="ttname"><a href="classslmm_1_1_g_l_l.html">slmm::GLL</a></div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l01186">compose_slmm.cpp:1186</a></div></div>
<div class="ttc" id="aclassslmm_1_1_g_l_l_html_a412b4075256ad5aca5309352b97cba91"><div class="ttname"><a href="classslmm_1_1_g_l_l.html#a412b4075256ad5aca5309352b97cba91">slmm::GLL::eval_derivative</a></div><div class="ttdeci">KOKKOS_INLINE_FUNCTION void eval_derivative(const Basis &amp;b, const Real &amp;x, Real *const ge) const</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l01298">compose_slmm.cpp:1298</a></div></div>
<div class="ttc" id="aclassslmm_1_1_g_l_l_html_a545619c94529c2ab082fa64f90b27654"><div class="ttname"><a href="classslmm_1_1_g_l_l.html#a545619c94529c2ab082fa64f90b27654">slmm::GLL::GLL</a></div><div class="ttdeci">KOKKOS_INLINE_FUNCTION GLL()</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l01203">compose_slmm.cpp:1203</a></div></div>
<div class="ttc" id="aclassslmm_1_1_g_l_l_html_a54fba27da4d71f6b3bca5964f1ff48b1"><div class="ttname"><a href="classslmm_1_1_g_l_l.html#a54fba27da4d71f6b3bca5964f1ff48b1">slmm::GLL::get_coef</a></div><div class="ttdeci">KOKKOS_INLINE_FUNCTION void get_coef(const Int np, const Real *&amp;coord, const Real *&amp;wt) const</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l01206">compose_slmm.cpp:1206</a></div></div>
<div class="ttc" id="aclassslmm_1_1_g_l_l_html_aa681216b46ee048c89a20a2cf8094284a572bdf0ea4245230402c0ef9a860b5f8"><div class="ttname"><a href="classslmm_1_1_g_l_l.html#aa681216b46ee048c89a20a2cf8094284a572bdf0ea4245230402c0ef9a860b5f8">slmm::GLL::np_max</a></div><div class="ttdeci">@ np_max</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l01201">compose_slmm.cpp:1201</a></div></div>
<div class="ttc" id="aclassslmm_1_1_g_l_l_html_ab585b784c0bbf8faf7ab4fb351f686e3"><div class="ttname"><a href="classslmm_1_1_g_l_l.html#ab585b784c0bbf8faf7ab4fb351f686e3">slmm::GLL::eval</a></div><div class="ttdeci">KOKKOS_INLINE_FUNCTION void eval(const Basis &amp;b, const Real &amp;x, Real *const ge) const</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l01233">compose_slmm.cpp:1233</a></div></div>
<div class="ttc" id="aclassslmm_1_1_g_l_l_html_addadc6c09df1b566581f17e15ff4c746"><div class="ttname"><a href="classslmm_1_1_g_l_l.html#addadc6c09df1b566581f17e15ff4c746">slmm::GLL::get_coef</a></div><div class="ttdeci">KOKKOS_INLINE_FUNCTION void get_coef(const Basis &amp;b, const Real *&amp;coord, const Real *&amp;wt) const</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l01227">compose_slmm.cpp:1227</a></div></div>
<div class="ttc" id="acompose__slmm_8cpp_html_a00c9d73dc78617d79a14652f947cbad0"><div class="ttname"><a href="compose__slmm_8cpp.html#a00c9d73dc78617d79a14652f947cbad0">SIQK_QUADRATURE_TRISYM_ORDER4_COORD</a></div><div class="ttdeci">#define SIQK_QUADRATURE_TRISYM_ORDER4_COORD</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l00220">compose_slmm.cpp:220</a></div></div>
<div class="ttc" id="acompose__slmm_8cpp_html_a0b39b63145e0e7596d715512f46f5238"><div class="ttname"><a href="compose__slmm_8cpp.html#a0b39b63145e0e7596d715512f46f5238">SIQK_QUADRATURE_TRISYM_ORDER4_WEIGHT</a></div><div class="ttdeci">#define SIQK_QUADRATURE_TRISYM_ORDER4_WEIGHT</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l00227">compose_slmm.cpp:227</a></div></div>
<div class="ttc" id="acompose__slmm_8cpp_html_a12d21f36c12baa218839b0795337467d"><div class="ttname"><a href="compose__slmm_8cpp.html#a12d21f36c12baa218839b0795337467d">slmm_set_bufs</a></div><div class="ttdeci">void slmm_set_bufs(homme::Real *sendbuf, homme::Real *recvbuf, homme::Int, homme::Int)</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l04044">compose_slmm.cpp:4044</a></div></div>
<div class="ttc" id="acompose__slmm_8cpp_html_a2912a5cf7e76e41c2ecf69b5c610479d"><div class="ttname"><a href="compose__slmm_8cpp.html#a2912a5cf7e76e41c2ecf69b5c610479d">slmm_assert</a></div><div class="ttdeci">#define slmm_assert(condition)</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l01129">compose_slmm.cpp:1129</a></div></div>
<div class="ttc" id="acompose__slmm_8cpp_html_a3b3cf3d8c264ccb732bc94edd2b2575b"><div class="ttname"><a href="compose__slmm_8cpp.html#a3b3cf3d8c264ccb732bc94edd2b2575b">slmm_csl_set_elem_data</a></div><div class="ttdeci">void slmm_csl_set_elem_data(homme::Int ie, homme::Real *metdet, homme::Real *qdp, homme::Real *dp, homme::Real *q, homme::Int nelem_in_patch)</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l04074">compose_slmm.cpp:4074</a></div></div>
<div class="ttc" id="acompose__slmm_8cpp_html_a3c903a7bc0e949f119d9fe67f9b2a0da"><div class="ttname"><a href="compose__slmm_8cpp.html#a3c903a7bc0e949f119d9fe67f9b2a0da">slmm_unittest</a></div><div class="ttdeci">int slmm_unittest()</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l03986">compose_slmm.cpp:3986</a></div></div>
<div class="ttc" id="acompose__slmm_8cpp_html_a3f1d231278e45a0fb77db7a246ac9315"><div class="ttname"><a href="compose__slmm_8cpp.html#a3f1d231278e45a0fb77db7a246ac9315">SIQK_QUADRATURE_TRISYM_ORDER8_WEIGHT</a></div><div class="ttdeci">#define SIQK_QUADRATURE_TRISYM_ORDER8_WEIGHT</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l00248">compose_slmm.cpp:248</a></div></div>
<div class="ttc" id="acompose__slmm_8cpp_html_a3f9ab6375e6c3b0625b05febef326825"><div class="ttname"><a href="compose__slmm_8cpp.html#a3f9ab6375e6c3b0625b05febef326825">slmm_get_mpi_pattern</a></div><div class="ttdeci">void slmm_get_mpi_pattern(homme::Int *sl_mpi)</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l04050">compose_slmm.cpp:4050</a></div></div>
<div class="ttc" id="acompose__slmm_8cpp_html_a5bc934576043704c15e9b16cc4a8a96b"><div class="ttname"><a href="compose__slmm_8cpp.html#a5bc934576043704c15e9b16cc4a8a96b">SIQK_QUADRATURE_TRISYM_ORDER8_COORD</a></div><div class="ttdeci">#define SIQK_QUADRATURE_TRISYM_ORDER8_COORD</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l00231">compose_slmm.cpp:231</a></div></div>
<div class="ttc" id="acompose__slmm_8cpp_html_a5d150781e1388bb857ce7cd759bff4cc"><div class="ttname"><a href="compose__slmm_8cpp.html#a5d150781e1388bb857ce7cd759bff4cc">dpotrf_</a></div><div class="ttdeci">void dpotrf_(const char *uplo, const int *n, double *a, const int *lda, int *info)</div></div>
<div class="ttc" id="acompose__slmm_8cpp_html_a62f071f9019b2263ed76a35f753af003"><div class="ttname"><a href="compose__slmm_8cpp.html#a62f071f9019b2263ed76a35f753af003">pr</a></div><div class="ttdeci">#define pr(m)</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l00037">compose_slmm.cpp:37</a></div></div>
<div class="ttc" id="acompose__slmm_8cpp_html_a6ab6e9fe314cf712bd31eefbbc13968c"><div class="ttname"><a href="compose__slmm_8cpp.html#a6ab6e9fe314cf712bd31eefbbc13968c">strto</a></div><div class="ttdeci">T strto(const char *s)</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l04008">compose_slmm.cpp:4008</a></div></div>
<div class="ttc" id="acompose__slmm_8cpp_html_a6faad11cf2cdf54482f7ae9d9fc378e8"><div class="ttname"><a href="compose__slmm_8cpp.html#a6faad11cf2cdf54482f7ae9d9fc378e8">slmm_query_bufsz</a></div><div class="ttdeci">void slmm_query_bufsz(homme::Int *sendsz, homme::Int *recvsz)</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l04035">compose_slmm.cpp:4035</a></div></div>
<div class="ttc" id="acompose__slmm_8cpp_html_a7290a1aabe779e162c8d6a36b3abec04"><div class="ttname"><a href="compose__slmm_8cpp.html#a7290a1aabe779e162c8d6a36b3abec04">slmm_throw_if</a></div><div class="ttdeci">#define slmm_throw_if(condition, message)</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l01140">compose_slmm.cpp:1140</a></div></div>
<div class="ttc" id="acompose__slmm_8cpp_html_a7f1def61c5ac9e4753536215ae1fb3c6"><div class="ttname"><a href="compose__slmm_8cpp.html#a7f1def61c5ac9e4753536215ae1fb3c6">slmm_check_ref2sphere</a></div><div class="ttdeci">void slmm_check_ref2sphere(homme::Int ie, homme::Cartesian3D *p)</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l04069">compose_slmm.cpp:4069</a></div></div>
<div class="ttc" id="acompose__slmm_8cpp_html_a85cbdff87860f958c17efc14d0931027"><div class="ttname"><a href="compose__slmm_8cpp.html#a85cbdff87860f958c17efc14d0931027">SIQK_QUADRATURE_TRISYM_ORDER14_WEIGHT</a></div><div class="ttdeci">#define SIQK_QUADRATURE_TRISYM_ORDER14_WEIGHT</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l00337">compose_slmm.cpp:337</a></div></div>
<div class="ttc" id="acompose__slmm_8cpp_html_a8811b605a971be0a2a4ceeaa40e88907"><div class="ttname"><a href="compose__slmm_8cpp.html#a8811b605a971be0a2a4ceeaa40e88907">slmm_init_impl</a></div><div class="ttdeci">void slmm_init_impl(homme::Int fcomm, homme::Int transport_alg, homme::Int np, homme::Int nlev, homme::Int qsize, homme::Int qsized, homme::Int nelem, homme::Int nelemd, homme::Int cubed_sphere_map, const homme::Int *lid2gid, const homme::Int *lid2facenum, const homme::Int *nbr_id_rank, const homme::Int *nirptr, homme::Int sl_nearest_point_lev, homme::Int, homme::Int, homme::Int, homme::Int)</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l04016">compose_slmm.cpp:4016</a></div></div>
<div class="ttc" id="acompose__slmm_8cpp_html_a89a02be79466842475d4bb9d65b20b19"><div class="ttname"><a href="compose__slmm_8cpp.html#a89a02be79466842475d4bb9d65b20b19">SIQK_QUADRATURE_TRITAY_ORDER6_WEIGHT</a></div><div class="ttdeci">#define SIQK_QUADRATURE_TRITAY_ORDER6_WEIGHT</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l00381">compose_slmm.cpp:381</a></div></div>
<div class="ttc" id="acompose__slmm_8cpp_html_a8aa8c36c408197a7b5c167212b38cd80"><div class="ttname"><a href="compose__slmm_8cpp.html#a8aa8c36c408197a7b5c167212b38cd80">SIQK_QUADRATURE_TRITAY_ORDER12_WEIGHT</a></div><div class="ttdeci">#define SIQK_QUADRATURE_TRITAY_ORDER12_WEIGHT</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l00355">compose_slmm.cpp:355</a></div></div>
<div class="ttc" id="acompose__slmm_8cpp_html_a96f8d18b38ee102e3197014e54f3b457"><div class="ttname"><a href="compose__slmm_8cpp.html#a96f8d18b38ee102e3197014e54f3b457">slmm_assert_high</a></div><div class="ttdeci">#define slmm_assert_high(condition)</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02354">compose_slmm.cpp:2354</a></div></div>
<div class="ttc" id="acompose__slmm_8cpp_html_a98fd88feb99433d9ee1ba08414134b3e"><div class="ttname"><a href="compose__slmm_8cpp.html#a98fd88feb99433d9ee1ba08414134b3e">slmm_init_local_mesh</a></div><div class="ttdeci">void slmm_init_local_mesh(homme::Int ie, homme::Cartesian3D *neigh_corners, homme::Int nnc, homme::Cartesian3D *p_inside, homme::Int)</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l04054">compose_slmm.cpp:4054</a></div></div>
<div class="ttc" id="acompose__slmm_8cpp_html_a9d6387552f10e43973ff9dc299f016e9"><div class="ttname"><a href="compose__slmm_8cpp.html#a9d6387552f10e43973ff9dc299f016e9">SIQK_QUADRATURE_TRISYM_ORDER14_COORD</a></div><div class="ttdeci">#define SIQK_QUADRATURE_TRISYM_ORDER14_COORD</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l00290">compose_slmm.cpp:290</a></div></div>
<div class="ttc" id="acompose__slmm_8cpp_html_aa9db60fd5d4873a20a8e4b8b98f68e65"><div class="ttname"><a href="compose__slmm_8cpp.html#aa9db60fd5d4873a20a8e4b8b98f68e65">dpotrs_</a></div><div class="ttdeci">void dpotrs_(const char *uplo, const int *n, const int *nrhs, const double *a, const int *lda, double *b, const int *ldb, int *info)</div></div>
<div class="ttc" id="acompose__slmm_8cpp_html_ad07d1b06cdd32a08841d0ed836bf8ace"><div class="ttname"><a href="compose__slmm_8cpp.html#ad07d1b06cdd32a08841d0ed836bf8ace">slmm_init_finalize</a></div><div class="ttdeci">void slmm_init_finalize()</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l04064">compose_slmm.cpp:4064</a></div></div>
<div class="ttc" id="acompose__slmm_8cpp_html_addc47ff9d33a59e563565bb1c07edf19"><div class="ttname"><a href="compose__slmm_8cpp.html#addc47ff9d33a59e563565bb1c07edf19">slmm_finalize</a></div><div class="ttdeci">void slmm_finalize()</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l04099">compose_slmm.cpp:4099</a></div></div>
<div class="ttc" id="acompose__slmm_8cpp_html_aed31b4c38ebebd571a22e451912558ff"><div class="ttname"><a href="compose__slmm_8cpp.html#aed31b4c38ebebd571a22e451912558ff">SIQK_QUADRATURE_TRITAY_ORDER12_COORD</a></div><div class="ttdeci">#define SIQK_QUADRATURE_TRITAY_ORDER12_COORD</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l00256">compose_slmm.cpp:256</a></div></div>
<div class="ttc" id="acompose__slmm_8cpp_html_aedda019adc3bb9a13f9a9289ad3fb53f"><div class="ttname"><a href="compose__slmm_8cpp.html#aedda019adc3bb9a13f9a9289ad3fb53f">SIQK_QUADRATURE_TRITAY_ORDER6_COORD</a></div><div class="ttdeci">#define SIQK_QUADRATURE_TRITAY_ORDER6_COORD</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l00368">compose_slmm.cpp:368</a></div></div>
<div class="ttc" id="acompose__slmm_8cpp_html_aeedef9961e344918a8181917bfdb31ba"><div class="ttname"><a href="compose__slmm_8cpp.html#aeedef9961e344918a8181917bfdb31ba">slmm_csl</a></div><div class="ttdeci">void slmm_csl(homme::Int nets, homme::Int nete, homme::Cartesian3D *dep_points, homme::Real *minq, homme::Real *maxq, homme::Int *info)</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l04083">compose_slmm.cpp:4083</a></div></div>
<div class="ttc" id="amain_8_f90_html_a8ec2266d83cd6c0b762cbcbc92c0af3d"><div class="ttname"><a href="main_8_f90.html#a8ec2266d83cd6c0b762cbcbc92c0af3d">main</a></div><div class="ttdeci">program main</div><div class="ttdef"><b>Definition:</b> <a href="main_8_f90_source.html#l00006">main.F90:6</a></div></div>
<div class="ttc" id="anamespace_homme_1_1_physical_constants_html_af1c6ba44dbdc6bf279635f8ef11b6862"><div class="ttname"><a href="namespace_homme_1_1_physical_constants.html#af1c6ba44dbdc6bf279635f8ef11b6862">Homme::PhysicalConstants::p0</a></div><div class="ttdeci">constexpr Real p0</div><div class="ttdef"><b>Definition:</b> <a href="_physical_constants_8hpp_source.html#l00024">PhysicalConstants.hpp:24</a></div></div>
<div class="ttc" id="anamespace_homme_html_a2fb615d1c0ef9769f9fe6ff030f5af5e"><div class="ttname"><a href="namespace_homme.html#a2fb615d1c0ef9769f9fe6ff030f5af5e">Homme::subview</a></div><div class="ttdeci">KOKKOS_INLINE_FUNCTION ViewUnmanaged&lt; ScalarType[DIM1], MemSpace &gt; subview(ViewType&lt; ScalarType *[DIM1], MemSpace, Properties... &gt; v_in, int ie)</div><div class="ttdef"><b>Definition:</b> <a href="_subview_utils_8hpp_source.html#l00025">SubviewUtils.hpp:25</a></div></div>
<div class="ttc" id="anamespace_kokkos_html"><div class="ttname"><a href="namespace_kokkos.html">Kokkos</a></div><div class="ttdef"><b>Definition:</b> <a href="compose__cedr_8cpp_source.html#l03755">compose_cedr.cpp:3755</a></div></div>
<div class="ttc" id="anamespacearkode__mod_html_a876a1cb648d7a4173b7b5532624b2743"><div class="ttname"><a href="namespacearkode__mod.html#a876a1cb648d7a4173b7b5532624b2743">arkode_mod::initialize</a></div><div class="ttdeci">subroutine initialize(elem, nets, nete, par, n0, qn0, tstart, arkode_parameters, table_set)</div><div class="ttdef"><b>Definition:</b> <a href="arkode__mod_8_f90_source.html#l00374">arkode_mod.F90:376</a></div></div>
<div class="ttc" id="anamespacebaroclinic__wave_html_a8619f63e6dd6db1077c1a18788afa359"><div class="ttname"><a href="namespacebaroclinic__wave.html#a8619f63e6dd6db1077c1a18788afa359">baroclinic_wave::k</a></div><div class="ttdeci">real(8), parameter k</div><div class="ttdef"><b>Definition:</b> <a href="dcmip2016-baroclinic_8_f90_source.html#l00083">dcmip2016-baroclinic.F90:83</a></div></div>
<div class="ttc" id="anamespacebaroclinic__wave_html_acf8e56bd7dfdfd2c39e16dfa491a5293"><div class="ttname"><a href="namespacebaroclinic__wave.html#acf8e56bd7dfdfd2c39e16dfa491a5293">baroclinic_wave::b</a></div><div class="ttdeci">real(8), parameter b</div><div class="ttdef"><b>Definition:</b> <a href="dcmip2016-baroclinic_8_f90_source.html#l00083">dcmip2016-baroclinic.F90:83</a></div></div>
<div class="ttc" id="anamespacecontrol__mod_html_a19f70697971fe3e6502be3097865437a"><div class="ttname"><a href="namespacecontrol__mod.html#a19f70697971fe3e6502be3097865437a">control_mod::tol</a></div><div class="ttdeci">real(kind=real_kind), public tol</div><div class="ttdef"><b>Definition:</b> <a href="control__mod_8_f90_source.html#l00137">control_mod.F90:137</a></div></div>
<div class="ttc" id="anamespacecontrol__mod_html_a7843d1e9a4379154a53150027e49f43b"><div class="ttname"><a href="namespacecontrol__mod.html#a7843d1e9a4379154a53150027e49f43b">control_mod::transport_alg</a></div><div class="ttdeci">integer, public transport_alg</div><div class="ttdef"><b>Definition:</b> <a href="control__mod_8_f90_source.html#l00021">control_mod.F90:21</a></div></div>
<div class="ttc" id="anamespacecontrol__mod_html_aff62de0026bd6ea7c244564a9cbf1c03"><div class="ttname"><a href="namespacecontrol__mod.html#aff62de0026bd6ea7c244564a9cbf1c03">control_mod::cubed_sphere_map</a></div><div class="ttdeci">integer, public cubed_sphere_map</div><div class="ttdef"><b>Definition:</b> <a href="control__mod_8_f90_source.html#l00087">control_mod.F90:87</a></div></div>
<div class="ttc" id="anamespacedcmip2012__test4_html_a17d6d85211f473d9cd440fcaca10820e"><div class="ttname"><a href="namespacedcmip2012__test4.html#a17d6d85211f473d9cd440fcaca10820e">dcmip2012_test4::q0</a></div><div class="ttdeci">real(8), parameter q0</div><div class="ttdef"><b>Definition:</b> <a href="dcmip2012__test4_8_f90_source.html#l00086">dcmip2012_test4.F90:86</a></div></div>
<div class="ttc" id="anamespacedcmip2012__test5_html_a23dbdf598e3e14675594d87b6df56eb3"><div class="ttname"><a href="namespacedcmip2012__test5.html#a23dbdf598e3e14675594d87b6df56eb3">dcmip2012_test5::epsilon</a></div><div class="ttdeci">real(8), parameter epsilon</div><div class="ttdef"><b>Definition:</b> <a href="dcmip2012__test5_8_f90_source.html#l00055">dcmip2012_test5.F90:55</a></div></div>
<div class="ttc" id="anamespacedcmip2012__test5_html_ad259dec8945b10d8b2c6226e53589de5"><div class="ttname"><a href="namespacedcmip2012__test5.html#ad259dec8945b10d8b2c6226e53589de5">dcmip2012_test5::dp</a></div><div class="ttdeci">real(8), parameter dp</div><div class="ttdef"><b>Definition:</b> <a href="dcmip2012__test5_8_f90_source.html#l00055">dcmip2012_test5.F90:55</a></div></div>
<div class="ttc" id="anamespacedcmip2012__test5_html_ad89ae7f123bdc5a628ee8e834c3e18a5"><div class="ttname"><a href="namespacedcmip2012__test5.html#ad89ae7f123bdc5a628ee8e834c3e18a5">dcmip2012_test5::convert</a></div><div class="ttdeci">real(8), parameter convert</div><div class="ttdef"><b>Definition:</b> <a href="dcmip2012__test5_8_f90_source.html#l00050">dcmip2012_test5.F90:50</a></div></div>
<div class="ttc" id="anamespacedimensions__mod_html_a0070848a40ac48379601d9a8a183c83b"><div class="ttname"><a href="namespacedimensions__mod.html#a0070848a40ac48379601d9a8a183c83b">dimensions_mod::qsize</a></div><div class="ttdeci">integer, public qsize</div><div class="ttdef"><b>Definition:</b> <a href="dimensions__mod_8_f90_source.html#l00026">dimensions_mod.F90:26</a></div></div>
<div class="ttc" id="anamespacedimensions__mod_html_a64817c8f3506c463c896d202d237025e"><div class="ttname"><a href="namespacedimensions__mod.html#a64817c8f3506c463c896d202d237025e">dimensions_mod::nelem</a></div><div class="ttdeci">integer, public nelem</div><div class="ttdef"><b>Definition:</b> <a href="dimensions__mod_8_f90_source.html#l00041">dimensions_mod.F90:41</a></div></div>
<div class="ttc" id="anamespacedimensions__mod_html_a6baa218e1683465acc4f37fcea8e30d5"><div class="ttname"><a href="namespacedimensions__mod.html#a6baa218e1683465acc4f37fcea8e30d5">dimensions_mod::nlev</a></div><div class="ttdeci">integer, parameter, public nlev</div><div class="ttdef"><b>Definition:</b> <a href="dimensions__mod_8_f90_source.html#l00029">dimensions_mod.F90:29</a></div></div>
<div class="ttc" id="anamespacedimensions__mod_html_a8648e26ae0e474ccf69d32a8148520c9"><div class="ttname"><a href="namespacedimensions__mod.html#a8648e26ae0e474ccf69d32a8148520c9">dimensions_mod::np</a></div><div class="ttdeci">integer, parameter, public np</div><div class="ttdef"><b>Definition:</b> <a href="dimensions__mod_8_f90_source.html#l00023">dimensions_mod.F90:23</a></div></div>
<div class="ttc" id="anamespacedimensions__mod_html_af137394c40531d5d6f0daa64351372e7"><div class="ttname"><a href="namespacedimensions__mod.html#af137394c40531d5d6f0daa64351372e7">dimensions_mod::ne</a></div><div class="ttdeci">integer, public ne</div><div class="ttdef"><b>Definition:</b> <a href="dimensions__mod_8_f90_source.html#l00039">dimensions_mod.F90:39</a></div></div>
<div class="ttc" id="anamespacedimensions__mod_html_af2bd2c00f3bbb316bc19c0b7964b18c4"><div class="ttname"><a href="namespacedimensions__mod.html#af2bd2c00f3bbb316bc19c0b7964b18c4">dimensions_mod::nelemd</a></div><div class="ttdeci">integer, public nelemd</div><div class="ttdef"><b>Definition:</b> <a href="dimensions__mod_8_f90_source.html#l00042">dimensions_mod.F90:42</a></div></div>
<div class="ttc" id="anamespacehomme_1_1cslmpi_1_1extend__halo_html_a0b28bfb437f4357677305e49b682e9b6"><div class="ttname"><a href="namespacehomme_1_1cslmpi_1_1extend__halo.html#a0b28bfb437f4357677305e49b682e9b6">homme::cslmpi::extend_halo::collect_gid_rank</a></div><div class="ttdeci">void collect_gid_rank(const mpi::Parallel &amp;p, FixedCapList&lt; ElemData &gt; &amp;eds)</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02828">compose_slmm.cpp:2828</a></div></div>
<div class="ttc" id="anamespacehomme_1_1cslmpi_1_1extend__halo_html_a16cf7ddbd04658463839e82fb8244824"><div class="ttname"><a href="namespacehomme_1_1cslmpi_1_1extend__halo.html#a16cf7ddbd04658463839e82fb8244824">homme::cslmpi::extend_halo::extend_local_meshes</a></div><div class="ttdeci">void extend_local_meshes(const mpi::Parallel &amp;p, const FixedCapList&lt; ElemData &gt; &amp;eds, slmm::Advecter &amp;advecter)</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02834">compose_slmm.cpp:2834</a></div></div>
<div class="ttc" id="anamespacehomme_1_1cslmpi_1_1extend__halo_html_a181b8883d547fec1599fce463691e1c9"><div class="ttname"><a href="namespacehomme_1_1cslmpi_1_1extend__halo.html#a181b8883d547fec1599fce463691e1c9">homme::cslmpi::extend_halo::RealBuf</a></div><div class="ttdeci">std::vector&lt; Real &gt; RealBuf</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02669">compose_slmm.cpp:2669</a></div></div>
<div class="ttc" id="anamespacehomme_1_1cslmpi_1_1extend__halo_html_a21f7b026fd02325c7eb3c68548ae229e"><div class="ttname"><a href="namespacehomme_1_1cslmpi_1_1extend__halo.html#a21f7b026fd02325c7eb3c68548ae229e">homme::cslmpi::extend_halo::GidRankPairs</a></div><div class="ttdeci">std::vector&lt; GidRankPair &gt; GidRankPairs</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02666">compose_slmm.cpp:2666</a></div></div>
<div class="ttc" id="anamespacehomme_1_1cslmpi_1_1extend__halo_html_a23401317c095aa03d286cabe77d4e476"><div class="ttname"><a href="namespacehomme_1_1cslmpi_1_1extend__halo.html#a23401317c095aa03d286cabe77d4e476">homme::cslmpi::extend_halo::fill_gid2nbrs</a></div><div class="ttdeci">void fill_gid2nbrs(const mpi::Parallel &amp;p, const FixedCapList&lt; ElemData &gt; &amp;eds, Gid2Nbrs &amp;gid2nbrs)</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02680">compose_slmm.cpp:2680</a></div></div>
<div class="ttc" id="anamespacehomme_1_1cslmpi_1_1extend__halo_html_a2de5a7ce5d7b1464dd13aa43727cfab8"><div class="ttname"><a href="namespacehomme_1_1cslmpi_1_1extend__halo.html#a2de5a7ce5d7b1464dd13aa43727cfab8">homme::cslmpi::extend_halo::IntBuf</a></div><div class="ttdeci">std::vector&lt; Int &gt; IntBuf</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02668">compose_slmm.cpp:2668</a></div></div>
<div class="ttc" id="anamespacehomme_1_1cslmpi_1_1extend__halo_html_a7062e760256f731fb032101dfefd4b84"><div class="ttname"><a href="namespacehomme_1_1cslmpi_1_1extend__halo.html#a7062e760256f731fb032101dfefd4b84">homme::cslmpi::extend_halo::ElemData</a></div><div class="ttdeci">CslMpi::ElemData ElemData</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02653">compose_slmm.cpp:2653</a></div></div>
<div class="ttc" id="anamespacehomme_1_1cslmpi_1_1extend__halo_html_a7a12af5e0cfecd81cc5b89f7f0eb5789"><div class="ttname"><a href="namespacehomme_1_1cslmpi_1_1extend__halo.html#a7a12af5e0cfecd81cc5b89f7f0eb5789">homme::cslmpi::extend_halo::Rank</a></div><div class="ttdeci">Int Rank</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02655">compose_slmm.cpp:2655</a></div></div>
<div class="ttc" id="anamespacehomme_1_1cslmpi_1_1extend__halo_html_abfcbff07665accf825719ffd1216844e"><div class="ttname"><a href="namespacehomme_1_1cslmpi_1_1extend__halo.html#abfcbff07665accf825719ffd1216844e">homme::cslmpi::extend_halo::all_nbrs_but_me</a></div><div class="ttdeci">GidRankPairs all_nbrs_but_me(const ElemData &amp;ed)</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02671">compose_slmm.cpp:2671</a></div></div>
<div class="ttc" id="anamespacehomme_1_1cslmpi_1_1extend__halo_html_acaa03db2914deec44a6b375c90731bff"><div class="ttname"><a href="namespacehomme_1_1cslmpi_1_1extend__halo.html#acaa03db2914deec44a6b375c90731bff">homme::cslmpi::extend_halo::Gid2Nbrs</a></div><div class="ttdeci">std::map&lt; Gid, GidRankPairs &gt; Gid2Nbrs</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02667">compose_slmm.cpp:2667</a></div></div>
<div class="ttc" id="anamespacehomme_1_1cslmpi_1_1extend__halo_html_ae58d6b3452c7322905e678d0af436744"><div class="ttname"><a href="namespacehomme_1_1cslmpi_1_1extend__halo.html#ae58d6b3452c7322905e678d0af436744">homme::cslmpi::extend_halo::extend_nbrs</a></div><div class="ttdeci">void extend_nbrs(const Gid2Nbrs &amp;gid2nbrs, FixedCapList&lt; ElemData &gt; &amp;eds)</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02790">compose_slmm.cpp:2790</a></div></div>
<div class="ttc" id="anamespacehomme_1_1cslmpi_1_1extend__halo_html_af74e0f8fab9daccac42745e70b4ed933"><div class="ttname"><a href="namespacehomme_1_1cslmpi_1_1extend__halo.html#af74e0f8fab9daccac42745e70b4ed933">homme::cslmpi::extend_halo::Gid</a></div><div class="ttdeci">Int Gid</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02654">compose_slmm.cpp:2654</a></div></div>
<div class="ttc" id="anamespacehomme_1_1cslmpi_html_a046d297dfd93e01977f02dac72bf35cc"><div class="ttname"><a href="namespacehomme_1_1cslmpi.html#a046d297dfd93e01977f02dac72bf35cc">homme::cslmpi::set_elem_data</a></div><div class="ttdeci">void set_elem_data(CslMpi &amp;cm, const Int ie, const Real *metdet, const Real *qdp, const Real *dp, Real *q, const Int nelem_in_patch)</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l03349">compose_slmm.cpp:3349</a></div></div>
<div class="ttc" id="anamespacehomme_1_1cslmpi_html_a052dd4e374a1b3adc306567af50bbf5f"><div class="ttname"><a href="namespacehomme_1_1cslmpi.html#a052dd4e374a1b3adc306567af50bbf5f">homme::cslmpi::setbuf</a></div><div class="ttdeci">Int setbuf(Buffer &amp;buf, const Int &amp;os, const Int &amp;i1, const Int &amp;i2)</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l03512">compose_slmm.cpp:3512</a></div></div>
<div class="ttc" id="anamespacehomme_1_1cslmpi_html_a07099f4d16dd444a00ee5992c322d330"><div class="ttname"><a href="namespacehomme_1_1cslmpi.html#a07099f4d16dd444a00ee5992c322d330">homme::cslmpi::pack_dep_points_sendbuf_pass1</a></div><div class="ttdeci">void pack_dep_points_sendbuf_pass1(CslMpi &amp;cm)</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l03543">compose_slmm.cpp:3543</a></div></div>
<div class="ttc" id="anamespacehomme_1_1cslmpi_html_a0d6deb13b24f57c3d1942a8b3162d246"><div class="ttname"><a href="namespacehomme_1_1cslmpi.html#a0d6deb13b24f57c3d1942a8b3162d246">homme::cslmpi::get_rank2gids</a></div><div class="ttdeci">void get_rank2gids(const CslMpi &amp;cm, Rank2Gids &amp;rank2rmtgids, Rank2Gids &amp;rank2owngids)</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l03046">compose_slmm.cpp:3046</a></div></div>
<div class="ttc" id="anamespacehomme_1_1cslmpi_html_a19a9e463b1553c3e6c2995097f5520d5"><div class="ttname"><a href="namespacehomme_1_1cslmpi.html#a19a9e463b1553c3e6c2995097f5520d5">homme::cslmpi::step</a></div><div class="ttdeci">void step(CslMpi &amp;cm, const Int nets, const Int nete, Cartesian3D *dep_points_r, Real *q_min_r, Real *q_max_r)</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l03930">compose_slmm.cpp:3930</a></div></div>
<div class="ttc" id="anamespacehomme_1_1cslmpi_html_a1ac669e059bf52c0905a8b1be7420b8a"><div class="ttname"><a href="namespacehomme_1_1cslmpi.html#a1ac669e059bf52c0905a8b1be7420b8a">homme::cslmpi::calc_q_extrema</a></div><div class="ttdeci">void calc_q_extrema(CslMpi &amp;cm, const Int &amp;nets, const Int &amp;nete)</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l03644">compose_slmm.cpp:3644</a></div></div>
<div class="ttc" id="anamespacehomme_1_1cslmpi_html_a1cb73238389100b0af5524e6bfca9e23"><div class="ttname"><a href="namespacehomme_1_1cslmpi.html#a1cb73238389100b0af5524e6bfca9e23">homme::cslmpi::calc_own_q</a></div><div class="ttdeci">void calc_own_q(CslMpi &amp;cm, const Int &amp;nets, const Int &amp;nete, const FA4&lt; const Real &gt; &amp;dep_points, const FA4&lt; Real &gt; &amp;q_min, const FA4&lt; Real &gt; &amp;q_max)</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l03872">compose_slmm.cpp:3872</a></div></div>
<div class="ttc" id="anamespacehomme_1_1cslmpi_html_a256ba3e25f45bad09c7ccdbbfbc5b520"><div class="ttname"><a href="namespacehomme_1_1cslmpi.html#a256ba3e25f45bad09c7ccdbbfbc5b520">homme::cslmpi::get_num_threads</a></div><div class="ttdeci">int get_num_threads()</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02547">compose_slmm.cpp:2547</a></div></div>
<div class="ttc" id="anamespacehomme_1_1cslmpi_html_a2a848539840228420a6645a192dc2dda"><div class="ttname"><a href="namespacehomme_1_1cslmpi.html#a2a848539840228420a6645a192dc2dda">homme::cslmpi::calc_rmt_q</a></div><div class="ttdeci">void calc_rmt_q(CslMpi &amp;cm)</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l03866">compose_slmm.cpp:3866</a></div></div>
<div class="ttc" id="anamespacehomme_1_1cslmpi_html_a2b713e2734729354e7c6f52f90ec64d6"><div class="ttname"><a href="namespacehomme_1_1cslmpi.html#a2b713e2734729354e7c6f52f90ec64d6">homme::cslmpi::recv</a></div><div class="ttdeci">void recv(CslMpi &amp;cm, const bool skip_if_empty=false)</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l03422">compose_slmm.cpp:3422</a></div></div>
<div class="ttc" id="anamespacehomme_1_1cslmpi_html_a3022054afadca5fa11fa65363437cd72"><div class="ttname"><a href="namespacehomme_1_1cslmpi.html#a3022054afadca5fa11fa65363437cd72">homme::cslmpi::isend</a></div><div class="ttdeci">void isend(CslMpi &amp;cm, const bool want_req=true, const bool skip_if_empty=false)</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l03379">compose_slmm.cpp:3379</a></div></div>
<div class="ttc" id="anamespacehomme_1_1cslmpi_html_a32509c39cdc3a8ba859f7ae3c9548fc9"><div class="ttname"><a href="namespacehomme_1_1cslmpi.html#a32509c39cdc3a8ba859f7ae3c9548fc9">homme::cslmpi::copy_q</a></div><div class="ttdeci">void copy_q(CslMpi &amp;cm, const Int &amp;nets, const FA4&lt; Real &gt; &amp;q_min, const FA4&lt; Real &gt; &amp;q_max)</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l03899">compose_slmm.cpp:3899</a></div></div>
<div class="ttc" id="anamespacehomme_1_1cslmpi_html_a4bc85dab30db1c90c07f4f06a386dba3"><div class="ttname"><a href="namespacehomme_1_1cslmpi.html#a4bc85dab30db1c90c07f4f06a386dba3">homme::cslmpi::calc_rmt_q_pass2</a></div><div class="ttdeci">void calc_rmt_q_pass2(CslMpi &amp;cm)</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l03835">compose_slmm.cpp:3835</a></div></div>
<div class="ttc" id="anamespacehomme_1_1cslmpi_html_a63db9c4328616160d33ba5a9a7c8af9e"><div class="ttname"><a href="namespacehomme_1_1cslmpi.html#a63db9c4328616160d33ba5a9a7c8af9e">homme::cslmpi::pack_dep_points_sendbuf_pass2</a></div><div class="ttdeci">void pack_dep_points_sendbuf_pass2(CslMpi &amp;cm, const FA4&lt; const Real &gt; &amp;dep_points)</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l03595">compose_slmm.cpp:3595</a></div></div>
<div class="ttc" id="anamespacehomme_1_1cslmpi_html_a6b0c6a7c4b69df2b2a760305451493e4"><div class="ttname"><a href="namespacehomme_1_1cslmpi.html#a6b0c6a7c4b69df2b2a760305451493e4">homme::cslmpi::getbuf</a></div><div class="ttdeci">Int getbuf(Buffer &amp;buf, const Int &amp;os, Int &amp;i1, Int &amp;i2)</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l03520">compose_slmm.cpp:3520</a></div></div>
<div class="ttc" id="anamespacehomme_1_1cslmpi_html_a77abbc438e30f8cb28d694a58f93fa0d"><div class="ttname"><a href="namespacehomme_1_1cslmpi.html#a77abbc438e30f8cb28d694a58f93fa0d">homme::cslmpi::size_mpi_buffers</a></div><div class="ttdeci">void size_mpi_buffers(CslMpi &amp;cm, const Rank2Gids &amp;rank2rmtgids, const Rank2Gids &amp;rank2owngids)</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l03220">compose_slmm.cpp:3220</a></div></div>
<div class="ttc" id="anamespacehomme_1_1cslmpi_html_a7ade007724eed5ac50831ef77f3c4431"><div class="ttname"><a href="namespacehomme_1_1cslmpi.html#a7ade007724eed5ac50831ef77f3c4431">homme::cslmpi::Rank2Gids</a></div><div class="ttdeci">std::map&lt; Int, std::set&lt; Int &gt; &gt; Rank2Gids</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l03044">compose_slmm.cpp:3044</a></div></div>
<div class="ttc" id="anamespacehomme_1_1cslmpi_html_a7c49b694c0edee08b4ddb61b2b700867"><div class="ttname"><a href="namespacehomme_1_1cslmpi.html#a7c49b694c0edee08b4ddb61b2b700867">homme::cslmpi::get_tid</a></div><div class="ttdeci">int get_tid()</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02539">compose_slmm.cpp:2539</a></div></div>
<div class="ttc" id="anamespacehomme_1_1cslmpi_html_a871d0115e909fcb69d0afe3b9ce9c6c5"><div class="ttname"><a href="namespacehomme_1_1cslmpi.html#a871d0115e909fcb69d0afe3b9ce9c6c5">homme::cslmpi::init_mylid_with_comm_threaded</a></div><div class="ttdeci">void init_mylid_with_comm_threaded(CslMpi &amp;cm, const Int &amp;nets, const Int &amp;nete)</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l03300">compose_slmm.cpp:3300</a></div></div>
<div class="ttc" id="anamespacehomme_1_1cslmpi_html_a8a5f75d82247e0c4dc633f7f1987d161"><div class="ttname"><a href="namespacehomme_1_1cslmpi.html#a8a5f75d82247e0c4dc633f7f1987d161">homme::cslmpi::alloc_mpi_buffers</a></div><div class="ttdeci">void alloc_mpi_buffers(CslMpi &amp;cm, Real *sendbuf=nullptr, Real *recvbuf=nullptr)</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l03263">compose_slmm.cpp:3263</a></div></div>
<div class="ttc" id="anamespacehomme_1_1cslmpi_html_aacaed757e415d59a7d9e6f843f5fe026"><div class="ttname"><a href="namespacehomme_1_1cslmpi.html#aacaed757e415d59a7d9e6f843f5fe026">homme::cslmpi::set_idx2_maps</a></div><div class="ttdeci">void set_idx2_maps(CslMpi &amp;cm, const Rank2Gids &amp;rank2rmtgids, const std::map&lt; Int, Int &gt; &amp;gid2rmt_owning_lid)</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l03161">compose_slmm.cpp:3161</a></div></div>
<div class="ttc" id="anamespacehomme_1_1cslmpi_html_aacdc9acd8b3757395cefeae350460628"><div class="ttname"><a href="namespacehomme_1_1cslmpi.html#aacdc9acd8b3757395cefeae350460628">homme::cslmpi::setup_irecv</a></div><div class="ttdeci">void setup_irecv(CslMpi &amp;cm, const bool skip_if_empty=false)</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l03360">compose_slmm.cpp:3360</a></div></div>
<div class="ttc" id="anamespacehomme_1_1cslmpi_html_abbb2510c34ec1efc66ea9a7c40d08d3f"><div class="ttname"><a href="namespacehomme_1_1cslmpi.html#abbb2510c34ec1efc66ea9a7c40d08d3f">homme::cslmpi::calc_q</a></div><div class="ttdeci">void calc_q(const CslMpi &amp;cm, const Int &amp;src_lid, const Int &amp;lev, const Real *const dep_point, Real *const q_tgt, const bool use_q)</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l03691">compose_slmm.cpp:3691</a></div></div>
<div class="ttc" id="anamespacehomme_1_1cslmpi_html_abe9d1dd9e3c5e823f5ca4910aef91819"><div class="ttname"><a href="namespacehomme_1_1cslmpi.html#abe9d1dd9e3c5e823f5ca4910aef91819">homme::cslmpi::setup_comm_pattern</a></div><div class="ttdeci">void setup_comm_pattern(CslMpi &amp;cm, const Int *nbr_id_rank, const Int *nirptr)</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l03285">compose_slmm.cpp:3285</a></div></div>
<div class="ttc" id="anamespacehomme_1_1cslmpi_html_ac51ce11648fb404be04ee0fdda9a409e"><div class="ttname"><a href="namespacehomme_1_1cslmpi.html#ac51ce11648fb404be04ee0fdda9a409e">homme::cslmpi::wait_on_send</a></div><div class="ttdeci">void wait_on_send(CslMpi &amp;cm, const bool skip_if_empty=false)</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l03407">compose_slmm.cpp:3407</a></div></div>
<div class="ttc" id="anamespacehomme_1_1cslmpi_html_ace72e34c6a3042506aac8ef481cddcec"><div class="ttname"><a href="namespacehomme_1_1cslmpi.html#ace72e34c6a3042506aac8ef481cddcec">homme::cslmpi::finalize_local_meshes</a></div><div class="ttdeci">void finalize_local_meshes(CslMpi &amp;cm, slmm::Advecter &amp;advecter)</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l03343">compose_slmm.cpp:3343</a></div></div>
<div class="ttc" id="anamespacehomme_1_1cslmpi_html_ad48822a697a885d832273d545c21f5ce"><div class="ttname"><a href="namespacehomme_1_1cslmpi.html#ad48822a697a885d832273d545c21f5ce">homme::cslmpi::calc_rmt_q_pass1</a></div><div class="ttdeci">void calc_rmt_q_pass1(CslMpi &amp;cm)</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l03775">compose_slmm.cpp:3775</a></div></div>
<div class="ttc" id="anamespacehomme_1_1cslmpi_html_ae779fc75a201a595ff26fb3496c7d91f"><div class="ttname"><a href="namespacehomme_1_1cslmpi.html#ae779fc75a201a595ff26fb3496c7d91f">homme::cslmpi::comm_lid_on_rank</a></div><div class="ttdeci">void comm_lid_on_rank(CslMpi &amp;cm, const Rank2Gids &amp;rank2rmtgids, const Rank2Gids &amp;rank2owngids, std::map&lt; Int, Int &gt; &amp;gid2rmt_owning_lid)</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l03063">compose_slmm.cpp:3063</a></div></div>
<div class="ttc" id="anamespacehomme_1_1cslmpi_html_aee15eed8b1833f44fd858475eac23eca"><div class="ttname"><a href="namespacehomme_1_1cslmpi.html#aee15eed8b1833f44fd858475eac23eca">homme::cslmpi::analyze_dep_points</a></div><div class="ttdeci">void analyze_dep_points(CslMpi &amp;cm, const Int &amp;nets, const Int &amp;nete, const FA4&lt; Real &gt; &amp;dep_points)</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l03435">compose_slmm.cpp:3435</a></div></div>
<div class="ttc" id="anamespacehomme_1_1cslmpi_html_aef296f5b9c1f04eaf474e67814a27ee2"><div class="ttname"><a href="namespacehomme_1_1cslmpi.html#aef296f5b9c1f04eaf474e67814a27ee2">homme::cslmpi::recv_and_wait_on_send</a></div><div class="ttdeci">void recv_and_wait_on_send(CslMpi &amp;cm)</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l03394">compose_slmm.cpp:3394</a></div></div>
<div class="ttc" id="anamespacehomme_1_1cslmpi_html_af40d7ea4fe4185cea6fc7c0e4f17133b"><div class="ttname"><a href="namespacehomme_1_1cslmpi.html#af40d7ea4fe4185cea6fc7c0e4f17133b">homme::cslmpi::init</a></div><div class="ttdeci">CslMpi::Ptr init(const slmm::Advecter::ConstPtr &amp;advecter, const mpi::Parallel::Ptr &amp;p, Int np, Int nlev, Int qsize, Int qsized, Int nelemd, const Int *nbr_id_rank, const Int *nirptr, Int halo)</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l03329">compose_slmm.cpp:3329</a></div></div>
<div class="ttc" id="anamespacehomme_1_1cslmpi_html_af584967327f65221fc9f7707fde769bf"><div class="ttname"><a href="namespacehomme_1_1cslmpi.html#af584967327f65221fc9f7707fde769bf">homme::cslmpi::collect_gid_rank</a></div><div class="ttdeci">void collect_gid_rank(CslMpi &amp;cm, const Int *nbr_id_rank, const Int *nirptr)</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l03015">compose_slmm.cpp:3015</a></div></div>
<div class="ttc" id="anamespacehomme_1_1mpi_html_a03a3312a58c03f70dcf34ab09d9399b4"><div class="ttname"><a href="namespacehomme_1_1mpi.html#a03a3312a58c03f70dcf34ab09d9399b4">homme::mpi::make_parallel</a></div><div class="ttdeci">Parallel::Ptr make_parallel(MPI_Comm comm)</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02241">compose_slmm.cpp:2241</a></div></div>
<div class="ttc" id="anamespacehomme_1_1mpi_html_a162358f1439766288643bddb8a93b52b"><div class="ttname"><a href="namespacehomme_1_1mpi.html#a162358f1439766288643bddb8a93b52b">homme::mpi::get_type&lt; long &gt;</a></div><div class="ttdeci">MPI_Datatype get_type&lt; long &gt;()</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02276">compose_slmm.cpp:2276</a></div></div>
<div class="ttc" id="anamespacehomme_1_1mpi_html_a3313f408c8edb7f88dbdc06d754841d3"><div class="ttname"><a href="namespacehomme_1_1mpi.html#a3313f408c8edb7f88dbdc06d754841d3">homme::mpi::wait</a></div><div class="ttdeci">int wait(Request *req, MPI_Status *stat=nullptr)</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02337">compose_slmm.cpp:2337</a></div></div>
<div class="ttc" id="anamespacehomme_1_1mpi_html_a34f40c3b1676af66d3ee317213118a1a"><div class="ttname"><a href="namespacehomme_1_1mpi.html#a34f40c3b1676af66d3ee317213118a1a">homme::mpi::waitall</a></div><div class="ttdeci">int waitall(int count, Request *reqs, MPI_Status *stats=nullptr)</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02320">compose_slmm.cpp:2320</a></div></div>
<div class="ttc" id="anamespacehomme_1_1mpi_html_a40185ee733d1b24e02d8f73d9bf9868b"><div class="ttname"><a href="namespacehomme_1_1mpi.html#a40185ee733d1b24e02d8f73d9bf9868b">homme::mpi::get_type&lt; double &gt;</a></div><div class="ttdeci">MPI_Datatype get_type&lt; double &gt;()</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02275">compose_slmm.cpp:2275</a></div></div>
<div class="ttc" id="anamespacehomme_1_1mpi_html_a4b2c02b22e6da57800116d5a3ef07d83"><div class="ttname"><a href="namespacehomme_1_1mpi.html#a4b2c02b22e6da57800116d5a3ef07d83">homme::mpi::get_type</a></div><div class="ttdeci">MPI_Datatype get_type()</div></div>
<div class="ttc" id="anamespacehomme_1_1mpi_html_a82d35837b534382faf656df6413b3e23"><div class="ttname"><a href="namespacehomme_1_1mpi.html#a82d35837b534382faf656df6413b3e23">homme::mpi::waitany</a></div><div class="ttdeci">int waitany(int count, Request *reqs, int *index, MPI_Status *stats=nullptr)</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02305">compose_slmm.cpp:2305</a></div></div>
<div class="ttc" id="anamespacehomme_1_1mpi_html_a9d1d599c4b4c778bd06a5c67ee2aa084"><div class="ttname"><a href="namespacehomme_1_1mpi.html#a9d1d599c4b4c778bd06a5c67ee2aa084">homme::mpi::get_type&lt; int &gt;</a></div><div class="ttdeci">MPI_Datatype get_type&lt; int &gt;()</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02274">compose_slmm.cpp:2274</a></div></div>
<div class="ttc" id="anamespacehomme_1_1mpi_html_ad0286e50c3714e7a55f00f9a87c3637e"><div class="ttname"><a href="namespacehomme_1_1mpi.html#ad0286e50c3714e7a55f00f9a87c3637e">homme::mpi::irecv</a></div><div class="ttdeci">int irecv(const Parallel &amp;p, T *buf, int count, int src, int tag, Request *ireq)</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02293">compose_slmm.cpp:2293</a></div></div>
<div class="ttc" id="anamespacehomme_1_1mpi_html_ad8082dcb60fee10aa4100b8bdd436f50"><div class="ttname"><a href="namespacehomme_1_1mpi.html#ad8082dcb60fee10aa4100b8bdd436f50">homme::mpi::isend</a></div><div class="ttdeci">int isend(const Parallel &amp;p, const T *buf, int count, int dest, int tag, Request *ireq)</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02279">compose_slmm.cpp:2279</a></div></div>
<div class="ttc" id="anamespacehomme_html"><div class="ttname"><a href="namespacehomme.html">homme</a></div><div class="ttdef"><b>Definition:</b> <a href="compose__cedr_8cpp_source.html#l05023">compose_cedr.cpp:5023</a></div></div>
<div class="ttc" id="anamespacehomme_html_a209d68f2b13c312588926b5c0493106f"><div class="ttname"><a href="namespacehomme.html#a209d68f2b13c312588926b5c0493106f">homme::FA5</a></div><div class="ttdeci">Kokkos::View&lt; T *****, Kokkos::LayoutLeft, Kokkos::HostSpace &gt; FA5</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02205">compose_slmm.cpp:2206</a></div></div>
<div class="ttc" id="anamespacehomme_html_a362172619ed099872f216687207d453d"><div class="ttname"><a href="namespacehomme.html#a362172619ed099872f216687207d453d">homme::slmm_init</a></div><div class="ttdeci">void slmm_init(const Int np, const Int nelem, const Int nelemd, const Int transport_alg, const Int cubed_sphere_map, const Int sl_nearest_point_lev, const Int *lid2facenum)</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02212">compose_slmm.cpp:2212</a></div></div>
<div class="ttc" id="anamespacehomme_html_a854e69de78ccf3e48d7f20d364114b4d"><div class="ttname"><a href="namespacehomme.html#a854e69de78ccf3e48d7f20d364114b4d">homme::FA4</a></div><div class="ttdeci">Kokkos::View&lt; T ****, Kokkos::LayoutLeft, Kokkos::HostSpace &gt; FA4</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02203">compose_slmm.cpp:2204</a></div></div>
<div class="ttc" id="anamespacehomme_html_a9798590dfa671ded8ffd2295e714df11"><div class="ttname"><a href="namespacehomme.html#a9798590dfa671ded8ffd2295e714df11">homme::FA3</a></div><div class="ttdeci">Kokkos::View&lt; T ***, Kokkos::LayoutLeft, Kokkos::HostSpace &gt; FA3</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02201">compose_slmm.cpp:2202</a></div></div>
<div class="ttc" id="anamespacehomme_html_aa2ca2aa98b50def12f1623c268d094ee"><div class="ttname"><a href="namespacehomme.html#aa2ca2aa98b50def12f1623c268d094ee">homme::Int</a></div><div class="ttdeci">slmm::Int Int</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02193">compose_slmm.cpp:2193</a></div></div>
<div class="ttc" id="anamespacehomme_html_ac98706588408697743e06647261f5ffa"><div class="ttname"><a href="namespacehomme.html#ac98706588408697743e06647261f5ffa">homme::FA2</a></div><div class="ttdeci">Kokkos::View&lt; T **, Kokkos::LayoutLeft, Kokkos::HostSpace &gt; FA2</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02199">compose_slmm.cpp:2200</a></div></div>
<div class="ttc" id="anamespacehomme_html_af613524ea9fa700597e28c2792c5b38d"><div class="ttname"><a href="namespacehomme.html#af613524ea9fa700597e28c2792c5b38d">homme::Real</a></div><div class="ttdeci">slmm::Real Real</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02194">compose_slmm.cpp:2194</a></div></div>
<div class="ttc" id="anamespacejw_html_a655cdd60136294f8259068e09d1307ff"><div class="ttname"><a href="namespacejw.html#a655cdd60136294f8259068e09d1307ff">jw::pi</a></div><div class="ttdeci">real(r8), parameter pi</div><div class="ttdef"><b>Definition:</b> <a href="asp__tests_8_f90_source.html#l00048">asp_tests.F90:48</a></div></div>
<div class="ttc" id="anamespacejw_html_acf663523b96ec023200fa8a0f58209f8"><div class="ttname"><a href="namespacejw.html#acf663523b96ec023200fa8a0f58209f8">jw::a</a></div><div class="ttdeci">real(r8), parameter a</div><div class="ttdef"><b>Definition:</b> <a href="asp__tests_8_f90_source.html#l00048">asp_tests.F90:48</a></div></div>
<div class="ttc" id="anamespacephysical__constants_html_a8f292bec2061eac2b56d3f01a57eeff2"><div class="ttname"><a href="namespacephysical__constants.html#a8f292bec2061eac2b56d3f01a57eeff2">physical_constants::dx</a></div><div class="ttdeci">real(kind=real_kind), public dx</div><div class="ttdef"><b>Definition:</b> <a href="physical__constants_8_f90_source.html#l00079">physical_constants.F90:79</a></div></div>
<div class="ttc" id="anamespacesiqk_1_1sqr_1_1impl_html_a0426c38c677787ff0781f439d8049f4b"><div class="ttname"><a href="namespacesiqk_1_1sqr_1_1impl.html#a0426c38c677787ff0781f439d8049f4b">siqk::sqr::impl::calc_Jacobian</a></div><div class="ttdeci">KOKKOS_INLINE_FUNCTION void calc_Jacobian(const ConstVec3sT &amp;p, const Quad &amp;e, Real a, Real b, Real J[6])</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l00906">compose_slmm.cpp:906</a></div></div>
<div class="ttc" id="anamespacesiqk_1_1sqr_1_1impl_html_a7d208820b935d30c141634dc64f5dd2c"><div class="ttname"><a href="namespacesiqk_1_1sqr_1_1impl.html#a7d208820b935d30c141634dc64f5dd2c">siqk::sqr::impl::solve_Jxr</a></div><div class="ttdeci">KOKKOS_INLINE_FUNCTION void solve_Jxr(Real J[6], const Real r[3], Real dx[2])</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l00934">compose_slmm.cpp:934</a></div></div>
<div class="ttc" id="anamespacesiqk_1_1sqr_1_1impl_html_a86e87f8161a3c6475f4f45a668fe6779"><div class="ttname"><a href="namespacesiqk_1_1sqr_1_1impl.html#a86e87f8161a3c6475f4f45a668fe6779">siqk::sqr::impl::calc_ref_to_bilinear</a></div><div class="ttdeci">KOKKOS_INLINE_FUNCTION void calc_ref_to_bilinear(const ConstVec3sT &amp;p, const Quad &amp;e, Real a, Real b, Real q[3])</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l00877">compose_slmm.cpp:877</a></div></div>
<div class="ttc" id="anamespacesiqk_1_1sqr_1_1impl_html_ab91b2a1a1a339e965efac255aac58f83"><div class="ttname"><a href="namespacesiqk_1_1sqr_1_1impl.html#ab91b2a1a1a339e965efac255aac58f83">siqk::sqr::impl::calc_T_row</a></div><div class="ttdeci">KOKKOS_INLINE_FUNCTION void calc_T_row(const ConstVec3sT &amp;p, const Quad &amp;e, const Int i, Real &amp;t1, Real &amp;t2, Real &amp;t3, Real &amp;t4)</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l00866">compose_slmm.cpp:866</a></div></div>
<div class="ttc" id="anamespacesiqk_1_1sqr_1_1impl_html_ac54967e129cebae1d0b0652fd27c3081"><div class="ttname"><a href="namespacesiqk_1_1sqr_1_1impl.html#ac54967e129cebae1d0b0652fd27c3081">siqk::sqr::impl::calc_residual</a></div><div class="ttdeci">KOKKOS_INLINE_FUNCTION void calc_residual(const ConstVec3sT &amp;p, const Quad &amp;e, const Real a, const Real b, const Real q[3], Real r[3])</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l00891">compose_slmm.cpp:891</a></div></div>
<div class="ttc" id="anamespacesiqk_1_1sqr_1_1test_html_a0c8752204330c8d761ae520a8e3fc220"><div class="ttname"><a href="namespacesiqk_1_1sqr_1_1test.html#a0c8752204330c8d761ae520a8e3fc220">siqk::sqr::test::test_sphere_to_ref</a></div><div class="ttdeci">Int test_sphere_to_ref(const ConstVec3s::HostMirror &amp;p, const ConstIdxs::HostMirror &amp;e)</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l01085">compose_slmm.cpp:1085</a></div></div>
<div class="ttc" id="anamespacesiqk_1_1sqr_html_a257faae633641a8c200b1213b5d81a1e"><div class="ttname"><a href="namespacesiqk_1_1sqr.html#a257faae633641a8c200b1213b5d81a1e">siqk::sqr::calc_sphere_to_ref</a></div><div class="ttdeci">KOKKOS_INLINE_FUNCTION void calc_sphere_to_ref(const ConstVec3sT &amp;p, const Quad &amp;e, const Real q[3], Real &amp;a, Real &amp;b, Info *const info=nullptr, const Int max_its=10, const Real tol=1e2 *std::numeric_limits&lt; Real &gt;::epsilon())</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l00976">compose_slmm.cpp:976</a></div></div>
<div class="ttc" id="anamespacesiqk_1_1sqr_html_a7472c75ffb07a32dc295a6a28f51fe96"><div class="ttname"><a href="namespacesiqk_1_1sqr.html#a7472c75ffb07a32dc295a6a28f51fe96">siqk::sqr::get_ref_vertices</a></div><div class="ttdeci">KOKKOS_INLINE_FUNCTION const Real * get_ref_vertices()</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l01013">compose_slmm.cpp:1013</a></div></div>
<div class="ttc" id="anamespacesiqk_1_1sqr_html_ae226341260ce9658bed3b60c48625886"><div class="ttname"><a href="namespacesiqk_1_1sqr.html#ae226341260ce9658bed3b60c48625886">siqk::sqr::calc_ref_to_sphere</a></div><div class="ttdeci">KOKKOS_INLINE_FUNCTION void calc_ref_to_sphere(const ConstVec3sT &amp;p, const Quad &amp;e, const Real a, const Real b, Real q[3])</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l00962">compose_slmm.cpp:962</a></div></div>
<div class="ttc" id="anamespacesiqk_1_1test_html_a75fe76653ae6f11ac4078ebf74da87e6"><div class="ttname"><a href="namespacesiqk_1_1test.html#a75fe76653ae6f11ac4078ebf74da87e6">siqk::test::fill_normals</a></div><div class="ttdeci">void fill_normals(sh::Mesh&lt; ko::HostSpace &gt; &amp;m)</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l00803">compose_slmm.cpp:803</a></div></div>
<div class="ttc" id="anamespacesiqk_html"><div class="ttname"><a href="namespacesiqk.html">siqk</a></div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l00034">compose_slmm.cpp:34</a></div></div>
<div class="ttc" id="anamespacesiqk_html_a04b40b29b12c447399a02e3c1575bf66"><div class="ttname"><a href="namespacesiqk.html#a04b40b29b12c447399a02e3c1575bf66">siqk::Int</a></div><div class="ttdeci">int Int</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l00077">compose_slmm.cpp:77</a></div></div>
<div class="ttc" id="anamespacesiqk_html_a05592daa8593f0bb255bf79d8a99a236"><div class="ttname"><a href="namespacesiqk.html#a05592daa8593f0bb255bf79d8a99a236">siqk::ConstIdxs</a></div><div class="ttdeci">ko::View&lt; const Int **, Layout &gt; ConstIdxs</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l00096">compose_slmm.cpp:96</a></div></div>
<div class="ttc" id="anamespacesiqk_html_a0cb103a46b9c7a9a03cb45e98c34ccc6"><div class="ttname"><a href="namespacesiqk.html#a0cb103a46b9c7a9a03cb45e98c34ccc6">siqk::Vec3s</a></div><div class="ttdeci">ko::View&lt; Real *[3], Layout &gt; Vec3s</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l00087">compose_slmm.cpp:87</a></div></div>
<div class="ttc" id="anamespacesiqk_html_a1c336be63fc7e99dd624e19821374c89"><div class="ttname"><a href="namespacesiqk.html#a1c336be63fc7e99dd624e19821374c89">siqk::ConstVec3s</a></div><div class="ttdeci">ko::View&lt; const Real *[3], Layout &gt; ConstVec3s</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l00088">compose_slmm.cpp:88</a></div></div>
<div class="ttc" id="anamespacesiqk_html_a2027be93ed31a13bb0fa99ad96f05236"><div class="ttname"><a href="namespacesiqk.html#a2027be93ed31a13bb0fa99ad96f05236">siqk::Vec6s</a></div><div class="ttdeci">ko::View&lt; Real *[6], Layout &gt; Vec6s</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l00089">compose_slmm.cpp:89</a></div></div>
<div class="ttc" id="anamespacesiqk_html_a3f1b5069fc1ac06e18aa603b592403e6"><div class="ttname"><a href="namespacesiqk.html#a3f1b5069fc1ac06e18aa603b592403e6">siqk::nslices</a></div><div class="ttdeci">KOKKOS_FORCEINLINE_FUNCTION Int nslices(const A2D &amp;a)</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l00143">compose_slmm.cpp:143</a></div></div>
<div class="ttc" id="anamespacesiqk_html_a40d665fdda062c3a8de4ea96650d0dff"><div class="ttname"><a href="namespacesiqk.html#a40d665fdda062c3a8de4ea96650d0dff">siqk::Idxs</a></div><div class="ttdeci">ko::View&lt; Int **, Layout &gt; Idxs</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l00095">compose_slmm.cpp:95</a></div></div>
<div class="ttc" id="anamespacesiqk_html_a55239018e386898ef9705ae765cd09a8"><div class="ttname"><a href="namespacesiqk.html#a55239018e386898ef9705ae765cd09a8">siqk::RawArray</a></div><div class="ttdeci">ko::View&lt; Real *, ko::LayoutRight, ko::MemoryTraits&lt; ko::Unmanaged &gt; &gt; RawArray</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l00093">compose_slmm.cpp:93</a></div></div>
<div class="ttc" id="anamespacesiqk_html_a61e7c4d0032d661a1c40535a5c9e329f"><div class="ttname"><a href="namespacesiqk.html#a61e7c4d0032d661a1c40535a5c9e329f">siqk::UnmanagedView</a></div><div class="ttdeci">ko::View&lt; typename ViewT::data_type, typename ViewT::array_layout, typename ViewT::device_type, ko::MemoryTraits&lt; ko::Unmanaged &gt; &gt; UnmanagedView</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l00103">compose_slmm.cpp:105</a></div></div>
<div class="ttc" id="anamespacesiqk_html_a6694847e2d56e697aa08277444325083"><div class="ttname"><a href="namespacesiqk.html#a6694847e2d56e697aa08277444325083">siqk::Real</a></div><div class="ttdeci">double Real</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l00078">compose_slmm.cpp:78</a></div></div>
<div class="ttc" id="anamespacesiqk_html_a69f02f046f299342da612da59b028644"><div class="ttname"><a href="namespacesiqk.html#a69f02f046f299342da612da59b028644">siqk::Layout</a></div><div class="ttdeci">ko::LayoutRight Layout</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l00083">compose_slmm.cpp:83</a></div></div>
<div class="ttc" id="anamespacesiqk_html_a6c43ff2c83ad6b7d0dc61c2c5e83a680"><div class="ttname"><a href="namespacesiqk.html#a6c43ff2c83ad6b7d0dc61c2c5e83a680">siqk::szslice</a></div><div class="ttdeci">KOKKOS_FORCEINLINE_FUNCTION Int szslice(const A2D &amp;a)</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l00147">compose_slmm.cpp:147</a></div></div>
<div class="ttc" id="anamespacesiqk_html_a6f525866efd388ad8b6b947226520628"><div class="ttname"><a href="namespacesiqk.html#a6f525866efd388ad8b6b947226520628">siqk::RawConstArray</a></div><div class="ttdeci">ko::View&lt; const Real *, ko::LayoutRight, ko::MemoryTraits&lt; ko::Unmanaged &gt; &gt; RawConstArray</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l00094">compose_slmm.cpp:94</a></div></div>
<div class="ttc" id="anamespacesiqk_html_a7276fa86dc33f28f66f7b76d5225f6f7"><div class="ttname"><a href="namespacesiqk.html#a7276fa86dc33f28f66f7b76d5225f6f7">siqk::ConstVec6s</a></div><div class="ttdeci">ko::View&lt; const Real *[6], Layout &gt; ConstVec6s</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l00090">compose_slmm.cpp:90</a></div></div>
<div class="ttc" id="anamespacesiqk_html_a8647704258165c25ff17cb2b546a1dae"><div class="ttname"><a href="namespacesiqk.html#a8647704258165c25ff17cb2b546a1dae">siqk::hm_resize_and_copy</a></div><div class="ttdeci">void hm_resize_and_copy(DV &amp;d, const SA &amp;s, const Int n)</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l00170">compose_slmm.cpp:170</a></div></div>
<div class="ttc" id="anamespacesiqk_html_a984fe7f0fc55d1f004981d9b6ffac4f7"><div class="ttname"><a href="namespacesiqk.html#a984fe7f0fc55d1f004981d9b6ffac4f7">siqk::max</a></div><div class="ttdeci">KOKKOS_INLINE_FUNCTION const T &amp; max(const T &amp;a, const T &amp;b)</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l00181">compose_slmm.cpp:181</a></div></div>
<div class="ttc" id="anamespacesiqk_html_a9943941928d901bed7442db5eaecbb46"><div class="ttname"><a href="namespacesiqk.html#a9943941928d901bed7442db5eaecbb46">siqk::swap</a></div><div class="ttdeci">KOKKOS_INLINE_FUNCTION void swap(T &amp;a, T &amp;b)</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l00183">compose_slmm.cpp:183</a></div></div>
<div class="ttc" id="anamespacesiqk_html_aa4d80b92cc4a0024c2a687c4ddeb6e7f"><div class="ttname"><a href="namespacesiqk.html#aa4d80b92cc4a0024c2a687c4ddeb6e7f">siqk::square</a></div><div class="ttdeci">constexpr KOKKOS_INLINE_FUNCTION T square(const T &amp;x)</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l00188">compose_slmm.cpp:188</a></div></div>
<div class="ttc" id="anamespacesiqk_html_aa8af675f4123cd3ef73b7d549fb84324"><div class="ttname"><a href="namespacesiqk.html#aa8af675f4123cd3ef73b7d549fb84324">siqk::min</a></div><div class="ttdeci">KOKKOS_INLINE_FUNCTION const T &amp; min(const T &amp;a, const T &amp;b)</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l00179">compose_slmm.cpp:179</a></div></div>
<div class="ttc" id="anamespacesiqk_html_aaa8c36644caf3da2c7cdcb701a3298c1"><div class="ttname"><a href="namespacesiqk.html#aaa8c36644caf3da2c7cdcb701a3298c1">siqk::const_slice</a></div><div class="ttdeci">KOKKOS_FORCEINLINE_FUNCTION VT::const_value_type * const_slice(const VT &amp;v, Int i)</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l00135">compose_slmm.cpp:135</a></div></div>
<div class="ttc" id="anamespacesiqk_html_ab14664dea7f479a9a4dd503e93f52152"><div class="ttname"><a href="namespacesiqk.html#ab14664dea7f479a9a4dd503e93f52152">siqk::Nodes</a></div><div class="ttdeci">ko::View&lt; Int *[8], Layout &gt; Nodes</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l00097">compose_slmm.cpp:97</a></div></div>
<div class="ttc" id="anamespacesiqk_html_ae334e4fa96b14e72d2fdb867d5838de8"><div class="ttname"><a href="namespacesiqk.html#ae334e4fa96b14e72d2fdb867d5838de8">siqk::ConstNodes</a></div><div class="ttdeci">ko::View&lt; const Int *[8], Layout &gt; ConstNodes</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l00098">compose_slmm.cpp:98</a></div></div>
<div class="ttc" id="anamespacesiqk_html_ae392f7b38ed1db8a53100783574ca586"><div class="ttname"><a href="namespacesiqk.html#ae392f7b38ed1db8a53100783574ca586">siqk::RawVec3s</a></div><div class="ttdeci">ko::View&lt; Real *[3], ko::LayoutRight, ko::MemoryTraits&lt; ko::Unmanaged &gt; &gt; RawVec3s</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l00091">compose_slmm.cpp:91</a></div></div>
<div class="ttc" id="anamespacesiqk_html_ae6ddc7d5c591da491b22457a56353479"><div class="ttname"><a href="namespacesiqk.html#ae6ddc7d5c591da491b22457a56353479">siqk::resize_and_copy</a></div><div class="ttdeci">void resize_and_copy(DV &amp;d, const SV &amp;s, typename std::enable_if&lt; DV::rank==1 &gt;::type *=0)</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l00156">compose_slmm.cpp:156</a></div></div>
<div class="ttc" id="anamespacesiqk_html_aee02aaa385cda31d0db2c0e750f24c08"><div class="ttname"><a href="namespacesiqk.html#aee02aaa385cda31d0db2c0e750f24c08">siqk::RawConstVec3s</a></div><div class="ttdeci">ko::View&lt; const Real *[3], ko::LayoutRight, ko::MemoryTraits&lt; ko::Unmanaged &gt; &gt; RawConstVec3s</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l00092">compose_slmm.cpp:92</a></div></div>
<div class="ttc" id="anamespacesiqk_html_aef983887889243999a1d7ddea864ad1f"><div class="ttname"><a href="namespacesiqk.html#aef983887889243999a1d7ddea864ad1f">siqk::slice</a></div><div class="ttdeci">KOKKOS_FORCEINLINE_FUNCTION VT::value_type * slice(const VT &amp;v, Int i)</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l00129">compose_slmm.cpp:129</a></div></div>
<div class="ttc" id="anamespacesiqk_html_af15b377ddde4f18068942a06030932be"><div class="ttname"><a href="namespacesiqk.html#af15b377ddde4f18068942a06030932be">siqk::sign</a></div><div class="ttdeci">KOKKOS_INLINE_FUNCTION T sign(const T &amp;a)</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l00191">compose_slmm.cpp:191</a></div></div>
<div class="ttc" id="anamespaceslmm_1_1nearest__point_html_a0ec75593ecf9631ec941a4f063a5d331"><div class="ttname"><a href="namespaceslmm_1_1nearest__point.html#a0ec75593ecf9631ec941a4f063a5d331">slmm::nearest_point::find_external_edges</a></div><div class="ttdeci">void find_external_edges(const Mesh &amp;m, std::vector&lt; Int &gt; &amp;external_edges)</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l01609">compose_slmm.cpp:1609</a></div></div>
<div class="ttc" id="anamespaceslmm_1_1nearest__point_html_a11b8bb5966e37004487b1867b4f761b5"><div class="ttname"><a href="namespaceslmm_1_1nearest__point.html#a11b8bb5966e37004487b1867b4f761b5">slmm::nearest_point::fill_perim</a></div><div class="ttdeci">void fill_perim(const Mesh &amp;m, MeshNearestPointData&lt; ko::HostSpace &gt; &amp;d)</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l01675">compose_slmm.cpp:1675</a></div></div>
<div class="ttc" id="anamespaceslmm_1_1nearest__point_html_a51823a25c8ab8941ce41bb0d8f659047"><div class="ttname"><a href="namespaceslmm_1_1nearest__point.html#a51823a25c8ab8941ce41bb0d8f659047">slmm::nearest_point::test_fill_perim</a></div><div class="ttdeci">Int test_fill_perim(const Mesh &amp;m, const Int &amp;tgt_ic, const MeshNearestPointData&lt; ko::HostSpace &gt; &amp;md)</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l01790">compose_slmm.cpp:1790</a></div></div>
<div class="ttc" id="anamespaceslmm_1_1nearest__point_html_a8df5028268da3dd050d3db963e11780d"><div class="ttname"><a href="namespaceslmm_1_1nearest__point.html#a8df5028268da3dd050d3db963e11780d">slmm::nearest_point::calc_dist</a></div><div class="ttdeci">Real calc_dist(const V3a &amp;p0, const V3b &amp;p1)</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l01599">compose_slmm.cpp:1599</a></div></div>
<div class="ttc" id="anamespaceslmm_1_1nearest__point_html_aa389a84fa6e8831d1ba347ec19219c0d"><div class="ttname"><a href="namespaceslmm_1_1nearest__point.html#aa389a84fa6e8831d1ba347ec19219c0d">slmm::nearest_point::Mesh</a></div><div class="ttdeci">siqk::sh::Mesh&lt; siqk::ko::HostSpace &gt; Mesh</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l01588">compose_slmm.cpp:1588</a></div></div>
<div class="ttc" id="anamespaceslmm_1_1nearest__point_html_ad4423d9ff23bfc563b52a5e68635de6e"><div class="ttname"><a href="namespaceslmm_1_1nearest__point.html#ad4423d9ff23bfc563b52a5e68635de6e">slmm::nearest_point::calc</a></div><div class="ttdeci">void calc(const Mesh &amp;m, const MeshNearestPointData&lt; ko::HostSpace &gt; &amp;d, Real *v)</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l01713">compose_slmm.cpp:1713</a></div></div>
<div class="ttc" id="anamespaceslmm_1_1nearest__point_html_ad8d54e9957242292b2386108848c9fb1"><div class="ttname"><a href="namespaceslmm_1_1nearest__point.html#ad8d54e9957242292b2386108848c9fb1">slmm::nearest_point::calc_approx_nearest_point_on_arc</a></div><div class="ttdeci">void calc_approx_nearest_point_on_arc(const V3 &amp;p0, const V3 &amp;p1, const V3 &amp;nml, const Real *point, Real *nearest)</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l01690">compose_slmm.cpp:1690</a></div></div>
<div class="ttc" id="anamespaceslmm_1_1nearest__point_html_ae5d25f37a8bc726da32ca0557f53115e"><div class="ttname"><a href="namespaceslmm_1_1nearest__point.html#ae5d25f37a8bc726da32ca0557f53115e">slmm::nearest_point::test_canpoa</a></div><div class="ttdeci">Int test_canpoa()</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l01743">compose_slmm.cpp:1743</a></div></div>
<div class="ttc" id="anamespaceslmm_1_1nearest__point_html_ae742c9deb75c67768851067d200f7441"><div class="ttname"><a href="namespaceslmm_1_1nearest__point.html#ae742c9deb75c67768851067d200f7441">slmm::nearest_point::test_calc</a></div><div class="ttdeci">Int test_calc(const Mesh &amp;m, const Int &amp;tgt_ic, const MeshNearestPointData&lt; ko::HostSpace &gt; &amp;md)</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l01765">compose_slmm.cpp:1765</a></div></div>
<div class="ttc" id="anamespaceslmm_html"><div class="ttname"><a href="namespaceslmm.html">slmm</a></div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l01155">compose_slmm.cpp:1155</a></div></div>
<div class="ttc" id="anamespaceslmm_html_a09c707719e4082afb80a56b15c2db8ac"><div class="ttname"><a href="namespaceslmm.html#a09c707719e4082afb80a56b15c2db8ac">slmm::get_src_cell</a></div><div class="ttdeci">int get_src_cell(const siqk::sh::Mesh&lt; siqk::ko::HostSpace &gt; &amp;m, const Real *v, const Int my_ic=-1)</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l01513">compose_slmm.cpp:1513</a></div></div>
<div class="ttc" id="anamespaceslmm_html_a2a193298c724f6fb329cfb2ba9785d88"><div class="ttname"><a href="namespaceslmm.html#a2a193298c724f6fb329cfb2ba9785d88">slmm::dpotrf</a></div><div class="ttdeci">int dpotrf(char uplo, int n, double *a, int lda)</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l01325">compose_slmm.cpp:1325</a></div></div>
<div class="ttc" id="anamespaceslmm_html_a3158888774efd0768378cbf65b50e923"><div class="ttname"><a href="namespaceslmm.html#a3158888774efd0768378cbf65b50e923">slmm::init_nearest_point_data</a></div><div class="ttdeci">void init_nearest_point_data(const nearest_point::Mesh &amp;m, MeshNearestPointData &amp;d)</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l01830">compose_slmm.cpp:1830</a></div></div>
<div class="ttc" id="anamespaceslmm_html_a3dd4be7f13cb04a0eb5d8e12138f308d"><div class="ttname"><a href="namespaceslmm.html#a3dd4be7f13cb04a0eb5d8e12138f308d">slmm::dpotrs</a></div><div class="ttdeci">int dpotrs(char uplo, int n, int nrhs, const double *a, int lda, double *bx, int ldb)</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l01331">compose_slmm.cpp:1331</a></div></div>
<div class="ttc" id="anamespaceslmm_html_a3df487e50f2e0c22abe225c73df0e4a4"><div class="ttname"><a href="namespaceslmm.html#a3df487e50f2e0c22abe225c73df0e4a4">slmm::is_inside</a></div><div class="ttdeci">bool is_inside(const siqk::sh::Mesh&lt; siqk::ko::HostSpace &gt; &amp;m, const Real *v, const Real &amp;atol, const Int &amp;ic)</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l01488">compose_slmm.cpp:1488</a></div></div>
<div class="ttc" id="anamespaceslmm_html_a410e5c4c97a57814b75c6a9b4583ced2"><div class="ttname"><a href="namespaceslmm.html#a410e5c4c97a57814b75c6a9b4583ced2">slmm::Ints</a></div><div class="ttdeci">Kokkos::View&lt; Int *, ko::HostSpace &gt; Ints</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l01880">compose_slmm.cpp:1880</a></div></div>
<div class="ttc" id="anamespaceslmm_html_a4d04f3d5ecdda3f8eab0b349aab35fe7"><div class="ttname"><a href="namespaceslmm.html#a4d04f3d5ecdda3f8eab0b349aab35fe7">slmm::Size</a></div><div class="ttdeci">Int Size</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l01158">compose_slmm.cpp:1158</a></div></div>
<div class="ttc" id="anamespaceslmm_html_a4d941cd95a177036a863d2f3387db705"><div class="ttname"><a href="namespaceslmm.html#a4d941cd95a177036a863d2f3387db705">slmm::gll_np4_eval</a></div><div class="ttdeci">void gll_np4_eval(const Real x, Real y[4])</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l01409">compose_slmm.cpp:1409</a></div></div>
<div class="ttc" id="anamespaceslmm_html_a6b2f7bea32d0ed791568dd376bc34122"><div class="ttname"><a href="namespaceslmm.html#a6b2f7bea32d0ed791568dd376bc34122">slmm::gll_np4_subgrid_eval</a></div><div class="ttdeci">void gll_np4_subgrid_eval(const Real &amp;x, Real y[4])</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l01419">compose_slmm.cpp:1419</a></div></div>
<div class="ttc" id="anamespaceslmm_html_a72e0b388216ade5a898974cd0ca27c01"><div class="ttname"><a href="namespaceslmm.html#a72e0b388216ade5a898974cd0ca27c01">slmm::copy_vertices</a></div><div class="ttdeci">void copy_vertices(const siqk::ConstVec3s::HostMirror &amp;p, const siqk::ConstIdxs::HostMirror &amp;c2n, const Int ci, Real *ps)</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l01338">compose_slmm.cpp:1338</a></div></div>
<div class="ttc" id="anamespaceslmm_html_a7a1095b904c8047101a58045c12f867c"><div class="ttname"><a href="namespaceslmm.html#a7a1095b904c8047101a58045c12f867c">slmm::unittest</a></div><div class="ttdeci">int unittest()</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l01400">compose_slmm.cpp:1400</a></div></div>
<div class="ttc" id="anamespaceslmm_html_aa3b5eab9cd0be884ffa31f0f38300fd4"><div class="ttname"><a href="namespaceslmm.html#aa3b5eab9cd0be884ffa31f0f38300fd4">slmm::get_nearest_point</a></div><div class="ttdeci">int get_nearest_point(const nearest_point::Mesh &amp;m, const MeshNearestPointData &amp;d, Real *v, const Int my_ic)</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l01835">compose_slmm.cpp:1835</a></div></div>
<div class="ttc" id="anamespaceslmm_html_aae47f57e3c25fdbca5ac4c99101905c0"><div class="ttname"><a href="namespaceslmm.html#aae47f57e3c25fdbca5ac4c99101905c0">slmm::len</a></div><div class="ttdeci">Int len(const V &amp;v)</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l01172">compose_slmm.cpp:1172</a></div></div>
<div class="ttc" id="anamespaceslmm_html_ab6e385dfff0e6b930f379fd12241e018"><div class="ttname"><a href="namespaceslmm.html#ab6e385dfff0e6b930f379fd12241e018">slmm::outer_eval</a></div><div class="ttdeci">void outer_eval(const Real &amp;x, Real v[4])</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l01443">compose_slmm.cpp:1443</a></div></div>
<div class="ttc" id="anamespaceslmm_html_abd0cae1accc71492fec5b3a5cfb40d09"><div class="ttname"><a href="namespaceslmm.html#abd0cae1accc71492fec5b3a5cfb40d09">slmm::to_string</a></div><div class="ttdeci">std::string to_string(const siqk::sh::Mesh&lt; siqk::ko::HostSpace &gt; &amp;m)</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l01554">compose_slmm.cpp:1554</a></div></div>
<div class="ttc" id="anamespaceslmm_html_abdee94ea2e7e6d3c8fbeca0ddc821f8d"><div class="ttname"><a href="namespaceslmm.html#abdee94ea2e7e6d3c8fbeca0ddc821f8d">slmm::gll_np4_subgrid_exp_eval</a></div><div class="ttdeci">void gll_np4_subgrid_exp_eval(const Real &amp;x, Real y[4])</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l01459">compose_slmm.cpp:1459</a></div></div>
<div class="ttc" id="anamespaceslmm_html_ac44161582202202a4c59397831ab8cc2"><div class="ttname"><a href="namespaceslmm.html#ac44161582202202a4c59397831ab8cc2">slmm::MeshNearestPointData</a></div><div class="ttdeci">nearest_point::MeshNearestPointData&lt; ko::HostSpace &gt; MeshNearestPointData</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l01828">compose_slmm.cpp:1828</a></div></div>
<div class="ttc" id="anamespacesupercell_html_ae57ef03dc0cb9828dbacc89aac8870c0"><div class="ttname"><a href="namespacesupercell.html#ae57ef03dc0cb9828dbacc89aac8870c0">supercell::x</a></div><div class="ttdeci">real(8), parameter x</div><div class="ttdef"><b>Definition:</b> <a href="dcmip2016-supercell_8_f90_source.html#l00084">dcmip2016-supercell.F90:84</a></div></div>
<div class="ttc" id="anamespacethread__mod_html_a3cfb271c6e26c035a846d90733d7b0db"><div class="ttname"><a href="namespacethread__mod.html#a3cfb271c6e26c035a846d90733d7b0db">thread_mod::omp_get_num_threads</a></div><div class="ttdeci">integer function, public omp_get_num_threads()</div><div class="ttdef"><b>Definition:</b> <a href="thread__mod_8_f90_source.html#l00039">thread_mod.F90:40</a></div></div>
<div class="ttc" id="anamespacethread__mod_html_a9a637164272859f06057a8224b5308d9"><div class="ttname"><a href="namespacethread__mod.html#a9a637164272859f06057a8224b5308d9">thread_mod::omp_get_thread_num</a></div><div class="ttdeci">integer function, public omp_get_thread_num()</div><div class="ttdef"><b>Definition:</b> <a href="thread__mod_8_f90_source.html#l00034">thread_mod.F90:35</a></div></div>
<div class="ttc" id="astruct_experiment_html"><div class="ttname"><a href="struct_experiment.html">Experiment</a></div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l04003">compose_slmm.cpp:4003</a></div></div>
<div class="ttc" id="astruct_experiment_html_a7c51a3ace4d0de0e22a51935b947a753"><div class="ttname"><a href="struct_experiment.html#a7c51a3ace4d0de0e22a51935b947a753">Experiment::sl_mpi</a></div><div class="ttdeci">int sl_mpi</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l04004">compose_slmm.cpp:4004</a></div></div>
<div class="ttc" id="astruct_experiment_html_afe14bc3019676171deda217152a021d9"><div class="ttname"><a href="struct_experiment.html#afe14bc3019676171deda217152a021d9">Experiment::halo</a></div><div class="ttdeci">int halo</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l04004">compose_slmm.cpp:4004</a></div></div>
<div class="ttc" id="astructhomme_1_1_cartesian3_d_html"><div class="ttname"><a href="structhomme_1_1_cartesian3_d.html">homme::Cartesian3D</a></div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02208">compose_slmm.cpp:2208</a></div></div>
<div class="ttc" id="astructhomme_1_1_cartesian3_d_html_a55b40736d06eed35782abd00d8543093"><div class="ttname"><a href="structhomme_1_1_cartesian3_d.html#a55b40736d06eed35782abd00d8543093">homme::Cartesian3D::y</a></div><div class="ttdeci">Real y</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02208">compose_slmm.cpp:2208</a></div></div>
<div class="ttc" id="astructhomme_1_1_cartesian3_d_html_a903d732a7aa6deb90742ec2f67fec8cf"><div class="ttname"><a href="structhomme_1_1_cartesian3_d.html#a903d732a7aa6deb90742ec2f67fec8cf">homme::Cartesian3D::z</a></div><div class="ttdeci">Real z</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02208">compose_slmm.cpp:2208</a></div></div>
<div class="ttc" id="astructhomme_1_1_cartesian3_d_html_ab1880bacfc3039e97d704cc5c1a32197"><div class="ttname"><a href="structhomme_1_1_cartesian3_d.html#ab1880bacfc3039e97d704cc5c1a32197">homme::Cartesian3D::x</a></div><div class="ttdeci">Real x</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02208">compose_slmm.cpp:2208</a></div></div>
<div class="ttc" id="astructhomme_1_1cslmpi_1_1_buffer_layout_array_1_1_buffer_rank_layout_array_html"><div class="ttname"><a href="structhomme_1_1cslmpi_1_1_buffer_layout_array_1_1_buffer_rank_layout_array.html">homme::cslmpi::BufferLayoutArray::BufferRankLayoutArray</a></div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02472">compose_slmm.cpp:2472</a></div></div>
<div class="ttc" id="astructhomme_1_1cslmpi_1_1_buffer_layout_array_1_1_buffer_rank_layout_array_html_ab49114fe74466f7001067d03fa16c358"><div class="ttname"><a href="structhomme_1_1cslmpi_1_1_buffer_layout_array_1_1_buffer_rank_layout_array.html#ab49114fe74466f7001067d03fa16c358">homme::cslmpi::BufferLayoutArray::BufferRankLayoutArray::operator()</a></div><div class="ttdeci">LayoutTriple &amp; operator()(const Int &amp;lidi, const Int &amp;lev)</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02473">compose_slmm.cpp:2473</a></div></div>
<div class="ttc" id="astructhomme_1_1cslmpi_1_1_buffer_layout_array_html"><div class="ttname"><a href="structhomme_1_1cslmpi_1_1_buffer_layout_array.html">homme::cslmpi::BufferLayoutArray</a></div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02471">compose_slmm.cpp:2471</a></div></div>
<div class="ttc" id="astructhomme_1_1cslmpi_1_1_buffer_layout_array_html_a43c8656052cf82986bff40b28177ec22"><div class="ttname"><a href="structhomme_1_1cslmpi_1_1_buffer_layout_array.html#a43c8656052cf82986bff40b28177ec22">homme::cslmpi::BufferLayoutArray::BufferLayoutArray</a></div><div class="ttdeci">BufferLayoutArray(const Int &amp;nrank, const Int *nlid_per_rank, const Int &amp;nlev)</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02491">compose_slmm.cpp:2491</a></div></div>
<div class="ttc" id="astructhomme_1_1cslmpi_1_1_buffer_layout_array_html_a4730e5d52892ddfac670ddd962966fa3"><div class="ttname"><a href="structhomme_1_1cslmpi_1_1_buffer_layout_array.html#a4730e5d52892ddfac670ddd962966fa3">homme::cslmpi::BufferLayoutArray::BufferLayoutArray</a></div><div class="ttdeci">BufferLayoutArray()</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02490">compose_slmm.cpp:2490</a></div></div>
<div class="ttc" id="astructhomme_1_1cslmpi_1_1_buffer_layout_array_html_a6762aeac900ca71b5857b0f441b5a66b"><div class="ttname"><a href="structhomme_1_1cslmpi_1_1_buffer_layout_array.html#a6762aeac900ca71b5857b0f441b5a66b">homme::cslmpi::BufferLayoutArray::init</a></div><div class="ttdeci">void init(const Int &amp;nrank, const Int *nlid_per_rank, const Int &amp;nlev)</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02493">compose_slmm.cpp:2493</a></div></div>
<div class="ttc" id="astructhomme_1_1cslmpi_1_1_buffer_layout_array_html_a7fc9a9e08333dbb6af828bc80c3496a7"><div class="ttname"><a href="structhomme_1_1cslmpi_1_1_buffer_layout_array.html#a7fc9a9e08333dbb6af828bc80c3496a7">homme::cslmpi::BufferLayoutArray::zero</a></div><div class="ttdeci">void zero()</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02504">compose_slmm.cpp:2504</a></div></div>
<div class="ttc" id="astructhomme_1_1cslmpi_1_1_buffer_layout_array_html_afaebb3e7c5eb7daa639dc892258961eb"><div class="ttname"><a href="structhomme_1_1cslmpi_1_1_buffer_layout_array.html#afaebb3e7c5eb7daa639dc892258961eb">homme::cslmpi::BufferLayoutArray::operator()</a></div><div class="ttdeci">LayoutTriple &amp; operator()(const Int &amp;ri, const Int &amp;lidi, const Int &amp;lev)</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02516">compose_slmm.cpp:2516</a></div></div>
<div class="ttc" id="astructhomme_1_1cslmpi_1_1_csl_mpi_1_1_elem_data_1_1_own_item_html"><div class="ttname"><a href="structhomme_1_1cslmpi_1_1_csl_mpi_1_1_elem_data_1_1_own_item.html">homme::cslmpi::CslMpi::ElemData::OwnItem</a></div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02574">compose_slmm.cpp:2574</a></div></div>
<div class="ttc" id="astructhomme_1_1cslmpi_1_1_csl_mpi_1_1_elem_data_1_1_own_item_html_a75a855f379c77e32265e027cdfb58873"><div class="ttname"><a href="structhomme_1_1cslmpi_1_1_csl_mpi_1_1_elem_data_1_1_own_item.html#a75a855f379c77e32265e027cdfb58873">homme::cslmpi::CslMpi::ElemData::OwnItem::k</a></div><div class="ttdeci">short k</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02576">compose_slmm.cpp:2576</a></div></div>
<div class="ttc" id="astructhomme_1_1cslmpi_1_1_csl_mpi_1_1_elem_data_1_1_own_item_html_aa5ff4f24cb98e87f4fa6b448de11be9c"><div class="ttname"><a href="structhomme_1_1cslmpi_1_1_csl_mpi_1_1_elem_data_1_1_own_item.html#aa5ff4f24cb98e87f4fa6b448de11be9c">homme::cslmpi::CslMpi::ElemData::OwnItem::lev</a></div><div class="ttdeci">short lev</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02575">compose_slmm.cpp:2575</a></div></div>
<div class="ttc" id="astructhomme_1_1cslmpi_1_1_csl_mpi_1_1_elem_data_1_1_remote_item_html"><div class="ttname"><a href="structhomme_1_1cslmpi_1_1_csl_mpi_1_1_elem_data_1_1_remote_item.html">homme::cslmpi::CslMpi::ElemData::RemoteItem</a></div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02578">compose_slmm.cpp:2578</a></div></div>
<div class="ttc" id="astructhomme_1_1cslmpi_1_1_csl_mpi_1_1_elem_data_1_1_remote_item_html_a1338cef88da416f09ba7b84b06a66413"><div class="ttname"><a href="structhomme_1_1cslmpi_1_1_csl_mpi_1_1_elem_data_1_1_remote_item.html#a1338cef88da416f09ba7b84b06a66413">homme::cslmpi::CslMpi::ElemData::RemoteItem::k</a></div><div class="ttdeci">short k</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02580">compose_slmm.cpp:2580</a></div></div>
<div class="ttc" id="astructhomme_1_1cslmpi_1_1_csl_mpi_1_1_elem_data_1_1_remote_item_html_abf74ecb6824adf51e6c2a946377ab0b3"><div class="ttname"><a href="structhomme_1_1cslmpi_1_1_csl_mpi_1_1_elem_data_1_1_remote_item.html#abf74ecb6824adf51e6c2a946377ab0b3">homme::cslmpi::CslMpi::ElemData::RemoteItem::lev</a></div><div class="ttdeci">short lev</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02580">compose_slmm.cpp:2580</a></div></div>
<div class="ttc" id="astructhomme_1_1cslmpi_1_1_csl_mpi_1_1_elem_data_1_1_remote_item_html_acfcf7975e82cc072c59165eca36d2b41"><div class="ttname"><a href="structhomme_1_1cslmpi_1_1_csl_mpi_1_1_elem_data_1_1_remote_item.html#acfcf7975e82cc072c59165eca36d2b41">homme::cslmpi::CslMpi::ElemData::RemoteItem::q_extrema_ptr</a></div><div class="ttdeci">Int q_extrema_ptr</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02579">compose_slmm.cpp:2579</a></div></div>
<div class="ttc" id="astructhomme_1_1cslmpi_1_1_csl_mpi_1_1_elem_data_1_1_remote_item_html_af1c437264df10182ffd9145ffab79dbe"><div class="ttname"><a href="structhomme_1_1cslmpi_1_1_csl_mpi_1_1_elem_data_1_1_remote_item.html#af1c437264df10182ffd9145ffab79dbe">homme::cslmpi::CslMpi::ElemData::RemoteItem::q_ptr</a></div><div class="ttdeci">Int q_ptr</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02579">compose_slmm.cpp:2579</a></div></div>
<div class="ttc" id="astructhomme_1_1cslmpi_1_1_csl_mpi_1_1_elem_data_html"><div class="ttname"><a href="structhomme_1_1cslmpi_1_1_csl_mpi_1_1_elem_data.html">homme::cslmpi::CslMpi::ElemData</a></div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02573">compose_slmm.cpp:2573</a></div></div>
<div class="ttc" id="astructhomme_1_1cslmpi_1_1_csl_mpi_1_1_elem_data_html_a2081c109afff870a5e1de0c87a0e56ca"><div class="ttname"><a href="structhomme_1_1cslmpi_1_1_csl_mpi_1_1_elem_data.html#a2081c109afff870a5e1de0c87a0e56ca">homme::cslmpi::CslMpi::ElemData::dp</a></div><div class="ttdeci">const Real * dp</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02589">compose_slmm.cpp:2589</a></div></div>
<div class="ttc" id="astructhomme_1_1cslmpi_1_1_csl_mpi_1_1_elem_data_html_a20d179528b738eafd6fc0683446f27b2"><div class="ttname"><a href="structhomme_1_1cslmpi_1_1_csl_mpi_1_1_elem_data.html#a20d179528b738eafd6fc0683446f27b2">homme::cslmpi::CslMpi::ElemData::me</a></div><div class="ttdeci">GidRank * me</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02582">compose_slmm.cpp:2582</a></div></div>
<div class="ttc" id="astructhomme_1_1cslmpi_1_1_csl_mpi_1_1_elem_data_html_a5b2832d644f5d6ccde1d72e5bb851a09"><div class="ttname"><a href="structhomme_1_1cslmpi_1_1_csl_mpi_1_1_elem_data.html#a5b2832d644f5d6ccde1d72e5bb851a09">homme::cslmpi::CslMpi::ElemData::metdet</a></div><div class="ttdeci">const Real * metdet</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02589">compose_slmm.cpp:2589</a></div></div>
<div class="ttc" id="astructhomme_1_1cslmpi_1_1_csl_mpi_1_1_elem_data_html_a64dd85494d0cabdfb6705b4a8c6ddbd3"><div class="ttname"><a href="structhomme_1_1cslmpi_1_1_csl_mpi_1_1_elem_data.html#a64dd85494d0cabdfb6705b4a8c6ddbd3">homme::cslmpi::CslMpi::ElemData::own</a></div><div class="ttdeci">FixedCapList&lt; OwnItem &gt; own</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02585">compose_slmm.cpp:2585</a></div></div>
<div class="ttc" id="astructhomme_1_1cslmpi_1_1_csl_mpi_1_1_elem_data_html_a7a59ae6edeb20124677aca3f8f384fae"><div class="ttname"><a href="structhomme_1_1cslmpi_1_1_csl_mpi_1_1_elem_data.html#a7a59ae6edeb20124677aca3f8f384fae">homme::cslmpi::CslMpi::ElemData::rmt</a></div><div class="ttdeci">FixedCapList&lt; RemoteItem &gt; rmt</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02586">compose_slmm.cpp:2586</a></div></div>
<div class="ttc" id="astructhomme_1_1cslmpi_1_1_csl_mpi_1_1_elem_data_html_a7c7572e59e980d4715e863294ccb03a9"><div class="ttname"><a href="structhomme_1_1cslmpi_1_1_csl_mpi_1_1_elem_data.html#a7c7572e59e980d4715e863294ccb03a9">homme::cslmpi::CslMpi::ElemData::q</a></div><div class="ttdeci">Real * q</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02590">compose_slmm.cpp:2590</a></div></div>
<div class="ttc" id="astructhomme_1_1cslmpi_1_1_csl_mpi_1_1_elem_data_html_a904bb892891e8f54b27eb762d3d549df"><div class="ttname"><a href="structhomme_1_1cslmpi_1_1_csl_mpi_1_1_elem_data.html#a904bb892891e8f54b27eb762d3d549df">homme::cslmpi::CslMpi::ElemData::qdp</a></div><div class="ttdeci">const Real * qdp</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02589">compose_slmm.cpp:2589</a></div></div>
<div class="ttc" id="astructhomme_1_1cslmpi_1_1_csl_mpi_1_1_elem_data_html_a9807a79ddca5b60f8731f0a2dacb8f4d"><div class="ttname"><a href="structhomme_1_1cslmpi_1_1_csl_mpi_1_1_elem_data.html#a9807a79ddca5b60f8731f0a2dacb8f4d">homme::cslmpi::CslMpi::ElemData::nin1halo</a></div><div class="ttdeci">Int nin1halo</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02584">compose_slmm.cpp:2584</a></div></div>
<div class="ttc" id="astructhomme_1_1cslmpi_1_1_csl_mpi_1_1_elem_data_html_a9aaeebb9910c867d80abb4f688502e5e"><div class="ttname"><a href="structhomme_1_1cslmpi_1_1_csl_mpi_1_1_elem_data.html#a9aaeebb9910c867d80abb4f688502e5e">homme::cslmpi::CslMpi::ElemData::q_extrema</a></div><div class="ttdeci">Array&lt; Real **[2]&gt; q_extrema</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02588">compose_slmm.cpp:2588</a></div></div>
<div class="ttc" id="astructhomme_1_1cslmpi_1_1_csl_mpi_1_1_elem_data_html_ad59be946e2883f78cebc3baeb79f0e85"><div class="ttname"><a href="structhomme_1_1cslmpi_1_1_csl_mpi_1_1_elem_data.html#ad59be946e2883f78cebc3baeb79f0e85">homme::cslmpi::CslMpi::ElemData::nbrs</a></div><div class="ttdeci">FixedCapList&lt; GidRank &gt; nbrs</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02583">compose_slmm.cpp:2583</a></div></div>
<div class="ttc" id="astructhomme_1_1cslmpi_1_1_csl_mpi_1_1_elem_data_html_af4aea612eaa763d5204a7b0ea8efff51"><div class="ttname"><a href="structhomme_1_1cslmpi_1_1_csl_mpi_1_1_elem_data.html#af4aea612eaa763d5204a7b0ea8efff51">homme::cslmpi::CslMpi::ElemData::src</a></div><div class="ttdeci">IntArray2D src</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02587">compose_slmm.cpp:2587</a></div></div>
<div class="ttc" id="astructhomme_1_1cslmpi_1_1_csl_mpi_1_1_gid_rank_html"><div class="ttname"><a href="structhomme_1_1cslmpi_1_1_csl_mpi_1_1_gid_rank.html">homme::cslmpi::CslMpi::GidRank</a></div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02563">compose_slmm.cpp:2563</a></div></div>
<div class="ttc" id="astructhomme_1_1cslmpi_1_1_csl_mpi_1_1_gid_rank_html_a1b6f790aeee2b1fafd4d681e5b5752b6"><div class="ttname"><a href="structhomme_1_1cslmpi_1_1_csl_mpi_1_1_gid_rank.html#a1b6f790aeee2b1fafd4d681e5b5752b6">homme::cslmpi::CslMpi::GidRank::lid_on_rank_idx</a></div><div class="ttdeci">Int lid_on_rank_idx</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02569">compose_slmm.cpp:2569</a></div></div>
<div class="ttc" id="astructhomme_1_1cslmpi_1_1_csl_mpi_1_1_gid_rank_html_a392cfaad3f848b837a3d493a916f5e60"><div class="ttname"><a href="structhomme_1_1cslmpi_1_1_csl_mpi_1_1_gid_rank.html#a392cfaad3f848b837a3d493a916f5e60">homme::cslmpi::CslMpi::GidRank::gid</a></div><div class="ttdeci">Int gid</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02565">compose_slmm.cpp:2565</a></div></div>
<div class="ttc" id="astructhomme_1_1cslmpi_1_1_csl_mpi_1_1_gid_rank_html_a492c556544992da097413532ff4c1b43"><div class="ttname"><a href="structhomme_1_1cslmpi_1_1_csl_mpi_1_1_gid_rank.html#a492c556544992da097413532ff4c1b43">homme::cslmpi::CslMpi::GidRank::lid_on_rank</a></div><div class="ttdeci">Int lid_on_rank</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02568">compose_slmm.cpp:2568</a></div></div>
<div class="ttc" id="astructhomme_1_1cslmpi_1_1_csl_mpi_1_1_gid_rank_html_ac1123a52efe3ae6ff2a5f3103a2ffc32"><div class="ttname"><a href="structhomme_1_1cslmpi_1_1_csl_mpi_1_1_gid_rank.html#ac1123a52efe3ae6ff2a5f3103a2ffc32">homme::cslmpi::CslMpi::GidRank::rank_idx</a></div><div class="ttdeci">Int rank_idx</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02567">compose_slmm.cpp:2567</a></div></div>
<div class="ttc" id="astructhomme_1_1cslmpi_1_1_csl_mpi_1_1_gid_rank_html_ac8cdce149a7dc8cc18aaa3336a0eef5e"><div class="ttname"><a href="structhomme_1_1cslmpi_1_1_csl_mpi_1_1_gid_rank.html#ac8cdce149a7dc8cc18aaa3336a0eef5e">homme::cslmpi::CslMpi::GidRank::rank</a></div><div class="ttdeci">Int rank</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02566">compose_slmm.cpp:2566</a></div></div>
<div class="ttc" id="astructhomme_1_1cslmpi_1_1_csl_mpi_html"><div class="ttname"><a href="structhomme_1_1cslmpi_1_1_csl_mpi.html">homme::cslmpi::CslMpi</a></div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02556">compose_slmm.cpp:2556</a></div></div>
<div class="ttc" id="astructhomme_1_1cslmpi_1_1_csl_mpi_html_a04bec07079fb55ceea64db025fa69c9c"><div class="ttname"><a href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a04bec07079fb55ceea64db025fa69c9c">homme::cslmpi::CslMpi::x_bulkdata_offset</a></div><div class="ttdeci">FixedCapList&lt; Int &gt; x_bulkdata_offset</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02608">compose_slmm.cpp:2608</a></div></div>
<div class="ttc" id="astructhomme_1_1cslmpi_1_1_csl_mpi_html_a09395c121510c776158739ce6fba7c31"><div class="ttname"><a href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a09395c121510c776158739ce6fba7c31">homme::cslmpi::CslMpi::p</a></div><div class="ttdeci">const mpi::Parallel::Ptr p</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02593">compose_slmm.cpp:2593</a></div></div>
<div class="ttc" id="astructhomme_1_1cslmpi_1_1_csl_mpi_html_a0eacf20e4f92f3748c742f8360c1e760"><div class="ttname"><a href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a0eacf20e4f92f3748c742f8360c1e760">homme::cslmpi::CslMpi::nrmt_xs</a></div><div class="ttdeci">Int nrmt_xs</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02609">compose_slmm.cpp:2609</a></div></div>
<div class="ttc" id="astructhomme_1_1cslmpi_1_1_csl_mpi_html_a139aec4ef20fe08ceb0d29fa65f10941"><div class="ttname"><a href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a139aec4ef20fe08ceb0d29fa65f10941">homme::cslmpi::CslMpi::Array</a></div><div class="ttdeci">ko::View&lt; Datatype, ko::LayoutRight, ko::HostSpace &gt; Array</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02560">compose_slmm.cpp:2560</a></div></div>
<div class="ttc" id="astructhomme_1_1cslmpi_1_1_csl_mpi_html_a255bf16730546cd00b75a932b8569670"><div class="ttname"><a href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a255bf16730546cd00b75a932b8569670">homme::cslmpi::CslMpi::horiz_openmp</a></div><div class="ttdeci">bool horiz_openmp</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02611">compose_slmm.cpp:2611</a></div></div>
<div class="ttc" id="astructhomme_1_1cslmpi_1_1_csl_mpi_html_a27a93b756e637dd27f8383706bf6fa63"><div class="ttname"><a href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a27a93b756e637dd27f8383706bf6fa63">homme::cslmpi::CslMpi::halo</a></div><div class="ttdeci">const Int halo</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02595">compose_slmm.cpp:2595</a></div></div>
<div class="ttc" id="astructhomme_1_1cslmpi_1_1_csl_mpi_html_a2bc103fcf1b1213dec73c720334e80a4"><div class="ttname"><a href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a2bc103fcf1b1213dec73c720334e80a4">homme::cslmpi::CslMpi::lid_on_rank</a></div><div class="ttdeci">ListOfLists&lt; Int &gt; lid_on_rank</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02601">compose_slmm.cpp:2601</a></div></div>
<div class="ttc" id="astructhomme_1_1cslmpi_1_1_csl_mpi_html_a3386735d284e9924db14acad99319d25"><div class="ttname"><a href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a3386735d284e9924db14acad99319d25">homme::cslmpi::CslMpi::nlev</a></div><div class="ttdeci">const Int nlev</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02595">compose_slmm.cpp:2595</a></div></div>
<div class="ttc" id="astructhomme_1_1cslmpi_1_1_csl_mpi_html_a370d8de04a4cc9d9e64cf4a3d3b28f94"><div class="ttname"><a href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a370d8de04a4cc9d9e64cf4a3d3b28f94">homme::cslmpi::CslMpi::rmt_xs</a></div><div class="ttdeci">FixedCapList&lt; Int &gt; rmt_xs</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02608">compose_slmm.cpp:2608</a></div></div>
<div class="ttc" id="astructhomme_1_1cslmpi_1_1_csl_mpi_html_a3d22abacf7bd37f0897d406f7566eb3f"><div class="ttname"><a href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a3d22abacf7bd37f0897d406f7566eb3f">homme::cslmpi::CslMpi::qsize</a></div><div class="ttdeci">const Int qsize</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02595">compose_slmm.cpp:2595</a></div></div>
<div class="ttc" id="astructhomme_1_1cslmpi_1_1_csl_mpi_html_a3de780cac76d3359bd90a33c189ea622"><div class="ttname"><a href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a3de780cac76d3359bd90a33c189ea622">homme::cslmpi::CslMpi::sendreq</a></div><div class="ttdeci">FixedCapList&lt; mpi::Request &gt; sendreq</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02607">compose_slmm.cpp:2607</a></div></div>
<div class="ttc" id="astructhomme_1_1cslmpi_1_1_csl_mpi_html_a3f7d02fbb1bf0589c931e6526802c266"><div class="ttname"><a href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a3f7d02fbb1bf0589c931e6526802c266">homme::cslmpi::CslMpi::mylid_with_comm</a></div><div class="ttdeci">FixedCapList&lt; Int &gt; mylid_with_comm</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02600">compose_slmm.cpp:2600</a></div></div>
<div class="ttc" id="astructhomme_1_1cslmpi_1_1_csl_mpi_html_a4c8e08ae7a21ce60733abff37c9c5058"><div class="ttname"><a href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a4c8e08ae7a21ce60733abff37c9c5058">homme::cslmpi::CslMpi::ed</a></div><div class="ttdeci">FixedCapList&lt; ElemData &gt; ed</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02597">compose_slmm.cpp:2597</a></div></div>
<div class="ttc" id="astructhomme_1_1cslmpi_1_1_csl_mpi_html_a4d4cef47264cc7acfc7545cd1be4196e"><div class="ttname"><a href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a4d4cef47264cc7acfc7545cd1be4196e">homme::cslmpi::CslMpi::CslMpi</a></div><div class="ttdeci">CslMpi(const mpi::Parallel::Ptr &amp;ip, const slmm::Advecter::ConstPtr &amp;advecter, Int inp, Int inlev, Int iqsize, Int iqsized, Int inelemd, Int ihalo)</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02620">compose_slmm.cpp:2620</a></div></div>
<div class="ttc" id="astructhomme_1_1cslmpi_1_1_csl_mpi_html_a5402ced381c42ff2808665611c4cc0e0"><div class="ttname"><a href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a5402ced381c42ff2808665611c4cc0e0">homme::cslmpi::CslMpi::ranks</a></div><div class="ttdeci">FixedCapList&lt; Int &gt; ranks</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02600">compose_slmm.cpp:2600</a></div></div>
<div class="ttc" id="astructhomme_1_1cslmpi_1_1_csl_mpi_html_a5ada77f6e71e2258d711ea2037ad7f47"><div class="ttname"><a href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a5ada77f6e71e2258d711ea2037ad7f47">homme::cslmpi::CslMpi::rwork</a></div><div class="ttdeci">Array&lt; Real ** &gt; rwork</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02618">compose_slmm.cpp:2618</a></div></div>
<div class="ttc" id="astructhomme_1_1cslmpi_1_1_csl_mpi_html_a5ed9e9c46d8d446b474544a70bb45622"><div class="ttname"><a href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a5ed9e9c46d8d446b474544a70bb45622">homme::cslmpi::CslMpi::nrmt_qs_extrema</a></div><div class="ttdeci">Int nrmt_qs_extrema</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02609">compose_slmm.cpp:2609</a></div></div>
<div class="ttc" id="astructhomme_1_1cslmpi_1_1_csl_mpi_html_a610b60e516b4b287caae09bf8834f233"><div class="ttname"><a href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a610b60e516b4b287caae09bf8834f233">homme::cslmpi::CslMpi::recvreq</a></div><div class="ttdeci">FixedCapList&lt; mpi::Request &gt; recvreq</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02607">compose_slmm.cpp:2607</a></div></div>
<div class="ttc" id="astructhomme_1_1cslmpi_1_1_csl_mpi_html_a71baac5c6f1ea673cd37504dd38b7630"><div class="ttname"><a href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a71baac5c6f1ea673cd37504dd38b7630">homme::cslmpi::CslMpi::qsized</a></div><div class="ttdeci">const Int qsized</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02595">compose_slmm.cpp:2595</a></div></div>
<div class="ttc" id="astructhomme_1_1cslmpi_1_1_csl_mpi_html_a8d3ead06518816f0985a84be689b0b85"><div class="ttname"><a href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a8d3ead06518816f0985a84be689b0b85">homme::cslmpi::CslMpi::nelemd</a></div><div class="ttdeci">const Int nelemd</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02595">compose_slmm.cpp:2595</a></div></div>
<div class="ttc" id="astructhomme_1_1cslmpi_1_1_csl_mpi_html_a9f7fc421d09c34cbcf8f2d2a45b6b0dd"><div class="ttname"><a href="structhomme_1_1cslmpi_1_1_csl_mpi.html#a9f7fc421d09c34cbcf8f2d2a45b6b0dd">homme::cslmpi::CslMpi::recvsz</a></div><div class="ttdeci">std::vector&lt; Int &gt; recvsz</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02617">compose_slmm.cpp:2617</a></div></div>
<div class="ttc" id="astructhomme_1_1cslmpi_1_1_csl_mpi_html_aa9071b0582a3ac177ced0dc521e124ad"><div class="ttname"><a href="structhomme_1_1cslmpi_1_1_csl_mpi.html#aa9071b0582a3ac177ced0dc521e124ad">homme::cslmpi::CslMpi::nx_in_lid</a></div><div class="ttdeci">ListOfLists&lt; Int &gt; nx_in_lid</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02601">compose_slmm.cpp:2601</a></div></div>
<div class="ttc" id="astructhomme_1_1cslmpi_1_1_csl_mpi_html_aac097e860798e529cbc07ea2e643d266"><div class="ttname"><a href="structhomme_1_1cslmpi_1_1_csl_mpi.html#aac097e860798e529cbc07ea2e643d266">homme::cslmpi::CslMpi::mylid_with_comm_tid_ptr</a></div><div class="ttdeci">FixedCapList&lt; Int &gt; mylid_with_comm_tid_ptr</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02600">compose_slmm.cpp:2600</a></div></div>
<div class="ttc" id="astructhomme_1_1cslmpi_1_1_csl_mpi_html_ab10638ab6b28d2d99faf5835ce842a5d"><div class="ttname"><a href="structhomme_1_1cslmpi_1_1_csl_mpi.html#ab10638ab6b28d2d99faf5835ce842a5d">homme::cslmpi::CslMpi::advecter</a></div><div class="ttdeci">const slmm::Advecter::ConstPtr advecter</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02594">compose_slmm.cpp:2594</a></div></div>
<div class="ttc" id="astructhomme_1_1cslmpi_1_1_csl_mpi_html_ab52f53a78f20b5ff0d0ad14439eb3bec"><div class="ttname"><a href="structhomme_1_1cslmpi_1_1_csl_mpi.html#ab52f53a78f20b5ff0d0ad14439eb3bec">homme::cslmpi::CslMpi::sendcount</a></div><div class="ttdeci">FixedCapList&lt; Int &gt; sendcount</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02606">compose_slmm.cpp:2606</a></div></div>
<div class="ttc" id="astructhomme_1_1cslmpi_1_1_csl_mpi_html_aba38cec734c8bce04f9b6af93c3788e2"><div class="ttname"><a href="structhomme_1_1cslmpi_1_1_csl_mpi.html#aba38cec734c8bce04f9b6af93c3788e2">homme::cslmpi::CslMpi::~CslMpi</a></div><div class="ttdeci">~CslMpi()</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02627">compose_slmm.cpp:2627</a></div></div>
<div class="ttc" id="astructhomme_1_1cslmpi_1_1_csl_mpi_html_abdef54045d56d191f36b9fdaf8707f67"><div class="ttname"><a href="structhomme_1_1cslmpi_1_1_csl_mpi.html#abdef54045d56d191f36b9fdaf8707f67">homme::cslmpi::CslMpi::sendsz</a></div><div class="ttdeci">std::vector&lt; Int &gt; sendsz</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02617">compose_slmm.cpp:2617</a></div></div>
<div class="ttc" id="astructhomme_1_1cslmpi_1_1_csl_mpi_html_ac64568d9b4b802315f2228beccaaac70"><div class="ttname"><a href="structhomme_1_1cslmpi_1_1_csl_mpi.html#ac64568d9b4b802315f2228beccaaac70">homme::cslmpi::CslMpi::np2</a></div><div class="ttdeci">const Int np2</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02595">compose_slmm.cpp:2595</a></div></div>
<div class="ttc" id="astructhomme_1_1cslmpi_1_1_csl_mpi_html_ac8fa1afe06db413e6dfb8bcd37dec1a7"><div class="ttname"><a href="structhomme_1_1cslmpi_1_1_csl_mpi.html#ac8fa1afe06db413e6dfb8bcd37dec1a7">homme::cslmpi::CslMpi::bla</a></div><div class="ttdeci">BufferLayoutArray bla</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02602">compose_slmm.cpp:2602</a></div></div>
<div class="ttc" id="astructhomme_1_1cslmpi_1_1_csl_mpi_html_acc05bcbacc077773d31a44fb2900d9f7"><div class="ttname"><a href="structhomme_1_1cslmpi_1_1_csl_mpi.html#acc05bcbacc077773d31a44fb2900d9f7">homme::cslmpi::CslMpi::nx_in_rank</a></div><div class="ttdeci">FixedCapList&lt; Int &gt; nx_in_rank</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02600">compose_slmm.cpp:2600</a></div></div>
<div class="ttc" id="astructhomme_1_1cslmpi_1_1_csl_mpi_html_ad93c0e96ca487335f1ed7c474e7e5fd7"><div class="ttname"><a href="structhomme_1_1cslmpi_1_1_csl_mpi.html#ad93c0e96ca487335f1ed7c474e7e5fd7">homme::cslmpi::CslMpi::IntArray2D</a></div><div class="ttdeci">Array&lt; Int ** &gt; IntArray2D</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02561">compose_slmm.cpp:2561</a></div></div>
<div class="ttc" id="astructhomme_1_1cslmpi_1_1_csl_mpi_html_adaffbb9ca8a843233389aa2c8b8c5826"><div class="ttname"><a href="structhomme_1_1cslmpi_1_1_csl_mpi.html#adaffbb9ca8a843233389aa2c8b8c5826">homme::cslmpi::CslMpi::sendbuf</a></div><div class="ttdeci">ListOfLists&lt; Real &gt; sendbuf</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02605">compose_slmm.cpp:2605</a></div></div>
<div class="ttc" id="astructhomme_1_1cslmpi_1_1_csl_mpi_html_ae05655fc7966bb7cb695bc3933bc212d"><div class="ttname"><a href="structhomme_1_1cslmpi_1_1_csl_mpi.html#ae05655fc7966bb7cb695bc3933bc212d">homme::cslmpi::CslMpi::Ptr</a></div><div class="ttdeci">std::shared_ptr&lt; CslMpi &gt; Ptr</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02557">compose_slmm.cpp:2557</a></div></div>
<div class="ttc" id="astructhomme_1_1cslmpi_1_1_csl_mpi_html_ae61b8439c5232dc4cdcd885d6a6510c2"><div class="ttname"><a href="structhomme_1_1cslmpi_1_1_csl_mpi.html#ae61b8439c5232dc4cdcd885d6a6510c2">homme::cslmpi::CslMpi::np</a></div><div class="ttdeci">const Int np</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02595">compose_slmm.cpp:2595</a></div></div>
<div class="ttc" id="astructhomme_1_1cslmpi_1_1_csl_mpi_html_ae6362eba877446b15f51dc5d6d4ed37e"><div class="ttname"><a href="structhomme_1_1cslmpi_1_1_csl_mpi.html#ae6362eba877446b15f51dc5d6d4ed37e">homme::cslmpi::CslMpi::nlid_per_rank</a></div><div class="ttdeci">std::vector&lt; Int &gt; nlid_per_rank</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02617">compose_slmm.cpp:2617</a></div></div>
<div class="ttc" id="astructhomme_1_1cslmpi_1_1_csl_mpi_html_ae80c9ada751aa4e59974d6277c56952b"><div class="ttname"><a href="structhomme_1_1cslmpi_1_1_csl_mpi.html#ae80c9ada751aa4e59974d6277c56952b">homme::cslmpi::CslMpi::rmt_qs_extrema</a></div><div class="ttdeci">FixedCapList&lt; Int &gt; rmt_qs_extrema</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02608">compose_slmm.cpp:2608</a></div></div>
<div class="ttc" id="astructhomme_1_1cslmpi_1_1_csl_mpi_html_ae992f1c83abeae202aa8bbf4010b26bc"><div class="ttname"><a href="structhomme_1_1cslmpi_1_1_csl_mpi.html#ae992f1c83abeae202aa8bbf4010b26bc">homme::cslmpi::CslMpi::recvbuf</a></div><div class="ttdeci">ListOfLists&lt; Real &gt; recvbuf</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02605">compose_slmm.cpp:2605</a></div></div>
<div class="ttc" id="astructhomme_1_1cslmpi_1_1_fixed_cap_list_html"><div class="ttname"><a href="structhomme_1_1cslmpi_1_1_fixed_cap_list.html">homme::cslmpi::FixedCapList</a></div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02362">compose_slmm.cpp:2362</a></div></div>
<div class="ttc" id="astructhomme_1_1cslmpi_1_1_fixed_cap_list_html_a1cecc082c0d47805347a17f78fd78bb6"><div class="ttname"><a href="structhomme_1_1cslmpi_1_1_fixed_cap_list.html#a1cecc082c0d47805347a17f78fd78bb6">homme::cslmpi::FixedCapList::end</a></div><div class="ttdeci">const T * end() const</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02386">compose_slmm.cpp:2386</a></div></div>
<div class="ttc" id="astructhomme_1_1cslmpi_1_1_fixed_cap_list_html_a201b2c44da196bccf882911274c227c7"><div class="ttname"><a href="structhomme_1_1cslmpi_1_1_fixed_cap_list.html#a201b2c44da196bccf882911274c227c7">homme::cslmpi::FixedCapList::operator()</a></div><div class="ttdeci">const T &amp; operator()(const Int &amp;i) const</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02375">compose_slmm.cpp:2375</a></div></div>
<div class="ttc" id="astructhomme_1_1cslmpi_1_1_fixed_cap_list_html_a3e9b033769f333ba49055706c62961e8"><div class="ttname"><a href="structhomme_1_1cslmpi_1_1_fixed_cap_list.html#a3e9b033769f333ba49055706c62961e8">homme::cslmpi::FixedCapList::reset_capacity</a></div><div class="ttdeci">void reset_capacity(const Int &amp;cap, const bool also_size=false)</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02365">compose_slmm.cpp:2365</a></div></div>
<div class="ttc" id="astructhomme_1_1cslmpi_1_1_fixed_cap_list_html_a51d614326a8de7c16f9e667a6a643fc0"><div class="ttname"><a href="structhomme_1_1cslmpi_1_1_fixed_cap_list.html#a51d614326a8de7c16f9e667a6a643fc0">homme::cslmpi::FixedCapList::begin</a></div><div class="ttdeci">T * begin()</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02385">compose_slmm.cpp:2385</a></div></div>
<div class="ttc" id="astructhomme_1_1cslmpi_1_1_fixed_cap_list_html_a568d836fc566d263a5aa12a807d47e75"><div class="ttname"><a href="structhomme_1_1cslmpi_1_1_fixed_cap_list.html#a568d836fc566d263a5aa12a807d47e75">homme::cslmpi::FixedCapList::capacity</a></div><div class="ttdeci">Int capacity() const</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02374">compose_slmm.cpp:2374</a></div></div>
<div class="ttc" id="astructhomme_1_1cslmpi_1_1_fixed_cap_list_html_a697b98514512be0e0d821406216216c4"><div class="ttname"><a href="structhomme_1_1cslmpi_1_1_fixed_cap_list.html#a697b98514512be0e0d821406216216c4">homme::cslmpi::FixedCapList::data</a></div><div class="ttdeci">const T * data() const</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02380">compose_slmm.cpp:2380</a></div></div>
<div class="ttc" id="astructhomme_1_1cslmpi_1_1_fixed_cap_list_html_a95eda4a044bcc685a22740df5611ba3e"><div class="ttname"><a href="structhomme_1_1cslmpi_1_1_fixed_cap_list.html#a95eda4a044bcc685a22740df5611ba3e">homme::cslmpi::FixedCapList::back</a></div><div class="ttdeci">T &amp; back()</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02383">compose_slmm.cpp:2383</a></div></div>
<div class="ttc" id="astructhomme_1_1cslmpi_1_1_fixed_cap_list_html_aa5648aaf20e3e28707f797288ab945f1"><div class="ttname"><a href="structhomme_1_1cslmpi_1_1_fixed_cap_list.html#aa5648aaf20e3e28707f797288ab945f1">homme::cslmpi::FixedCapList::inc</a></div><div class="ttdeci">void inc(const Int &amp;dn)</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02378">compose_slmm.cpp:2378</a></div></div>
<div class="ttc" id="astructhomme_1_1cslmpi_1_1_fixed_cap_list_html_aad4f28cbbbe5499b8e1a60e8d984aa18"><div class="ttname"><a href="structhomme_1_1cslmpi_1_1_fixed_cap_list.html#aad4f28cbbbe5499b8e1a60e8d984aa18">homme::cslmpi::FixedCapList::n</a></div><div class="ttdeci">Int n() const</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02372">compose_slmm.cpp:2372</a></div></div>
<div class="ttc" id="astructhomme_1_1cslmpi_1_1_fixed_cap_list_html_ab8e972993f8c917e95107b125163f0c0"><div class="ttname"><a href="structhomme_1_1cslmpi_1_1_fixed_cap_list.html#ab8e972993f8c917e95107b125163f0c0">homme::cslmpi::FixedCapList::clear</a></div><div class="ttdeci">void clear()</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02370">compose_slmm.cpp:2370</a></div></div>
<div class="ttc" id="astructhomme_1_1cslmpi_1_1_fixed_cap_list_html_ab8fa2048d078e34eb7911f51bd83e5a4"><div class="ttname"><a href="structhomme_1_1cslmpi_1_1_fixed_cap_list.html#ab8fa2048d078e34eb7911f51bd83e5a4">homme::cslmpi::FixedCapList::data</a></div><div class="ttdeci">T * data()</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02381">compose_slmm.cpp:2381</a></div></div>
<div class="ttc" id="astructhomme_1_1cslmpi_1_1_fixed_cap_list_html_ac1a2f14ff00bf93ba5290ff9377eda69"><div class="ttname"><a href="structhomme_1_1cslmpi_1_1_fixed_cap_list.html#ac1a2f14ff00bf93ba5290ff9377eda69">homme::cslmpi::FixedCapList::FixedCapList</a></div><div class="ttdeci">FixedCapList()</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02363">compose_slmm.cpp:2363</a></div></div>
<div class="ttc" id="astructhomme_1_1cslmpi_1_1_fixed_cap_list_html_ad1954a826b38abe88aa5c4eb05ec9cdb"><div class="ttname"><a href="structhomme_1_1cslmpi_1_1_fixed_cap_list.html#ad1954a826b38abe88aa5c4eb05ec9cdb">homme::cslmpi::FixedCapList::FixedCapList</a></div><div class="ttdeci">FixedCapList(const Int &amp;cap)</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02364">compose_slmm.cpp:2364</a></div></div>
<div class="ttc" id="astructhomme_1_1cslmpi_1_1_fixed_cap_list_html_ad5ac1ee99fc2091a5425a3d4dfade068"><div class="ttname"><a href="structhomme_1_1cslmpi_1_1_fixed_cap_list.html#ad5ac1ee99fc2091a5425a3d4dfade068">homme::cslmpi::FixedCapList::size</a></div><div class="ttdeci">Int size() const</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02373">compose_slmm.cpp:2373</a></div></div>
<div class="ttc" id="astructhomme_1_1cslmpi_1_1_fixed_cap_list_html_ad602c949367c66276068f68d48b64717"><div class="ttname"><a href="structhomme_1_1cslmpi_1_1_fixed_cap_list.html#ad602c949367c66276068f68d48b64717">homme::cslmpi::FixedCapList::end</a></div><div class="ttdeci">T * end()</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02387">compose_slmm.cpp:2387</a></div></div>
<div class="ttc" id="astructhomme_1_1cslmpi_1_1_fixed_cap_list_html_ada310da68364580af2420776e7d54a32"><div class="ttname"><a href="structhomme_1_1cslmpi_1_1_fixed_cap_list.html#ada310da68364580af2420776e7d54a32">homme::cslmpi::FixedCapList::back</a></div><div class="ttdeci">const T &amp; back() const</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02382">compose_slmm.cpp:2382</a></div></div>
<div class="ttc" id="astructhomme_1_1cslmpi_1_1_fixed_cap_list_html_adcf681a89e5b8db48d9268d35e6f0544"><div class="ttname"><a href="structhomme_1_1cslmpi_1_1_fixed_cap_list.html#adcf681a89e5b8db48d9268d35e6f0544">homme::cslmpi::FixedCapList::begin</a></div><div class="ttdeci">const T * begin() const</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02384">compose_slmm.cpp:2384</a></div></div>
<div class="ttc" id="astructhomme_1_1cslmpi_1_1_fixed_cap_list_html_ae2b8645820433b9777ddbed87eb5daf0"><div class="ttname"><a href="structhomme_1_1cslmpi_1_1_fixed_cap_list.html#ae2b8645820433b9777ddbed87eb5daf0">homme::cslmpi::FixedCapList::inc</a></div><div class="ttdeci">void inc()</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02377">compose_slmm.cpp:2377</a></div></div>
<div class="ttc" id="astructhomme_1_1cslmpi_1_1_layout_triple_html"><div class="ttname"><a href="structhomme_1_1cslmpi_1_1_layout_triple.html">homme::cslmpi::LayoutTriple</a></div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02465">compose_slmm.cpp:2465</a></div></div>
<div class="ttc" id="astructhomme_1_1cslmpi_1_1_layout_triple_html_a30122012b909033f0439e43772932c80"><div class="ttname"><a href="structhomme_1_1cslmpi_1_1_layout_triple.html#a30122012b909033f0439e43772932c80">homme::cslmpi::LayoutTriple::xptr</a></div><div class="ttdeci">Int xptr</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02466">compose_slmm.cpp:2466</a></div></div>
<div class="ttc" id="astructhomme_1_1cslmpi_1_1_layout_triple_html_a9147af30052aa1a35892d8b92d1b7a45"><div class="ttname"><a href="structhomme_1_1cslmpi_1_1_layout_triple.html#a9147af30052aa1a35892d8b92d1b7a45">homme::cslmpi::LayoutTriple::qptr</a></div><div class="ttdeci">Int qptr</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02466">compose_slmm.cpp:2466</a></div></div>
<div class="ttc" id="astructhomme_1_1cslmpi_1_1_layout_triple_html_a954b9c68414bdf327b607ec9ff3b73e6"><div class="ttname"><a href="structhomme_1_1cslmpi_1_1_layout_triple.html#a954b9c68414bdf327b607ec9ff3b73e6">homme::cslmpi::LayoutTriple::LayoutTriple</a></div><div class="ttdeci">LayoutTriple(const Int &amp;val)</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02468">compose_slmm.cpp:2468</a></div></div>
<div class="ttc" id="astructhomme_1_1cslmpi_1_1_layout_triple_html_a96ce50bddefff51db0dea7cfddf4b6f1"><div class="ttname"><a href="structhomme_1_1cslmpi_1_1_layout_triple.html#a96ce50bddefff51db0dea7cfddf4b6f1">homme::cslmpi::LayoutTriple::cnt</a></div><div class="ttdeci">Int cnt</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02466">compose_slmm.cpp:2466</a></div></div>
<div class="ttc" id="astructhomme_1_1cslmpi_1_1_layout_triple_html_af79beb7bc68fbabec48cc4e5e495ca6d"><div class="ttname"><a href="structhomme_1_1cslmpi_1_1_layout_triple.html#af79beb7bc68fbabec48cc4e5e495ca6d">homme::cslmpi::LayoutTriple::LayoutTriple</a></div><div class="ttdeci">LayoutTriple()</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02467">compose_slmm.cpp:2467</a></div></div>
<div class="ttc" id="astructhomme_1_1cslmpi_1_1_list_of_lists_1_1_list_html"><div class="ttname"><a href="structhomme_1_1cslmpi_1_1_list_of_lists_1_1_list.html">homme::cslmpi::ListOfLists::List</a></div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02396">compose_slmm.cpp:2396</a></div></div>
<div class="ttc" id="astructhomme_1_1cslmpi_1_1_list_of_lists_1_1_list_html_a194b4c859156676706e9bb68dc7a9261"><div class="ttname"><a href="structhomme_1_1cslmpi_1_1_list_of_lists_1_1_list.html#a194b4c859156676706e9bb68dc7a9261">homme::cslmpi::ListOfLists::List::end</a></div><div class="ttdeci">T * end()</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02407">compose_slmm.cpp:2407</a></div></div>
<div class="ttc" id="astructhomme_1_1cslmpi_1_1_list_of_lists_1_1_list_html_a295bce2446a8ef408a410c1a9f9518ba"><div class="ttname"><a href="structhomme_1_1cslmpi_1_1_list_of_lists_1_1_list.html#a295bce2446a8ef408a410c1a9f9518ba">homme::cslmpi::ListOfLists::List::begin</a></div><div class="ttdeci">T * begin()</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02405">compose_slmm.cpp:2405</a></div></div>
<div class="ttc" id="astructhomme_1_1cslmpi_1_1_list_of_lists_1_1_list_html_a33306b1f6695dd0d3781501148d834a7"><div class="ttname"><a href="structhomme_1_1cslmpi_1_1_list_of_lists_1_1_list.html#a33306b1f6695dd0d3781501148d834a7">homme::cslmpi::ListOfLists::List::operator()</a></div><div class="ttdeci">T &amp; operator()(const Int &amp;i)</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02399">compose_slmm.cpp:2399</a></div></div>
<div class="ttc" id="astructhomme_1_1cslmpi_1_1_list_of_lists_1_1_list_html_a456323eb53bb8511c7069baba1870a76"><div class="ttname"><a href="structhomme_1_1cslmpi_1_1_list_of_lists_1_1_list.html#a456323eb53bb8511c7069baba1870a76">homme::cslmpi::ListOfLists::List::data</a></div><div class="ttdeci">T * data()</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02403">compose_slmm.cpp:2403</a></div></div>
<div class="ttc" id="astructhomme_1_1cslmpi_1_1_list_of_lists_1_1_list_html_a63d84e934ca16f226d278a7d061fa61d"><div class="ttname"><a href="structhomme_1_1cslmpi_1_1_list_of_lists_1_1_list.html#a63d84e934ca16f226d278a7d061fa61d">homme::cslmpi::ListOfLists::List::begin</a></div><div class="ttdeci">const T * begin() const</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02404">compose_slmm.cpp:2404</a></div></div>
<div class="ttc" id="astructhomme_1_1cslmpi_1_1_list_of_lists_1_1_list_html_a64c98937bfc2c3fcac44fb26ffe52b48"><div class="ttname"><a href="structhomme_1_1cslmpi_1_1_list_of_lists_1_1_list.html#a64c98937bfc2c3fcac44fb26ffe52b48">homme::cslmpi::ListOfLists::List::zero</a></div><div class="ttdeci">void zero()</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02409">compose_slmm.cpp:2409</a></div></div>
<div class="ttc" id="astructhomme_1_1cslmpi_1_1_list_of_lists_1_1_list_html_a6513236aee6083abcea798365cdd87a1"><div class="ttname"><a href="structhomme_1_1cslmpi_1_1_list_of_lists_1_1_list.html#a6513236aee6083abcea798365cdd87a1">homme::cslmpi::ListOfLists::List::end</a></div><div class="ttdeci">const T * end() const</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02406">compose_slmm.cpp:2406</a></div></div>
<div class="ttc" id="astructhomme_1_1cslmpi_1_1_list_of_lists_1_1_list_html_a715c7f2b1e90f0d2e5c3d2eeb08bdec4"><div class="ttname"><a href="structhomme_1_1cslmpi_1_1_list_of_lists_1_1_list.html#a715c7f2b1e90f0d2e5c3d2eeb08bdec4">homme::cslmpi::ListOfLists::List::n</a></div><div class="ttdeci">Int n() const</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02397">compose_slmm.cpp:2397</a></div></div>
<div class="ttc" id="astructhomme_1_1cslmpi_1_1_list_of_lists_1_1_list_html_ac41446418bc47fb81408bd2e96ad88b5"><div class="ttname"><a href="structhomme_1_1cslmpi_1_1_list_of_lists_1_1_list.html#ac41446418bc47fb81408bd2e96ad88b5">homme::cslmpi::ListOfLists::List::data</a></div><div class="ttdeci">const T * data() const</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02402">compose_slmm.cpp:2402</a></div></div>
<div class="ttc" id="astructhomme_1_1cslmpi_1_1_list_of_lists_html"><div class="ttname"><a href="structhomme_1_1cslmpi_1_1_list_of_lists.html">homme::cslmpi::ListOfLists</a></div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02395">compose_slmm.cpp:2395</a></div></div>
<div class="ttc" id="astructhomme_1_1cslmpi_1_1_list_of_lists_html_a148e5115425454d913ebf0efdc31117e"><div class="ttname"><a href="structhomme_1_1cslmpi_1_1_list_of_lists.html#a148e5115425454d913ebf0efdc31117e">homme::cslmpi::ListOfLists::ListOfLists</a></div><div class="ttdeci">ListOfLists(const Int nlist, const Int *nlist_per_list)</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02419">compose_slmm.cpp:2419</a></div></div>
<div class="ttc" id="astructhomme_1_1cslmpi_1_1_list_of_lists_html_a1a334a3602be27a8c1e64701b9dea1b9"><div class="ttname"><a href="structhomme_1_1cslmpi_1_1_list_of_lists.html#a1a334a3602be27a8c1e64701b9dea1b9">homme::cslmpi::ListOfLists::operator()</a></div><div class="ttdeci">List operator()(const Int &amp;i)</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02437">compose_slmm.cpp:2437</a></div></div>
<div class="ttc" id="astructhomme_1_1cslmpi_1_1_list_of_lists_html_a6711fa719e03ffad7df6afe223f9ea23"><div class="ttname"><a href="structhomme_1_1cslmpi_1_1_list_of_lists.html#a6711fa719e03ffad7df6afe223f9ea23">homme::cslmpi::ListOfLists::n</a></div><div class="ttdeci">Int n() const</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02436">compose_slmm.cpp:2436</a></div></div>
<div class="ttc" id="astructhomme_1_1cslmpi_1_1_list_of_lists_html_a87de27b3c77aadeed3b24f4c7365d675"><div class="ttname"><a href="structhomme_1_1cslmpi_1_1_list_of_lists.html#a87de27b3c77aadeed3b24f4c7365d675">homme::cslmpi::ListOfLists::ListOfLists</a></div><div class="ttdeci">ListOfLists()</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02418">compose_slmm.cpp:2418</a></div></div>
<div class="ttc" id="astructhomme_1_1cslmpi_1_1_list_of_lists_html_aa6d35555467b2286472dd6862b9b8cc3"><div class="ttname"><a href="structhomme_1_1cslmpi_1_1_list_of_lists.html#aa6d35555467b2286472dd6862b9b8cc3">homme::cslmpi::ListOfLists::init</a></div><div class="ttdeci">void init(const Int nlist, const Int *nlist_per_list, T *buf=nullptr)</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02420">compose_slmm.cpp:2420</a></div></div>
<div class="ttc" id="astructhomme_1_1cslmpi_1_1extend__halo_1_1_gid_rank_pair_html"><div class="ttname"><a href="structhomme_1_1cslmpi_1_1extend__halo_1_1_gid_rank_pair.html">homme::cslmpi::extend_halo::GidRankPair</a></div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02656">compose_slmm.cpp:2656</a></div></div>
<div class="ttc" id="astructhomme_1_1cslmpi_1_1extend__halo_1_1_gid_rank_pair_html_a4f2d150c137cbf6903826ea04a8998f8"><div class="ttname"><a href="structhomme_1_1cslmpi_1_1extend__halo_1_1_gid_rank_pair.html#a4f2d150c137cbf6903826ea04a8998f8">homme::cslmpi::extend_halo::GidRankPair::rank</a></div><div class="ttdeci">const Rank rank</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02658">compose_slmm.cpp:2658</a></div></div>
<div class="ttc" id="astructhomme_1_1cslmpi_1_1extend__halo_1_1_gid_rank_pair_html_aaa8b9701575e54532bdbf1732827c49a"><div class="ttname"><a href="structhomme_1_1cslmpi_1_1extend__halo_1_1_gid_rank_pair.html#aaa8b9701575e54532bdbf1732827c49a">homme::cslmpi::extend_halo::GidRankPair::operator&lt;</a></div><div class="ttdeci">bool operator&lt;(const GidRankPair &amp;o) const</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02660">compose_slmm.cpp:2660</a></div></div>
<div class="ttc" id="astructhomme_1_1cslmpi_1_1extend__halo_1_1_gid_rank_pair_html_aac48ea68ece7a2824bacdf0687fa0ebf"><div class="ttname"><a href="structhomme_1_1cslmpi_1_1extend__halo_1_1_gid_rank_pair.html#aac48ea68ece7a2824bacdf0687fa0ebf">homme::cslmpi::extend_halo::GidRankPair::GidRankPair</a></div><div class="ttdeci">GidRankPair(const Gid &amp;gid_, const Rank &amp;rank_)</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02659">compose_slmm.cpp:2659</a></div></div>
<div class="ttc" id="astructhomme_1_1cslmpi_1_1extend__halo_1_1_gid_rank_pair_html_aeb1ccc086803f08a986ae3d9e4c0645a"><div class="ttname"><a href="structhomme_1_1cslmpi_1_1extend__halo_1_1_gid_rank_pair.html#aeb1ccc086803f08a986ae3d9e4c0645a">homme::cslmpi::extend_halo::GidRankPair::gid</a></div><div class="ttdeci">const Gid gid</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02657">compose_slmm.cpp:2657</a></div></div>
<div class="ttc" id="astructhomme_1_1mpi_1_1_request_html"><div class="ttname"><a href="structhomme_1_1mpi_1_1_request.html">homme::mpi::Request</a></div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02245">compose_slmm.cpp:2245</a></div></div>
<div class="ttc" id="astructhomme_1_1mpi_1_1_request_html_afeffd56251f8a51cbda9672fec828d18"><div class="ttname"><a href="structhomme_1_1mpi_1_1_request.html#afeffd56251f8a51cbda9672fec828d18">homme::mpi::Request::request</a></div><div class="ttdeci">MPI_Request request</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02246">compose_slmm.cpp:2246</a></div></div>
<div class="ttc" id="astructsiqk_1_1_in_exe_space_3_01_v_t_00_01ko_1_1_host_space_01_4_html_a9541d7505385a5a434cc6ba60a31f15e"><div class="ttname"><a href="structsiqk_1_1_in_exe_space_3_01_v_t_00_01ko_1_1_host_space_01_4.html#a9541d7505385a5a434cc6ba60a31f15e">siqk::InExeSpace&lt; VT, ko::HostSpace &gt;::type</a></div><div class="ttdeci">VT::HostMirror type</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l00112">compose_slmm.cpp:112</a></div></div>
<div class="ttc" id="astructsiqk_1_1_in_exe_space_html"><div class="ttname"><a href="structsiqk_1_1_in_exe_space.html">siqk::InExeSpace</a></div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l00108">compose_slmm.cpp:108</a></div></div>
<div class="ttc" id="astructsiqk_1_1_in_exe_space_html_a39009b9757c788f34a6db4f442f8adb2"><div class="ttname"><a href="structsiqk_1_1_in_exe_space.html#a39009b9757c788f34a6db4f442f8adb2">siqk::InExeSpace::type</a></div><div class="ttdeci">VT type</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l00109">compose_slmm.cpp:109</a></div></div>
<div class="ttc" id="astructsiqk_1_1_plane_geometry_html"><div class="ttname"><a href="structsiqk_1_1_plane_geometry.html">siqk::PlaneGeometry</a></div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l00446">compose_slmm.cpp:446</a></div></div>
<div class="ttc" id="astructsiqk_1_1_plane_geometry_html_a2c0abf0414aad833e56ebe59405c926a"><div class="ttname"><a href="structsiqk_1_1_plane_geometry.html#a2c0abf0414aad833e56ebe59405c926a">siqk::PlaneGeometry::scale</a></div><div class="ttdeci">static KOKKOS_INLINE_FUNCTION void scale(const Real &amp;a, V v)</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l00448">compose_slmm.cpp:448</a></div></div>
<div class="ttc" id="astructsiqk_1_1_plane_geometry_html_a2f85a124e19fb90b952844385342d0a8"><div class="ttname"><a href="structsiqk_1_1_plane_geometry.html#a2f85a124e19fb90b952844385342d0a8">siqk::PlaneGeometry::edge_normal</a></div><div class="ttdeci">static KOKKOS_INLINE_FUNCTION void edge_normal(const CV e1, const CV e2, V en)</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l00468">compose_slmm.cpp:468</a></div></div>
<div class="ttc" id="astructsiqk_1_1_plane_geometry_html_a4995be0c4128dddab5ed06cf36c36de7"><div class="ttname"><a href="structsiqk_1_1_plane_geometry.html#a4995be0c4128dddab5ed06cf36c36de7">siqk::PlaneGeometry::inside</a></div><div class="ttdeci">static KOKKOS_INLINE_FUNCTION bool inside(const CV v, const CV e1, const CV en)</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l00474">compose_slmm.cpp:474</a></div></div>
<div class="ttc" id="astructsiqk_1_1_plane_geometry_html_a5bcade77711cd1e96bd6ac787dcef0a8"><div class="ttname"><a href="structsiqk_1_1_plane_geometry.html#a5bcade77711cd1e96bd6ac787dcef0a8">siqk::PlaneGeometry::intersect</a></div><div class="ttdeci">static KOKKOS_INLINE_FUNCTION void intersect(const CV v1, const CV v2, const CV e1, const CV en, V intersection)</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l00479">compose_slmm.cpp:479</a></div></div>
<div class="ttc" id="astructsiqk_1_1_plane_geometry_html_a61208fd207658a785e7e50954b9316a8"><div class="ttname"><a href="structsiqk_1_1_plane_geometry.html#a61208fd207658a785e7e50954b9316a8">siqk::PlaneGeometry::calc_tri_jacobian</a></div><div class="ttdeci">static KOKKOS_INLINE_FUNCTION Real calc_tri_jacobian(const CV v1, const CV v2, const CV v3)</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l00537">compose_slmm.cpp:537</a></div></div>
<div class="ttc" id="astructsiqk_1_1_plane_geometry_html_a6cd5d37ee1e3d437fa9e29488a79e62d"><div class="ttname"><a href="structsiqk_1_1_plane_geometry.html#a6cd5d37ee1e3d437fa9e29488a79e62d">siqk::PlaneGeometry::output</a></div><div class="ttdeci">static KOKKOS_INLINE_FUNCTION bool output(const CV v, Int &amp;no, const V vo)</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l00492">compose_slmm.cpp:492</a></div></div>
<div class="ttc" id="astructsiqk_1_1_plane_geometry_html_a98ba6fd378e91f6ae5a861dea14c56d1"><div class="ttname"><a href="structsiqk_1_1_plane_geometry.html#a98ba6fd378e91f6ae5a861dea14c56d1">siqk::PlaneGeometry::calc_area</a></div><div class="ttdeci">static KOKKOS_INLINE_FUNCTION Real calc_area(const TriangleQuadrature &amp;, const CV2s &amp;v, const Int n)</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l00511">compose_slmm.cpp:511</a></div></div>
<div class="ttc" id="astructsiqk_1_1_plane_geometry_html_aabd0bea685514cc050df35ed109aa0c0"><div class="ttname"><a href="structsiqk_1_1_plane_geometry.html#aabd0bea685514cc050df35ed109aa0c0">siqk::PlaneGeometry::calc_area_formula</a></div><div class="ttdeci">static KOKKOS_INLINE_FUNCTION Real calc_area_formula(const CV2s &amp;v, const Int n)</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l00518">compose_slmm.cpp:518</a></div></div>
<div class="ttc" id="astructsiqk_1_1_plane_geometry_html_aaff4adc83dcf850e47fa175ed4d27d7f"><div class="ttname"><a href="structsiqk_1_1_plane_geometry.html#aaff4adc83dcf850e47fa175ed4d27d7f">siqk::PlaneGeometry::dot_c_amb</a></div><div class="ttdeci">static KOKKOS_INLINE_FUNCTION Real dot_c_amb(const CV c, const CV a, const CV b)</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l00452">compose_slmm.cpp:452</a></div></div>
<div class="ttc" id="astructsiqk_1_1_plane_geometry_html_ab04d3962792af51655f60857a6cb31d7"><div class="ttname"><a href="structsiqk_1_1_plane_geometry.html#ab04d3962792af51655f60857a6cb31d7">siqk::PlaneGeometry::axpy</a></div><div class="ttdeci">static KOKKOS_INLINE_FUNCTION void axpy(const Real &amp;a, const CV x, V y)</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l00462">compose_slmm.cpp:462</a></div></div>
<div class="ttc" id="astructsiqk_1_1_plane_geometry_html_ae32bb0359254d2eb1cff27c3ea3a5b0b"><div class="ttname"><a href="structsiqk_1_1_plane_geometry.html#ae32bb0359254d2eb1cff27c3ea3a5b0b">siqk::PlaneGeometry::combine</a></div><div class="ttdeci">static KOKKOS_INLINE_FUNCTION void combine(const CV u, const CV v, const Real &amp;a, V x)</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l00456">compose_slmm.cpp:456</a></div></div>
<div class="ttc" id="astructsiqk_1_1_plane_geometry_html_ae854fb6c0d18fec7d947e06266bce8e8"><div class="ttname"><a href="structsiqk_1_1_plane_geometry.html#ae854fb6c0d18fec7d947e06266bce8e8">siqk::PlaneGeometry::bary2coord</a></div><div class="ttdeci">static KOKKOS_INLINE_FUNCTION void bary2coord(const CV v1, const CV v2, const CV v3, const CA alpha, Real u[2])</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l00527">compose_slmm.cpp:527</a></div></div>
<div class="ttc" id="astructsiqk_1_1_sphere_geometry_html"><div class="ttname"><a href="structsiqk_1_1_sphere_geometry.html">siqk::SphereGeometry</a></div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l00550">compose_slmm.cpp:550</a></div></div>
<div class="ttc" id="astructsiqk_1_1_sphere_geometry_html_a02d2e96e35359f90e419eb4fba379e34"><div class="ttname"><a href="structsiqk_1_1_sphere_geometry.html#a02d2e96e35359f90e419eb4fba379e34">siqk::SphereGeometry::calc_area</a></div><div class="ttdeci">static KOKKOS_INLINE_FUNCTION Real calc_area(const TriangleQuadrature &amp;q, const CV3s &amp;v, const Int n)</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l00685">compose_slmm.cpp:685</a></div></div>
<div class="ttc" id="astructsiqk_1_1_sphere_geometry_html_a08158927fa5b0e17115588332406f820"><div class="ttname"><a href="structsiqk_1_1_sphere_geometry.html#a08158927fa5b0e17115588332406f820">siqk::SphereGeometry::axpy</a></div><div class="ttdeci">static KOKKOS_INLINE_FUNCTION void axpy(const Real &amp;a, const CV x, V y)</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l00578">compose_slmm.cpp:578</a></div></div>
<div class="ttc" id="astructsiqk_1_1_sphere_geometry_html_a10bebaf5ff1a296f4dfaa50523876b73"><div class="ttname"><a href="structsiqk_1_1_sphere_geometry.html#a10bebaf5ff1a296f4dfaa50523876b73">siqk::SphereGeometry::edge_normal</a></div><div class="ttdeci">static KOKKOS_INLINE_FUNCTION void edge_normal(const CV a, const CV b, V en)</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l00605">compose_slmm.cpp:605</a></div></div>
<div class="ttc" id="astructsiqk_1_1_sphere_geometry_html_a1618aaa4edfb918ad167c9fdb75cc8eb"><div class="ttname"><a href="structsiqk_1_1_sphere_geometry.html#a1618aaa4edfb918ad167c9fdb75cc8eb">siqk::SphereGeometry::calc_area_formula</a></div><div class="ttdeci">static KOKKOS_INLINE_FUNCTION Real calc_area_formula(const CV3s &amp;v, const Int n)</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l00662">compose_slmm.cpp:662</a></div></div>
<div class="ttc" id="astructsiqk_1_1_sphere_geometry_html_a27022ecf217cd41de8b02d307c8e283c"><div class="ttname"><a href="structsiqk_1_1_sphere_geometry.html#a27022ecf217cd41de8b02d307c8e283c">siqk::SphereGeometry::output</a></div><div class="ttdeci">static KOKKOS_INLINE_FUNCTION bool output(const CV v, Int &amp;no, V vo)</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l00641">compose_slmm.cpp:641</a></div></div>
<div class="ttc" id="astructsiqk_1_1_sphere_geometry_html_a4285d0d14d246cfc3e6687c7aed5ec36"><div class="ttname"><a href="structsiqk_1_1_sphere_geometry.html#a4285d0d14d246cfc3e6687c7aed5ec36">siqk::SphereGeometry::dot_c_amb</a></div><div class="ttdeci">static KOKKOS_INLINE_FUNCTION Real dot_c_amb(const CVC c, const CVA a, const CVB b)</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l00574">compose_slmm.cpp:574</a></div></div>
<div class="ttc" id="astructsiqk_1_1_sphere_geometry_html_a4e6a9a84dc10f2cbccf89be84af41a7e"><div class="ttname"><a href="structsiqk_1_1_sphere_geometry.html#a4e6a9a84dc10f2cbccf89be84af41a7e">siqk::SphereGeometry::calc_arc_length</a></div><div class="ttdeci">static KOKKOS_INLINE_FUNCTION Real calc_arc_length(const CV a, const CV b)</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l00677">compose_slmm.cpp:677</a></div></div>
<div class="ttc" id="astructsiqk_1_1_sphere_geometry_html_a5cd34159f10e01024d4425b363e922e8"><div class="ttname"><a href="structsiqk_1_1_sphere_geometry.html#a5cd34159f10e01024d4425b363e922e8">siqk::SphereGeometry::scale</a></div><div class="ttdeci">static KOKKOS_INLINE_FUNCTION void scale(const Real &amp;a, V v)</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l00566">compose_slmm.cpp:566</a></div></div>
<div class="ttc" id="astructsiqk_1_1_sphere_geometry_html_a5d62310dba1533d5822d1e61a2124303"><div class="ttname"><a href="structsiqk_1_1_sphere_geometry.html#a5d62310dba1533d5822d1e61a2124303">siqk::SphereGeometry::normalize</a></div><div class="ttdeci">static KOKKOS_INLINE_FUNCTION void normalize(V v)</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l00570">compose_slmm.cpp:570</a></div></div>
<div class="ttc" id="astructsiqk_1_1_sphere_geometry_html_a76492d5747e39b374b0c253894ad5744"><div class="ttname"><a href="structsiqk_1_1_sphere_geometry.html#a76492d5747e39b374b0c253894ad5744">siqk::SphereGeometry::inside</a></div><div class="ttdeci">static KOKKOS_INLINE_FUNCTION bool inside(const CVV v, const CVA a, const CVN n)</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l00612">compose_slmm.cpp:612</a></div></div>
<div class="ttc" id="astructsiqk_1_1_sphere_geometry_html_a925ea6009b465032ab66aeb8a7465120"><div class="ttname"><a href="structsiqk_1_1_sphere_geometry.html#a925ea6009b465032ab66aeb8a7465120">siqk::SphereGeometry::calc_tri_jacobian</a></div><div class="ttdeci">static KOKKOS_INLINE_FUNCTION Real calc_tri_jacobian(const CV v1, const CV v2, const CV v3, const CA alpha, Real u[3])</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l00705">compose_slmm.cpp:705</a></div></div>
<div class="ttc" id="astructsiqk_1_1_sphere_geometry_html_a96b5477dfa04c756127d8c8a528cec0e"><div class="ttname"><a href="structsiqk_1_1_sphere_geometry.html#a96b5477dfa04c756127d8c8a528cec0e">siqk::SphereGeometry::combine</a></div><div class="ttdeci">static KOKKOS_INLINE_FUNCTION void combine(const CV u, const CV v, const Real &amp;a, V x)</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l00597">compose_slmm.cpp:597</a></div></div>
<div class="ttc" id="astructsiqk_1_1_sphere_geometry_html_aa3b244e614f36a709624d53b10909334"><div class="ttname"><a href="structsiqk_1_1_sphere_geometry.html#aa3b244e614f36a709624d53b10909334">siqk::SphereGeometry::cross</a></div><div class="ttdeci">static KOKKOS_INLINE_FUNCTION void cross(const CV a, const CV b, V c)</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l00552">compose_slmm.cpp:552</a></div></div>
<div class="ttc" id="astructsiqk_1_1_sphere_geometry_html_ab09386c8b086f7b7df5c15b3f72af91e"><div class="ttname"><a href="structsiqk_1_1_sphere_geometry.html#ab09386c8b086f7b7df5c15b3f72af91e">siqk::SphereGeometry::dot</a></div><div class="ttdeci">static KOKKOS_INLINE_FUNCTION Real dot(const CVA a, const CVB b)</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l00558">compose_slmm.cpp:558</a></div></div>
<div class="ttc" id="astructsiqk_1_1_sphere_geometry_html_abe55b2f04df31eb101c6ede1d4e2da3f"><div class="ttname"><a href="structsiqk_1_1_sphere_geometry.html#abe55b2f04df31eb101c6ede1d4e2da3f">siqk::SphereGeometry::axpbyz</a></div><div class="ttdeci">static KOKKOS_INLINE_FUNCTION void axpbyz(const Real &amp;a, const CVX x, const Real &amp;b, const CVY y, VZ z)</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l00584">compose_slmm.cpp:584</a></div></div>
<div class="ttc" id="astructsiqk_1_1_sphere_geometry_html_abeb5a91432744cabf20d3a357e08f18d"><div class="ttname"><a href="structsiqk_1_1_sphere_geometry.html#abeb5a91432744cabf20d3a357e08f18d">siqk::SphereGeometry::norm2</a></div><div class="ttdeci">static KOKKOS_INLINE_FUNCTION Real norm2(const CV v)</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l00562">compose_slmm.cpp:562</a></div></div>
<div class="ttc" id="astructsiqk_1_1_sphere_geometry_html_ac0ede37337f870a25eebf6c08e13e0a7"><div class="ttname"><a href="structsiqk_1_1_sphere_geometry.html#ac0ede37337f870a25eebf6c08e13e0a7">siqk::SphereGeometry::copy</a></div><div class="ttdeci">static KOKKOS_INLINE_FUNCTION void copy(V d, const CV s)</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l00591">compose_slmm.cpp:591</a></div></div>
<div class="ttc" id="astructsiqk_1_1_sphere_geometry_html_ad5491c146f58632ad07f1717bc705028"><div class="ttname"><a href="structsiqk_1_1_sphere_geometry.html#ad5491c146f58632ad07f1717bc705028">siqk::SphereGeometry::intersect</a></div><div class="ttdeci">static KOKKOS_INLINE_FUNCTION void intersect(const CV v1, const CV v2, const CV e1, const CV en, V intersection)</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l00627">compose_slmm.cpp:627</a></div></div>
<div class="ttc" id="astructsiqk_1_1sh_1_1_mesh_html"><div class="ttname"><a href="structsiqk_1_1sh_1_1_mesh.html">siqk::sh::Mesh</a></div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l00775">compose_slmm.cpp:775</a></div></div>
<div class="ttc" id="astructsiqk_1_1sh_1_1_mesh_html_a08b7acf03ca69f64736bda8060053539"><div class="ttname"><a href="structsiqk_1_1sh_1_1_mesh.html#a08b7acf03ca69f64736bda8060053539">siqk::sh::Mesh::nml</a></div><div class="ttdeci">RealArray nml</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l00779">compose_slmm.cpp:779</a></div></div>
<div class="ttc" id="astructsiqk_1_1sh_1_1_mesh_html_a09ea9632dd1680a04d53aec55d4b6e4f"><div class="ttname"><a href="structsiqk_1_1sh_1_1_mesh.html#a09ea9632dd1680a04d53aec55d4b6e4f">siqk::sh::Mesh::p</a></div><div class="ttdeci">RealArray p</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l00779">compose_slmm.cpp:779</a></div></div>
<div class="ttc" id="astructsiqk_1_1sh_1_1_mesh_html_a1ebc900d7142e767c6b27925916fc917"><div class="ttname"><a href="structsiqk_1_1sh_1_1_mesh.html#a1ebc900d7142e767c6b27925916fc917">siqk::sh::Mesh::IntArray</a></div><div class="ttdeci">InExeSpace&lt; ConstIdxs, ES &gt;::type IntArray</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l00777">compose_slmm.cpp:777</a></div></div>
<div class="ttc" id="astructsiqk_1_1sh_1_1_mesh_html_a3e86d388497c2a559b87e401a1235e87"><div class="ttname"><a href="structsiqk_1_1sh_1_1_mesh.html#a3e86d388497c2a559b87e401a1235e87">siqk::sh::Mesh::e</a></div><div class="ttdeci">IntArray e</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l00780">compose_slmm.cpp:780</a></div></div>
<div class="ttc" id="astructsiqk_1_1sh_1_1_mesh_html_a5840d05f3000193f5e19bbf51e0b2845"><div class="ttname"><a href="structsiqk_1_1sh_1_1_mesh.html#a5840d05f3000193f5e19bbf51e0b2845">siqk::sh::Mesh::Mesh</a></div><div class="ttdeci">Mesh(const Mesh&lt; ko::HostSpace &gt; &amp;m)</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l00784">compose_slmm.cpp:784</a></div></div>
<div class="ttc" id="astructsiqk_1_1sh_1_1_mesh_html_abb2b255c79d852e853cdc9ab6ffc092f"><div class="ttname"><a href="structsiqk_1_1sh_1_1_mesh.html#abb2b255c79d852e853cdc9ab6ffc092f">siqk::sh::Mesh::RealArray</a></div><div class="ttdeci">InExeSpace&lt; ConstVec3s, ES &gt;::type RealArray</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l00776">compose_slmm.cpp:776</a></div></div>
<div class="ttc" id="astructsiqk_1_1sh_1_1_mesh_html_ac734002157287653809b1a732348d568"><div class="ttname"><a href="structsiqk_1_1sh_1_1_mesh.html#ac734002157287653809b1a732348d568">siqk::sh::Mesh::en</a></div><div class="ttdeci">IntArray en</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l00780">compose_slmm.cpp:780</a></div></div>
<div class="ttc" id="astructsiqk_1_1sh_1_1_mesh_html_ae6c581aa93fb98d457e55dfad1f6f898"><div class="ttname"><a href="structsiqk_1_1sh_1_1_mesh.html#ae6c581aa93fb98d457e55dfad1f6f898">siqk::sh::Mesh::Mesh</a></div><div class="ttdeci">Mesh()</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l00782">compose_slmm.cpp:782</a></div></div>
<div class="ttc" id="astructsiqk_1_1sqr_1_1_info_html"><div class="ttname"><a href="structsiqk_1_1sqr_1_1_info.html">siqk::sqr::Info</a></div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l00955">compose_slmm.cpp:955</a></div></div>
<div class="ttc" id="astructsiqk_1_1sqr_1_1_info_html_a9a01d651b2e286335a208f672c8dbf0c"><div class="ttname"><a href="structsiqk_1_1sqr_1_1_info.html#a9a01d651b2e286335a208f672c8dbf0c">siqk::sqr::Info::success</a></div><div class="ttdeci">bool success</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l00956">compose_slmm.cpp:956</a></div></div>
<div class="ttc" id="astructsiqk_1_1sqr_1_1_info_html_aae7126c703242df2f17f566307ed4e5a"><div class="ttname"><a href="structsiqk_1_1sqr_1_1_info.html#aae7126c703242df2f17f566307ed4e5a">siqk::sqr::Info::n_iterations</a></div><div class="ttdeci">Int n_iterations</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l00957">compose_slmm.cpp:957</a></div></div>
<div class="ttc" id="astructsiqk_1_1sqr_1_1test_1_1_info_html"><div class="ttname"><a href="structsiqk_1_1sqr_1_1test_1_1_info.html">siqk::sqr::test::Info</a></div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l01019">compose_slmm.cpp:1019</a></div></div>
<div class="ttc" id="astructsiqk_1_1sqr_1_1test_1_1_info_html_a28ab5b87898dc4d6116ae6b6e6460707"><div class="ttname"><a href="structsiqk_1_1sqr_1_1test_1_1_info.html#a28ab5b87898dc4d6116ae6b6e6460707">siqk::sqr::test::Info::sum_nits</a></div><div class="ttdeci">Int sum_nits</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l01020">compose_slmm.cpp:1020</a></div></div>
<div class="ttc" id="astructsiqk_1_1sqr_1_1test_1_1_info_html_a387b7c755b2504b200f2fb502560f719"><div class="ttname"><a href="structsiqk_1_1sqr_1_1test_1_1_info.html#a387b7c755b2504b200f2fb502560f719">siqk::sqr::test::Info::nfails</a></div><div class="ttdeci">Int nfails</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l01020">compose_slmm.cpp:1020</a></div></div>
<div class="ttc" id="astructsiqk_1_1sqr_1_1test_1_1_info_html_a81481f3c64cc936710bc2230fa9114d0"><div class="ttname"><a href="structsiqk_1_1sqr_1_1test_1_1_info.html#a81481f3c64cc936710bc2230fa9114d0">siqk::sqr::test::Info::max_nits</a></div><div class="ttdeci">Int max_nits</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l01020">compose_slmm.cpp:1020</a></div></div>
<div class="ttc" id="astructslmm_1_1_advecter_1_1_alg_html"><div class="ttname"><a href="structslmm_1_1_advecter_1_1_alg.html">slmm::Advecter::Alg</a></div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l01991">compose_slmm.cpp:1991</a></div></div>
<div class="ttc" id="astructslmm_1_1_advecter_1_1_alg_html_a8d25733af0135add595ca9429d96ae15"><div class="ttname"><a href="structslmm_1_1_advecter_1_1_alg.html#a8d25733af0135add595ca9429d96ae15">slmm::Advecter::Alg::Enum</a></div><div class="ttdeci">Enum</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l01992">compose_slmm.cpp:1992</a></div></div>
<div class="ttc" id="astructslmm_1_1_advecter_1_1_alg_html_a8d25733af0135add595ca9429d96ae15a04aca1177ddd519ab399ffe663fe5cbb"><div class="ttname"><a href="structslmm_1_1_advecter_1_1_alg.html#a8d25733af0135add595ca9429d96ae15a04aca1177ddd519ab399ffe663fe5cbb">slmm::Advecter::Alg::csl_gll</a></div><div class="ttdeci">@ csl_gll</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l01995">compose_slmm.cpp:1995</a></div></div>
<div class="ttc" id="astructslmm_1_1_advecter_1_1_alg_html_a8d25733af0135add595ca9429d96ae15a0fa461bca58d930799338c0dd9b26df2"><div class="ttname"><a href="structslmm_1_1_advecter_1_1_alg.html#a8d25733af0135add595ca9429d96ae15a0fa461bca58d930799338c0dd9b26df2">slmm::Advecter::Alg::csl_gll_exp</a></div><div class="ttdeci">@ csl_gll_exp</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l01997">compose_slmm.cpp:1997</a></div></div>
<div class="ttc" id="astructslmm_1_1_advecter_1_1_alg_html_a8d25733af0135add595ca9429d96ae15a10bd2bf4e2e9889c0eb5f8c08a26489d"><div class="ttname"><a href="structslmm_1_1_advecter_1_1_alg.html#a8d25733af0135add595ca9429d96ae15a10bd2bf4e2e9889c0eb5f8c08a26489d">slmm::Advecter::Alg::qos</a></div><div class="ttdeci">@ qos</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l01994">compose_slmm.cpp:1994</a></div></div>
<div class="ttc" id="astructslmm_1_1_advecter_1_1_alg_html_a8d25733af0135add595ca9429d96ae15a4b92e82dd683b8e5e36401c4c417320c"><div class="ttname"><a href="structslmm_1_1_advecter_1_1_alg.html#a8d25733af0135add595ca9429d96ae15a4b92e82dd683b8e5e36401c4c417320c">slmm::Advecter::Alg::csl_gll_subgrid</a></div><div class="ttdeci">@ csl_gll_subgrid</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l01996">compose_slmm.cpp:1996</a></div></div>
<div class="ttc" id="astructslmm_1_1_advecter_1_1_alg_html_a8d25733af0135add595ca9429d96ae15a58d3371520961c730ed3d792dd6ef208"><div class="ttname"><a href="structslmm_1_1_advecter_1_1_alg.html#a8d25733af0135add595ca9429d96ae15a58d3371520961c730ed3d792dd6ef208">slmm::Advecter::Alg::jct</a></div><div class="ttdeci">@ jct</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l01993">compose_slmm.cpp:1993</a></div></div>
<div class="ttc" id="astructslmm_1_1_advecter_1_1_alg_html_aa5850685e0fb4b5bc662118d9209fab9"><div class="ttname"><a href="structslmm_1_1_advecter_1_1_alg.html#aa5850685e0fb4b5bc662118d9209fab9">slmm::Advecter::Alg::is_cisl</a></div><div class="ttdeci">static bool is_cisl(const Enum &amp;alg)</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02009">compose_slmm.cpp:2009</a></div></div>
<div class="ttc" id="astructslmm_1_1_advecter_1_1_alg_html_af754ef31d61d9d042335b77f28880bab"><div class="ttname"><a href="structslmm_1_1_advecter_1_1_alg.html#af754ef31d61d9d042335b77f28880bab">slmm::Advecter::Alg::convert</a></div><div class="ttdeci">static Enum convert(Int alg)</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l01999">compose_slmm.cpp:1999</a></div></div>
<div class="ttc" id="astructslmm_1_1_advecter_html"><div class="ttname"><a href="structslmm_1_1_advecter.html">slmm::Advecter</a></div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l01987">compose_slmm.cpp:1987</a></div></div>
<div class="ttc" id="astructslmm_1_1_advecter_html_a14d43ce08c47ea1df937dc1703d195f3"><div class="ttname"><a href="structslmm_1_1_advecter.html#a14d43ce08c47ea1df937dc1703d195f3">slmm::Advecter::ConstPtr</a></div><div class="ttdeci">std::shared_ptr&lt; const Advecter &gt; ConstPtr</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l01989">compose_slmm.cpp:1989</a></div></div>
<div class="ttc" id="astructslmm_1_1_advecter_html_a1dda64ded895b0512f71910a86cfd93b"><div class="ttname"><a href="structslmm_1_1_advecter.html#a1dda64ded895b0512f71910a86cfd93b">slmm::Advecter::np4</a></div><div class="ttdeci">Int np4() const</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02033">compose_slmm.cpp:2033</a></div></div>
<div class="ttc" id="astructslmm_1_1_advecter_html_a22cd6080ae37bf5092cf4d6dc0a4772a"><div class="ttname"><a href="structslmm_1_1_advecter.html#a22cd6080ae37bf5092cf4d6dc0a4772a">slmm::Advecter::mass_mix_buffer</a></div><div class="ttdeci">std::vector&lt; Real &gt; &amp; mass_mix_buffer()</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02075">compose_slmm.cpp:2075</a></div></div>
<div class="ttc" id="astructslmm_1_1_advecter_html_a39c4157f373425e5604b1f0a087f1c8d"><div class="ttname"><a href="structslmm_1_1_advecter.html#a39c4157f373425e5604b1f0a087f1c8d">slmm::Advecter::local_mesh</a></div><div class="ttdeci">LocalMesh &amp; local_mesh(const Int ie)</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02060">compose_slmm.cpp:2060</a></div></div>
<div class="ttc" id="astructslmm_1_1_advecter_html_a513fc6399078d132a97d0d449a843607"><div class="ttname"><a href="structslmm_1_1_advecter.html#a513fc6399078d132a97d0d449a843607">slmm::Advecter::init_meta_data</a></div><div class="ttdeci">void init_meta_data(const Int nelem_global, const Int *lid2facenum)</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02105">compose_slmm.cpp:2106</a></div></div>
<div class="ttc" id="astructslmm_1_1_advecter_html_a55953c4bd87ec3121bf9993bcc11dbf2"><div class="ttname"><a href="structslmm_1_1_advecter.html#a55953c4bd87ec3121bf9993bcc11dbf2">slmm::Advecter::tq_order</a></div><div class="ttdeci">Int tq_order() const</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02035">compose_slmm.cpp:2035</a></div></div>
<div class="ttc" id="astructslmm_1_1_advecter_html_a5be0d0c905559d9d7e7ff775c5a4f593"><div class="ttname"><a href="structslmm_1_1_advecter.html#a5be0d0c905559d9d7e7ff775c5a4f593">slmm::Advecter::np2</a></div><div class="ttdeci">Int np2() const</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02032">compose_slmm.cpp:2032</a></div></div>
<div class="ttc" id="astructslmm_1_1_advecter_html_a5e2a035d422023c3a4f696a7eae46f12"><div class="ttname"><a href="structslmm_1_1_advecter.html#a5e2a035d422023c3a4f696a7eae46f12">slmm::Advecter::M_tgt</a></div><div class="ttdeci">const Real * M_tgt(const Int &amp;ie)</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02077">compose_slmm.cpp:2077</a></div></div>
<div class="ttc" id="astructslmm_1_1_advecter_html_a669827265583101df84a49f02b700057"><div class="ttname"><a href="structslmm_1_1_advecter.html#a669827265583101df84a49f02b700057">slmm::Advecter::check_ref2sphere</a></div><div class="ttdeci">void check_ref2sphere(const Int ie, const Real *p_homme)</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02145">compose_slmm.cpp:2145</a></div></div>
<div class="ttc" id="astructslmm_1_1_advecter_html_a6aee13815de2f218c92599d2e145f7f9"><div class="ttname"><a href="structslmm_1_1_advecter.html#a6aee13815de2f218c92599d2e145f7f9">slmm::Advecter::Ptr</a></div><div class="ttdeci">std::shared_ptr&lt; Advecter &gt; Ptr</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l01988">compose_slmm.cpp:1988</a></div></div>
<div class="ttc" id="astructslmm_1_1_advecter_html_a84b17c3e0c8ceb58d593fec7b3d07850"><div class="ttname"><a href="structslmm_1_1_advecter.html#a84b17c3e0c8ceb58d593fec7b3d07850">slmm::Advecter::np</a></div><div class="ttdeci">Int np() const</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02031">compose_slmm.cpp:2031</a></div></div>
<div class="ttc" id="astructslmm_1_1_advecter_html_a8bad166a3312089bd75418f41519c86c"><div class="ttname"><a href="structslmm_1_1_advecter.html#a8bad166a3312089bd75418f41519c86c">slmm::Advecter::init_local_mesh_if_needed</a></div><div class="ttdeci">void init_local_mesh_if_needed(const Int ie, const Array3D &amp;corners, const Real *p_inside)</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02114">compose_slmm.cpp:2114</a></div></div>
<div class="ttc" id="astructslmm_1_1_advecter_html_a91fd6505ebc4de2399ebaf6b259424f2"><div class="ttname"><a href="structslmm_1_1_advecter.html#a91fd6505ebc4de2399ebaf6b259424f2">slmm::Advecter::nearest_point_data</a></div><div class="ttdeci">const MeshNearestPointData &amp; nearest_point_data(const Int ie) const</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02065">compose_slmm.cpp:2065</a></div></div>
<div class="ttc" id="astructslmm_1_1_advecter_html_a9f36cc9f88fbd851722e96c247d07ea5"><div class="ttname"><a href="structslmm_1_1_advecter.html#a9f36cc9f88fbd851722e96c247d07ea5">slmm::Advecter::alg</a></div><div class="ttdeci">Alg::Enum alg() const</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02036">compose_slmm.cpp:2036</a></div></div>
<div class="ttc" id="astructslmm_1_1_advecter_html_aa9c928d571650b1b4a4a73e03f5890ca"><div class="ttname"><a href="structslmm_1_1_advecter.html#aa9c928d571650b1b4a4a73e03f5890ca">slmm::Advecter::cubed_sphere_map</a></div><div class="ttdeci">Int cubed_sphere_map() const</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02039">compose_slmm.cpp:2039</a></div></div>
<div class="ttc" id="astructslmm_1_1_advecter_html_ab9a96789ed360210aee71d6b904cf8db"><div class="ttname"><a href="structslmm_1_1_advecter.html#ab9a96789ed360210aee71d6b904cf8db">slmm::Advecter::is_cisl</a></div><div class="ttdeci">bool is_cisl() const</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02037">compose_slmm.cpp:2037</a></div></div>
<div class="ttc" id="astructslmm_1_1_advecter_html_ac48a72f438fd44f70a224323415ae435"><div class="ttname"><a href="structslmm_1_1_advecter.html#ac48a72f438fd44f70a224323415ae435">slmm::Advecter::s2r</a></div><div class="ttdeci">const SphereToRef &amp; s2r() const</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02088">compose_slmm.cpp:2088</a></div></div>
<div class="ttc" id="astructslmm_1_1_advecter_html_ac93fc0f27e3838ae2ccea5ddcc983c41"><div class="ttname"><a href="structslmm_1_1_advecter.html#ac93fc0f27e3838ae2ccea5ddcc983c41">slmm::Advecter::Advecter</a></div><div class="ttdeci">Advecter(const Int np, const Int nelem, const Int transport_alg, const Int cubed_sphere_map, const Int nearest_point_permitted_lev_bdy)</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02012">compose_slmm.cpp:2012</a></div></div>
<div class="ttc" id="astructslmm_1_1_advecter_html_aca02b2cf0c258e41f36f324159f5d0a8"><div class="ttname"><a href="structslmm_1_1_advecter.html#aca02b2cf0c258e41f36f324159f5d0a8">slmm::Advecter::fill_nearest_points_if_needed</a></div><div class="ttdeci">void fill_nearest_points_if_needed()</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02138">compose_slmm.cpp:2138</a></div></div>
<div class="ttc" id="astructslmm_1_1_advecter_html_ad0c9dc9bf29858727dae8c578fee42f1"><div class="ttname"><a href="structslmm_1_1_advecter.html#ad0c9dc9bf29858727dae8c578fee42f1">slmm::Advecter::rhs_buffer</a></div><div class="ttdeci">std::vector&lt; Real &gt; &amp; rhs_buffer(const Int qsize)</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02070">compose_slmm.cpp:2070</a></div></div>
<div class="ttc" id="astructslmm_1_1_advecter_html_adec3da25a76af49865473c80f45ea9bf"><div class="ttname"><a href="structslmm_1_1_advecter.html#adec3da25a76af49865473c80f45ea9bf">slmm::Advecter::lid2facenum</a></div><div class="ttdeci">const Ints &amp; lid2facenum() const</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02040">compose_slmm.cpp:2040</a></div></div>
<div class="ttc" id="astructslmm_1_1_advecter_html_ae0e59b5516d366a7d8ea825f37674d27"><div class="ttname"><a href="structslmm_1_1_advecter.html#ae0e59b5516d366a7d8ea825f37674d27">slmm::Advecter::nearest_point_permitted</a></div><div class="ttdeci">bool nearest_point_permitted(const Int &amp;lev) const</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02084">compose_slmm.cpp:2084</a></div></div>
<div class="ttc" id="astructslmm_1_1_advecter_html_aef6709967e01e0162a7ce68093e38a6e"><div class="ttname"><a href="structslmm_1_1_advecter.html#aef6709967e01e0162a7ce68093e38a6e">slmm::Advecter::nelem</a></div><div class="ttdeci">Int nelem() const</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02034">compose_slmm.cpp:2034</a></div></div>
<div class="ttc" id="astructslmm_1_1_advecter_html_af0e7e647ca4de5abe97fa3f04b96792d"><div class="ttname"><a href="structslmm_1_1_advecter.html#af0e7e647ca4de5abe97fa3f04b96792d">slmm::Advecter::local_mesh</a></div><div class="ttdeci">const LocalMesh &amp; local_mesh(const Int ie) const</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l02056">compose_slmm.cpp:2056</a></div></div>
<div class="ttc" id="astructslmm_1_1_basis_html"><div class="ttname"><a href="structslmm_1_1_basis.html">slmm::Basis</a></div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l01178">compose_slmm.cpp:1178</a></div></div>
<div class="ttc" id="astructslmm_1_1_basis_html_a4460417806b4ac2e9928cb430b847d1a"><div class="ttname"><a href="structslmm_1_1_basis.html#a4460417806b4ac2e9928cb430b847d1a">slmm::Basis::monotone_type</a></div><div class="ttdeci">Int monotone_type</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l01179">compose_slmm.cpp:1179</a></div></div>
<div class="ttc" id="astructslmm_1_1_basis_html_a62914faa92816a730775972caf7015d3"><div class="ttname"><a href="structslmm_1_1_basis.html#a62914faa92816a730775972caf7015d3">slmm::Basis::Basis</a></div><div class="ttdeci">Basis(const Int inp, const Int imt)</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l01181">compose_slmm.cpp:1181</a></div></div>
<div class="ttc" id="astructslmm_1_1_basis_html_a7eed6557d9778a23be30031ef7e7206f"><div class="ttname"><a href="structslmm_1_1_basis.html#a7eed6557d9778a23be30031ef7e7206f">slmm::Basis::np</a></div><div class="ttdeci">Int np</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l01179">compose_slmm.cpp:1179</a></div></div>
<div class="ttc" id="astructslmm_1_1_basis_html_affebd08fdc6df6ed442ebee3691db7ed"><div class="ttname"><a href="structslmm_1_1_basis.html#affebd08fdc6df6ed442ebee3691db7ed">slmm::Basis::Basis</a></div><div class="ttdeci">Basis()</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l01180">compose_slmm.cpp:1180</a></div></div>
<div class="ttc" id="astructslmm_1_1_local_mesh_html"><div class="ttname"><a href="structslmm_1_1_local_mesh.html">slmm::LocalMesh</a></div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l01884">compose_slmm.cpp:1884</a></div></div>
<div class="ttc" id="astructslmm_1_1_local_mesh_html_a31bfa049e11148a3474fc90b8c7303a6"><div class="ttname"><a href="structslmm_1_1_local_mesh.html#a31bfa049e11148a3474fc90b8c7303a6">slmm::LocalMesh::IntArray</a></div><div class="ttdeci">Super::IntArray IntArray</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l01886">compose_slmm.cpp:1886</a></div></div>
<div class="ttc" id="astructslmm_1_1_local_mesh_html_a84bbd39af98680d8f3441c37db94faa2"><div class="ttname"><a href="structslmm_1_1_local_mesh.html#a84bbd39af98680d8f3441c37db94faa2">slmm::LocalMesh::tgt_elem</a></div><div class="ttdeci">Int tgt_elem</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l01890">compose_slmm.cpp:1890</a></div></div>
<div class="ttc" id="astructslmm_1_1_local_mesh_html_ac076fa9e10662f4d1e3dd776f3a11695"><div class="ttname"><a href="structslmm_1_1_local_mesh.html#ac076fa9e10662f4d1e3dd776f3a11695">slmm::LocalMesh::Super</a></div><div class="ttdeci">siqk::sh::Mesh&lt; ko::HostSpace &gt; Super</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l01885">compose_slmm.cpp:1885</a></div></div>
<div class="ttc" id="astructslmm_1_1_local_mesh_html_ad312495f9adc29acc50c47b1ab281447"><div class="ttname"><a href="structslmm_1_1_local_mesh.html#ad312495f9adc29acc50c47b1ab281447">slmm::LocalMesh::RealArray</a></div><div class="ttdeci">Super::RealArray RealArray</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l01887">compose_slmm.cpp:1887</a></div></div>
<div class="ttc" id="astructslmm_1_1_sphere_to_ref_html"><div class="ttname"><a href="structslmm_1_1_sphere_to_ref.html">slmm::SphereToRef</a></div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l01896">compose_slmm.cpp:1896</a></div></div>
<div class="ttc" id="astructslmm_1_1_sphere_to_ref_html_a617fc3725ecbe170be737594d8928138"><div class="ttname"><a href="structslmm_1_1_sphere_to_ref.html#a617fc3725ecbe170be737594d8928138">slmm::SphereToRef::tol</a></div><div class="ttdeci">Real tol() const</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l01907">compose_slmm.cpp:1907</a></div></div>
<div class="ttc" id="astructslmm_1_1_sphere_to_ref_html_a6a0b6d9c7df0e737dcc7c458533e6620"><div class="ttname"><a href="structslmm_1_1_sphere_to_ref.html#a6a0b6d9c7df0e737dcc7c458533e6620">slmm::SphereToRef::init</a></div><div class="ttdeci">void init(const Int cubed_sphere_map, const Int nelem_global, const Ints::const_type &amp;lid2facenum)</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l01897">compose_slmm.cpp:1897</a></div></div>
<div class="ttc" id="astructslmm_1_1_sphere_to_ref_html_aaad555824cc81462aa94165d11702bc9"><div class="ttname"><a href="structslmm_1_1_sphere_to_ref.html#aaad555824cc81462aa94165d11702bc9">slmm::SphereToRef::calc_sphere_to_ref</a></div><div class="ttdeci">void calc_sphere_to_ref(const Int &amp;ie, const LocalMesh &amp;m, const Real q[3], Real &amp;a, Real &amp;b, siqk::sqr::Info *const info=nullptr, const Int max_its=10, const Real tol=1e2 *std::numeric_limits&lt; Real &gt;::epsilon()) const</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l01912">compose_slmm.cpp:1912</a></div></div>
<div class="ttc" id="astructslmm_1_1_sphere_to_ref_html_aad9870de578831b4c97c7a1d9916533c"><div class="ttname"><a href="structslmm_1_1_sphere_to_ref.html#aad9870de578831b4c97c7a1d9916533c">slmm::SphereToRef::check</a></div><div class="ttdeci">bool check(const Int &amp;ie, const LocalMesh &amp;m) const</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l01932">compose_slmm.cpp:1932</a></div></div>
<div class="ttc" id="astructslmm_1_1nearest__point_1_1_mesh_nearest_point_data_html"><div class="ttname"><a href="structslmm_1_1nearest__point_1_1_mesh_nearest_point_data.html">slmm::nearest_point::MeshNearestPointData</a></div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l01591">compose_slmm.cpp:1591</a></div></div>
<div class="ttc" id="astructslmm_1_1nearest__point_1_1_mesh_nearest_point_data_html_a960ab7dce344a0638cc7916beb860e17"><div class="ttname"><a href="structslmm_1_1nearest__point_1_1_mesh_nearest_point_data.html#a960ab7dce344a0638cc7916beb860e17">slmm::nearest_point::MeshNearestPointData::perimnml</a></div><div class="ttdeci">Ints perimnml</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l01595">compose_slmm.cpp:1595</a></div></div>
<div class="ttc" id="astructslmm_1_1nearest__point_1_1_mesh_nearest_point_data_html_ab588a28d42c14b6d948b948da9c91f6c"><div class="ttname"><a href="structslmm_1_1nearest__point_1_1_mesh_nearest_point_data.html#ab588a28d42c14b6d948b948da9c91f6c">slmm::nearest_point::MeshNearestPointData::Ints</a></div><div class="ttdeci">ko::View&lt; Int *, ES &gt; Ints</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l01592">compose_slmm.cpp:1592</a></div></div>
<div class="ttc" id="astructslmm_1_1nearest__point_1_1_mesh_nearest_point_data_html_ac72796b400d078db1a96e260968ff226"><div class="ttname"><a href="structslmm_1_1nearest__point_1_1_mesh_nearest_point_data.html#ac72796b400d078db1a96e260968ff226">slmm::nearest_point::MeshNearestPointData::perimp</a></div><div class="ttdeci">Ints perimp</div><div class="ttdef"><b>Definition:</b> <a href="compose__slmm_8cpp_source.html#l01595">compose_slmm.cpp:1595</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_0b9b079b26fcc9f7494e277d37e7b67d.html">share</a></li><li class="navelem"><a class="el" href="dir_ba74d2a1222e90ef480fd96e94c40893.html">compose</a></li><li class="navelem"><a class="el" href="compose__slmm_8cpp.html">compose_slmm.cpp</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
