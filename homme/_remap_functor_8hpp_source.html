<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Homme: src/share/cxx/RemapFunctor.hpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Homme
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('_remap_functor_8hpp_source.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">RemapFunctor.hpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="_remap_functor_8hpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/********************************************************************************</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"> * HOMMEXX 1.0: Copyright of Sandia Corporation</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"> * This software is released under the BSD license</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"> * See the file &#39;COPYRIGHT&#39; in the HOMMEXX/src/share/cxx directory</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"> *******************************************************************************/</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160; </div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="preprocessor">#ifndef HOMMEXX_REMAP_FUNCTOR_HPP</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="preprocessor">#define HOMMEXX_REMAP_FUNCTOR_HPP</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160; </div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="preprocessor">#include &lt;memory&gt;</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="preprocessor">#include &lt;type_traits&gt;</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160; </div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_error_defs_8hpp.html">ErrorDefs.hpp</a>&quot;</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160; </div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_elements_8hpp.html">Elements.hpp</a>&quot;</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_tracers_8hpp.html">Tracers.hpp</a>&quot;</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_hybrid_v_coord_8hpp.html">HybridVCoord.hpp</a>&quot;</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_kernel_variables_8hpp.html">KernelVariables.hpp</a>&quot;</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_column_ops_8hpp.html">ColumnOps.hpp</a>&quot;</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_types_8hpp.html">Types.hpp</a>&quot;</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_loops_utils_8hpp.html">utilities/LoopsUtils.hpp</a>&quot;</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_math_utils_8hpp.html">utilities/MathUtils.hpp</a>&quot;</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_subview_utils_8hpp.html">utilities/SubviewUtils.hpp</a>&quot;</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_sync_utils_8hpp.html">utilities/SyncUtils.hpp</a>&quot;</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#include &quot;RemapStateProvider.hpp&quot;</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160; </div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="profiling_8hpp.html">profiling.hpp</a>&quot;</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160; </div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespace_homme.html">Homme</a> {</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="keyword">namespace </span>Remap {</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160; </div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment">// The RemapStateAndThicknessProvider provides states and src/tgt thicknesses</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="comment">// to the RemapFunctor. Its implementation differ depending on whether rsplit</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="comment">// is zero or not. In case it is not zero, it must provide states to remap.</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment">// For this task, it relies on the RemapStateProvider class, which is implemented</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment">// inside each model (preqx and theta), since the state structure is different</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment">// across models.</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="keyword">template</span> &lt;<span class="keywordtype">bool</span> nonzero_rsplit&gt;</div>
<div class="line"><a name="l00039"></a><span class="lineno"><a class="line" href="struct_homme_1_1_remap_1_1_remap_state_and_thickness_provider.html">   39</a></span>&#160;<span class="keyword">struct </span><a class="code" href="struct_homme_1_1_remap_1_1_remap_state_and_thickness_provider.html">RemapStateAndThicknessProvider</a>;</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160; </div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="keyword">template</span> &lt;&gt;</div>
<div class="line"><a name="l00042"></a><span class="lineno"><a class="line" href="struct_homme_1_1_remap_1_1_remap_state_and_thickness_provider_3_01false_01_4.html">   42</a></span>&#160;<span class="keyword">struct </span><a class="code" href="struct_homme_1_1_remap_1_1_remap_state_and_thickness_provider.html">RemapStateAndThicknessProvider</a>&lt;false&gt; {</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160; </div>
<div class="line"><a name="l00044"></a><span class="lineno"><a class="line" href="struct_homme_1_1_remap_1_1_remap_state_and_thickness_provider_3_01false_01_4.html#aae6cb1d0431a81f5ec3b18ee37d40863">   44</a></span>&#160;  <a class="code" href="namespace_homme.html#ae4e4c236c03960ced6be1fbb557097d1">ExecViewManaged&lt;Scalar * [NP][NP][NUM_LEV]&gt;</a> <a class="code" href="struct_homme_1_1_remap_1_1_remap_state_and_thickness_provider_3_01false_01_4.html#aae6cb1d0431a81f5ec3b18ee37d40863">m_src_layer_thickness</a>;</div>
<div class="line"><a name="l00045"></a><span class="lineno"><a class="line" href="struct_homme_1_1_remap_1_1_remap_state_and_thickness_provider_3_01false_01_4.html#a558b9be72c65a088103578702cb33988">   45</a></span>&#160;  <a class="code" href="namespace_homme.html#ae4e4c236c03960ced6be1fbb557097d1">ExecViewManaged&lt;Scalar * [NP][NP][NUM_LEV]&gt;</a> <a class="code" href="struct_homme_1_1_remap_1_1_remap_state_and_thickness_provider_3_01false_01_4.html#a558b9be72c65a088103578702cb33988">m_tgt_layer_thickness</a>;</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160; </div>
<div class="line"><a name="l00047"></a><span class="lineno"><a class="line" href="struct_homme_1_1_remap_1_1_remap_state_and_thickness_provider_3_01false_01_4.html#a81197f551f2f20c87f0d539705e731ec">   47</a></span>&#160;  <a class="code" href="namespace_homme.html#ab890b69860872d32c6a3173f53674505">ExecViewUnmanaged&lt;const Scalar * [NP][NP][NUM_LEV_P]&gt;</a> <a class="code" href="struct_homme_1_1_remap_1_1_remap_state_and_thickness_provider_3_01false_01_4.html#a81197f551f2f20c87f0d539705e731ec">m_eta_dot_dpdn</a>;</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160; </div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;  <span class="keyword">explicit</span></div>
<div class="line"><a name="l00050"></a><span class="lineno"><a class="line" href="struct_homme_1_1_remap_1_1_remap_state_and_thickness_provider_3_01false_01_4.html#a4db64f5266b56acf7e9483a361234b8a">   50</a></span>&#160;  <a class="code" href="struct_homme_1_1_remap_1_1_remap_state_and_thickness_provider_3_01false_01_4.html#a4db64f5266b56acf7e9483a361234b8a">RemapStateAndThicknessProvider</a> (<span class="keyword">const</span> <a class="code" href="class_homme_1_1_elements.html">Elements</a>&amp; elements)</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    : m_src_layer_thickness(<span class="stringliteral">&quot;Source layer thickness&quot;</span>, elements.num_elems())</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    , m_tgt_layer_thickness(<span class="stringliteral">&quot;Target layer thickness&quot;</span>, elements.num_elems())</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    , m_eta_dot_dpdn(elements.m_derived.m_eta_dot_dpdn)</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;  {}</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160; </div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;  KOKKOS_INLINE_FUNCTION</div>
<div class="line"><a name="l00057"></a><span class="lineno"><a class="line" href="struct_homme_1_1_remap_1_1_remap_state_and_thickness_provider_3_01false_01_4.html#ac9a0589481a41dfcf45608a74b1ba217">   57</a></span>&#160;  <span class="keywordtype">int</span> <a class="code" href="struct_homme_1_1_remap_1_1_remap_state_and_thickness_provider_3_01false_01_4.html#ac9a0589481a41dfcf45608a74b1ba217">num_states_remap</a> ()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> 0; }</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160; </div>
<div class="line"><a name="l00059"></a><span class="lineno"><a class="line" href="struct_homme_1_1_remap_1_1_remap_state_and_thickness_provider_3_01false_01_4.html#a2b2dab16f8f881845b6fa38afdd86767">   59</a></span>&#160;  <span class="keywordtype">int</span> <a class="code" href="struct_homme_1_1_remap_1_1_remap_state_and_thickness_provider_3_01false_01_4.html#a2b2dab16f8f881845b6fa38afdd86767">requested_buffer_size</a> ()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;  }</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160; </div>
<div class="line"><a name="l00063"></a><span class="lineno"><a class="line" href="struct_homme_1_1_remap_1_1_remap_state_and_thickness_provider_3_01false_01_4.html#ab6441c71595d798658991801bfc4e6ab">   63</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="struct_homme_1_1_remap_1_1_remap_state_and_thickness_provider_3_01false_01_4.html#ab6441c71595d798658991801bfc4e6ab">init_buffers</a>(<span class="keyword">const</span> <a class="code" href="struct_homme_1_1_functors_buffers_manager.html">FunctorsBuffersManager</a>&amp; <span class="comment">/* fbm */</span>) {</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    <span class="comment">// Do nothing</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;  }</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160; </div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;  KOKKOS_INLINE_FUNCTION</div>
<div class="line"><a name="l00068"></a><span class="lineno"><a class="line" href="struct_homme_1_1_remap_1_1_remap_state_and_thickness_provider_3_01false_01_4.html#ae03cb0cea830f7be798230c372ed2558">   68</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="struct_homme_1_1_remap_1_1_remap_state_and_thickness_provider_3_01false_01_4.html#ae03cb0cea830f7be798230c372ed2558">is_intrinsic_state</a> (<span class="keyword">const</span> <span class="keywordtype">int</span> <span class="comment">/* istate */</span>)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    <span class="comment">// We should never reach this part</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    assert(<span class="keyword">false</span>);</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;  }</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160; </div>
<div class="line"><a name="l00074"></a><span class="lineno"><a class="line" href="struct_homme_1_1_remap_1_1_remap_state_and_thickness_provider_3_01false_01_4.html#aabed000a98c6c325dea7174f14eb3c56">   74</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="struct_homme_1_1_remap_1_1_remap_state_and_thickness_provider_3_01false_01_4.html#aabed000a98c6c325dea7174f14eb3c56">preprocess_states</a> (<span class="keyword">const</span> <span class="keywordtype">int</span> <span class="comment">/* np1 */</span>)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    <span class="comment">// Do nothing</span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  }</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160; </div>
<div class="line"><a name="l00078"></a><span class="lineno"><a class="line" href="struct_homme_1_1_remap_1_1_remap_state_and_thickness_provider_3_01false_01_4.html#a21d5348013cca5067880bc3a4d47f6f7">   78</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="struct_homme_1_1_remap_1_1_remap_state_and_thickness_provider_3_01false_01_4.html#a21d5348013cca5067880bc3a4d47f6f7">postprocess_states</a> (<span class="keyword">const</span> <span class="keywordtype">int</span> <span class="comment">/* np1 */</span>)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    <span class="comment">// Do nothing</span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;  }</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160; </div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;  KOKKOS_INLINE_FUNCTION</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;  <a class="code" href="namespace_homme.html#ab890b69860872d32c6a3173f53674505">ExecViewUnmanaged&lt;Scalar[NP][NP][NUM_LEV]&gt;</a></div>
<div class="line"><a name="l00084"></a><span class="lineno"><a class="line" href="struct_homme_1_1_remap_1_1_remap_state_and_thickness_provider_3_01false_01_4.html#a3977b0caa9a50ef1c3bca43e916eb2e7">   84</a></span>&#160;  <a class="code" href="struct_homme_1_1_remap_1_1_remap_state_and_thickness_provider_3_01false_01_4.html#a3977b0caa9a50ef1c3bca43e916eb2e7">get_state</a>(<span class="keyword">const</span> <a class="code" href="struct_homme_1_1_kernel_variables.html">KernelVariables</a> &amp;<span class="comment">/* kv */</span>, <span class="keywordtype">int</span> <span class="comment">/*np1*/</span>, <span class="keywordtype">int</span> <span class="comment">/*var*/</span>)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    Kokkos::abort(<span class="stringliteral">&quot;Error! Asked for state in an rsplit=0 remap.\n&quot;</span>);</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160; </div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    <span class="comment">// Dummy, to silence compiler warnings</span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespace_homme.html#ab890b69860872d32c6a3173f53674505">ExecViewUnmanaged&lt;Scalar[NP][NP][NUM_LEV]&gt;</a>();</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;  } </div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160; </div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  KOKKOS_INLINE_FUNCTION</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;  <a class="code" href="namespace_homme.html#ab890b69860872d32c6a3173f53674505">ExecViewUnmanaged&lt;Scalar[NP][NP][NUM_LEV]&gt;</a></div>
<div class="line"><a name="l00093"></a><span class="lineno"><a class="line" href="struct_homme_1_1_remap_1_1_remap_state_and_thickness_provider_3_01false_01_4.html#a901d792f08203d8c9c09e365de0adfea">   93</a></span>&#160;  <a class="code" href="struct_homme_1_1_remap_1_1_remap_state_and_thickness_provider_3_01false_01_4.html#a901d792f08203d8c9c09e365de0adfea">get_source_thickness</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> ie, <span class="keyword">const</span> <span class="keywordtype">int</span> <span class="comment">/* np1 */</span>)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespace_homme.html#a2fb615d1c0ef9769f9fe6ff030f5af5e">Homme::subview</a>(m_src_layer_thickness, ie);</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  }</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160; </div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;  KOKKOS_INLINE_FUNCTION</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;  <a class="code" href="namespace_homme.html#ab890b69860872d32c6a3173f53674505">ExecViewUnmanaged&lt;const Scalar[NP][NP][NUM_LEV]&gt;</a></div>
<div class="line"><a name="l00099"></a><span class="lineno"><a class="line" href="struct_homme_1_1_remap_1_1_remap_state_and_thickness_provider_3_01false_01_4.html#a012040d3ab9a13ab918dc0213c60d255">   99</a></span>&#160;  <a class="code" href="struct_homme_1_1_remap_1_1_remap_state_and_thickness_provider_3_01false_01_4.html#a012040d3ab9a13ab918dc0213c60d255">compute_source_thickness</a>(</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;      <a class="code" href="struct_homme_1_1_kernel_variables.html">KernelVariables</a> &amp;kv, <span class="keyword">const</span> <span class="keywordtype">int</span> &amp;np1, <span class="keyword">const</span> <a class="code" href="namespace_homme.html#a8d2ed41bead9ec23a2a8a6c728a9f154">Real</a> &amp;dt,</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;      <a class="code" href="namespace_homme.html#ab890b69860872d32c6a3173f53674505">ExecViewUnmanaged</a>&lt;<span class="keyword">const</span> <a class="code" href="class_kokkos_kernels_1_1_batched_1_1_experimental_1_1_vector.html">Scalar</a>[NP][NP][NUM_LEV]&gt; tgt_layer_thickness)<span class="keyword"></span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="keyword">      const </span>{</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160; </div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    <span class="keyword">auto</span> src_layer_thickness = get_source_thickness(kv.<a class="code" href="struct_homme_1_1_kernel_variables.html#a3191a82ad3209763dfd817720ea68ab5">ie</a>, np1);</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160; </div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    Kokkos::parallel_for(Kokkos::TeamThreadRange(kv.<a class="code" href="struct_homme_1_1_kernel_variables.html#a7a205f05488de1a2b43e43f282007593">team</a>, NP * NP),</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;                         [&amp;](<span class="keyword">const</span> <span class="keywordtype">int</span> &amp;loop_idx) {</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;      const int igp = loop_idx / NP;</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;      const int jgp = loop_idx % NP;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160; </div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;      auto eta_dot_dpdn     = Homme::subview(m_eta_dot_dpdn,kv.ie,igp,jgp);</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;      auto src_thickness_ij = Homme::subview(src_layer_thickness,igp,jgp);</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160; </div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;      ColumnOps::compute_midpoint_delta&lt;CombineMode::Scale&gt;(kv,eta_dot_dpdn,src_thickness_ij,dt);</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160; </div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;      auto tgt_thickness_ij = Homme::subview(tgt_layer_thickness,igp,jgp);</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;      Kokkos::parallel_for(Kokkos::ThreadVectorRange(kv.team, NUM_LEV),</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;                           [&amp;](const int ilev) {</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;        src_thickness_ij(ilev) += tgt_thickness_ij(ilev);</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;      });</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    });</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    kv.team_barrier();</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    <span class="keywordflow">return</span> src_layer_thickness;</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;  }</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;};</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160; </div>
<div class="line"><a name="l00127"></a><span class="lineno"><a class="line" href="struct_homme_1_1_remap_1_1_remap_state_and_thickness_provider_3_01true_01_4.html">  127</a></span>&#160;<span class="keyword">template</span> &lt;&gt; <span class="keyword">struct</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<a class="code" href="struct_homme_1_1_remap_1_1_remap_state_and_thickness_provider_3_01true_01_4.html">RemapStateAndThicknessProvider&lt;true&gt;</a> {</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160; </div>
<div class="line"><a name="l00130"></a><span class="lineno"><a class="line" href="struct_homme_1_1_remap_1_1_remap_state_and_thickness_provider_3_01true_01_4.html#a728c2a97cf342f13529dda97fa0a3ba2">  130</a></span>&#160;  <a class="code" href="namespace_homme.html#ab890b69860872d32c6a3173f53674505">ExecViewUnmanaged&lt;Scalar *[NUM_TIME_LEVELS][NP][NP][NUM_LEV]&gt;</a> <a class="code" href="struct_homme_1_1_remap_1_1_remap_state_and_thickness_provider_3_01true_01_4.html#a728c2a97cf342f13529dda97fa0a3ba2">m_dp3d</a>;</div>
<div class="line"><a name="l00131"></a><span class="lineno"><a class="line" href="struct_homme_1_1_remap_1_1_remap_state_and_thickness_provider_3_01true_01_4.html#ac86b9caba77391e18008575179f42091">  131</a></span>&#160;  <a class="code" href="namespace_homme.html#ae4e4c236c03960ced6be1fbb557097d1">ExecViewManaged&lt;Scalar * [NP][NP][NUM_LEV]&gt;</a> <a class="code" href="struct_homme_1_1_remap_1_1_remap_state_and_thickness_provider_3_01true_01_4.html#ac86b9caba77391e18008575179f42091">m_tgt_layer_thickness</a>;</div>
<div class="line"><a name="l00132"></a><span class="lineno"><a class="line" href="struct_homme_1_1_remap_1_1_remap_state_and_thickness_provider_3_01true_01_4.html#a3c23869922650ea9eed46888c9851c55">  132</a></span>&#160;  <a class="code" href="struct_homme_1_1_remap_1_1_remap_state_provider.html">RemapStateProvider</a>          <a class="code" href="struct_homme_1_1_remap_1_1_remap_state_and_thickness_provider_3_01true_01_4.html#a3c23869922650ea9eed46888c9851c55">m_state_provider</a>;</div>
<div class="line"><a name="l00133"></a><span class="lineno"><a class="line" href="struct_homme_1_1_remap_1_1_remap_state_and_thickness_provider_3_01true_01_4.html#ac884ec4836df683874ba3c15677fb98c">  133</a></span>&#160;  <span class="keywordtype">int</span> <a class="code" href="struct_homme_1_1_remap_1_1_remap_state_and_thickness_provider_3_01true_01_4.html#ac884ec4836df683874ba3c15677fb98c">m_np1</a>;</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160; </div>
<div class="line"><a name="l00135"></a><span class="lineno"><a class="line" href="struct_homme_1_1_remap_1_1_remap_state_and_thickness_provider_3_01true_01_4_1_1_tag_pre_process.html">  135</a></span>&#160;  <span class="keyword">struct </span>TagPreProcess  {};</div>
<div class="line"><a name="l00136"></a><span class="lineno"><a class="line" href="struct_homme_1_1_remap_1_1_remap_state_and_thickness_provider_3_01true_01_4_1_1_tag_post_process.html">  136</a></span>&#160;  <span class="keyword">struct </span>TagPostProcess {};</div>
<div class="line"><a name="l00137"></a><span class="lineno"><a class="line" href="struct_homme_1_1_remap_1_1_remap_state_and_thickness_provider_3_01true_01_4.html#ab9c244c588abda611374587e6891112b">  137</a></span>&#160;  Kokkos::TeamPolicy&lt;ExecSpace,TagPreProcess&gt;  <a class="code" href="struct_homme_1_1_remap_1_1_remap_state_and_thickness_provider_3_01true_01_4.html#ab9c244c588abda611374587e6891112b">m_policy_pre</a>;</div>
<div class="line"><a name="l00138"></a><span class="lineno"><a class="line" href="struct_homme_1_1_remap_1_1_remap_state_and_thickness_provider_3_01true_01_4.html#a67df8621d35b1c258dfac1e62bfcfd76">  138</a></span>&#160;  Kokkos::TeamPolicy&lt;ExecSpace,TagPostProcess&gt; <a class="code" href="struct_homme_1_1_remap_1_1_remap_state_and_thickness_provider_3_01true_01_4.html#a67df8621d35b1c258dfac1e62bfcfd76">m_policy_post</a>;</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160; </div>
<div class="line"><a name="l00140"></a><span class="lineno"><a class="line" href="struct_homme_1_1_remap_1_1_remap_state_and_thickness_provider_3_01true_01_4.html#a23fa8b42e9de9357a52266ce3accd073">  140</a></span>&#160;  <a class="code" href="class_homme_1_1_team_utils.html">TeamUtils&lt;ExecSpace&gt;</a> <a class="code" href="struct_homme_1_1_remap_1_1_remap_state_and_thickness_provider_3_01true_01_4.html#a23fa8b42e9de9357a52266ce3accd073">m_tu</a>;</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160; </div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;  <span class="keyword">explicit</span></div>
<div class="line"><a name="l00143"></a><span class="lineno"><a class="line" href="struct_homme_1_1_remap_1_1_remap_state_and_thickness_provider_3_01true_01_4.html#a29e92897bb40e1f76ee8b7641cdde56f">  143</a></span>&#160;  <a class="code" href="struct_homme_1_1_remap_1_1_remap_state_and_thickness_provider_3_01true_01_4.html#a29e92897bb40e1f76ee8b7641cdde56f">RemapStateAndThicknessProvider</a> (<span class="keyword">const</span> <a class="code" href="class_homme_1_1_elements.html">Elements</a>&amp; elements)</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    : m_dp3d (elements.m_state.m_dp3d)</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    , m_tgt_layer_thickness(<span class="stringliteral">&quot;Target layer thickness&quot;</span>, elements.num_elems())</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    , m_state_provider (elements)</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    , m_policy_pre(<a class="code" href="namespace_homme.html">Homme</a>::<a class="code" href="namespace_homme.html#ae7a6813a53e3f9affa8f76c91acaeac3">get_default_team_policy</a>&lt;<a class="code" href="namespace_homme.html#a0f0e1a7897b0895773148728d6a74cb1">ExecSpace</a>,TagPreProcess&gt;(1))</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    , m_policy_post(<a class="code" href="namespace_homme.html">Homme</a>::<a class="code" href="namespace_homme.html#ae7a6813a53e3f9affa8f76c91acaeac3">get_default_team_policy</a>&lt;<a class="code" href="namespace_homme.html#a0f0e1a7897b0895773148728d6a74cb1">ExecSpace</a>,TagPostProcess&gt;(1))</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    , m_tu(m_policy_pre)</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;  {</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    <span class="comment">// We do not init them in the initialization list, since they require info</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    <span class="comment">// from the state provider. Although, as they are declared in the class,</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    <span class="comment">// the state provider is inited before the policies, it is safer to query</span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    <span class="comment">// the state provider inside the ctor body (in case someone rearranges the</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    <span class="comment">// members of the class.</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160; </div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> iters_pre = m_state_provider.<a class="code" href="struct_homme_1_1_remap_1_1_remap_state_provider.html#ab1561afafc405dabab07847282e039cd">num_states_preprocess</a>();</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> iters_post = m_state_provider.<a class="code" href="struct_homme_1_1_remap_1_1_remap_state_provider.html#a3bc69436a6a6ccb60878dc79c50e47d0">num_states_postprocess</a>();</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> num_elems = elements.<a class="code" href="class_homme_1_1_elements.html#a45ed484dcba35066f7511ed61d652541">m_state</a>.<a class="code" href="class_homme_1_1_elements_state.html#a6d0a69517ec68a39521545acebccc7fb">num_elems</a>();</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    m_policy_pre = Homme::get_default_team_policy&lt;ExecSpace,TagPreProcess&gt;(iters_pre*num_elems);</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    m_policy_post = Homme::get_default_team_policy&lt;ExecSpace,TagPostProcess&gt;(iters_post*num_elems);</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160; </div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    <span class="keywordflow">if</span> (iters_pre*num_elems &gt; 0) {</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;      m_tu = <a class="code" href="class_homme_1_1_team_utils.html">TeamUtils&lt;ExecSpace&gt;</a>(m_policy_pre);</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    }</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;  }</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160; </div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;  KOKKOS_INLINE_FUNCTION</div>
<div class="line"><a name="l00169"></a><span class="lineno"><a class="line" href="struct_homme_1_1_remap_1_1_remap_state_and_thickness_provider_3_01true_01_4.html#a04de30a25a21018878bfdb59e461c35c">  169</a></span>&#160;  <span class="keywordtype">int</span> <a class="code" href="struct_homme_1_1_remap_1_1_remap_state_and_thickness_provider_3_01true_01_4.html#a04de30a25a21018878bfdb59e461c35c">num_states_remap</a> ()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> m_state_provider.<a class="code" href="struct_homme_1_1_remap_1_1_remap_state_provider.html#a297793c486cf9ee9833185e7b2915c66">num_states_remap</a>(); }</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160; </div>
<div class="line"><a name="l00171"></a><span class="lineno"><a class="line" href="struct_homme_1_1_remap_1_1_remap_state_and_thickness_provider_3_01true_01_4.html#a2d3aacd823855381fb51c334516972c6">  171</a></span>&#160;  <span class="keywordtype">int</span> <a class="code" href="struct_homme_1_1_remap_1_1_remap_state_and_thickness_provider_3_01true_01_4.html#a2d3aacd823855381fb51c334516972c6">requested_buffer_size</a> ()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    <span class="keywordflow">return</span> m_state_provider.<a class="code" href="struct_homme_1_1_remap_1_1_remap_state_provider.html#aaa4fe04e841f5795e608131a0cc042f4">requested_buffer_size</a>(m_tu.<a class="code" href="class_homme_1_1___team_utils_common_base.html#abee222dbd07f3305af7b96e25dba9c75">get_num_ws_slots</a>());</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;  }</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160; </div>
<div class="line"><a name="l00175"></a><span class="lineno"><a class="line" href="struct_homme_1_1_remap_1_1_remap_state_and_thickness_provider_3_01true_01_4.html#a47b617f101fd7d2d1f1b507147104c85">  175</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="struct_homme_1_1_remap_1_1_remap_state_and_thickness_provider_3_01true_01_4.html#a47b617f101fd7d2d1f1b507147104c85">init_buffers</a>(<span class="keyword">const</span> <a class="code" href="struct_homme_1_1_functors_buffers_manager.html">FunctorsBuffersManager</a>&amp; fbm) {</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    m_state_provider.<a class="code" href="struct_homme_1_1_remap_1_1_remap_state_provider.html#a6619e55475bfbe090028be5951e95fcb">init_buffers</a>(fbm, m_tu.<a class="code" href="class_homme_1_1___team_utils_common_base.html#abee222dbd07f3305af7b96e25dba9c75">get_num_ws_slots</a>());</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;  }</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160; </div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;  KOKKOS_INLINE_FUNCTION</div>
<div class="line"><a name="l00180"></a><span class="lineno"><a class="line" href="struct_homme_1_1_remap_1_1_remap_state_and_thickness_provider_3_01true_01_4.html#a57876683ee9d2662a50f72f065e93154">  180</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="struct_homme_1_1_remap_1_1_remap_state_and_thickness_provider_3_01true_01_4.html#a57876683ee9d2662a50f72f065e93154">is_intrinsic_state</a> (<span class="keyword">const</span> <span class="keywordtype">int</span> istate)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    <span class="keywordflow">return</span> m_state_provider.<a class="code" href="struct_homme_1_1_remap_1_1_remap_state_provider.html#a713a5df1481a4606e6c1a70942290b61">is_intrinsic_state</a>(istate);</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;  }</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160; </div>
<div class="line"><a name="l00184"></a><span class="lineno"><a class="line" href="struct_homme_1_1_remap_1_1_remap_state_and_thickness_provider_3_01true_01_4.html#a6a706d80514b790590c1d9e3ef458a66">  184</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="struct_homme_1_1_remap_1_1_remap_state_and_thickness_provider_3_01true_01_4.html#a6a706d80514b790590c1d9e3ef458a66">preprocess_states</a> (<span class="keyword">const</span> <span class="keywordtype">int</span> np1) {</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    <span class="keywordflow">if</span> (m_state_provider.<a class="code" href="struct_homme_1_1_remap_1_1_remap_state_provider.html#ab1561afafc405dabab07847282e039cd">num_states_preprocess</a>()&gt;0) {</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;      m_np1 = np1;</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;      Kokkos::parallel_for(<span class="stringliteral">&quot;Pre-process states&quot;</span>,m_policy_pre,*<span class="keyword">this</span>);</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;      ExecSpace::impl_static_fence();</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    }</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;  }</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160; </div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;  KOKKOS_INLINE_FUNCTION</div>
<div class="line"><a name="l00193"></a><span class="lineno"><a class="line" href="struct_homme_1_1_remap_1_1_remap_state_and_thickness_provider_3_01true_01_4.html#a0851bfbb3f4fda4eecfcba4c373ce25a">  193</a></span>&#160;  <span class="keywordtype">void</span> operator() (<span class="keyword">const</span> TagPreProcess&amp;,</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;                   <span class="keyword">const</span> <a class="code" href="namespace_homme.html#ae7b6f8cea89941388a32535d02199147">TeamMember</a>&amp; team)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    <a class="code" href="struct_homme_1_1_kernel_variables.html">KernelVariables</a> kv(team, m_tu);</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> istate = kv.<a class="code" href="struct_homme_1_1_kernel_variables.html#a3191a82ad3209763dfd817720ea68ab5">ie</a> % m_state_provider.<a class="code" href="struct_homme_1_1_remap_1_1_remap_state_provider.html#ab1561afafc405dabab07847282e039cd">num_states_preprocess</a>();</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    kv.<a class="code" href="struct_homme_1_1_kernel_variables.html#a3191a82ad3209763dfd817720ea68ab5">ie</a> /= m_state_provider.<a class="code" href="struct_homme_1_1_remap_1_1_remap_state_provider.html#ab1561afafc405dabab07847282e039cd">num_states_preprocess</a>();</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    <span class="keyword">auto</span> <a class="code" href="namespacedcmip2012__test5.html#ad259dec8945b10d8b2c6226e53589de5">dp</a> = get_source_thickness(kv.<a class="code" href="struct_homme_1_1_kernel_variables.html#a3191a82ad3209763dfd817720ea68ab5">ie</a>,m_np1);</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    m_state_provider.<a class="code" href="struct_homme_1_1_remap_1_1_remap_state_provider.html#a21c90b37db1adce69add8d1d9cb84f6b">preprocess_state</a>(kv,istate,m_np1,<a class="code" href="namespacedcmip2012__test5.html#ad259dec8945b10d8b2c6226e53589de5">dp</a>);</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;  }</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160; </div>
<div class="line"><a name="l00202"></a><span class="lineno"><a class="line" href="struct_homme_1_1_remap_1_1_remap_state_and_thickness_provider_3_01true_01_4.html#ac8be85ffe8bff644552e3e292fb12248">  202</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="struct_homme_1_1_remap_1_1_remap_state_and_thickness_provider_3_01true_01_4.html#ac8be85ffe8bff644552e3e292fb12248">postprocess_states</a> (<span class="keyword">const</span> <span class="keywordtype">int</span> np1) {</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    <span class="keywordflow">if</span> (m_state_provider.<a class="code" href="struct_homme_1_1_remap_1_1_remap_state_provider.html#a3bc69436a6a6ccb60878dc79c50e47d0">num_states_postprocess</a>()&gt;0) {</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;      m_np1 = np1;</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;      Kokkos::parallel_for(<span class="stringliteral">&quot;Post-process states&quot;</span>,m_policy_post,*<span class="keyword">this</span>);</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;      ExecSpace::impl_static_fence();</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    }</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;  }</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160; </div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;  KOKKOS_INLINE_FUNCTION</div>
<div class="line"><a name="l00211"></a><span class="lineno"><a class="line" href="struct_homme_1_1_remap_1_1_remap_state_and_thickness_provider_3_01true_01_4.html#a05672ececd50c0120117ee6bcc775ff6">  211</a></span>&#160;  <span class="keywordtype">void</span> operator() (<span class="keyword">const</span> TagPostProcess&amp;,</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;                   <span class="keyword">const</span> <a class="code" href="namespace_homme.html#ae7b6f8cea89941388a32535d02199147">TeamMember</a>&amp; team)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    <a class="code" href="struct_homme_1_1_kernel_variables.html">KernelVariables</a> kv(team, m_tu);</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> istate = kv.<a class="code" href="struct_homme_1_1_kernel_variables.html#a3191a82ad3209763dfd817720ea68ab5">ie</a> % m_state_provider.<a class="code" href="struct_homme_1_1_remap_1_1_remap_state_provider.html#ab1561afafc405dabab07847282e039cd">num_states_preprocess</a>();</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    kv.<a class="code" href="struct_homme_1_1_kernel_variables.html#a3191a82ad3209763dfd817720ea68ab5">ie</a> /= m_state_provider.<a class="code" href="struct_homme_1_1_remap_1_1_remap_state_provider.html#ab1561afafc405dabab07847282e039cd">num_states_preprocess</a>();</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    <span class="keyword">auto</span> <a class="code" href="namespacedcmip2012__test5.html#ad259dec8945b10d8b2c6226e53589de5">dp</a> = <a class="code" href="namespace_homme.html#a2fb615d1c0ef9769f9fe6ff030f5af5e">Homme::subview</a>(m_tgt_layer_thickness,kv.<a class="code" href="struct_homme_1_1_kernel_variables.html#a3191a82ad3209763dfd817720ea68ab5">ie</a>);</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    m_state_provider.<a class="code" href="struct_homme_1_1_remap_1_1_remap_state_provider.html#a89e19c74590408ee375fbd4b201d064c">postprocess_state</a>(kv,istate,m_np1,<a class="code" href="namespacedcmip2012__test5.html#ad259dec8945b10d8b2c6226e53589de5">dp</a>);</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    team.team_barrier();</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;  }</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160; </div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;  KOKKOS_INLINE_FUNCTION</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;  <a class="code" href="namespace_homme.html#ab890b69860872d32c6a3173f53674505">ExecViewUnmanaged&lt;Scalar[NP][NP][NUM_LEV]&gt;</a></div>
<div class="line"><a name="l00223"></a><span class="lineno"><a class="line" href="struct_homme_1_1_remap_1_1_remap_state_and_thickness_provider_3_01true_01_4.html#a59f16ef12dcba437af2f0e45bdedbe49">  223</a></span>&#160;  <a class="code" href="struct_homme_1_1_remap_1_1_remap_state_and_thickness_provider_3_01true_01_4.html#a59f16ef12dcba437af2f0e45bdedbe49">get_state</a>(<span class="keyword">const</span> <a class="code" href="struct_homme_1_1_kernel_variables.html">KernelVariables</a> &amp;kv, <span class="keywordtype">int</span> np1, <span class="keywordtype">int</span> var)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    <span class="keywordflow">return</span> m_state_provider.<a class="code" href="struct_homme_1_1_remap_1_1_remap_state_provider.html#a4a634b2b5e002348fa68f5922dcf342d">get_state</a>(kv,np1,var);</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;  } </div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160; </div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;  KOKKOS_INLINE_FUNCTION</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;  <a class="code" href="namespace_homme.html#ab890b69860872d32c6a3173f53674505">ExecViewUnmanaged&lt;Scalar[NP][NP][NUM_LEV]&gt;</a></div>
<div class="line"><a name="l00229"></a><span class="lineno"><a class="line" href="struct_homme_1_1_remap_1_1_remap_state_and_thickness_provider_3_01true_01_4.html#a0dcba22c7a38542fe4ea0bfce833b029">  229</a></span>&#160;  <a class="code" href="struct_homme_1_1_remap_1_1_remap_state_and_thickness_provider_3_01true_01_4.html#a0dcba22c7a38542fe4ea0bfce833b029">get_source_thickness</a> (<span class="keyword">const</span> <span class="keywordtype">int</span> ie, <span class="keyword">const</span> <span class="keywordtype">int</span> np1)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespace_homme.html#a2fb615d1c0ef9769f9fe6ff030f5af5e">Homme::subview</a>(m_dp3d, ie, np1);</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;  }</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160; </div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;  KOKKOS_INLINE_FUNCTION</div>
<div class="line"><a name="l00234"></a><span class="lineno"><a class="line" href="struct_homme_1_1_remap_1_1_remap_state_and_thickness_provider_3_01true_01_4.html#abb87f74191a2cd3a826c4956a69ffe2b">  234</a></span>&#160;  <a class="code" href="namespace_homme.html#ab890b69860872d32c6a3173f53674505">ExecViewUnmanaged&lt;const Scalar[NP][NP][NUM_LEV]&gt;</a> <a class="code" href="struct_homme_1_1_remap_1_1_remap_state_and_thickness_provider_3_01true_01_4.html#abb87f74191a2cd3a826c4956a69ffe2b">compute_source_thickness</a>(</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;      <a class="code" href="struct_homme_1_1_kernel_variables.html">KernelVariables</a> &amp;kv, <span class="keyword">const</span> <span class="keywordtype">int</span> np1, <span class="keyword">const</span> <a class="code" href="namespace_homme.html#a8d2ed41bead9ec23a2a8a6c728a9f154">Real</a> <span class="comment">/* dt */</span>,</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;      <a class="code" href="namespace_homme.html#ab890b69860872d32c6a3173f53674505">ExecViewUnmanaged</a>&lt;<span class="keyword">const</span> <a class="code" href="class_kokkos_kernels_1_1_batched_1_1_experimental_1_1_vector.html">Scalar</a>[NP][NP][NUM_LEV]&gt; <span class="comment">/* tgt_layer_thickness */</span>)<span class="keyword"></span></div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;<span class="keyword">      const </span>{</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    <span class="keywordflow">return</span> get_source_thickness(kv.<a class="code" href="struct_homme_1_1_kernel_variables.html#a3191a82ad3209763dfd817720ea68ab5">ie</a>, np1);</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;  }</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;};</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160; </div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;<span class="comment">// This base class serves the purpose of allowing pimp implementation in VerticalRemapManager</span></div>
<div class="line"><a name="l00243"></a><span class="lineno"><a class="line" href="struct_homme_1_1_remap_1_1_remapper.html">  243</a></span>&#160;<span class="keyword">struct </span><a class="code" href="struct_homme_1_1_remap_1_1_remapper.html">Remapper</a> {</div>
<div class="line"><a name="l00244"></a><span class="lineno"><a class="line" href="struct_homme_1_1_remap_1_1_remapper.html#a02ad7140adf654ac4d61bc3ec5bb1028">  244</a></span>&#160;  <span class="keyword">virtual</span> <a class="code" href="struct_homme_1_1_remap_1_1_remapper.html#a02ad7140adf654ac4d61bc3ec5bb1028">~Remapper</a>() {}</div>
<div class="line"><a name="l00245"></a><span class="lineno"><a class="line" href="struct_homme_1_1_remap_1_1_remapper.html#a9c7473ceefaa54e6d59510fbb9fde704">  245</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="struct_homme_1_1_remap_1_1_remapper.html#a9c7473ceefaa54e6d59510fbb9fde704">run_remap</a>(<span class="keywordtype">int</span> np1, <span class="keywordtype">int</span> np1_qdp, <span class="keywordtype">double</span> dt) = 0;</div>
<div class="line"><a name="l00246"></a><span class="lineno"><a class="line" href="struct_homme_1_1_remap_1_1_remapper.html#aae34e3607399c0dc0990861cb438036c">  246</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">int</span> <a class="code" href="struct_homme_1_1_remap_1_1_remapper.html#aae34e3607399c0dc0990861cb438036c">requested_buffer_size</a> () <span class="keyword">const</span> = 0;</div>
<div class="line"><a name="l00247"></a><span class="lineno"><a class="line" href="struct_homme_1_1_remap_1_1_remapper.html#a3dea08e8633edda16fc9acee0b280f79">  247</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="struct_homme_1_1_remap_1_1_remapper.html#a3dea08e8633edda16fc9acee0b280f79">init_buffers</a>(<span class="keyword">const</span> <a class="code" href="struct_homme_1_1_functors_buffers_manager.html">FunctorsBuffersManager</a>&amp; fbm) = 0;</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;};</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160; </div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;<span class="comment">// The Remap functor</span></div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;<span class="keyword">template</span> &lt;<span class="keywordtype">bool</span> nonzero_rsplit,</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;          <span class="keyword">typename</span> RemapType&gt;</div>
<div class="line"><a name="l00253"></a><span class="lineno"><a class="line" href="struct_homme_1_1_remap_1_1_remap_functor.html">  253</a></span>&#160;<span class="keyword">struct </span><a class="code" href="struct_homme_1_1_remap_1_1_remap_functor.html">RemapFunctor</a> : <span class="keyword">public</span> <a class="code" href="struct_homme_1_1_remap_1_1_remapper.html">Remapper</a> {</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160; </div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;  static_assert(std::is_base_of&lt;VertRemapAlg, RemapType&gt;::value,</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;                <span class="stringliteral">&quot;RemapFunctor not given a remap algorithm to use&quot;</span>);</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160; </div>
<div class="line"><a name="l00258"></a><span class="lineno"><a class="line" href="struct_homme_1_1_remap_1_1_remap_functor_1_1_remap_data.html">  258</a></span>&#160;  <span class="keyword">struct </span><a class="code" href="struct_homme_1_1_remap_1_1_remap_functor_1_1_remap_data.html">RemapData</a> {</div>
<div class="line"><a name="l00259"></a><span class="lineno"><a class="line" href="struct_homme_1_1_remap_1_1_remap_functor_1_1_remap_data.html#a59bd34f50052c6d0c3ccff77426bef15">  259</a></span>&#160;    <a class="code" href="struct_homme_1_1_remap_1_1_remap_functor_1_1_remap_data.html#a59bd34f50052c6d0c3ccff77426bef15">RemapData</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> qsize_in) : <a class="code" href="namespacedimensions__mod.html#a0070848a40ac48379601d9a8a183c83b">qsize</a>(qsize_in) {}</div>
<div class="line"><a name="l00260"></a><span class="lineno"><a class="line" href="struct_homme_1_1_remap_1_1_remap_functor_1_1_remap_data.html#ab141b5857ebef14e953acbe53a0271bd">  260</a></span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="struct_homme_1_1_remap_1_1_remap_functor_1_1_remap_data.html#ab141b5857ebef14e953acbe53a0271bd">qsize</a>;</div>
<div class="line"><a name="l00261"></a><span class="lineno"><a class="line" href="struct_homme_1_1_remap_1_1_remap_functor_1_1_remap_data.html#adb2442e8ae1d1179175f7c9bffc7541b">  261</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="struct_homme_1_1_remap_1_1_remap_functor_1_1_remap_data.html#adb2442e8ae1d1179175f7c9bffc7541b">np1</a>;</div>
<div class="line"><a name="l00262"></a><span class="lineno"><a class="line" href="struct_homme_1_1_remap_1_1_remap_functor_1_1_remap_data.html#a9234476d21062fedbba1a193dd51e82d">  262</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="struct_homme_1_1_remap_1_1_remap_functor_1_1_remap_data.html#a9234476d21062fedbba1a193dd51e82d">np1_qdp</a>;</div>
<div class="line"><a name="l00263"></a><span class="lineno"><a class="line" href="struct_homme_1_1_remap_1_1_remap_functor_1_1_remap_data.html#ab146ae7645ff19b901984ddc21b5db7e">  263</a></span>&#160;    <a class="code" href="namespace_homme.html#a8d2ed41bead9ec23a2a8a6c728a9f154">Real</a> <a class="code" href="struct_homme_1_1_remap_1_1_remap_functor_1_1_remap_data.html#ab146ae7645ff19b901984ddc21b5db7e">dt</a>;</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;  };</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160; </div>
<div class="line"><a name="l00266"></a><span class="lineno"><a class="line" href="struct_homme_1_1_remap_1_1_remap_functor.html#a0c498e05a9f1ecfef4a9508811be6eda">  266</a></span>&#160;  <a class="code" href="struct_homme_1_1_remap_1_1_remap_functor_1_1_remap_data.html">RemapData</a> <a class="code" href="struct_homme_1_1_remap_1_1_remap_functor.html#a0c498e05a9f1ecfef4a9508811be6eda">m_data</a>;</div>
<div class="line"><a name="l00267"></a><span class="lineno"><a class="line" href="struct_homme_1_1_remap_1_1_remap_functor.html#a8aa2a7093f1e2416b468e433f0a7a419">  267</a></span>&#160;  <a class="code" href="struct_homme_1_1_remap_1_1_remap_state_and_thickness_provider.html">RemapStateAndThicknessProvider&lt;nonzero_rsplit&gt;</a> <a class="code" href="struct_homme_1_1_remap_1_1_remap_functor.html#a8aa2a7093f1e2416b468e433f0a7a419">m_fields_provider</a>;</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160; </div>
<div class="line"><a name="l00269"></a><span class="lineno"><a class="line" href="struct_homme_1_1_remap_1_1_remap_functor.html#a958dc535214d56fec1250b01aed140d8">  269</a></span>&#160;  <span class="keyword">const</span> <a class="code" href="class_homme_1_1_elements_state.html">ElementsState</a> <a class="code" href="struct_homme_1_1_remap_1_1_remap_functor.html#a958dc535214d56fec1250b01aed140d8">m_state</a>;</div>
<div class="line"><a name="l00270"></a><span class="lineno"><a class="line" href="struct_homme_1_1_remap_1_1_remap_functor.html#a6aaf6a4a6828ad1a377314393fc66185">  270</a></span>&#160;  <span class="keyword">const</span> <a class="code" href="class_homme_1_1_hybrid_v_coord.html">HybridVCoord</a> <a class="code" href="struct_homme_1_1_remap_1_1_remap_functor.html#a6aaf6a4a6828ad1a377314393fc66185">m_hvcoord</a>;</div>
<div class="line"><a name="l00271"></a><span class="lineno"><a class="line" href="struct_homme_1_1_remap_1_1_remap_functor.html#addc1352459b65857a2627d356ffac76f">  271</a></span>&#160;  <a class="code" href="namespace_homme.html#ae4e4c236c03960ced6be1fbb557097d1">ExecViewManaged&lt;Scalar*[Q_NUM_TIME_LEVELS][QSIZE_D][NP][NP][NUM_LEV]&gt;</a> <a class="code" href="struct_homme_1_1_remap_1_1_remap_functor.html#addc1352459b65857a2627d356ffac76f">m_qdp</a>;</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160; </div>
<div class="line"><a name="l00273"></a><span class="lineno"><a class="line" href="struct_homme_1_1_remap_1_1_remap_functor.html#ab762bcbb4c0245f05a2a6d9d620ae493">  273</a></span>&#160;  <a class="code" href="namespace_homme.html#ae4e4c236c03960ced6be1fbb557097d1">ExecViewManaged&lt;bool *&gt;</a> <a class="code" href="struct_homme_1_1_remap_1_1_remap_functor.html#ab762bcbb4c0245f05a2a6d9d620ae493">valid_layer_thickness</a>;</div>
<div class="line"><a name="l00274"></a><span class="lineno"><a class="line" href="struct_homme_1_1_remap_1_1_remap_functor.html#acd31969e23b1aacec82484d7e116161d">  274</a></span>&#160;  <span class="keyword">typename</span> decltype(valid_layer_thickness)::HostMirror host_valid_input;</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160; </div>
<div class="line"><a name="l00276"></a><span class="lineno"><a class="line" href="struct_homme_1_1_remap_1_1_remap_functor.html#a4656ff7dc4c2c05ad35b62360a588091">  276</a></span>&#160;  RemapType <a class="code" href="struct_homme_1_1_remap_1_1_remap_functor.html#a4656ff7dc4c2c05ad35b62360a588091">m_remap</a>;</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160; </div>
<div class="line"><a name="l00278"></a><span class="lineno"><a class="line" href="struct_homme_1_1_remap_1_1_remap_functor.html#a1fe2db83bc52f42e2b198b82a8cd456e">  278</a></span>&#160;  <a class="code" href="class_homme_1_1_team_utils.html">TeamUtils&lt;ExecSpace&gt;</a> <a class="code" href="struct_homme_1_1_remap_1_1_remap_functor.html#a1fe2db83bc52f42e2b198b82a8cd456e">m_tu_ne</a>, m_tu_ne_nsr, m_tu_ne_ntr;</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160; </div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;  <span class="keyword">explicit</span></div>
<div class="line"><a name="l00281"></a><span class="lineno"><a class="line" href="struct_homme_1_1_remap_1_1_remap_functor.html#af5e34b730423445396a7f14f84a8b568">  281</a></span>&#160;  <a class="code" href="struct_homme_1_1_remap_1_1_remap_functor.html#af5e34b730423445396a7f14f84a8b568">RemapFunctor</a> (<span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="namespacedimensions__mod.html#a0070848a40ac48379601d9a8a183c83b">qsize</a>,</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;                <span class="keyword">const</span> <a class="code" href="class_homme_1_1_elements.html">Elements</a>&amp; elements,</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;                <span class="keyword">const</span> <a class="code" href="struct_homme_1_1_tracers.html">Tracers</a>&amp; tracers,</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;                <span class="keyword">const</span> <a class="code" href="class_homme_1_1_hybrid_v_coord.html">HybridVCoord</a> &amp;hvcoord)</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;   : m_data(<a class="code" href="namespacedimensions__mod.html#a0070848a40ac48379601d9a8a183c83b">qsize</a>)</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;   , m_fields_provider(elements)</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;   , m_state(elements.m_state)</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;   , m_hvcoord(hvcoord)</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;   , m_qdp(tracers.qdp)</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;   , m_remap(elements.num_elems(), this-&gt;num_to_remap())</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;   <span class="comment">// Functor tags are irrelevant below</span></div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;   , m_tu_ne(remap_team_policy&lt;<a class="code" href="struct_homme_1_1_remap_1_1_remap_functor_1_1_compute_thickness_tag.html">ComputeThicknessTag</a>&gt;(m_state.num_elems()))</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;   , m_tu_ne_nsr(remap_team_policy&lt;<a class="code" href="struct_homme_1_1_remap_1_1_remap_functor_1_1_compute_thickness_tag.html">ComputeThicknessTag</a>&gt;(m_state.num_elems() * m_fields_provider.num_states_remap()))</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;   , m_tu_ne_ntr(remap_team_policy&lt;<a class="code" href="struct_homme_1_1_remap_1_1_remap_functor_1_1_compute_thickness_tag.html">ComputeThicknessTag</a>&gt;(m_state.num_elems() * num_to_remap()))</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;  {</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    <span class="comment">// Members used for sanity checks</span></div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    valid_layer_thickness = decltype(valid_layer_thickness)(<span class="stringliteral">&quot;Check for whether the surface thicknesses are positive&quot;</span>,elements.<a class="code" href="class_homme_1_1_elements.html#a8eb3fc53ab98b7fca48a25307c43f6c7">num_elems</a>());</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    host_valid_input = Kokkos::create_mirror_view(valid_layer_thickness);</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;  }</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160; </div>
<div class="line"><a name="l00301"></a><span class="lineno"><a class="line" href="struct_homme_1_1_remap_1_1_remap_functor.html#aabf3d2b7fd7b70cad43e9c1888fa0d17">  301</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="struct_homme_1_1_remap_1_1_remap_functor.html#aabf3d2b7fd7b70cad43e9c1888fa0d17">input_valid_assert</a>() {</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    Kokkos::deep_copy(host_valid_input, valid_layer_thickness);</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ie = 0; ie &lt; m_state.<a class="code" href="class_homme_1_1_elements_state.html#a6d0a69517ec68a39521545acebccc7fb">num_elems</a>(); ++ie) {</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;      <span class="keywordflow">if</span> (host_valid_input(ie) == <span class="keyword">false</span>) {</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;        <a class="code" href="namespace_homme_1_1_errors.html#a481b959a321e831e95ea777bc86a5b10">Errors::runtime_abort</a>(<span class="stringliteral">&quot;Negative (or nan) layer thickness detected, aborting!&quot;</span>,</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;                              Errors::err_negative_layer_thickness);</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;      }</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    }</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;  }</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160; </div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;  KOKKOS_INLINE_FUNCTION</div>
<div class="line"><a name="l00312"></a><span class="lineno"><a class="line" href="struct_homme_1_1_remap_1_1_remap_functor.html#a255291a6c0473878f96c1a55410fa6f6">  312</a></span>&#160;  <span class="keywordtype">int</span> <a class="code" href="struct_homme_1_1_remap_1_1_remap_functor.html#a255291a6c0473878f96c1a55410fa6f6">num_to_remap</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> m_fields_provider.num_states_remap() + m_data.<a class="code" href="struct_homme_1_1_remap_1_1_remap_functor_1_1_remap_data.html#ab141b5857ebef14e953acbe53a0271bd">qsize</a>; }</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160; </div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;  KOKKOS_INLINE_FUNCTION</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;  <a class="code" href="namespace_homme.html#ab890b69860872d32c6a3173f53674505">ExecViewUnmanaged&lt;Scalar[NP][NP][NUM_LEV]&gt;</a></div>
<div class="line"><a name="l00316"></a><span class="lineno"><a class="line" href="struct_homme_1_1_remap_1_1_remap_functor.html#a0ad33fe82082c0ac934c2e06741d82ba">  316</a></span>&#160;  <a class="code" href="struct_homme_1_1_remap_1_1_remap_functor.html#a0ad33fe82082c0ac934c2e06741d82ba">get_remap_val</a>(<span class="keyword">const</span> <a class="code" href="struct_homme_1_1_kernel_variables.html">KernelVariables</a> &amp;kv, <span class="keywordtype">int</span> var)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    <span class="keywordflow">if</span> (!nonzero_rsplit || var &gt;= m_fields_provider.num_states_remap()) {</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;      <span class="keywordflow">if</span> (var &gt;= m_fields_provider.num_states_remap())</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;        var -= m_fields_provider.num_states_remap();</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="namespace_homme.html#a2fb615d1c0ef9769f9fe6ff030f5af5e">Homme::subview</a>(m_qdp, kv.<a class="code" href="struct_homme_1_1_kernel_variables.html#a3191a82ad3209763dfd817720ea68ab5">ie</a>, m_data.<a class="code" href="struct_homme_1_1_remap_1_1_remap_functor_1_1_remap_data.html#a9234476d21062fedbba1a193dd51e82d">np1_qdp</a>, var);</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;      <span class="keywordflow">return</span> m_fields_provider.get_state(kv, m_data.<a class="code" href="struct_homme_1_1_remap_1_1_remap_functor_1_1_remap_data.html#adb2442e8ae1d1179175f7c9bffc7541b">np1</a>, var);</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    }</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;  }</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160; </div>
<div class="line"><a name="l00326"></a><span class="lineno"><a class="line" href="struct_homme_1_1_remap_1_1_remap_functor_1_1_compute_thickness_tag.html">  326</a></span>&#160;  <span class="keyword">struct </span><a class="code" href="struct_homme_1_1_remap_1_1_remap_functor_1_1_compute_thickness_tag.html">ComputeThicknessTag</a> {};</div>
<div class="line"><a name="l00327"></a><span class="lineno"><a class="line" href="struct_homme_1_1_remap_1_1_remap_functor_1_1_compute_grids_tag.html">  327</a></span>&#160;  <span class="keyword">struct </span><a class="code" href="struct_homme_1_1_remap_1_1_remap_functor_1_1_compute_grids_tag.html">ComputeGridsTag</a> {};</div>
<div class="line"><a name="l00328"></a><span class="lineno"><a class="line" href="struct_homme_1_1_remap_1_1_remap_functor_1_1_compute_remap_tag.html">  328</a></span>&#160;  <span class="keyword">struct </span><a class="code" href="struct_homme_1_1_remap_1_1_remap_functor_1_1_compute_remap_tag.html">ComputeRemapTag</a> {};</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;  <span class="comment">// Computes the extrinsic values of the states in the initial map</span></div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;  <span class="comment">// i.e. velocity -&gt; momentum</span></div>
<div class="line"><a name="l00331"></a><span class="lineno"><a class="line" href="struct_homme_1_1_remap_1_1_remap_functor_1_1_compute_extrinsics_tag.html">  331</a></span>&#160;  <span class="keyword">struct </span><a class="code" href="struct_homme_1_1_remap_1_1_remap_functor_1_1_compute_extrinsics_tag.html">ComputeExtrinsicsTag</a> {};</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;  <span class="comment">// Computes the intrinsic values of the states in the final map</span></div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;  <span class="comment">// i.e. momentum -&gt; velocity</span></div>
<div class="line"><a name="l00334"></a><span class="lineno"><a class="line" href="struct_homme_1_1_remap_1_1_remap_functor_1_1_compute_intrinsics_tag.html">  334</a></span>&#160;  <span class="keyword">struct </span><a class="code" href="struct_homme_1_1_remap_1_1_remap_functor_1_1_compute_intrinsics_tag.html">ComputeIntrinsicsTag</a> {};</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;  <span class="comment">// Sets dp to the target dp in the state</span></div>
<div class="line"><a name="l00336"></a><span class="lineno"><a class="line" href="struct_homme_1_1_remap_1_1_remap_functor_1_1_update_thickness_tag.html">  336</a></span>&#160;  <span class="keyword">struct </span><a class="code" href="struct_homme_1_1_remap_1_1_remap_functor_1_1_update_thickness_tag.html">UpdateThicknessTag</a> {};</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160; </div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;  KOKKOS_INLINE_FUNCTION</div>
<div class="line"><a name="l00339"></a><span class="lineno"><a class="line" href="struct_homme_1_1_remap_1_1_remap_functor.html#a3b9cc0030c92ab5889ff5e609a88df93">  339</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="struct_homme_1_1_remap_1_1_remap_functor.html#a3b9cc0030c92ab5889ff5e609a88df93">operator()</a>(<a class="code" href="struct_homme_1_1_remap_1_1_remap_functor_1_1_compute_thickness_tag.html">ComputeThicknessTag</a>, <span class="keyword">const</span> <a class="code" href="namespace_homme.html#ae7b6f8cea89941388a32535d02199147">TeamMember</a> &amp;team)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    <a class="code" href="struct_homme_1_1_kernel_variables.html">KernelVariables</a> kv(team, m_tu_ne);</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    m_hvcoord.<a class="code" href="class_homme_1_1_hybrid_v_coord.html#adf54b60e104057c3b0c7d584e26a3d1d">compute_ps_ref_from_dp</a>(kv, <a class="code" href="namespace_homme.html#a2fb615d1c0ef9769f9fe6ff030f5af5e">Homme::subview</a>(m_state.<a class="code" href="class_homme_1_1_elements_state.html#abaceb199362f44be6f65fad0412aa4f7">m_dp3d</a>, kv.<a class="code" href="struct_homme_1_1_kernel_variables.html#a3191a82ad3209763dfd817720ea68ab5">ie</a>, m_data.<a class="code" href="struct_homme_1_1_remap_1_1_remap_functor_1_1_remap_data.html#adb2442e8ae1d1179175f7c9bffc7541b">np1</a>),</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;                                         <a class="code" href="namespace_homme.html#a2fb615d1c0ef9769f9fe6ff030f5af5e">Homme::subview</a>(m_state.<a class="code" href="class_homme_1_1_elements_state.html#a073eefceb5c79269fed7a848d2bdd8d2">m_ps_v</a>, kv.<a class="code" href="struct_homme_1_1_kernel_variables.html#a3191a82ad3209763dfd817720ea68ab5">ie</a>, m_data.<a class="code" href="struct_homme_1_1_remap_1_1_remap_functor_1_1_remap_data.html#adb2442e8ae1d1179175f7c9bffc7541b">np1</a>));</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160; </div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    <span class="keyword">auto</span> tgt_layer_thickness = compute_target_thickness(kv);</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    <span class="keyword">auto</span> src_layer_thickness = m_fields_provider.compute_source_thickness(kv, m_data.<a class="code" href="struct_homme_1_1_remap_1_1_remap_functor_1_1_remap_data.html#adb2442e8ae1d1179175f7c9bffc7541b">np1</a>, m_data.<a class="code" href="struct_homme_1_1_remap_1_1_remap_functor_1_1_remap_data.html#ab146ae7645ff19b901984ddc21b5db7e">dt</a>, tgt_layer_thickness);</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    check_source_thickness(kv, src_layer_thickness);</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;  }</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160; </div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;  KOKKOS_INLINE_FUNCTION</div>
<div class="line"><a name="l00350"></a><span class="lineno"><a class="line" href="struct_homme_1_1_remap_1_1_remap_functor.html#a44ea1247f5410ff0699c026e5b471ef0">  350</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="struct_homme_1_1_remap_1_1_remap_functor.html#a44ea1247f5410ff0699c026e5b471ef0">operator()</a>(<a class="code" href="struct_homme_1_1_remap_1_1_remap_functor_1_1_compute_extrinsics_tag.html">ComputeExtrinsicsTag</a>, <span class="keyword">const</span> <a class="code" href="namespace_homme.html#ae7b6f8cea89941388a32535d02199147">TeamMember</a> &amp;team)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    <a class="code" href="struct_homme_1_1_kernel_variables.html">KernelVariables</a> kv(team, m_tu_ne_nsr);</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160; </div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    assert(m_fields_provider.num_states_remap() &gt; 0);</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> den = (m_fields_provider.num_states_remap() &gt; 0) ? m_fields_provider.num_states_remap() : 1;</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> var = kv.<a class="code" href="struct_homme_1_1_kernel_variables.html#a3191a82ad3209763dfd817720ea68ab5">ie</a> % den;</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    kv.<a class="code" href="struct_homme_1_1_kernel_variables.html#a3191a82ad3209763dfd817720ea68ab5">ie</a> /= den;</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    assert(kv.<a class="code" href="struct_homme_1_1_kernel_variables.html#a3191a82ad3209763dfd817720ea68ab5">ie</a> &lt; m_state.<a class="code" href="class_homme_1_1_elements_state.html#a6d0a69517ec68a39521545acebccc7fb">num_elems</a>());</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160; </div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    <span class="keywordflow">if</span> (m_fields_provider.is_intrinsic_state(var)) {</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;      <span class="keyword">auto</span> src_layer_thickness = m_fields_provider.get_source_thickness(kv.<a class="code" href="struct_homme_1_1_kernel_variables.html#a3191a82ad3209763dfd817720ea68ab5">ie</a>, m_data.<a class="code" href="struct_homme_1_1_remap_1_1_remap_functor_1_1_remap_data.html#adb2442e8ae1d1179175f7c9bffc7541b">np1</a>);</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;      compute_extrinsic_state(</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;          kv, src_layer_thickness,</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;          m_fields_provider.get_state(kv, m_data.<a class="code" href="struct_homme_1_1_remap_1_1_remap_functor_1_1_remap_data.html#adb2442e8ae1d1179175f7c9bffc7541b">np1</a>, var));</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;    }</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;  }</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160; </div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;  <span class="comment">// This functor is the only one guaranteed to be run</span></div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;  <span class="comment">// (in rare cases, no tracers and rsplit==0),</span></div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;  <span class="comment">// so it needs to be separated from the others to reduce latency on the GPU</span></div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;  KOKKOS_INLINE_FUNCTION</div>
<div class="line"><a name="l00371"></a><span class="lineno"><a class="line" href="struct_homme_1_1_remap_1_1_remap_functor.html#a4b0305b17d69383efeb09145d18bfe37">  371</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="struct_homme_1_1_remap_1_1_remap_functor.html#a4b0305b17d69383efeb09145d18bfe37">operator()</a>(<a class="code" href="struct_homme_1_1_remap_1_1_remap_functor_1_1_compute_grids_tag.html">ComputeGridsTag</a>, <span class="keyword">const</span> <a class="code" href="namespace_homme.html#ae7b6f8cea89941388a32535d02199147">TeamMember</a> &amp;team)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    <a class="code" href="struct_homme_1_1_kernel_variables.html">KernelVariables</a> kv(team, m_tu_ne);</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    m_remap.compute_grids_phase(</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;        kv, m_fields_provider.get_source_thickness(kv.<a class="code" href="struct_homme_1_1_kernel_variables.html#a3191a82ad3209763dfd817720ea68ab5">ie</a>, m_data.<a class="code" href="struct_homme_1_1_remap_1_1_remap_functor_1_1_remap_data.html#adb2442e8ae1d1179175f7c9bffc7541b">np1</a>),</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;        <a class="code" href="namespace_homme.html#a2fb615d1c0ef9769f9fe6ff030f5af5e">Homme::subview</a>(m_fields_provider.m_tgt_layer_thickness, kv.<a class="code" href="struct_homme_1_1_kernel_variables.html#a3191a82ad3209763dfd817720ea68ab5">ie</a>));</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;  }</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160; </div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;  <span class="comment">// This asserts if num_to_remap() == 0</span></div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;  KOKKOS_INLINE_FUNCTION</div>
<div class="line"><a name="l00380"></a><span class="lineno"><a class="line" href="struct_homme_1_1_remap_1_1_remap_functor.html#a3e00e92b281ed7f5c80d45bc0392a3b7">  380</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="struct_homme_1_1_remap_1_1_remap_functor.html#a3e00e92b281ed7f5c80d45bc0392a3b7">operator()</a>(<a class="code" href="struct_homme_1_1_remap_1_1_remap_functor_1_1_compute_remap_tag.html">ComputeRemapTag</a>, <span class="keyword">const</span> <a class="code" href="namespace_homme.html#ae7b6f8cea89941388a32535d02199147">TeamMember</a> &amp;team)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    <a class="code" href="struct_homme_1_1_kernel_variables.html">KernelVariables</a> kv(team, m_tu_ne_ntr);</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    assert(num_to_remap() != 0);</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> var = kv.<a class="code" href="struct_homme_1_1_kernel_variables.html#a3191a82ad3209763dfd817720ea68ab5">ie</a> % num_to_remap();</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    kv.<a class="code" href="struct_homme_1_1_kernel_variables.html#a3191a82ad3209763dfd817720ea68ab5">ie</a> /= num_to_remap();</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    assert(kv.<a class="code" href="struct_homme_1_1_kernel_variables.html#a3191a82ad3209763dfd817720ea68ab5">ie</a> &lt; m_state.<a class="code" href="class_homme_1_1_elements_state.html#a6d0a69517ec68a39521545acebccc7fb">num_elems</a>());</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160; </div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    this-&gt;m_remap.compute_remap_phase(kv, get_remap_val(kv, var));</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;  }</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160; </div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;  KOKKOS_INLINE_FUNCTION</div>
<div class="line"><a name="l00391"></a><span class="lineno"><a class="line" href="struct_homme_1_1_remap_1_1_remap_functor.html#a0adc1349d228d84bf7aaaaaf84b04bb8">  391</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="struct_homme_1_1_remap_1_1_remap_functor.html#a0adc1349d228d84bf7aaaaaf84b04bb8">operator()</a>(<a class="code" href="struct_homme_1_1_remap_1_1_remap_functor_1_1_compute_intrinsics_tag.html">ComputeIntrinsicsTag</a>, <span class="keyword">const</span> <a class="code" href="namespace_homme.html#ae7b6f8cea89941388a32535d02199147">TeamMember</a> &amp;team)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    <a class="code" href="struct_homme_1_1_kernel_variables.html">KernelVariables</a> kv(team, m_tu_ne_nsr);</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160; </div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;    assert(m_fields_provider.num_states_remap() != 0);</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> den = (m_fields_provider.num_states_remap() &gt; 0) ? m_fields_provider.num_states_remap() : 1;</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> var = kv.<a class="code" href="struct_homme_1_1_kernel_variables.html#a3191a82ad3209763dfd817720ea68ab5">ie</a> % den;</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    kv.<a class="code" href="struct_homme_1_1_kernel_variables.html#a3191a82ad3209763dfd817720ea68ab5">ie</a> /= den;</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    assert(kv.<a class="code" href="struct_homme_1_1_kernel_variables.html#a3191a82ad3209763dfd817720ea68ab5">ie</a> &lt; m_state.<a class="code" href="class_homme_1_1_elements_state.html#a6d0a69517ec68a39521545acebccc7fb">num_elems</a>());</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160; </div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;    <span class="keywordflow">if</span> (m_fields_provider.is_intrinsic_state(var)) {</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;      <span class="keyword">auto</span> tgt_layer_thickness = <a class="code" href="namespace_homme.html#a2fb615d1c0ef9769f9fe6ff030f5af5e">Homme::subview</a>(m_fields_provider.m_tgt_layer_thickness, kv.<a class="code" href="struct_homme_1_1_kernel_variables.html#a3191a82ad3209763dfd817720ea68ab5">ie</a>);</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;      compute_intrinsic_state(kv, tgt_layer_thickness,</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;                              m_fields_provider.get_state(kv, m_data.<a class="code" href="struct_homme_1_1_remap_1_1_remap_functor_1_1_remap_data.html#adb2442e8ae1d1179175f7c9bffc7541b">np1</a>, var));</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    }</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;  }</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160; </div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;  KOKKOS_INLINE_FUNCTION</div>
<div class="line"><a name="l00408"></a><span class="lineno"><a class="line" href="struct_homme_1_1_remap_1_1_remap_functor.html#a057b1135232e78ffb250c983eaea218f">  408</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="struct_homme_1_1_remap_1_1_remap_functor.html#a057b1135232e78ffb250c983eaea218f">operator()</a>(<a class="code" href="struct_homme_1_1_remap_1_1_remap_functor_1_1_update_thickness_tag.html">UpdateThicknessTag</a>, <span class="keyword">const</span> <span class="keywordtype">int</span> idx)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> ie   =  idx / (NP*NP*NUM_LEV);</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> igp  = (idx / (NP*NUM_LEV)) % NP;</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> jgp  = (idx / NUM_LEV) % NP;</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> ilev =  idx % NUM_LEV;</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160; </div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;    m_state.<a class="code" href="class_homme_1_1_elements_state.html#abaceb199362f44be6f65fad0412aa4f7">m_dp3d</a>(ie,m_data.<a class="code" href="struct_homme_1_1_remap_1_1_remap_functor_1_1_remap_data.html#adb2442e8ae1d1179175f7c9bffc7541b">np1</a>,igp,jgp,ilev) = m_fields_provider.m_tgt_layer_thickness(ie,igp,jgp,ilev);</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;  }</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160; </div>
<div class="line"><a name="l00417"></a><span class="lineno"><a class="line" href="struct_homme_1_1_remap_1_1_remap_functor.html#a9d7c3ef03e8db442c76623da2f63f516">  417</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="struct_homme_1_1_remap_1_1_remap_functor.html#a9d7c3ef03e8db442c76623da2f63f516">run_remap</a>(<span class="keywordtype">int</span> np1, <span class="keywordtype">int</span> np1_qdp, <span class="keywordtype">double</span> dt)<span class="keyword"> override </span>{</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    m_data.<a class="code" href="struct_homme_1_1_remap_1_1_remap_functor_1_1_remap_data.html#adb2442e8ae1d1179175f7c9bffc7541b">np1</a> = np1;</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    m_data.<a class="code" href="struct_homme_1_1_remap_1_1_remap_functor_1_1_remap_data.html#a9234476d21062fedbba1a193dd51e82d">np1_qdp</a> = np1_qdp;</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    m_data.<a class="code" href="struct_homme_1_1_remap_1_1_remap_functor_1_1_remap_data.html#ab146ae7645ff19b901984ddc21b5db7e">dt</a> = dt;</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    run_remap();</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;  }</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160; </div>
<div class="line"><a name="l00424"></a><span class="lineno"><a class="line" href="struct_homme_1_1_remap_1_1_remap_functor.html#a72a6394547311a73257c637ab5acf21a">  424</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="struct_homme_1_1_remap_1_1_remap_functor.html#a72a6394547311a73257c637ab5acf21a">run_remap</a>() {</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    <span class="comment">// This runs the remap algorithm after determining it needs to</span></div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    <span class="comment">// It also verifies the state of the simulation is valid</span></div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    <span class="comment">// If there&#39;s nothing to remap, it will only perform the verification</span></div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    run_functor&lt;ComputeThicknessTag&gt;(<span class="stringliteral">&quot;Remap Thickness Functor&quot;</span>,</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;                                     this-&gt;m_state.<a class="code" href="class_homme_1_1_elements_state.html#a6d0a69517ec68a39521545acebccc7fb">num_elems</a>());</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;    this-&gt;input_valid_assert();</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;    <span class="keywordflow">if</span> (num_to_remap() &gt; 0) {</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;      <span class="comment">// We don&#39;t want the latency of launching an empty kernel</span></div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;      <span class="keywordflow">if</span> (nonzero_rsplit) {</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;        <span class="comment">// Pre-process the states if necessary</span></div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;        m_fields_provider.preprocess_states(m_data.<a class="code" href="struct_homme_1_1_remap_1_1_remap_functor_1_1_remap_data.html#adb2442e8ae1d1179175f7c9bffc7541b">np1</a>);</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160; </div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;        run_functor&lt;ComputeExtrinsicsTag&gt;(<span class="stringliteral">&quot;Remap Scale States Functor&quot;</span>,</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;                                          m_state.<a class="code" href="class_homme_1_1_elements_state.html#a6d0a69517ec68a39521545acebccc7fb">num_elems</a>() * m_fields_provider.num_states_remap());</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;      }</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;      run_functor&lt;ComputeGridsTag&gt;(<span class="stringliteral">&quot;Remap Compute Grids Functor&quot;</span>,</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;                                   m_state.<a class="code" href="class_homme_1_1_elements_state.html#a6d0a69517ec68a39521545acebccc7fb">num_elems</a>());</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;      run_functor&lt;ComputeRemapTag&gt;(<span class="stringliteral">&quot;Remap Compute Remap Functor&quot;</span>,</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;                                   m_state.<a class="code" href="class_homme_1_1_elements_state.html#a6d0a69517ec68a39521545acebccc7fb">num_elems</a>() * num_to_remap());</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;      <span class="keywordflow">if</span> (nonzero_rsplit) {</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;        run_functor&lt;ComputeIntrinsicsTag&gt;(<span class="stringliteral">&quot;Remap Rescale States Functor&quot;</span>,</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;                                          m_state.<a class="code" href="class_homme_1_1_elements_state.html#a6d0a69517ec68a39521545acebccc7fb">num_elems</a>() * m_fields_provider.num_states_remap());</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;        m_fields_provider.postprocess_states(m_data.<a class="code" href="struct_homme_1_1_remap_1_1_remap_functor_1_1_remap_data.html#adb2442e8ae1d1179175f7c9bffc7541b">np1</a>);</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;      }</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;    }</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160; </div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;    <span class="keyword">auto</span> update_dp_policy = Kokkos::RangePolicy&lt;ExecSpace,UpdateThicknessTag&gt;(0,m_state.<a class="code" href="class_homme_1_1_elements_state.html#a6d0a69517ec68a39521545acebccc7fb">num_elems</a>()*NP*NP*NUM_LEV);</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;    Kokkos::parallel_for(update_dp_policy, *<span class="keyword">this</span>);</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;  }</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160; </div>
<div class="line"><a name="l00455"></a><span class="lineno"><a class="line" href="struct_homme_1_1_remap_1_1_remap_functor.html#adc87f31f5925e0a44fc46487cb132935">  455</a></span>&#160;  <span class="keywordtype">int</span> <a class="code" href="struct_homme_1_1_remap_1_1_remap_functor.html#adc87f31f5925e0a44fc46487cb132935">requested_buffer_size</a> ()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;    <span class="keywordflow">return</span> m_fields_provider.requested_buffer_size();</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;  }</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160; </div>
<div class="line"><a name="l00459"></a><span class="lineno"><a class="line" href="struct_homme_1_1_remap_1_1_remap_functor.html#ababb88c14b26da94606961b828ed3722">  459</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="struct_homme_1_1_remap_1_1_remap_functor.html#ababb88c14b26da94606961b828ed3722">init_buffers</a>(<span class="keyword">const</span> <a class="code" href="struct_homme_1_1_functors_buffers_manager.html">FunctorsBuffersManager</a>&amp; fbm) {</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    m_fields_provider.init_buffers(fbm);</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;  }</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160; </div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;<span class="keyword">private</span>:</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> FunctorTag&gt;</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;  <span class="keyword">typename</span> std::enable_if&lt;OnGpu&lt;ExecSpace&gt;::value == <span class="keyword">false</span>,</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;                          Kokkos::TeamPolicy&lt;ExecSpace, FunctorTag&gt; &gt;::type</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;  remap_team_policy(<span class="keywordtype">int</span> num_exec) {</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;    <span class="keywordflow">return</span> Homme::get_default_team_policy&lt;ExecSpace, FunctorTag&gt;(num_exec);</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;  }</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160; </div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> FunctorTag&gt;</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;  <span class="keyword">typename</span> std::enable_if&lt;OnGpu&lt;ExecSpace&gt;::value == <span class="keyword">true</span>,</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;                          Kokkos::TeamPolicy&lt;ExecSpace, FunctorTag&gt; &gt;::type</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;  remap_team_policy(<span class="keywordtype">int</span> num_exec) {</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;    constexpr <span class="keywordtype">int</span> num_threads = 16;</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;    constexpr <span class="keywordtype">int</span> num_vectors = 32;</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;    <span class="keywordflow">return</span> Kokkos::TeamPolicy&lt;ExecSpace, FunctorTag&gt;(num_exec, num_threads,</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;                                                     num_vectors);</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;  }</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160; </div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> FunctorTag&gt;</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;  <span class="keywordtype">void</span> run_functor(<span class="keyword">const</span> std::string functor_name, <span class="keywordtype">int</span> num_exec) {</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span> policy = remap_team_policy&lt;FunctorTag&gt;(num_exec);</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;    <span class="comment">// Timers don&#39;t work on CUDA, so place them here</span></div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;    GPTLstart(functor_name.c_str());</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;    <a class="code" href="profiling_8hpp.html#a534139baa2b701f650ec97ac7e13adc8">profiling_resume</a>();</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    Kokkos::parallel_for(<span class="stringliteral">&quot;vertical remap&quot;</span>, policy, *<span class="keyword">this</span>);</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;    ExecSpace::impl_static_fence();</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;    <a class="code" href="profiling_8hpp.html#ad1b2926a5bdc322f0776d9ad02549552">profiling_pause</a>();</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;    GPTLstop(functor_name.c_str());</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;  }</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160; </div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;  KOKKOS_INLINE_FUNCTION</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;  <span class="keywordtype">void</span> compute_extrinsic_state(</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;      KernelVariables &amp;kv,</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;      <a class="code" href="namespace_homme.html#ab890b69860872d32c6a3173f53674505">ExecViewUnmanaged</a>&lt;<span class="keyword">const</span> <a class="code" href="namespace_homme.html#a14cb237a09aa2cdfd9095a8d3b048092">Scalar</a>[NP][NP][NUM_LEV]&gt; src_layer_thickness,</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;      <a class="code" href="namespace_homme.html#ab890b69860872d32c6a3173f53674505">ExecViewUnmanaged</a>&lt;<a class="code" href="namespace_homme.html#a14cb237a09aa2cdfd9095a8d3b048092">Scalar</a>[NP][NP][NUM_LEV]&gt; state_remap)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;    Kokkos::parallel_for(Kokkos::TeamThreadRange(kv.team, NP * NP),</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;                         [&amp;](<span class="keyword">const</span> <span class="keywordtype">int</span> &amp;loop_idx) {</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;      const int igp = loop_idx / NP;</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;      const int jgp = loop_idx % NP;</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;      Kokkos::parallel_for(Kokkos::ThreadVectorRange(kv.team, NUM_LEV),</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;                           [&amp;](const int &amp;ilev) {</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;        state_remap(igp, jgp, ilev) *= src_layer_thickness(igp, jgp, ilev);</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160; </div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;      });</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;    });</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;  }</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160; </div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;  KOKKOS_INLINE_FUNCTION</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;  <span class="keywordtype">void</span> compute_intrinsic_state(</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;      KernelVariables &amp;kv,</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;      <a class="code" href="namespace_homme.html#ab890b69860872d32c6a3173f53674505">ExecViewUnmanaged</a>&lt;<span class="keyword">const</span> <a class="code" href="namespace_homme.html#a14cb237a09aa2cdfd9095a8d3b048092">Scalar</a>[NP][NP][NUM_LEV]&gt; tgt_layer_thickness,</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;      <a class="code" href="namespace_homme.html#ab890b69860872d32c6a3173f53674505">ExecViewUnmanaged</a>&lt;<a class="code" href="namespace_homme.html#a14cb237a09aa2cdfd9095a8d3b048092">Scalar</a>[NP][NP][NUM_LEV]&gt; state_remap)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;    Kokkos::parallel_for(Kokkos::TeamThreadRange(kv.team, NP * NP),</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;                         [&amp;](<span class="keyword">const</span> <span class="keywordtype">int</span> &amp;loop_idx) {</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;      const int igp = loop_idx / NP;</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;      const int jgp = loop_idx % NP;</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;      Kokkos::parallel_for(Kokkos::ThreadVectorRange(kv.team, NUM_LEV),</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;                           [&amp;](const int &amp;ilev) {</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;        state_remap(igp, jgp, ilev) /= tgt_layer_thickness(igp, jgp, ilev);</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;      });</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;    });</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;  }</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160; </div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;  KOKKOS_INLINE_FUNCTION ExecViewUnmanaged&lt;const Scalar[NP][NP][NUM_LEV]&gt;</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;  compute_target_thickness(KernelVariables &amp;kv)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;    <span class="keyword">auto</span> tgt_layer_thickness = <a class="code" href="namespace_homme.html#a2fb615d1c0ef9769f9fe6ff030f5af5e">Homme::subview</a>(m_fields_provider.m_tgt_layer_thickness, kv.ie);</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160; </div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;    m_hvcoord.<a class="code" href="class_homme_1_1_hybrid_v_coord.html#a6d21020c3b3abb12c4a777a3bccbe3d3">compute_dp_ref</a>(kv,<a class="code" href="namespace_homme.html#a2fb615d1c0ef9769f9fe6ff030f5af5e">Homme::subview</a>(m_state.<a class="code" href="class_homme_1_1_elements_state.html#a073eefceb5c79269fed7a848d2bdd8d2">m_ps_v</a>,kv.ie,m_data.<a class="code" href="struct_homme_1_1_remap_1_1_remap_functor_1_1_remap_data.html#adb2442e8ae1d1179175f7c9bffc7541b">np1</a>),tgt_layer_thickness);</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160; </div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;    <span class="keywordflow">return</span> tgt_layer_thickness;</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;  }</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160; </div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;  KOKKOS_INLINE_FUNCTION <span class="keywordtype">void</span> check_source_thickness(</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;      KernelVariables &amp;kv,</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;      <a class="code" href="namespace_homme.html#ab890b69860872d32c6a3173f53674505">ExecViewUnmanaged</a>&lt;<span class="keyword">const</span> <a class="code" href="namespace_homme.html#a14cb237a09aa2cdfd9095a8d3b048092">Scalar</a>[NP][NP][NUM_LEV]&gt; src_layer_thickness)<span class="keyword"></span></div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;<span class="keyword">      const </span>{</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;    <span class="comment">// Kokkos parallel reduce doesn&#39;t support bool as a reduction type, so use</span></div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;    <span class="comment">// int instead</span></div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;    <span class="comment">// Reduce starts with false (0), making that the default state</span></div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;    <span class="comment">// If there is an error, this becomes true</span></div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;    <span class="keywordtype">int</span> invalid = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;    Kokkos::parallel_reduce(</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;        Kokkos::TeamThreadRange(kv.team, NP * NP * NUM_PHYSICAL_LEV),</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;        [&amp;](<span class="keyword">const</span> <span class="keywordtype">int</span> &amp;loop_idx, <span class="keywordtype">int</span> &amp;is_invalid) {</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;          const int igp = (loop_idx / NUM_PHYSICAL_LEV) / NP;</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;          const int jgp = (loop_idx / NUM_PHYSICAL_LEV) % NP;</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;          const int level = loop_idx % NUM_PHYSICAL_LEV;</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;          const int ilev = level / VECTOR_SIZE;</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;          const int vlev = level % VECTOR_SIZE;</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;          is_invalid |= Homme::isnan(src_layer_thickness(igp, jgp, ilev)[vlev]);</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;          is_invalid |= (src_layer_thickness(igp, jgp, ilev)[vlev] &lt; 0.0);</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;        },</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;        invalid);</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;    valid_layer_thickness(kv.ie) = !invalid;</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;  }</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;};</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160; </div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;} <span class="comment">// namespace Remap</span></div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;} <span class="comment">// namespace Homme</span></div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160; </div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;<span class="preprocessor">#endif </span><span class="comment">// HOMMEXX_REMAP_FUNCTOR_HPP</span></div>
<div class="ttc" id="a_column_ops_8hpp_html"><div class="ttname"><a href="_column_ops_8hpp.html">ColumnOps.hpp</a></div></div>
<div class="ttc" id="a_elements_8hpp_html"><div class="ttname"><a href="_elements_8hpp.html">Elements.hpp</a></div></div>
<div class="ttc" id="a_error_defs_8hpp_html"><div class="ttname"><a href="_error_defs_8hpp.html">ErrorDefs.hpp</a></div></div>
<div class="ttc" id="a_hybrid_v_coord_8hpp_html"><div class="ttname"><a href="_hybrid_v_coord_8hpp.html">HybridVCoord.hpp</a></div></div>
<div class="ttc" id="a_kernel_variables_8hpp_html"><div class="ttname"><a href="_kernel_variables_8hpp.html">KernelVariables.hpp</a></div></div>
<div class="ttc" id="a_loops_utils_8hpp_html"><div class="ttname"><a href="_loops_utils_8hpp.html">LoopsUtils.hpp</a></div></div>
<div class="ttc" id="a_math_utils_8hpp_html"><div class="ttname"><a href="_math_utils_8hpp.html">MathUtils.hpp</a></div></div>
<div class="ttc" id="a_subview_utils_8hpp_html"><div class="ttname"><a href="_subview_utils_8hpp.html">SubviewUtils.hpp</a></div></div>
<div class="ttc" id="a_sync_utils_8hpp_html"><div class="ttname"><a href="_sync_utils_8hpp.html">SyncUtils.hpp</a></div></div>
<div class="ttc" id="a_tracers_8hpp_html"><div class="ttname"><a href="_tracers_8hpp.html">Tracers.hpp</a></div></div>
<div class="ttc" id="a_types_8hpp_html"><div class="ttname"><a href="_types_8hpp.html">Types.hpp</a></div></div>
<div class="ttc" id="aclass_homme_1_1___team_utils_common_base_html_abee222dbd07f3305af7b96e25dba9c75"><div class="ttname"><a href="class_homme_1_1___team_utils_common_base.html#abee222dbd07f3305af7b96e25dba9c75">Homme::_TeamUtilsCommonBase::get_num_ws_slots</a></div><div class="ttdeci">int get_num_ws_slots() const</div><div class="ttdef"><b>Definition:</b> <a href="kokkos__utils_8hpp_source.html#l00057">kokkos_utils.hpp:57</a></div></div>
<div class="ttc" id="aclass_homme_1_1_elements_html"><div class="ttname"><a href="class_homme_1_1_elements.html">Homme::Elements</a></div><div class="ttdef"><b>Definition:</b> <a href="_elements_8hpp_source.html#l00032">Elements.hpp:32</a></div></div>
<div class="ttc" id="aclass_homme_1_1_elements_html_a45ed484dcba35066f7511ed61d652541"><div class="ttname"><a href="class_homme_1_1_elements.html#a45ed484dcba35066f7511ed61d652541">Homme::Elements::m_state</a></div><div class="ttdeci">ElementsState m_state</div><div class="ttdef"><b>Definition:</b> <a href="_elements_8hpp_source.html#l00036">Elements.hpp:36</a></div></div>
<div class="ttc" id="aclass_homme_1_1_elements_html_a8eb3fc53ab98b7fca48a25307c43f6c7"><div class="ttname"><a href="class_homme_1_1_elements.html#a8eb3fc53ab98b7fca48a25307c43f6c7">Homme::Elements::num_elems</a></div><div class="ttdeci">int num_elems() const</div><div class="ttdef"><b>Definition:</b> <a href="_elements_8hpp_source.html#l00042">Elements.hpp:42</a></div></div>
<div class="ttc" id="aclass_homme_1_1_elements_state_html"><div class="ttname"><a href="class_homme_1_1_elements_state.html">Homme::ElementsState</a></div><div class="ttdef"><b>Definition:</b> <a href="preqx__kokkos_2cxx_2_elements_state_8hpp_source.html#l00017">ElementsState.hpp:17</a></div></div>
<div class="ttc" id="aclass_homme_1_1_elements_state_html_a073eefceb5c79269fed7a848d2bdd8d2"><div class="ttname"><a href="class_homme_1_1_elements_state.html#a073eefceb5c79269fed7a848d2bdd8d2">Homme::ElementsState::m_ps_v</a></div><div class="ttdeci">ExecViewManaged&lt; Real *[NUM_TIME_LEVELS][NP][NP]&gt; m_ps_v</div><div class="ttdef"><b>Definition:</b> <a href="preqx__kokkos_2cxx_2_elements_state_8hpp_source.html#l00026">ElementsState.hpp:26</a></div></div>
<div class="ttc" id="aclass_homme_1_1_elements_state_html_a6d0a69517ec68a39521545acebccc7fb"><div class="ttname"><a href="class_homme_1_1_elements_state.html#a6d0a69517ec68a39521545acebccc7fb">Homme::ElementsState::num_elems</a></div><div class="ttdeci">KOKKOS_INLINE_FUNCTION int num_elems() const</div><div class="ttdef"><b>Definition:</b> <a href="preqx__kokkos_2cxx_2_elements_state_8hpp_source.html#l00043">ElementsState.hpp:43</a></div></div>
<div class="ttc" id="aclass_homme_1_1_elements_state_html_abaceb199362f44be6f65fad0412aa4f7"><div class="ttname"><a href="class_homme_1_1_elements_state.html#abaceb199362f44be6f65fad0412aa4f7">Homme::ElementsState::m_dp3d</a></div><div class="ttdeci">ExecViewManaged&lt; Scalar *[NUM_TIME_LEVELS][NP][NP][NUM_LEV]&gt; m_dp3d</div><div class="ttdef"><b>Definition:</b> <a href="preqx__kokkos_2cxx_2_elements_state_8hpp_source.html#l00024">ElementsState.hpp:24</a></div></div>
<div class="ttc" id="aclass_homme_1_1_hybrid_v_coord_html"><div class="ttname"><a href="class_homme_1_1_hybrid_v_coord.html">Homme::HybridVCoord</a></div><div class="ttdef"><b>Definition:</b> <a href="_hybrid_v_coord_8hpp_source.html#l00019">HybridVCoord.hpp:20</a></div></div>
<div class="ttc" id="aclass_homme_1_1_hybrid_v_coord_html_a6d21020c3b3abb12c4a777a3bccbe3d3"><div class="ttname"><a href="class_homme_1_1_hybrid_v_coord.html#a6d21020c3b3abb12c4a777a3bccbe3d3">Homme::HybridVCoord::compute_dp_ref</a></div><div class="ttdeci">KOKKOS_INLINE_FUNCTION void compute_dp_ref(const KernelVariables &amp;kv, const ExecViewUnmanaged&lt; const Real[NP][NP]&gt; &amp;ps, const ExecViewUnmanaged&lt; Scalar[NP][NP][NUM_LEV]&gt; &amp;dp) const</div><div class="ttdef"><b>Definition:</b> <a href="_hybrid_v_coord_8hpp_source.html#l00066">HybridVCoord.hpp:66</a></div></div>
<div class="ttc" id="aclass_homme_1_1_hybrid_v_coord_html_adf54b60e104057c3b0c7d584e26a3d1d"><div class="ttname"><a href="class_homme_1_1_hybrid_v_coord.html#adf54b60e104057c3b0c7d584e26a3d1d">Homme::HybridVCoord::compute_ps_ref_from_dp</a></div><div class="ttdeci">KOKKOS_INLINE_FUNCTION void compute_ps_ref_from_dp(const KernelVariables &amp;kv, const ExecViewUnmanaged&lt; const Scalar[NP][NP][NUM_LEV]&gt; &amp;dp, const ExecViewUnmanaged&lt; Real[NP][NP]&gt; &amp;ps) const</div><div class="ttdef"><b>Definition:</b> <a href="_hybrid_v_coord_8hpp_source.html#l00099">HybridVCoord.hpp:99</a></div></div>
<div class="ttc" id="aclass_homme_1_1_team_utils_html"><div class="ttname"><a href="class_homme_1_1_team_utils.html">Homme::TeamUtils&lt; ExecSpace &gt;</a></div></div>
<div class="ttc" id="aclass_kokkos_kernels_1_1_batched_1_1_experimental_1_1_vector_html"><div class="ttname"><a href="class_kokkos_kernels_1_1_batched_1_1_experimental_1_1_vector.html">KokkosKernels::Batched::Experimental::Vector&lt; VectorType &gt;</a></div></div>
<div class="ttc" id="anamespace_homme_1_1_errors_html_a481b959a321e831e95ea777bc86a5b10"><div class="ttname"><a href="namespace_homme_1_1_errors.html#a481b959a321e831e95ea777bc86a5b10">Homme::Errors::runtime_abort</a></div><div class="ttdeci">void runtime_abort(const std::string &amp;message, int code)</div><div class="ttdef"><b>Definition:</b> <a href="_error_defs_8cpp_source.html#l00042">ErrorDefs.cpp:42</a></div></div>
<div class="ttc" id="anamespace_homme_html"><div class="ttname"><a href="namespace_homme.html">Homme</a></div><div class="ttdef"><b>Definition:</b> <a href="preqx__kokkos_2cxx_2_caar_functor_impl_8hpp_source.html#l00032">CaarFunctorImpl.hpp:32</a></div></div>
<div class="ttc" id="anamespace_homme_html_a0f0e1a7897b0895773148728d6a74cb1"><div class="ttname"><a href="namespace_homme.html#a0f0e1a7897b0895773148728d6a74cb1">Homme::ExecSpace</a></div><div class="ttdeci">Kokkos::DefaultExecutionSpace::execution_space ExecSpace</div><div class="ttdef"><b>Definition:</b> <a href="_exec_space_defs_8hpp_source.html#l00064">ExecSpaceDefs.hpp:64</a></div></div>
<div class="ttc" id="anamespace_homme_html_a14cb237a09aa2cdfd9095a8d3b048092"><div class="ttname"><a href="namespace_homme.html#a14cb237a09aa2cdfd9095a8d3b048092">Homme::Scalar</a></div><div class="ttdeci">KokkosKernels::Batched::Experimental::Vector&lt; VectorType &gt; Scalar</div><div class="ttdef"><b>Definition:</b> <a href="_types_8hpp_source.html#l00037">Types.hpp:37</a></div></div>
<div class="ttc" id="anamespace_homme_html_a2fb615d1c0ef9769f9fe6ff030f5af5e"><div class="ttname"><a href="namespace_homme.html#a2fb615d1c0ef9769f9fe6ff030f5af5e">Homme::subview</a></div><div class="ttdeci">KOKKOS_INLINE_FUNCTION ViewUnmanaged&lt; ScalarType[DIM1], MemSpace &gt; subview(ViewType&lt; ScalarType *[DIM1], MemSpace, Properties... &gt; v_in, int ie)</div><div class="ttdef"><b>Definition:</b> <a href="_subview_utils_8hpp_source.html#l00025">SubviewUtils.hpp:25</a></div></div>
<div class="ttc" id="anamespace_homme_html_a8d2ed41bead9ec23a2a8a6c728a9f154"><div class="ttname"><a href="namespace_homme.html#a8d2ed41bead9ec23a2a8a6c728a9f154">Homme::Real</a></div><div class="ttdeci">double Real</div><div class="ttdef"><b>Definition:</b> <a href="_types_8hpp_source.html#l00025">Types.hpp:25</a></div></div>
<div class="ttc" id="anamespace_homme_html_ab890b69860872d32c6a3173f53674505"><div class="ttname"><a href="namespace_homme.html#ab890b69860872d32c6a3173f53674505">Homme::ExecViewUnmanaged</a></div><div class="ttdeci">ExecView&lt; DataType, MemoryUnmanaged &gt; ExecViewUnmanaged</div><div class="ttdef"><b>Definition:</b> <a href="_types_8hpp_source.html#l00112">Types.hpp:112</a></div></div>
<div class="ttc" id="anamespace_homme_html_ae4e4c236c03960ced6be1fbb557097d1"><div class="ttname"><a href="namespace_homme.html#ae4e4c236c03960ced6be1fbb557097d1">Homme::ExecViewManaged</a></div><div class="ttdeci">ExecView&lt; DataType, MemoryManaged &gt; ExecViewManaged</div><div class="ttdef"><b>Definition:</b> <a href="_types_8hpp_source.html#l00110">Types.hpp:110</a></div></div>
<div class="ttc" id="anamespace_homme_html_ae7a6813a53e3f9affa8f76c91acaeac3"><div class="ttname"><a href="namespace_homme.html#ae7a6813a53e3f9affa8f76c91acaeac3">Homme::get_default_team_policy</a></div><div class="ttdeci">Kokkos::TeamPolicy&lt; ExecSpace, Tags... &gt; get_default_team_policy(const int num_parallel_iterations, const ThreadPreferences tp=ThreadPreferences())</div><div class="ttdef"><b>Definition:</b> <a href="_exec_space_defs_8hpp_source.html#l00158">ExecSpaceDefs.hpp:158</a></div></div>
<div class="ttc" id="anamespace_homme_html_ae7b6f8cea89941388a32535d02199147"><div class="ttname"><a href="namespace_homme.html#ae7b6f8cea89941388a32535d02199147">Homme::TeamMember</a></div><div class="ttdeci">Kokkos::TeamPolicy&lt; ExecSpace &gt;::member_type TeamMember</div><div class="ttdef"><b>Definition:</b> <a href="_types_8hpp_source.html#l00073">Types.hpp:73</a></div></div>
<div class="ttc" id="anamespacedcmip2012__test5_html_ad259dec8945b10d8b2c6226e53589de5"><div class="ttname"><a href="namespacedcmip2012__test5.html#ad259dec8945b10d8b2c6226e53589de5">dcmip2012_test5::dp</a></div><div class="ttdeci">real(8), parameter dp</div><div class="ttdef"><b>Definition:</b> <a href="dcmip2012__test5_8_f90_source.html#l00055">dcmip2012_test5.F90:55</a></div></div>
<div class="ttc" id="anamespacedimensions__mod_html_a0070848a40ac48379601d9a8a183c83b"><div class="ttname"><a href="namespacedimensions__mod.html#a0070848a40ac48379601d9a8a183c83b">dimensions_mod::qsize</a></div><div class="ttdeci">integer, public qsize</div><div class="ttdef"><b>Definition:</b> <a href="dimensions__mod_8_f90_source.html#l00026">dimensions_mod.F90:26</a></div></div>
<div class="ttc" id="aprofiling_8hpp_html"><div class="ttname"><a href="profiling_8hpp.html">profiling.hpp</a></div></div>
<div class="ttc" id="aprofiling_8hpp_html_a534139baa2b701f650ec97ac7e13adc8"><div class="ttname"><a href="profiling_8hpp.html#a534139baa2b701f650ec97ac7e13adc8">profiling_resume</a></div><div class="ttdeci">#define profiling_resume()</div><div class="ttdef"><b>Definition:</b> <a href="profiling_8hpp_source.html#l00048">profiling.hpp:48</a></div></div>
<div class="ttc" id="aprofiling_8hpp_html_ad1b2926a5bdc322f0776d9ad02549552"><div class="ttname"><a href="profiling_8hpp.html#ad1b2926a5bdc322f0776d9ad02549552">profiling_pause</a></div><div class="ttdeci">#define profiling_pause()</div><div class="ttdef"><b>Definition:</b> <a href="profiling_8hpp_source.html#l00049">profiling.hpp:49</a></div></div>
<div class="ttc" id="astruct_homme_1_1_functors_buffers_manager_html"><div class="ttname"><a href="struct_homme_1_1_functors_buffers_manager.html">Homme::FunctorsBuffersManager</a></div><div class="ttdef"><b>Definition:</b> <a href="_functors_buffers_manager_8hpp_source.html#l00015">FunctorsBuffersManager.hpp:15</a></div></div>
<div class="ttc" id="astruct_homme_1_1_kernel_variables_html"><div class="ttname"><a href="struct_homme_1_1_kernel_variables.html">Homme::KernelVariables</a></div><div class="ttdef"><b>Definition:</b> <a href="_kernel_variables_8hpp_source.html#l00015">KernelVariables.hpp:15</a></div></div>
<div class="ttc" id="astruct_homme_1_1_kernel_variables_html_a3191a82ad3209763dfd817720ea68ab5"><div class="ttname"><a href="struct_homme_1_1_kernel_variables.html#a3191a82ad3209763dfd817720ea68ab5">Homme::KernelVariables::ie</a></div><div class="ttdeci">int ie</div><div class="ttdef"><b>Definition:</b> <a href="_kernel_variables_8hpp_source.html#l00152">KernelVariables.hpp:152</a></div></div>
<div class="ttc" id="astruct_homme_1_1_kernel_variables_html_a7a205f05488de1a2b43e43f282007593"><div class="ttname"><a href="struct_homme_1_1_kernel_variables.html#a7a205f05488de1a2b43e43f282007593">Homme::KernelVariables::team</a></div><div class="ttdeci">const TeamMember &amp; team</div><div class="ttdef"><b>Definition:</b> <a href="_kernel_variables_8hpp_source.html#l00146">KernelVariables.hpp:146</a></div></div>
<div class="ttc" id="astruct_homme_1_1_remap_1_1_remap_functor_1_1_compute_extrinsics_tag_html"><div class="ttname"><a href="struct_homme_1_1_remap_1_1_remap_functor_1_1_compute_extrinsics_tag.html">Homme::Remap::RemapFunctor::ComputeExtrinsicsTag</a></div><div class="ttdef"><b>Definition:</b> <a href="_remap_functor_8hpp_source.html#l00331">RemapFunctor.hpp:331</a></div></div>
<div class="ttc" id="astruct_homme_1_1_remap_1_1_remap_functor_1_1_compute_grids_tag_html"><div class="ttname"><a href="struct_homme_1_1_remap_1_1_remap_functor_1_1_compute_grids_tag.html">Homme::Remap::RemapFunctor::ComputeGridsTag</a></div><div class="ttdef"><b>Definition:</b> <a href="_remap_functor_8hpp_source.html#l00327">RemapFunctor.hpp:327</a></div></div>
<div class="ttc" id="astruct_homme_1_1_remap_1_1_remap_functor_1_1_compute_intrinsics_tag_html"><div class="ttname"><a href="struct_homme_1_1_remap_1_1_remap_functor_1_1_compute_intrinsics_tag.html">Homme::Remap::RemapFunctor::ComputeIntrinsicsTag</a></div><div class="ttdef"><b>Definition:</b> <a href="_remap_functor_8hpp_source.html#l00334">RemapFunctor.hpp:334</a></div></div>
<div class="ttc" id="astruct_homme_1_1_remap_1_1_remap_functor_1_1_compute_remap_tag_html"><div class="ttname"><a href="struct_homme_1_1_remap_1_1_remap_functor_1_1_compute_remap_tag.html">Homme::Remap::RemapFunctor::ComputeRemapTag</a></div><div class="ttdef"><b>Definition:</b> <a href="_remap_functor_8hpp_source.html#l00328">RemapFunctor.hpp:328</a></div></div>
<div class="ttc" id="astruct_homme_1_1_remap_1_1_remap_functor_1_1_compute_thickness_tag_html"><div class="ttname"><a href="struct_homme_1_1_remap_1_1_remap_functor_1_1_compute_thickness_tag.html">Homme::Remap::RemapFunctor::ComputeThicknessTag</a></div><div class="ttdef"><b>Definition:</b> <a href="_remap_functor_8hpp_source.html#l00326">RemapFunctor.hpp:326</a></div></div>
<div class="ttc" id="astruct_homme_1_1_remap_1_1_remap_functor_1_1_remap_data_html"><div class="ttname"><a href="struct_homme_1_1_remap_1_1_remap_functor_1_1_remap_data.html">Homme::Remap::RemapFunctor::RemapData</a></div><div class="ttdef"><b>Definition:</b> <a href="_remap_functor_8hpp_source.html#l00258">RemapFunctor.hpp:258</a></div></div>
<div class="ttc" id="astruct_homme_1_1_remap_1_1_remap_functor_1_1_remap_data_html_a59bd34f50052c6d0c3ccff77426bef15"><div class="ttname"><a href="struct_homme_1_1_remap_1_1_remap_functor_1_1_remap_data.html#a59bd34f50052c6d0c3ccff77426bef15">Homme::Remap::RemapFunctor::RemapData::RemapData</a></div><div class="ttdeci">RemapData(const int qsize_in)</div><div class="ttdef"><b>Definition:</b> <a href="_remap_functor_8hpp_source.html#l00259">RemapFunctor.hpp:259</a></div></div>
<div class="ttc" id="astruct_homme_1_1_remap_1_1_remap_functor_1_1_remap_data_html_a9234476d21062fedbba1a193dd51e82d"><div class="ttname"><a href="struct_homme_1_1_remap_1_1_remap_functor_1_1_remap_data.html#a9234476d21062fedbba1a193dd51e82d">Homme::Remap::RemapFunctor::RemapData::np1_qdp</a></div><div class="ttdeci">int np1_qdp</div><div class="ttdef"><b>Definition:</b> <a href="_remap_functor_8hpp_source.html#l00262">RemapFunctor.hpp:262</a></div></div>
<div class="ttc" id="astruct_homme_1_1_remap_1_1_remap_functor_1_1_remap_data_html_ab141b5857ebef14e953acbe53a0271bd"><div class="ttname"><a href="struct_homme_1_1_remap_1_1_remap_functor_1_1_remap_data.html#ab141b5857ebef14e953acbe53a0271bd">Homme::Remap::RemapFunctor::RemapData::qsize</a></div><div class="ttdeci">const int qsize</div><div class="ttdef"><b>Definition:</b> <a href="_remap_functor_8hpp_source.html#l00260">RemapFunctor.hpp:260</a></div></div>
<div class="ttc" id="astruct_homme_1_1_remap_1_1_remap_functor_1_1_remap_data_html_ab146ae7645ff19b901984ddc21b5db7e"><div class="ttname"><a href="struct_homme_1_1_remap_1_1_remap_functor_1_1_remap_data.html#ab146ae7645ff19b901984ddc21b5db7e">Homme::Remap::RemapFunctor::RemapData::dt</a></div><div class="ttdeci">Real dt</div><div class="ttdef"><b>Definition:</b> <a href="_remap_functor_8hpp_source.html#l00263">RemapFunctor.hpp:263</a></div></div>
<div class="ttc" id="astruct_homme_1_1_remap_1_1_remap_functor_1_1_remap_data_html_adb2442e8ae1d1179175f7c9bffc7541b"><div class="ttname"><a href="struct_homme_1_1_remap_1_1_remap_functor_1_1_remap_data.html#adb2442e8ae1d1179175f7c9bffc7541b">Homme::Remap::RemapFunctor::RemapData::np1</a></div><div class="ttdeci">int np1</div><div class="ttdef"><b>Definition:</b> <a href="_remap_functor_8hpp_source.html#l00261">RemapFunctor.hpp:261</a></div></div>
<div class="ttc" id="astruct_homme_1_1_remap_1_1_remap_functor_1_1_update_thickness_tag_html"><div class="ttname"><a href="struct_homme_1_1_remap_1_1_remap_functor_1_1_update_thickness_tag.html">Homme::Remap::RemapFunctor::UpdateThicknessTag</a></div><div class="ttdef"><b>Definition:</b> <a href="_remap_functor_8hpp_source.html#l00336">RemapFunctor.hpp:336</a></div></div>
<div class="ttc" id="astruct_homme_1_1_remap_1_1_remap_functor_html"><div class="ttname"><a href="struct_homme_1_1_remap_1_1_remap_functor.html">Homme::Remap::RemapFunctor</a></div><div class="ttdef"><b>Definition:</b> <a href="_remap_functor_8hpp_source.html#l00253">RemapFunctor.hpp:253</a></div></div>
<div class="ttc" id="astruct_homme_1_1_remap_1_1_remap_functor_html_a057b1135232e78ffb250c983eaea218f"><div class="ttname"><a href="struct_homme_1_1_remap_1_1_remap_functor.html#a057b1135232e78ffb250c983eaea218f">Homme::Remap::RemapFunctor::operator()</a></div><div class="ttdeci">KOKKOS_INLINE_FUNCTION void operator()(UpdateThicknessTag, const int idx) const</div><div class="ttdef"><b>Definition:</b> <a href="_remap_functor_8hpp_source.html#l00408">RemapFunctor.hpp:408</a></div></div>
<div class="ttc" id="astruct_homme_1_1_remap_1_1_remap_functor_html_a0ad33fe82082c0ac934c2e06741d82ba"><div class="ttname"><a href="struct_homme_1_1_remap_1_1_remap_functor.html#a0ad33fe82082c0ac934c2e06741d82ba">Homme::Remap::RemapFunctor::get_remap_val</a></div><div class="ttdeci">KOKKOS_INLINE_FUNCTION ExecViewUnmanaged&lt; Scalar[NP][NP][NUM_LEV]&gt; get_remap_val(const KernelVariables &amp;kv, int var) const</div><div class="ttdef"><b>Definition:</b> <a href="_remap_functor_8hpp_source.html#l00316">RemapFunctor.hpp:316</a></div></div>
<div class="ttc" id="astruct_homme_1_1_remap_1_1_remap_functor_html_a0adc1349d228d84bf7aaaaaf84b04bb8"><div class="ttname"><a href="struct_homme_1_1_remap_1_1_remap_functor.html#a0adc1349d228d84bf7aaaaaf84b04bb8">Homme::Remap::RemapFunctor::operator()</a></div><div class="ttdeci">KOKKOS_INLINE_FUNCTION void operator()(ComputeIntrinsicsTag, const TeamMember &amp;team) const</div><div class="ttdef"><b>Definition:</b> <a href="_remap_functor_8hpp_source.html#l00391">RemapFunctor.hpp:391</a></div></div>
<div class="ttc" id="astruct_homme_1_1_remap_1_1_remap_functor_html_a0c498e05a9f1ecfef4a9508811be6eda"><div class="ttname"><a href="struct_homme_1_1_remap_1_1_remap_functor.html#a0c498e05a9f1ecfef4a9508811be6eda">Homme::Remap::RemapFunctor::m_data</a></div><div class="ttdeci">RemapData m_data</div><div class="ttdef"><b>Definition:</b> <a href="_remap_functor_8hpp_source.html#l00266">RemapFunctor.hpp:266</a></div></div>
<div class="ttc" id="astruct_homme_1_1_remap_1_1_remap_functor_html_a1fe2db83bc52f42e2b198b82a8cd456e"><div class="ttname"><a href="struct_homme_1_1_remap_1_1_remap_functor.html#a1fe2db83bc52f42e2b198b82a8cd456e">Homme::Remap::RemapFunctor::m_tu_ne</a></div><div class="ttdeci">TeamUtils&lt; ExecSpace &gt; m_tu_ne</div><div class="ttdef"><b>Definition:</b> <a href="_remap_functor_8hpp_source.html#l00278">RemapFunctor.hpp:278</a></div></div>
<div class="ttc" id="astruct_homme_1_1_remap_1_1_remap_functor_html_a255291a6c0473878f96c1a55410fa6f6"><div class="ttname"><a href="struct_homme_1_1_remap_1_1_remap_functor.html#a255291a6c0473878f96c1a55410fa6f6">Homme::Remap::RemapFunctor::num_to_remap</a></div><div class="ttdeci">KOKKOS_INLINE_FUNCTION int num_to_remap() const</div><div class="ttdef"><b>Definition:</b> <a href="_remap_functor_8hpp_source.html#l00312">RemapFunctor.hpp:312</a></div></div>
<div class="ttc" id="astruct_homme_1_1_remap_1_1_remap_functor_html_a3b9cc0030c92ab5889ff5e609a88df93"><div class="ttname"><a href="struct_homme_1_1_remap_1_1_remap_functor.html#a3b9cc0030c92ab5889ff5e609a88df93">Homme::Remap::RemapFunctor::operator()</a></div><div class="ttdeci">KOKKOS_INLINE_FUNCTION void operator()(ComputeThicknessTag, const TeamMember &amp;team) const</div><div class="ttdef"><b>Definition:</b> <a href="_remap_functor_8hpp_source.html#l00339">RemapFunctor.hpp:339</a></div></div>
<div class="ttc" id="astruct_homme_1_1_remap_1_1_remap_functor_html_a3e00e92b281ed7f5c80d45bc0392a3b7"><div class="ttname"><a href="struct_homme_1_1_remap_1_1_remap_functor.html#a3e00e92b281ed7f5c80d45bc0392a3b7">Homme::Remap::RemapFunctor::operator()</a></div><div class="ttdeci">KOKKOS_INLINE_FUNCTION void operator()(ComputeRemapTag, const TeamMember &amp;team) const</div><div class="ttdef"><b>Definition:</b> <a href="_remap_functor_8hpp_source.html#l00380">RemapFunctor.hpp:380</a></div></div>
<div class="ttc" id="astruct_homme_1_1_remap_1_1_remap_functor_html_a44ea1247f5410ff0699c026e5b471ef0"><div class="ttname"><a href="struct_homme_1_1_remap_1_1_remap_functor.html#a44ea1247f5410ff0699c026e5b471ef0">Homme::Remap::RemapFunctor::operator()</a></div><div class="ttdeci">KOKKOS_INLINE_FUNCTION void operator()(ComputeExtrinsicsTag, const TeamMember &amp;team) const</div><div class="ttdef"><b>Definition:</b> <a href="_remap_functor_8hpp_source.html#l00350">RemapFunctor.hpp:350</a></div></div>
<div class="ttc" id="astruct_homme_1_1_remap_1_1_remap_functor_html_a4656ff7dc4c2c05ad35b62360a588091"><div class="ttname"><a href="struct_homme_1_1_remap_1_1_remap_functor.html#a4656ff7dc4c2c05ad35b62360a588091">Homme::Remap::RemapFunctor::m_remap</a></div><div class="ttdeci">RemapType m_remap</div><div class="ttdef"><b>Definition:</b> <a href="_remap_functor_8hpp_source.html#l00276">RemapFunctor.hpp:276</a></div></div>
<div class="ttc" id="astruct_homme_1_1_remap_1_1_remap_functor_html_a4b0305b17d69383efeb09145d18bfe37"><div class="ttname"><a href="struct_homme_1_1_remap_1_1_remap_functor.html#a4b0305b17d69383efeb09145d18bfe37">Homme::Remap::RemapFunctor::operator()</a></div><div class="ttdeci">KOKKOS_INLINE_FUNCTION void operator()(ComputeGridsTag, const TeamMember &amp;team) const</div><div class="ttdef"><b>Definition:</b> <a href="_remap_functor_8hpp_source.html#l00371">RemapFunctor.hpp:371</a></div></div>
<div class="ttc" id="astruct_homme_1_1_remap_1_1_remap_functor_html_a6aaf6a4a6828ad1a377314393fc66185"><div class="ttname"><a href="struct_homme_1_1_remap_1_1_remap_functor.html#a6aaf6a4a6828ad1a377314393fc66185">Homme::Remap::RemapFunctor::m_hvcoord</a></div><div class="ttdeci">const HybridVCoord m_hvcoord</div><div class="ttdef"><b>Definition:</b> <a href="_remap_functor_8hpp_source.html#l00270">RemapFunctor.hpp:270</a></div></div>
<div class="ttc" id="astruct_homme_1_1_remap_1_1_remap_functor_html_a72a6394547311a73257c637ab5acf21a"><div class="ttname"><a href="struct_homme_1_1_remap_1_1_remap_functor.html#a72a6394547311a73257c637ab5acf21a">Homme::Remap::RemapFunctor::run_remap</a></div><div class="ttdeci">void run_remap()</div><div class="ttdef"><b>Definition:</b> <a href="_remap_functor_8hpp_source.html#l00424">RemapFunctor.hpp:424</a></div></div>
<div class="ttc" id="astruct_homme_1_1_remap_1_1_remap_functor_html_a8aa2a7093f1e2416b468e433f0a7a419"><div class="ttname"><a href="struct_homme_1_1_remap_1_1_remap_functor.html#a8aa2a7093f1e2416b468e433f0a7a419">Homme::Remap::RemapFunctor::m_fields_provider</a></div><div class="ttdeci">RemapStateAndThicknessProvider&lt; nonzero_rsplit &gt; m_fields_provider</div><div class="ttdef"><b>Definition:</b> <a href="_remap_functor_8hpp_source.html#l00267">RemapFunctor.hpp:267</a></div></div>
<div class="ttc" id="astruct_homme_1_1_remap_1_1_remap_functor_html_a958dc535214d56fec1250b01aed140d8"><div class="ttname"><a href="struct_homme_1_1_remap_1_1_remap_functor.html#a958dc535214d56fec1250b01aed140d8">Homme::Remap::RemapFunctor::m_state</a></div><div class="ttdeci">const ElementsState m_state</div><div class="ttdef"><b>Definition:</b> <a href="_remap_functor_8hpp_source.html#l00269">RemapFunctor.hpp:269</a></div></div>
<div class="ttc" id="astruct_homme_1_1_remap_1_1_remap_functor_html_a9d7c3ef03e8db442c76623da2f63f516"><div class="ttname"><a href="struct_homme_1_1_remap_1_1_remap_functor.html#a9d7c3ef03e8db442c76623da2f63f516">Homme::Remap::RemapFunctor::run_remap</a></div><div class="ttdeci">void run_remap(int np1, int np1_qdp, double dt) override</div><div class="ttdef"><b>Definition:</b> <a href="_remap_functor_8hpp_source.html#l00417">RemapFunctor.hpp:417</a></div></div>
<div class="ttc" id="astruct_homme_1_1_remap_1_1_remap_functor_html_aabf3d2b7fd7b70cad43e9c1888fa0d17"><div class="ttname"><a href="struct_homme_1_1_remap_1_1_remap_functor.html#aabf3d2b7fd7b70cad43e9c1888fa0d17">Homme::Remap::RemapFunctor::input_valid_assert</a></div><div class="ttdeci">void input_valid_assert()</div><div class="ttdef"><b>Definition:</b> <a href="_remap_functor_8hpp_source.html#l00301">RemapFunctor.hpp:301</a></div></div>
<div class="ttc" id="astruct_homme_1_1_remap_1_1_remap_functor_html_ab762bcbb4c0245f05a2a6d9d620ae493"><div class="ttname"><a href="struct_homme_1_1_remap_1_1_remap_functor.html#ab762bcbb4c0245f05a2a6d9d620ae493">Homme::Remap::RemapFunctor::valid_layer_thickness</a></div><div class="ttdeci">ExecViewManaged&lt; bool * &gt; valid_layer_thickness</div><div class="ttdef"><b>Definition:</b> <a href="_remap_functor_8hpp_source.html#l00273">RemapFunctor.hpp:273</a></div></div>
<div class="ttc" id="astruct_homme_1_1_remap_1_1_remap_functor_html_ababb88c14b26da94606961b828ed3722"><div class="ttname"><a href="struct_homme_1_1_remap_1_1_remap_functor.html#ababb88c14b26da94606961b828ed3722">Homme::Remap::RemapFunctor::init_buffers</a></div><div class="ttdeci">void init_buffers(const FunctorsBuffersManager &amp;fbm)</div><div class="ttdef"><b>Definition:</b> <a href="_remap_functor_8hpp_source.html#l00459">RemapFunctor.hpp:459</a></div></div>
<div class="ttc" id="astruct_homme_1_1_remap_1_1_remap_functor_html_adc87f31f5925e0a44fc46487cb132935"><div class="ttname"><a href="struct_homme_1_1_remap_1_1_remap_functor.html#adc87f31f5925e0a44fc46487cb132935">Homme::Remap::RemapFunctor::requested_buffer_size</a></div><div class="ttdeci">int requested_buffer_size() const</div><div class="ttdef"><b>Definition:</b> <a href="_remap_functor_8hpp_source.html#l00455">RemapFunctor.hpp:455</a></div></div>
<div class="ttc" id="astruct_homme_1_1_remap_1_1_remap_functor_html_addc1352459b65857a2627d356ffac76f"><div class="ttname"><a href="struct_homme_1_1_remap_1_1_remap_functor.html#addc1352459b65857a2627d356ffac76f">Homme::Remap::RemapFunctor::m_qdp</a></div><div class="ttdeci">ExecViewManaged&lt; Scalar *[Q_NUM_TIME_LEVELS][QSIZE_D][NP][NP][NUM_LEV]&gt; m_qdp</div><div class="ttdef"><b>Definition:</b> <a href="_remap_functor_8hpp_source.html#l00271">RemapFunctor.hpp:271</a></div></div>
<div class="ttc" id="astruct_homme_1_1_remap_1_1_remap_functor_html_af5e34b730423445396a7f14f84a8b568"><div class="ttname"><a href="struct_homme_1_1_remap_1_1_remap_functor.html#af5e34b730423445396a7f14f84a8b568">Homme::Remap::RemapFunctor::RemapFunctor</a></div><div class="ttdeci">RemapFunctor(const int qsize, const Elements &amp;elements, const Tracers &amp;tracers, const HybridVCoord &amp;hvcoord)</div><div class="ttdef"><b>Definition:</b> <a href="_remap_functor_8hpp_source.html#l00281">RemapFunctor.hpp:281</a></div></div>
<div class="ttc" id="astruct_homme_1_1_remap_1_1_remap_state_and_thickness_provider_3_01false_01_4_html_a012040d3ab9a13ab918dc0213c60d255"><div class="ttname"><a href="struct_homme_1_1_remap_1_1_remap_state_and_thickness_provider_3_01false_01_4.html#a012040d3ab9a13ab918dc0213c60d255">Homme::Remap::RemapStateAndThicknessProvider&lt; false &gt;::compute_source_thickness</a></div><div class="ttdeci">KOKKOS_INLINE_FUNCTION ExecViewUnmanaged&lt; const Scalar[NP][NP][NUM_LEV]&gt; compute_source_thickness(KernelVariables &amp;kv, const int &amp;np1, const Real &amp;dt, ExecViewUnmanaged&lt; const Scalar[NP][NP][NUM_LEV]&gt; tgt_layer_thickness) const</div><div class="ttdef"><b>Definition:</b> <a href="_remap_functor_8hpp_source.html#l00099">RemapFunctor.hpp:99</a></div></div>
<div class="ttc" id="astruct_homme_1_1_remap_1_1_remap_state_and_thickness_provider_3_01false_01_4_html_a21d5348013cca5067880bc3a4d47f6f7"><div class="ttname"><a href="struct_homme_1_1_remap_1_1_remap_state_and_thickness_provider_3_01false_01_4.html#a21d5348013cca5067880bc3a4d47f6f7">Homme::Remap::RemapStateAndThicknessProvider&lt; false &gt;::postprocess_states</a></div><div class="ttdeci">void postprocess_states(const int) const</div><div class="ttdef"><b>Definition:</b> <a href="_remap_functor_8hpp_source.html#l00078">RemapFunctor.hpp:78</a></div></div>
<div class="ttc" id="astruct_homme_1_1_remap_1_1_remap_state_and_thickness_provider_3_01false_01_4_html_a2b2dab16f8f881845b6fa38afdd86767"><div class="ttname"><a href="struct_homme_1_1_remap_1_1_remap_state_and_thickness_provider_3_01false_01_4.html#a2b2dab16f8f881845b6fa38afdd86767">Homme::Remap::RemapStateAndThicknessProvider&lt; false &gt;::requested_buffer_size</a></div><div class="ttdeci">int requested_buffer_size() const</div><div class="ttdef"><b>Definition:</b> <a href="_remap_functor_8hpp_source.html#l00059">RemapFunctor.hpp:59</a></div></div>
<div class="ttc" id="astruct_homme_1_1_remap_1_1_remap_state_and_thickness_provider_3_01false_01_4_html_a3977b0caa9a50ef1c3bca43e916eb2e7"><div class="ttname"><a href="struct_homme_1_1_remap_1_1_remap_state_and_thickness_provider_3_01false_01_4.html#a3977b0caa9a50ef1c3bca43e916eb2e7">Homme::Remap::RemapStateAndThicknessProvider&lt; false &gt;::get_state</a></div><div class="ttdeci">KOKKOS_INLINE_FUNCTION ExecViewUnmanaged&lt; Scalar[NP][NP][NUM_LEV]&gt; get_state(const KernelVariables &amp;, int, int) const</div><div class="ttdef"><b>Definition:</b> <a href="_remap_functor_8hpp_source.html#l00084">RemapFunctor.hpp:84</a></div></div>
<div class="ttc" id="astruct_homme_1_1_remap_1_1_remap_state_and_thickness_provider_3_01false_01_4_html_a4db64f5266b56acf7e9483a361234b8a"><div class="ttname"><a href="struct_homme_1_1_remap_1_1_remap_state_and_thickness_provider_3_01false_01_4.html#a4db64f5266b56acf7e9483a361234b8a">Homme::Remap::RemapStateAndThicknessProvider&lt; false &gt;::RemapStateAndThicknessProvider</a></div><div class="ttdeci">RemapStateAndThicknessProvider(const Elements &amp;elements)</div><div class="ttdef"><b>Definition:</b> <a href="_remap_functor_8hpp_source.html#l00050">RemapFunctor.hpp:50</a></div></div>
<div class="ttc" id="astruct_homme_1_1_remap_1_1_remap_state_and_thickness_provider_3_01false_01_4_html_a558b9be72c65a088103578702cb33988"><div class="ttname"><a href="struct_homme_1_1_remap_1_1_remap_state_and_thickness_provider_3_01false_01_4.html#a558b9be72c65a088103578702cb33988">Homme::Remap::RemapStateAndThicknessProvider&lt; false &gt;::m_tgt_layer_thickness</a></div><div class="ttdeci">ExecViewManaged&lt; Scalar *[NP][NP][NUM_LEV]&gt; m_tgt_layer_thickness</div><div class="ttdef"><b>Definition:</b> <a href="_remap_functor_8hpp_source.html#l00045">RemapFunctor.hpp:45</a></div></div>
<div class="ttc" id="astruct_homme_1_1_remap_1_1_remap_state_and_thickness_provider_3_01false_01_4_html_a81197f551f2f20c87f0d539705e731ec"><div class="ttname"><a href="struct_homme_1_1_remap_1_1_remap_state_and_thickness_provider_3_01false_01_4.html#a81197f551f2f20c87f0d539705e731ec">Homme::Remap::RemapStateAndThicknessProvider&lt; false &gt;::m_eta_dot_dpdn</a></div><div class="ttdeci">ExecViewUnmanaged&lt; const Scalar *[NP][NP][NUM_LEV_P]&gt; m_eta_dot_dpdn</div><div class="ttdef"><b>Definition:</b> <a href="_remap_functor_8hpp_source.html#l00047">RemapFunctor.hpp:47</a></div></div>
<div class="ttc" id="astruct_homme_1_1_remap_1_1_remap_state_and_thickness_provider_3_01false_01_4_html_a901d792f08203d8c9c09e365de0adfea"><div class="ttname"><a href="struct_homme_1_1_remap_1_1_remap_state_and_thickness_provider_3_01false_01_4.html#a901d792f08203d8c9c09e365de0adfea">Homme::Remap::RemapStateAndThicknessProvider&lt; false &gt;::get_source_thickness</a></div><div class="ttdeci">KOKKOS_INLINE_FUNCTION ExecViewUnmanaged&lt; Scalar[NP][NP][NUM_LEV]&gt; get_source_thickness(const int ie, const int) const</div><div class="ttdef"><b>Definition:</b> <a href="_remap_functor_8hpp_source.html#l00093">RemapFunctor.hpp:93</a></div></div>
<div class="ttc" id="astruct_homme_1_1_remap_1_1_remap_state_and_thickness_provider_3_01false_01_4_html_aabed000a98c6c325dea7174f14eb3c56"><div class="ttname"><a href="struct_homme_1_1_remap_1_1_remap_state_and_thickness_provider_3_01false_01_4.html#aabed000a98c6c325dea7174f14eb3c56">Homme::Remap::RemapStateAndThicknessProvider&lt; false &gt;::preprocess_states</a></div><div class="ttdeci">void preprocess_states(const int) const</div><div class="ttdef"><b>Definition:</b> <a href="_remap_functor_8hpp_source.html#l00074">RemapFunctor.hpp:74</a></div></div>
<div class="ttc" id="astruct_homme_1_1_remap_1_1_remap_state_and_thickness_provider_3_01false_01_4_html_aae6cb1d0431a81f5ec3b18ee37d40863"><div class="ttname"><a href="struct_homme_1_1_remap_1_1_remap_state_and_thickness_provider_3_01false_01_4.html#aae6cb1d0431a81f5ec3b18ee37d40863">Homme::Remap::RemapStateAndThicknessProvider&lt; false &gt;::m_src_layer_thickness</a></div><div class="ttdeci">ExecViewManaged&lt; Scalar *[NP][NP][NUM_LEV]&gt; m_src_layer_thickness</div><div class="ttdef"><b>Definition:</b> <a href="_remap_functor_8hpp_source.html#l00044">RemapFunctor.hpp:44</a></div></div>
<div class="ttc" id="astruct_homme_1_1_remap_1_1_remap_state_and_thickness_provider_3_01false_01_4_html_ab6441c71595d798658991801bfc4e6ab"><div class="ttname"><a href="struct_homme_1_1_remap_1_1_remap_state_and_thickness_provider_3_01false_01_4.html#ab6441c71595d798658991801bfc4e6ab">Homme::Remap::RemapStateAndThicknessProvider&lt; false &gt;::init_buffers</a></div><div class="ttdeci">void init_buffers(const FunctorsBuffersManager &amp;)</div><div class="ttdef"><b>Definition:</b> <a href="_remap_functor_8hpp_source.html#l00063">RemapFunctor.hpp:63</a></div></div>
<div class="ttc" id="astruct_homme_1_1_remap_1_1_remap_state_and_thickness_provider_3_01false_01_4_html_ac9a0589481a41dfcf45608a74b1ba217"><div class="ttname"><a href="struct_homme_1_1_remap_1_1_remap_state_and_thickness_provider_3_01false_01_4.html#ac9a0589481a41dfcf45608a74b1ba217">Homme::Remap::RemapStateAndThicknessProvider&lt; false &gt;::num_states_remap</a></div><div class="ttdeci">KOKKOS_INLINE_FUNCTION int num_states_remap() const</div><div class="ttdef"><b>Definition:</b> <a href="_remap_functor_8hpp_source.html#l00057">RemapFunctor.hpp:57</a></div></div>
<div class="ttc" id="astruct_homme_1_1_remap_1_1_remap_state_and_thickness_provider_3_01false_01_4_html_ae03cb0cea830f7be798230c372ed2558"><div class="ttname"><a href="struct_homme_1_1_remap_1_1_remap_state_and_thickness_provider_3_01false_01_4.html#ae03cb0cea830f7be798230c372ed2558">Homme::Remap::RemapStateAndThicknessProvider&lt; false &gt;::is_intrinsic_state</a></div><div class="ttdeci">KOKKOS_INLINE_FUNCTION bool is_intrinsic_state(const int) const</div><div class="ttdef"><b>Definition:</b> <a href="_remap_functor_8hpp_source.html#l00068">RemapFunctor.hpp:68</a></div></div>
<div class="ttc" id="astruct_homme_1_1_remap_1_1_remap_state_and_thickness_provider_3_01true_01_4_html"><div class="ttname"><a href="struct_homme_1_1_remap_1_1_remap_state_and_thickness_provider_3_01true_01_4.html">Homme::Remap::RemapStateAndThicknessProvider&lt; true &gt;</a></div><div class="ttdef"><b>Definition:</b> <a href="_remap_functor_8hpp_source.html#l00127">RemapFunctor.hpp:128</a></div></div>
<div class="ttc" id="astruct_homme_1_1_remap_1_1_remap_state_and_thickness_provider_3_01true_01_4_html_a04de30a25a21018878bfdb59e461c35c"><div class="ttname"><a href="struct_homme_1_1_remap_1_1_remap_state_and_thickness_provider_3_01true_01_4.html#a04de30a25a21018878bfdb59e461c35c">Homme::Remap::RemapStateAndThicknessProvider&lt; true &gt;::num_states_remap</a></div><div class="ttdeci">KOKKOS_INLINE_FUNCTION int num_states_remap() const</div><div class="ttdef"><b>Definition:</b> <a href="_remap_functor_8hpp_source.html#l00169">RemapFunctor.hpp:169</a></div></div>
<div class="ttc" id="astruct_homme_1_1_remap_1_1_remap_state_and_thickness_provider_3_01true_01_4_html_a0dcba22c7a38542fe4ea0bfce833b029"><div class="ttname"><a href="struct_homme_1_1_remap_1_1_remap_state_and_thickness_provider_3_01true_01_4.html#a0dcba22c7a38542fe4ea0bfce833b029">Homme::Remap::RemapStateAndThicknessProvider&lt; true &gt;::get_source_thickness</a></div><div class="ttdeci">KOKKOS_INLINE_FUNCTION ExecViewUnmanaged&lt; Scalar[NP][NP][NUM_LEV]&gt; get_source_thickness(const int ie, const int np1) const</div><div class="ttdef"><b>Definition:</b> <a href="_remap_functor_8hpp_source.html#l00229">RemapFunctor.hpp:229</a></div></div>
<div class="ttc" id="astruct_homme_1_1_remap_1_1_remap_state_and_thickness_provider_3_01true_01_4_html_a23fa8b42e9de9357a52266ce3accd073"><div class="ttname"><a href="struct_homme_1_1_remap_1_1_remap_state_and_thickness_provider_3_01true_01_4.html#a23fa8b42e9de9357a52266ce3accd073">Homme::Remap::RemapStateAndThicknessProvider&lt; true &gt;::m_tu</a></div><div class="ttdeci">TeamUtils&lt; ExecSpace &gt; m_tu</div><div class="ttdef"><b>Definition:</b> <a href="_remap_functor_8hpp_source.html#l00140">RemapFunctor.hpp:140</a></div></div>
<div class="ttc" id="astruct_homme_1_1_remap_1_1_remap_state_and_thickness_provider_3_01true_01_4_html_a29e92897bb40e1f76ee8b7641cdde56f"><div class="ttname"><a href="struct_homme_1_1_remap_1_1_remap_state_and_thickness_provider_3_01true_01_4.html#a29e92897bb40e1f76ee8b7641cdde56f">Homme::Remap::RemapStateAndThicknessProvider&lt; true &gt;::RemapStateAndThicknessProvider</a></div><div class="ttdeci">RemapStateAndThicknessProvider(const Elements &amp;elements)</div><div class="ttdef"><b>Definition:</b> <a href="_remap_functor_8hpp_source.html#l00143">RemapFunctor.hpp:143</a></div></div>
<div class="ttc" id="astruct_homme_1_1_remap_1_1_remap_state_and_thickness_provider_3_01true_01_4_html_a2d3aacd823855381fb51c334516972c6"><div class="ttname"><a href="struct_homme_1_1_remap_1_1_remap_state_and_thickness_provider_3_01true_01_4.html#a2d3aacd823855381fb51c334516972c6">Homme::Remap::RemapStateAndThicknessProvider&lt; true &gt;::requested_buffer_size</a></div><div class="ttdeci">int requested_buffer_size() const</div><div class="ttdef"><b>Definition:</b> <a href="_remap_functor_8hpp_source.html#l00171">RemapFunctor.hpp:171</a></div></div>
<div class="ttc" id="astruct_homme_1_1_remap_1_1_remap_state_and_thickness_provider_3_01true_01_4_html_a3c23869922650ea9eed46888c9851c55"><div class="ttname"><a href="struct_homme_1_1_remap_1_1_remap_state_and_thickness_provider_3_01true_01_4.html#a3c23869922650ea9eed46888c9851c55">Homme::Remap::RemapStateAndThicknessProvider&lt; true &gt;::m_state_provider</a></div><div class="ttdeci">RemapStateProvider m_state_provider</div><div class="ttdef"><b>Definition:</b> <a href="_remap_functor_8hpp_source.html#l00132">RemapFunctor.hpp:132</a></div></div>
<div class="ttc" id="astruct_homme_1_1_remap_1_1_remap_state_and_thickness_provider_3_01true_01_4_html_a47b617f101fd7d2d1f1b507147104c85"><div class="ttname"><a href="struct_homme_1_1_remap_1_1_remap_state_and_thickness_provider_3_01true_01_4.html#a47b617f101fd7d2d1f1b507147104c85">Homme::Remap::RemapStateAndThicknessProvider&lt; true &gt;::init_buffers</a></div><div class="ttdeci">void init_buffers(const FunctorsBuffersManager &amp;fbm)</div><div class="ttdef"><b>Definition:</b> <a href="_remap_functor_8hpp_source.html#l00175">RemapFunctor.hpp:175</a></div></div>
<div class="ttc" id="astruct_homme_1_1_remap_1_1_remap_state_and_thickness_provider_3_01true_01_4_html_a57876683ee9d2662a50f72f065e93154"><div class="ttname"><a href="struct_homme_1_1_remap_1_1_remap_state_and_thickness_provider_3_01true_01_4.html#a57876683ee9d2662a50f72f065e93154">Homme::Remap::RemapStateAndThicknessProvider&lt; true &gt;::is_intrinsic_state</a></div><div class="ttdeci">KOKKOS_INLINE_FUNCTION bool is_intrinsic_state(const int istate) const</div><div class="ttdef"><b>Definition:</b> <a href="_remap_functor_8hpp_source.html#l00180">RemapFunctor.hpp:180</a></div></div>
<div class="ttc" id="astruct_homme_1_1_remap_1_1_remap_state_and_thickness_provider_3_01true_01_4_html_a59f16ef12dcba437af2f0e45bdedbe49"><div class="ttname"><a href="struct_homme_1_1_remap_1_1_remap_state_and_thickness_provider_3_01true_01_4.html#a59f16ef12dcba437af2f0e45bdedbe49">Homme::Remap::RemapStateAndThicknessProvider&lt; true &gt;::get_state</a></div><div class="ttdeci">KOKKOS_INLINE_FUNCTION ExecViewUnmanaged&lt; Scalar[NP][NP][NUM_LEV]&gt; get_state(const KernelVariables &amp;kv, int np1, int var) const</div><div class="ttdef"><b>Definition:</b> <a href="_remap_functor_8hpp_source.html#l00223">RemapFunctor.hpp:223</a></div></div>
<div class="ttc" id="astruct_homme_1_1_remap_1_1_remap_state_and_thickness_provider_3_01true_01_4_html_a67df8621d35b1c258dfac1e62bfcfd76"><div class="ttname"><a href="struct_homme_1_1_remap_1_1_remap_state_and_thickness_provider_3_01true_01_4.html#a67df8621d35b1c258dfac1e62bfcfd76">Homme::Remap::RemapStateAndThicknessProvider&lt; true &gt;::m_policy_post</a></div><div class="ttdeci">Kokkos::TeamPolicy&lt; ExecSpace, TagPostProcess &gt; m_policy_post</div><div class="ttdef"><b>Definition:</b> <a href="_remap_functor_8hpp_source.html#l00138">RemapFunctor.hpp:138</a></div></div>
<div class="ttc" id="astruct_homme_1_1_remap_1_1_remap_state_and_thickness_provider_3_01true_01_4_html_a6a706d80514b790590c1d9e3ef458a66"><div class="ttname"><a href="struct_homme_1_1_remap_1_1_remap_state_and_thickness_provider_3_01true_01_4.html#a6a706d80514b790590c1d9e3ef458a66">Homme::Remap::RemapStateAndThicknessProvider&lt; true &gt;::preprocess_states</a></div><div class="ttdeci">void preprocess_states(const int np1)</div><div class="ttdef"><b>Definition:</b> <a href="_remap_functor_8hpp_source.html#l00184">RemapFunctor.hpp:184</a></div></div>
<div class="ttc" id="astruct_homme_1_1_remap_1_1_remap_state_and_thickness_provider_3_01true_01_4_html_a728c2a97cf342f13529dda97fa0a3ba2"><div class="ttname"><a href="struct_homme_1_1_remap_1_1_remap_state_and_thickness_provider_3_01true_01_4.html#a728c2a97cf342f13529dda97fa0a3ba2">Homme::Remap::RemapStateAndThicknessProvider&lt; true &gt;::m_dp3d</a></div><div class="ttdeci">ExecViewUnmanaged&lt; Scalar *[NUM_TIME_LEVELS][NP][NP][NUM_LEV]&gt; m_dp3d</div><div class="ttdef"><b>Definition:</b> <a href="_remap_functor_8hpp_source.html#l00130">RemapFunctor.hpp:130</a></div></div>
<div class="ttc" id="astruct_homme_1_1_remap_1_1_remap_state_and_thickness_provider_3_01true_01_4_html_ab9c244c588abda611374587e6891112b"><div class="ttname"><a href="struct_homme_1_1_remap_1_1_remap_state_and_thickness_provider_3_01true_01_4.html#ab9c244c588abda611374587e6891112b">Homme::Remap::RemapStateAndThicknessProvider&lt; true &gt;::m_policy_pre</a></div><div class="ttdeci">Kokkos::TeamPolicy&lt; ExecSpace, TagPreProcess &gt; m_policy_pre</div><div class="ttdef"><b>Definition:</b> <a href="_remap_functor_8hpp_source.html#l00137">RemapFunctor.hpp:137</a></div></div>
<div class="ttc" id="astruct_homme_1_1_remap_1_1_remap_state_and_thickness_provider_3_01true_01_4_html_abb87f74191a2cd3a826c4956a69ffe2b"><div class="ttname"><a href="struct_homme_1_1_remap_1_1_remap_state_and_thickness_provider_3_01true_01_4.html#abb87f74191a2cd3a826c4956a69ffe2b">Homme::Remap::RemapStateAndThicknessProvider&lt; true &gt;::compute_source_thickness</a></div><div class="ttdeci">KOKKOS_INLINE_FUNCTION ExecViewUnmanaged&lt; const Scalar[NP][NP][NUM_LEV]&gt; compute_source_thickness(KernelVariables &amp;kv, const int np1, const Real, ExecViewUnmanaged&lt; const Scalar[NP][NP][NUM_LEV]&gt;) const</div><div class="ttdef"><b>Definition:</b> <a href="_remap_functor_8hpp_source.html#l00234">RemapFunctor.hpp:234</a></div></div>
<div class="ttc" id="astruct_homme_1_1_remap_1_1_remap_state_and_thickness_provider_3_01true_01_4_html_ac86b9caba77391e18008575179f42091"><div class="ttname"><a href="struct_homme_1_1_remap_1_1_remap_state_and_thickness_provider_3_01true_01_4.html#ac86b9caba77391e18008575179f42091">Homme::Remap::RemapStateAndThicknessProvider&lt; true &gt;::m_tgt_layer_thickness</a></div><div class="ttdeci">ExecViewManaged&lt; Scalar *[NP][NP][NUM_LEV]&gt; m_tgt_layer_thickness</div><div class="ttdef"><b>Definition:</b> <a href="_remap_functor_8hpp_source.html#l00131">RemapFunctor.hpp:131</a></div></div>
<div class="ttc" id="astruct_homme_1_1_remap_1_1_remap_state_and_thickness_provider_3_01true_01_4_html_ac884ec4836df683874ba3c15677fb98c"><div class="ttname"><a href="struct_homme_1_1_remap_1_1_remap_state_and_thickness_provider_3_01true_01_4.html#ac884ec4836df683874ba3c15677fb98c">Homme::Remap::RemapStateAndThicknessProvider&lt; true &gt;::m_np1</a></div><div class="ttdeci">int m_np1</div><div class="ttdef"><b>Definition:</b> <a href="_remap_functor_8hpp_source.html#l00133">RemapFunctor.hpp:133</a></div></div>
<div class="ttc" id="astruct_homme_1_1_remap_1_1_remap_state_and_thickness_provider_3_01true_01_4_html_ac8be85ffe8bff644552e3e292fb12248"><div class="ttname"><a href="struct_homme_1_1_remap_1_1_remap_state_and_thickness_provider_3_01true_01_4.html#ac8be85ffe8bff644552e3e292fb12248">Homme::Remap::RemapStateAndThicknessProvider&lt; true &gt;::postprocess_states</a></div><div class="ttdeci">void postprocess_states(const int np1)</div><div class="ttdef"><b>Definition:</b> <a href="_remap_functor_8hpp_source.html#l00202">RemapFunctor.hpp:202</a></div></div>
<div class="ttc" id="astruct_homme_1_1_remap_1_1_remap_state_and_thickness_provider_html"><div class="ttname"><a href="struct_homme_1_1_remap_1_1_remap_state_and_thickness_provider.html">Homme::Remap::RemapStateAndThicknessProvider</a></div><div class="ttdef"><b>Definition:</b> <a href="_remap_functor_8hpp_source.html#l00039">RemapFunctor.hpp:39</a></div></div>
<div class="ttc" id="astruct_homme_1_1_remap_1_1_remap_state_provider_html"><div class="ttname"><a href="struct_homme_1_1_remap_1_1_remap_state_provider.html">Homme::Remap::RemapStateProvider</a></div><div class="ttdef"><b>Definition:</b> <a href="preqx__kokkos_2cxx_2_remap_state_provider_8hpp_source.html#l00022">RemapStateProvider.hpp:22</a></div></div>
<div class="ttc" id="astruct_homme_1_1_remap_1_1_remap_state_provider_html_a21c90b37db1adce69add8d1d9cb84f6b"><div class="ttname"><a href="struct_homme_1_1_remap_1_1_remap_state_provider.html#a21c90b37db1adce69add8d1d9cb84f6b">Homme::Remap::RemapStateProvider::preprocess_state</a></div><div class="ttdeci">KOKKOS_INLINE_FUNCTION void preprocess_state(const KernelVariables &amp;, const int, const int, ExecViewUnmanaged&lt; const Scalar[NP][NP][NUM_LEV]&gt;) const</div><div class="ttdef"><b>Definition:</b> <a href="preqx__kokkos_2cxx_2_remap_state_provider_8hpp_source.html#l00062">RemapStateProvider.hpp:62</a></div></div>
<div class="ttc" id="astruct_homme_1_1_remap_1_1_remap_state_provider_html_a297793c486cf9ee9833185e7b2915c66"><div class="ttname"><a href="struct_homme_1_1_remap_1_1_remap_state_provider.html#a297793c486cf9ee9833185e7b2915c66">Homme::Remap::RemapStateProvider::num_states_remap</a></div><div class="ttdeci">KOKKOS_INLINE_FUNCTION int num_states_remap() const</div><div class="ttdef"><b>Definition:</b> <a href="preqx__kokkos_2cxx_2_remap_state_provider_8hpp_source.html#l00041">RemapStateProvider.hpp:41</a></div></div>
<div class="ttc" id="astruct_homme_1_1_remap_1_1_remap_state_provider_html_a3bc69436a6a6ccb60878dc79c50e47d0"><div class="ttname"><a href="struct_homme_1_1_remap_1_1_remap_state_provider.html#a3bc69436a6a6ccb60878dc79c50e47d0">Homme::Remap::RemapStateProvider::num_states_postprocess</a></div><div class="ttdeci">KOKKOS_INLINE_FUNCTION int num_states_postprocess() const</div><div class="ttdef"><b>Definition:</b> <a href="preqx__kokkos_2cxx_2_remap_state_provider_8hpp_source.html#l00047">RemapStateProvider.hpp:47</a></div></div>
<div class="ttc" id="astruct_homme_1_1_remap_1_1_remap_state_provider_html_a4a634b2b5e002348fa68f5922dcf342d"><div class="ttname"><a href="struct_homme_1_1_remap_1_1_remap_state_provider.html#a4a634b2b5e002348fa68f5922dcf342d">Homme::Remap::RemapStateProvider::get_state</a></div><div class="ttdeci">KOKKOS_INLINE_FUNCTION ExecViewUnmanaged&lt; Scalar[NP][NP][NUM_LEV]&gt; get_state(const KernelVariables &amp;kv, int np1, int var) const</div><div class="ttdef"><b>Definition:</b> <a href="preqx__kokkos_2cxx_2_remap_state_provider_8hpp_source.html#l00079">RemapStateProvider.hpp:79</a></div></div>
<div class="ttc" id="astruct_homme_1_1_remap_1_1_remap_state_provider_html_a6619e55475bfbe090028be5951e95fcb"><div class="ttname"><a href="struct_homme_1_1_remap_1_1_remap_state_provider.html#a6619e55475bfbe090028be5951e95fcb">Homme::Remap::RemapStateProvider::init_buffers</a></div><div class="ttdeci">void init_buffers(const FunctorsBuffersManager &amp;, int)</div><div class="ttdef"><b>Definition:</b> <a href="preqx__kokkos_2cxx_2_remap_state_provider_8hpp_source.html#l00035">RemapStateProvider.hpp:35</a></div></div>
<div class="ttc" id="astruct_homme_1_1_remap_1_1_remap_state_provider_html_a713a5df1481a4606e6c1a70942290b61"><div class="ttname"><a href="struct_homme_1_1_remap_1_1_remap_state_provider.html#a713a5df1481a4606e6c1a70942290b61">Homme::Remap::RemapStateProvider::is_intrinsic_state</a></div><div class="ttdeci">KOKKOS_INLINE_FUNCTION bool is_intrinsic_state(const int istate) const</div><div class="ttdef"><b>Definition:</b> <a href="preqx__kokkos_2cxx_2_remap_state_provider_8hpp_source.html#l00050">RemapStateProvider.hpp:50</a></div></div>
<div class="ttc" id="astruct_homme_1_1_remap_1_1_remap_state_provider_html_a89e19c74590408ee375fbd4b201d064c"><div class="ttname"><a href="struct_homme_1_1_remap_1_1_remap_state_provider.html#a89e19c74590408ee375fbd4b201d064c">Homme::Remap::RemapStateProvider::postprocess_state</a></div><div class="ttdeci">KOKKOS_INLINE_FUNCTION void postprocess_state(const KernelVariables &amp;, const int, const int, ExecViewUnmanaged&lt; const Scalar[NP][NP][NUM_LEV]&gt;) const</div><div class="ttdef"><b>Definition:</b> <a href="preqx__kokkos_2cxx_2_remap_state_provider_8hpp_source.html#l00070">RemapStateProvider.hpp:70</a></div></div>
<div class="ttc" id="astruct_homme_1_1_remap_1_1_remap_state_provider_html_aaa4fe04e841f5795e608131a0cc042f4"><div class="ttname"><a href="struct_homme_1_1_remap_1_1_remap_state_provider.html#aaa4fe04e841f5795e608131a0cc042f4">Homme::Remap::RemapStateProvider::requested_buffer_size</a></div><div class="ttdeci">int requested_buffer_size(int) const</div><div class="ttdef"><b>Definition:</b> <a href="preqx__kokkos_2cxx_2_remap_state_provider_8hpp_source.html#l00029">RemapStateProvider.hpp:29</a></div></div>
<div class="ttc" id="astruct_homme_1_1_remap_1_1_remap_state_provider_html_ab1561afafc405dabab07847282e039cd"><div class="ttname"><a href="struct_homme_1_1_remap_1_1_remap_state_provider.html#ab1561afafc405dabab07847282e039cd">Homme::Remap::RemapStateProvider::num_states_preprocess</a></div><div class="ttdeci">KOKKOS_INLINE_FUNCTION int num_states_preprocess() const</div><div class="ttdef"><b>Definition:</b> <a href="preqx__kokkos_2cxx_2_remap_state_provider_8hpp_source.html#l00044">RemapStateProvider.hpp:44</a></div></div>
<div class="ttc" id="astruct_homme_1_1_remap_1_1_remapper_html"><div class="ttname"><a href="struct_homme_1_1_remap_1_1_remapper.html">Homme::Remap::Remapper</a></div><div class="ttdef"><b>Definition:</b> <a href="_remap_functor_8hpp_source.html#l00243">RemapFunctor.hpp:243</a></div></div>
<div class="ttc" id="astruct_homme_1_1_remap_1_1_remapper_html_a02ad7140adf654ac4d61bc3ec5bb1028"><div class="ttname"><a href="struct_homme_1_1_remap_1_1_remapper.html#a02ad7140adf654ac4d61bc3ec5bb1028">Homme::Remap::Remapper::~Remapper</a></div><div class="ttdeci">virtual ~Remapper()</div><div class="ttdef"><b>Definition:</b> <a href="_remap_functor_8hpp_source.html#l00244">RemapFunctor.hpp:244</a></div></div>
<div class="ttc" id="astruct_homme_1_1_remap_1_1_remapper_html_a3dea08e8633edda16fc9acee0b280f79"><div class="ttname"><a href="struct_homme_1_1_remap_1_1_remapper.html#a3dea08e8633edda16fc9acee0b280f79">Homme::Remap::Remapper::init_buffers</a></div><div class="ttdeci">virtual void init_buffers(const FunctorsBuffersManager &amp;fbm)=0</div></div>
<div class="ttc" id="astruct_homme_1_1_remap_1_1_remapper_html_a9c7473ceefaa54e6d59510fbb9fde704"><div class="ttname"><a href="struct_homme_1_1_remap_1_1_remapper.html#a9c7473ceefaa54e6d59510fbb9fde704">Homme::Remap::Remapper::run_remap</a></div><div class="ttdeci">virtual void run_remap(int np1, int np1_qdp, double dt)=0</div></div>
<div class="ttc" id="astruct_homme_1_1_remap_1_1_remapper_html_aae34e3607399c0dc0990861cb438036c"><div class="ttname"><a href="struct_homme_1_1_remap_1_1_remapper.html#aae34e3607399c0dc0990861cb438036c">Homme::Remap::Remapper::requested_buffer_size</a></div><div class="ttdeci">virtual int requested_buffer_size() const =0</div></div>
<div class="ttc" id="astruct_homme_1_1_tracers_html"><div class="ttname"><a href="struct_homme_1_1_tracers.html">Homme::Tracers</a></div><div class="ttdef"><b>Definition:</b> <a href="_tracers_8hpp_source.html#l00014">Tracers.hpp:14</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_0b9b079b26fcc9f7494e277d37e7b67d.html">share</a></li><li class="navelem"><a class="el" href="dir_cee376dc00ff043c3e7200eac8ce46d9.html">cxx</a></li><li class="navelem"><a class="el" href="_remap_functor_8hpp.html">RemapFunctor.hpp</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
