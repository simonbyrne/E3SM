<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Homme: src/test_src/baroclinic_inst_mod.F90 Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Homme
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('baroclinic__inst__mod_8_f90_source.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">baroclinic_inst_mod.F90</div>  </div>
</div><!--header-->
<div class="contents">
<a href="baroclinic__inst__mod_8_f90.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="preprocessor">#ifdef HAVE_CONFIG_H</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#include &quot;config.h&quot;</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="preprocessor"></span> </div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">!  This file contains the initial condititions for two baroclinic</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">!  instability probelms:</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">!  Polvani, Scott and Thomas, MWR 2004</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">!  Jablonowski and Williamson, QJR (2006) 132 </span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">!  MT 2017-11: be sure to DSS the initial condition for NGGPS tracers</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00014"></a><span class="lineno"><a class="line" href="namespacebaroclinic__inst__mod.html">   14</a></span>&#160;<span class="keyword">module</span> <a class="code" href="namespacebaroclinic__inst__mod.html">baroclinic_inst_mod</a></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">!  This module contains the initial condititions for two baroclinic</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">!  instability probelms:</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">!  Polvani, Scott and Thomas, MWR 2004</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">!  Jablonowski and Williamson, QJR (2006) 132 </span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;    <span class="comment">! ====================</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacekinds.html">kinds</a>, <span class="keywordtype">only</span> : <a class="code" href="namespacekinds.html#abddc5e60584151b4d48b02e6436330f3">real_kind</a>, <a class="code" href="namespacekinds.html#af49f799ffc0bd030b587fb57de97d162">iulog</a></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;    <span class="comment">! ====================</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacephysical__constants.html">physical_constants</a>, <span class="keywordtype">only</span> : <a class="code" href="namespacephysical__constants.html#ac5250a6d5a30592be8eef149e57894fa">omega</a>, <a class="code" href="namespacephysical__constants.html#ab0f67c26417296baa8f3b876c001ff99">rearth</a>, <a class="code" href="namespacephysical__constants.html#a69f714bc9b76972dfccc59b88524efd3">rgas</a>, <a class="code" href="namespacephysical__constants.html#a723576dfdca03ef9e1ac67040270bf37">p0</a>, <a class="code" href="namespacephysical__constants.html#a0db9fd87afb6b6822d7817592fcb4634">dd_pi</a>, <a class="code" href="namespacephysical__constants.html#a9e383c954fc7f7ee936c4848b91194a3">cp</a>,<a class="code" href="namespacephysical__constants.html#adf45737a6626ac54e4f0e4d83a69e839">g</a></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;    <span class="comment">! ====================</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacedimensions__mod.html">dimensions_mod</a>, <span class="keywordtype">only</span> : <a class="code" href="namespacedimensions__mod.html#a6baa218e1683465acc4f37fcea8e30d5">nlev</a>,<a class="code" href="namespacedimensions__mod.html#a8648e26ae0e474ccf69d32a8148520c9">np</a>, <a class="code" href="namespacedimensions__mod.html#a0070848a40ac48379601d9a8a183c83b">qsize</a></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    <span class="comment">! ====================</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacequadrature__mod.html">quadrature_mod</a>, <span class="keywordtype">only</span> : <a class="code" href="structquadrature__mod_1_1quadrature__t.html">quadrature_t</a>, <a class="code" href="namespacequadrature__mod.html#aeab04095eea7662f234066f076e82a51">gauss</a></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    <span class="comment">! ====================</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespaceelement__mod.html">element_mod</a>, <span class="keywordtype">only</span> : <a class="code" href="structelement__mod_1_1element__t.html">element_t</a></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespaceelement__state.html">element_state</a>, <span class="keywordtype">only</span> : <a class="code" href="namespaceelement__state.html#ad600dbbab5d81bfc236df4786d322a10">timelevels</a></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespaceelement__ops.html">element_ops</a>, <span class="keywordtype">only</span> : <a class="code" href="namespaceelement__ops.html#a7fa9079971e0009efbe82ad383b660ad">set_thermostate</a>, <a class="code" href="namespaceelement__ops.html#a51c2a4b1d47e6b6f29432c0b7b790ca0">get_field</a></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    <span class="comment">! ====================</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespaceglobal__norms__mod.html">global_norms_mod</a>, <span class="keywordtype">only</span> : <a class="code" href="namespaceglobal__norms__mod.html#aa60e7cee9b156c24445f02a0692107d2">global_integral</a></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    <span class="comment">! ====================</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacehybrid__mod.html">hybrid_mod</a>, <span class="keywordtype">only</span> : <a class="code" href="structhybrid__mod_1_1hybrid__t.html">hybrid_t</a></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    <span class="comment">! ====================</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacecontrol__mod.html">control_mod</a>, <span class="keywordtype">only</span> : <a class="code" href="namespacecontrol__mod.html#a9a6f4129394969bdffe333ae2e3b4990">integration</a>, <a class="code" href="namespacecontrol__mod.html#a1c2d69b8f71e9a957a5b180477a751e4">test_case</a>, <a class="code" href="namespacecontrol__mod.html#a168fccf9923f508ba4ac441a049d08cf">u_perturb</a></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    <span class="comment">! ====================</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacehybvcoord__mod.html">hybvcoord_mod</a>, <span class="keywordtype">only</span> : <a class="code" href="structhybvcoord__mod_1_1hvcoord__t.html">hvcoord_t</a> </div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    <span class="comment">! ====================</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespacecoordinate__systems__mod.html">coordinate_systems_mod</a>, <span class="keywordtype">only</span> : <a class="code" href="structcoordinate__systems__mod_1_1spherical__polar__t.html">spherical_polar_t</a></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    <span class="keywordtype">use </span><a class="code" href="namespaceviscosity__mod.html">viscosity_mod</a>, <span class="keywordtype">only</span> : compute_zeta_c0, make_c0</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160; </div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160; </div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;  <span class="keywordtype">implicit none</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;  <span class="keywordtype">private</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160; </div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;  <span class="keywordtype">public</span> :: <a class="code" href="namespacebaroclinic__inst__mod.html#a983116490ea6a60625d49db92a533c59">binst_init_state</a>, <a class="code" href="namespacebaroclinic__inst__mod.html#a687c122d95eb3e5ea70e19b467ffb10c">jw_baroclinic</a></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160; </div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160; </div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160; </div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="keyword">contains</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160; </div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160; </div>
<div class="line"><a name="l00057"></a><span class="lineno"><a class="line" href="namespacebaroclinic__inst__mod.html#a687c122d95eb3e5ea70e19b467ffb10c">   57</a></span>&#160;<span class="keyword">subroutine </span><a class="code" href="namespacebaroclinic__inst__mod.html#a687c122d95eb3e5ea70e19b467ffb10c">jw_baroclinic</a>(elem,hybrid,hvcoord,nets,nete)</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="comment">!=======================================================================================================!</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    <span class="keywordtype">type</span>(<a class="code" href="structelement__mod_1_1element__t.html">element_t</a>), <span class="keywordtype">intent(inout)</span> :: elem(:)</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    <span class="keywordtype">type</span> (<a class="code" href="structhybvcoord__mod_1_1hvcoord__t.html">hvcoord_t</a>)                  :: hvcoord</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    <span class="keywordtype">type</span> (<a class="code" href="structhybrid__mod_1_1hybrid__t.html">hybrid_t</a>), <span class="keywordtype">intent(in)</span> :: hybrid</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    <span class="keywordtype">integer</span> :: nets,nete</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="comment">!=======================================================================================================!</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="keywordtype">    real</span> (kind=<a class="code" href="namespacekinds.html#abddc5e60584151b4d48b02e6436330f3">real_kind</a>)  :: tbar(<a class="code" href="namespacedimensions__mod.html#a6baa218e1683465acc4f37fcea8e30d5">nlev</a>)     </div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="keywordtype">    real</span> (kind=<a class="code" href="namespacekinds.html#abddc5e60584151b4d48b02e6436330f3">real_kind</a>) ::  eta(<a class="code" href="namespacedimensions__mod.html#a6baa218e1683465acc4f37fcea8e30d5">nlev</a>), etv(<a class="code" href="namespacedimensions__mod.html#a6baa218e1683465acc4f37fcea8e30d5">nlev</a>)</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="keywordtype">    real</span> (kind=<a class="code" href="namespacekinds.html#abddc5e60584151b4d48b02e6436330f3">real_kind</a>) ::  latc, lonc, rr,rc,  aa, lat,lon, snlat, cslat , v1,v2 </div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="keywordtype">    real</span> (kind=<a class="code" href="namespacekinds.html#abddc5e60584151b4d48b02e6436330f3">real_kind</a>) ::  trm1,trm2,trm3,trm4, term</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    <span class="keywordtype">integer</span> :: tl,i,j,k,ie, idex</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="comment">!=======================================================================================================!</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="keywordtype">   real</span> (kind=<a class="code" href="namespacekinds.html#abddc5e60584151b4d48b02e6436330f3">real_kind</a>),  <span class="keywordtype">parameter</span>  :: u0 = 35.0d0        <span class="comment">! Zonal Mean wind </span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="keywordtype">   real</span> (kind=<a class="code" href="namespacekinds.html#abddc5e60584151b4d48b02e6436330f3">real_kind</a>),  <span class="keywordtype">parameter</span>  :: t0 = 288.0d0       <span class="comment">! Mean temp</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="keywordtype">   real</span> (kind=<a class="code" href="namespacekinds.html#abddc5e60584151b4d48b02e6436330f3">real_kind</a>),  <span class="keywordtype">parameter</span>  :: gama = 0.005d0     <span class="comment">! Lapse rate</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="comment">!     Nair implementation was using r_d = 287.0D0, c_p = 1004.64D0</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="comment">!     which is slightly different than Rgas and Cp.  should not matter</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="comment">!   real (kind=real_kind),  parameter  :: r_d = 287.0D0      ! Gas const (dry)</span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="comment">!   real (kind=real_kind),  parameter  :: c_p = 1004.64D0    ! Cp        </span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="comment">!   real (kind=real_kind),  parameter  :: grv = 9.80616D0    ! Gravity   </span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="comment">!   real (kind=real_kind),  parameter  :: omg = 7.29212D-05  ! Omega     </span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="comment">!   real (kind=real_kind),  parameter  :: erad = 6.371229D06 ! Earth radius</span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="keywordtype">   real</span> (kind=<a class="code" href="namespacekinds.html#abddc5e60584151b4d48b02e6436330f3">real_kind</a>),  <span class="keywordtype">parameter</span>  :: ddt = 4.8d05       <span class="comment">! Temp  gradient </span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="keywordtype">   real</span> (kind=<a class="code" href="namespacekinds.html#abddc5e60584151b4d48b02e6436330f3">real_kind</a>),  <span class="keywordtype">parameter</span>  :: eta_t  = 0.2d0     <span class="comment">! eta level </span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="keywordtype">   real</span> (kind=<a class="code" href="namespacekinds.html#abddc5e60584151b4d48b02e6436330f3">real_kind</a>),  <span class="keywordtype">parameter</span>  :: eta_s  = 1.0d0     <span class="comment">! eta level </span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="keywordtype">   real</span> (kind=<a class="code" href="namespacekinds.html#abddc5e60584151b4d48b02e6436330f3">real_kind</a>),  <span class="keywordtype">parameter</span>  :: eta_0  = 0.252d0   <span class="comment">! eta level </span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160; </div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="keywordtype">   real</span> (kind=<a class="code" href="namespacekinds.html#abddc5e60584151b4d48b02e6436330f3">real_kind</a>) :: r_d,omg,grv,erad</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160; </div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="keywordtype">   real</span>(kind=<a class="code" href="namespacekinds.html#abddc5e60584151b4d48b02e6436330f3">real_kind</a>) :: var3d(<a class="code" href="namespacedimensions__mod.html#a8648e26ae0e474ccf69d32a8148520c9">np</a>,<a class="code" href="namespacedimensions__mod.html#a8648e26ae0e474ccf69d32a8148520c9">np</a>,<a class="code" href="namespacedimensions__mod.html#a6baa218e1683465acc4f37fcea8e30d5">nlev</a>,nets:nete)</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="keywordtype">   real</span>(kind=<a class="code" href="namespacekinds.html#abddc5e60584151b4d48b02e6436330f3">real_kind</a>) :: temperature(<a class="code" href="namespacedimensions__mod.html#a8648e26ae0e474ccf69d32a8148520c9">np</a>,<a class="code" href="namespacedimensions__mod.html#a8648e26ae0e474ccf69d32a8148520c9">np</a>,<a class="code" href="namespacedimensions__mod.html#a6baa218e1683465acc4f37fcea8e30d5">nlev</a>),ps(<a class="code" href="namespacedimensions__mod.html#a8648e26ae0e474ccf69d32a8148520c9">np</a>,<a class="code" href="namespacedimensions__mod.html#a8648e26ae0e474ccf69d32a8148520c9">np</a>)</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160; </div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;   <span class="keywordflow">if</span> (hybrid%masterthread) <span class="keyword">write</span>(<a class="code" href="namespacekinds.html#af49f799ffc0bd030b587fb57de97d162">iulog</a>,*) <span class="stringliteral">&#39;initializing Jablonowski and Williamson baroclinic instability test V1&#39;</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160; </div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="comment">!      Call eta_levels(ak,bk,eta,etai)</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="comment">!          interfaces   p(k) = hyai(k)*ps0 + hybi(k)*ps</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="comment">!          midpoints    p(k) = hyam(k)*ps0 + hybm(k)*ps</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="comment">!          etai = hyai(k)+hybi(k)</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="comment">!          etam = hyam(k)+hybm(k)</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160; </div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="comment">! Note: for this test case, at t=0, ps0=ps=1000 mb.  </span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="comment">! so p = (a(k)+b(k)), OR  p = eta ps   and eta = sigma = p/ps</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="comment">! (code is using mb for surface pressure?  )</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="comment">!  </span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;      r_d = <a class="code" href="namespacephysical__constants.html#a69f714bc9b76972dfccc59b88524efd3">rgas</a></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;      omg=<a class="code" href="namespacephysical__constants.html#ac5250a6d5a30592be8eef149e57894fa">omega</a></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;      erad=<a class="code" href="namespacephysical__constants.html#ab0f67c26417296baa8f3b876c001ff99">rearth</a></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;      grv=<a class="code" href="namespacephysical__constants.html#adf45737a6626ac54e4f0e4d83a69e839">g</a></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160; </div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160; </div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160; </div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;       <span class="keywordflow">do</span> k = 1, <a class="code" href="namespacedimensions__mod.html#a6baa218e1683465acc4f37fcea8e30d5">nlev</a></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;          eta(k) = hvcoord%etam(k)</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;          etv(k) = (eta(k) - eta_0) * <a class="code" href="namespacephysical__constants.html#a0db9fd87afb6b6822d7817592fcb4634">dd_pi</a> * 0.5d0 </div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="keywordflow">       end do</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;       </div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;       latc = <a class="code" href="namespacephysical__constants.html#a0db9fd87afb6b6822d7817592fcb4634">dd_pi</a> * (2.0d0/9.0d0) </div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;       lonc = <a class="code" href="namespacephysical__constants.html#a0db9fd87afb6b6822d7817592fcb4634">dd_pi</a> * (1.0d0/9.0d0) </div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160; </div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160; </div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="keywordflow">do</span> ie=nets,nete</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160; </div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    <span class="comment">! initial velocity       </span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    <span class="keywordflow">do</span> k=1, <a class="code" href="namespacedimensions__mod.html#a6baa218e1683465acc4f37fcea8e30d5">nlev</a> </div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;       <span class="keywordflow">do</span> j=1,<a class="code" href="namespacedimensions__mod.html#a8648e26ae0e474ccf69d32a8148520c9">np</a></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;          <span class="keywordflow">do</span> i=1,<a class="code" href="namespacedimensions__mod.html#a8648e26ae0e474ccf69d32a8148520c9">np</a></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160; </div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;          lon = elem(ie)%spherep(i,j)%lon</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;          lat = elem(ie)%spherep(i,j)%lat</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;          snlat=sin(lat)</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;          cslat=cos(lat)</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160; </div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160; </div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;          aa = sin(latc)*snlat + cos(latc)*cslat*cos(lon - lonc) </div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;          rc =  10.0d0  * acos(aa)</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;          v1 = u0 * (cos(etv(k)))**1.5d0 * (sin(2.0d0 * lat))**2  +  <a class="code" href="namespacecontrol__mod.html#a168fccf9923f508ba4ac441a049d08cf">u_perturb</a>*exp(-rc*rc) </div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;          elem(ie)%state%v(i,j,1,k,:)=v1</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;          elem(ie)%state%v(i,j,2,k,:)=0</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160; </div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;<span class="keywordflow">          end do</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="keywordflow">       end do</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160; </div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160; <span class="comment">! Layer-mean Temperature fields </span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160; </div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;   <span class="keywordflow">do</span> k = 1, <a class="code" href="namespacedimensions__mod.html#a6baa218e1683465acc4f37fcea8e30d5">nlev</a></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    <span class="keywordflow">if</span> (eta(k) &lt;= eta_t) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;       tbar(k) = t0 * eta(k)**(r_d*gama/grv) + ddt * (eta_t - eta(k))**5 </div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    <span class="keywordflow">else</span> </div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;       tbar(k) = t0 * eta(k)**(r_d*gama/grv)</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="keywordflow">    endif</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="keywordflow">   end do</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160; </div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160; </div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    <span class="keywordflow">do</span> k=1,<a class="code" href="namespacedimensions__mod.html#a6baa218e1683465acc4f37fcea8e30d5">nlev</a></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;       <span class="keywordflow">do</span> j=1,<a class="code" href="namespacedimensions__mod.html#a8648e26ae0e474ccf69d32a8148520c9">np</a></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;          <span class="keywordflow">do</span> i=1,<a class="code" href="namespacedimensions__mod.html#a8648e26ae0e474ccf69d32a8148520c9">np</a></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;             lon = elem(ie)%spherep(i,j)%lon</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;             lat = elem(ie)%spherep(i,j)%lat</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160; </div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;             snlat=sin(lat)</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;             cslat=cos(lat)</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160; </div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;             trm1 = 0.75d0 * (eta(k) * <a class="code" href="namespacephysical__constants.html#a0db9fd87afb6b6822d7817592fcb4634">dd_pi</a>*u0 /r_d) * sin(etv(k)) *sqrt(cos(etv(k)))</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;             trm2 = -2.0d0 *snlat**6 *(cslat**2 + 1.0d0/3.0d0) + 10.0d0/63.0d0 </div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;             trm3 =  2.0d0 * u0* (cos(etv(k)))**1.5d0</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;             trm4 = (1.60d0 *cslat**3 *(snlat**2 + 2.0d0/3.0d0) - <a class="code" href="namespacephysical__constants.html#a0db9fd87afb6b6822d7817592fcb4634">dd_pi</a> *0.25d0)* erad*omg</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160; </div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;             temperature(i,j,k) = tbar(k) + trm1 *(trm2 * trm3 + trm4 )</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160; </div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;<span class="keywordflow">          end do</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;<span class="keywordflow">       end do</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160; <span class="comment">!Surface geopotential</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160; </div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    <span class="keywordflow">do</span> j=1,<a class="code" href="namespacedimensions__mod.html#a8648e26ae0e474ccf69d32a8148520c9">np</a></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;       <span class="keywordflow">do</span> i=1,<a class="code" href="namespacedimensions__mod.html#a8648e26ae0e474ccf69d32a8148520c9">np</a></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;          lon = elem(ie)%spherep(i,j)%lon</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;          lat = elem(ie)%spherep(i,j)%lat</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;          snlat=sin(lat)</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;          cslat=cos(lat)</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160; </div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;          trm1 =  u0* ( cos((eta_s - eta_0)*<a class="code" href="namespacephysical__constants.html#a0db9fd87afb6b6822d7817592fcb4634">dd_pi</a>*0.5d0) )**1.5d0</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160; </div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;          trm2 = -2.0d0 *snlat**6 *(cslat**2 + 1.0d0/3.0d0) + 10.0d0/63.0d0 </div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;          trm3 = (1.60d0 *cslat**3 *(snlat**2 + 2.0d0/3.0d0) - <a class="code" href="namespacephysical__constants.html#a0db9fd87afb6b6822d7817592fcb4634">dd_pi</a> *0.25d0)* erad*omg</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160; </div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;          elem(ie)%state%phis(i,j) = trm1 *(trm2 * trm1 + trm3) </div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;          elem(ie)%state%ps_v(i,j,:) = <a class="code" href="namespacephysical__constants.html#a723576dfdca03ef9e1ac67040270bf37">p0</a></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;<span class="keywordflow">       end do</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    ps=<a class="code" href="namespacephysical__constants.html#a723576dfdca03ef9e1ac67040270bf37">p0</a></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    <span class="keyword">call </span><a class="code" href="namespaceelement__ops.html#a7fa9079971e0009efbe82ad383b660ad">set_thermostate</a>(elem(ie),ps,temperature,hvcoord)</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160; </div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;<span class="preprocessor">#ifdef MODEL_THETA_L</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;<span class="preprocessor"></span>    elem(ie)%state%w_i = 0.0</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;<span class="preprocessor"></span><span class="keywordflow">enddo</span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160; </div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160; </div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<span class="comment">! initialize passive tracers.  just for testing.  </span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<span class="comment">! first tracer:  temperature at T=0</span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160; </div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;<span class="keywordflow">if</span> (<a class="code" href="namespacedimensions__mod.html#a0070848a40ac48379601d9a8a183c83b">qsize</a>&gt;=1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;   <span class="keywordflow">do</span> idex=1,<a class="code" href="namespacedimensions__mod.html#a0070848a40ac48379601d9a8a183c83b">qsize</a></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;   <span class="keywordflow">do</span> ie=nets,nete</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;      <span class="keyword">call </span><a class="code" href="namespaceelement__ops.html#a51c2a4b1d47e6b6f29432c0b7b790ca0">get_field</a>(elem(ie),<span class="stringliteral">&#39;temperature&#39;</span>,temperature,hvcoord,1,1)</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;      <span class="comment">!do tl=1,3</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;      <span class="keywordflow">do</span> tl=1,1</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;         elem(ie)%state%Q(:,:,:,idex) = temperature(:,:,:)/400</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="keywordflow">      enddo</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;<span class="keywordflow">   enddo</span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;<span class="keywordflow">   enddo</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;<span class="keywordflow">endif</span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160; </div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;<span class="comment">! vorticity -2e-5 .. 2e-5</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;<span class="comment">! total tracer mass is close to zero since Q is positive and negative</span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;<span class="comment">! so lets take truncated values to test qneg fixer</span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;<span class="keywordflow">if</span> (<a class="code" href="namespacedimensions__mod.html#a0070848a40ac48379601d9a8a183c83b">qsize</a>&gt;=2) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;   idex=2 <span class="comment">! prevents a compiler warning when qsize&lt;2</span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;   <span class="keyword">call </span>compute_zeta_c0(var3d,elem,hybrid,nets,nete,1)</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;   <span class="keywordflow">do</span> ie=nets,nete</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;      <span class="comment">!do tl=1,3</span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;      <span class="keywordflow">do</span> tl=1,1</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;         <span class="keywordflow">do</span> k=1,<a class="code" href="namespacedimensions__mod.html#a6baa218e1683465acc4f37fcea8e30d5">nlev</a></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;         <span class="keywordflow">do</span> j=1,<a class="code" href="namespacedimensions__mod.html#a8648e26ae0e474ccf69d32a8148520c9">np</a></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;         <span class="keywordflow">do</span> i=1,<a class="code" href="namespacedimensions__mod.html#a8648e26ae0e474ccf69d32a8148520c9">np</a></div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;            elem(ie)%state%Q(i,j,k,idex) = var3d(i,j,k,ie)/2e-5</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;            <span class="keywordflow">if</span> (var3d(i,j,k,ie)&lt;0) elem(ie)%state%Q(i,j,k,idex)=0</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;<span class="keywordflow">         enddo</span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;<span class="keywordflow">         enddo</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;<span class="keywordflow">         enddo</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;<span class="keywordflow">      enddo</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;<span class="keywordflow">   enddo</span></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;<span class="keywordflow">endif</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160; </div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160; </div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;<span class="comment">! third tracer is constant</span></div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;<span class="keywordflow">if</span> (<a class="code" href="namespacedimensions__mod.html#a0070848a40ac48379601d9a8a183c83b">qsize</a>&gt;=3) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;   idex=3</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;   <span class="keywordflow">do</span> ie=nets,nete</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;      elem(ie)%state%Q(:,:,:,idex) = 1.0d0</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;<span class="keywordflow">   enddo</span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;<span class="keywordflow">endif</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160; </div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160; </div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;<span class="comment">! if we run a test case with 10 tracers, assume we want to reproduce the AVEC benchmarks</span></div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;<span class="comment">! using SJ&#39;s test tracers:</span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;<span class="comment">! tracers can be discontinous at element edges due to roundoff</span></div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;<span class="comment">! need to DSS the initial condition</span></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;<span class="keywordflow">if</span> (<a class="code" href="namespacedimensions__mod.html#a0070848a40ac48379601d9a8a183c83b">qsize</a>==10) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;   <span class="keywordflow">do</span> ie=nets,nete</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;      <span class="keywordflow">do</span> j=1,<a class="code" href="namespacedimensions__mod.html#a8648e26ae0e474ccf69d32a8148520c9">np</a></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;      <span class="keywordflow">do</span> i=1,<a class="code" href="namespacedimensions__mod.html#a8648e26ae0e474ccf69d32a8148520c9">np</a></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;         term = sin(9.*elem(ie)%spherep(i,j)%lon)*sin(9.*elem(ie)%spherep(i,j)%lat)</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;         <span class="keywordflow">do</span> k=1,<a class="code" href="namespacedimensions__mod.html#a6baa218e1683465acc4f37fcea8e30d5">nlev</a></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;            <span class="keywordflow">if</span> ( term &lt; 0. ) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;               var3d(i,j,k,ie)=0</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;               var3d(i,j,k,ie)=1</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;<span class="keywordflow">            endif</span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;<span class="keywordflow">         enddo</span></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;<span class="keywordflow">      enddo</span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;<span class="keywordflow">      enddo</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;<span class="keywordflow">   enddo</span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;   <span class="keyword">call </span>make_c0(var3d,elem,hybrid,nets,nete)</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;   <span class="keywordflow">do</span> idex=1,<a class="code" href="namespacedimensions__mod.html#a0070848a40ac48379601d9a8a183c83b">qsize</a></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;   <span class="keywordflow">do</span> ie=nets,nete</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;      elem(ie)%state%Q(:,:,:,idex) = var3d(:,:,:,ie)</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;<span class="keywordflow">   enddo</span></div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;<span class="keywordflow">   enddo</span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;<span class="keywordflow">endif</span></div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160; </div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160; </div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;<span class="comment">!=======================================================================================================!</span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160; <span class="keyword">end subroutine </span></div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160; </div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160; </div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160; </div>
<div class="line"><a name="l00278"></a><span class="lineno"><a class="line" href="namespacebaroclinic__inst__mod.html#a983116490ea6a60625d49db92a533c59">  278</a></span>&#160;  <span class="keyword">subroutine </span><a class="code" href="namespacebaroclinic__inst__mod.html#a983116490ea6a60625d49db92a533c59">binst_init_state</a>(elem, hybrid,nets,nete,hvcoord)</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    <span class="keywordtype">type</span>(<a class="code" href="structelement__mod_1_1element__t.html">element_t</a>), <span class="keywordtype">intent(inout)</span> :: elem(:)</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span>   :: nets</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span>   :: nete</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    <span class="keywordtype">type</span> (<a class="code" href="structhybvcoord__mod_1_1hvcoord__t.html">hvcoord_t</a>), <span class="keywordtype">intent(in)</span> :: hvcoord</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    <span class="keywordtype">type</span> (<a class="code" href="structhybrid__mod_1_1hybrid__t.html">hybrid_t</a>), <span class="keywordtype">intent(in)</span> :: hybrid</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160; </div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    <span class="comment">! Local variables</span></div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160; </div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">parameter</span> :: nlat = 128</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160; </div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">parameter</span> :: nhl  = <a class="code" href="namespacedimensions__mod.html#a6baa218e1683465acc4f37fcea8e30d5">nlev</a>+1, nfl = <a class="code" href="namespacedimensions__mod.html#a6baa218e1683465acc4f37fcea8e30d5">nlev</a></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160; </div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    <span class="keywordtype">type</span> (<a class="code" href="structquadrature__mod_1_1quadrature__t.html">quadrature_t</a>) :: gs</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160; </div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;<span class="keywordtype">    real</span> (kind=<a class="code" href="namespacekinds.html#abddc5e60584151b4d48b02e6436330f3">real_kind</a>), <span class="keywordtype">dimension(nlat)</span> :: lat</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;<span class="keywordtype">    real</span> (kind=<a class="code" href="namespacekinds.html#abddc5e60584151b4d48b02e6436330f3">real_kind</a>), <span class="keywordtype">dimension(nlat)</span> :: wts</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;<span class="preprocessor">#if 1</span></div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;<span class="preprocessor"></span><span class="keywordtype">    real</span> (kind=<a class="code" href="namespacekinds.html#abddc5e60584151b4d48b02e6436330f3">real_kind</a>), <span class="keywordtype">parameter</span> :: href = 7.34d0</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;<span class="preprocessor"></span><span class="keywordtype">    real</span> (kind=<a class="code" href="namespacekinds.html#abddc5e60584151b4d48b02e6436330f3">real_kind</a>), <span class="keywordtype">parameter</span> :: href = 7.d0</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;<span class="preprocessor">#endif </span></div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;<span class="preprocessor"></span><span class="keywordtype">    real</span> (kind=<a class="code" href="namespacekinds.html#abddc5e60584151b4d48b02e6436330f3">real_kind</a>), <span class="keywordtype">parameter</span> :: hrgas = href/<a class="code" href="namespacephysical__constants.html#a69f714bc9b76972dfccc59b88524efd3">rgas</a></div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;<span class="keywordtype">    real</span> (kind=<a class="code" href="namespacekinds.html#abddc5e60584151b4d48b02e6436330f3">real_kind</a>), <span class="keywordtype">parameter</span> :: z0 = 22.d0</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;<span class="keywordtype">    real</span> (kind=<a class="code" href="namespacekinds.html#abddc5e60584151b4d48b02e6436330f3">real_kind</a>), <span class="keywordtype">parameter</span> :: z1 = 30.d0</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;<span class="keywordtype">    real</span> (kind=<a class="code" href="namespacekinds.html#abddc5e60584151b4d48b02e6436330f3">real_kind</a>), <span class="keywordtype">parameter</span> :: zd = 5.d0</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;<span class="keywordtype">    real</span> (kind=<a class="code" href="namespacekinds.html#abddc5e60584151b4d48b02e6436330f3">real_kind</a>), <span class="keywordtype">parameter</span> :: u0 = 50.d0</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;<span class="keywordtype">    real</span> (kind=<a class="code" href="namespacekinds.html#abddc5e60584151b4d48b02e6436330f3">real_kind</a>), <span class="keywordtype">parameter</span> :: sat0 = 288.15d0</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160; </div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;<span class="keywordtype">    real</span> (kind=<a class="code" href="namespacekinds.html#abddc5e60584151b4d48b02e6436330f3">real_kind</a>), <span class="keywordtype">dimension(nlat)</span>   :: mu, mufac, tp, ef</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;<span class="keywordtype">    real</span> (kind=<a class="code" href="namespacekinds.html#abddc5e60584151b4d48b02e6436330f3">real_kind</a>), <span class="keywordtype">dimension(nlat-1)</span> :: dmu</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;<span class="keywordtype">    real</span> (kind=<a class="code" href="namespacekinds.html#abddc5e60584151b4d48b02e6436330f3">real_kind</a>), <span class="keywordtype">dimension(nlat)</span> :: ufull, dtdphi</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;<span class="keywordtype">    real</span> (kind=<a class="code" href="namespacekinds.html#abddc5e60584151b4d48b02e6436330f3">real_kind</a>)                  :: t1(<a class="code" href="namespacedimensions__mod.html#a8648e26ae0e474ccf69d32a8148520c9">np</a>,<a class="code" href="namespacedimensions__mod.html#a8648e26ae0e474ccf69d32a8148520c9">np</a>,nets:nete,<a class="code" href="namespacedimensions__mod.html#a6baa218e1683465acc4f37fcea8e30d5">nlev</a>)</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;<span class="keywordtype">    real</span> (kind=<a class="code" href="namespacekinds.html#abddc5e60584151b4d48b02e6436330f3">real_kind</a>)                  :: temperature(<a class="code" href="namespacedimensions__mod.html#a8648e26ae0e474ccf69d32a8148520c9">np</a>,<a class="code" href="namespacedimensions__mod.html#a8648e26ae0e474ccf69d32a8148520c9">np</a>,<a class="code" href="namespacedimensions__mod.html#a6baa218e1683465acc4f37fcea8e30d5">nlev</a>),ps(<a class="code" href="namespacedimensions__mod.html#a8648e26ae0e474ccf69d32a8148520c9">np</a>,<a class="code" href="namespacedimensions__mod.html#a8648e26ae0e474ccf69d32a8148520c9">np</a>)</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;<span class="keywordtype">    real</span> (kind=<a class="code" href="namespacekinds.html#abddc5e60584151b4d48b02e6436330f3">real_kind</a>), <span class="keywordtype">dimension(nfl)</span> :: tfull, avg</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;<span class="keywordtype">    real</span> (kind=<a class="code" href="namespacekinds.html#abddc5e60584151b4d48b02e6436330f3">real_kind</a>) :: dlat</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;<span class="keywordtype">    real</span> (kind=<a class="code" href="namespacekinds.html#abddc5e60584151b4d48b02e6436330f3">real_kind</a>) :: z, fac</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;<span class="keywordtype">    real</span> (kind=<a class="code" href="namespacekinds.html#abddc5e60584151b4d48b02e6436330f3">real_kind</a>) :: tz, sz, fp, dudz, uf</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160; </div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;<span class="keywordtype">    real</span> (kind=<a class="code" href="namespacekinds.html#abddc5e60584151b4d48b02e6436330f3">real_kind</a>), <span class="keywordtype">dimension(nlev+1)</span> :: shalf, phalf</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;<span class="keywordtype">    real</span> (kind=<a class="code" href="namespacekinds.html#abddc5e60584151b4d48b02e6436330f3">real_kind</a>), <span class="keywordtype">dimension(nlev)</span>   :: sfull, pfull, zfull</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160; </div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;<span class="keywordtype">    real</span> (kind=<a class="code" href="namespacekinds.html#abddc5e60584151b4d48b02e6436330f3">real_kind</a>) :: v1, v2, sume, sumo</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;<span class="keywordtype">    real</span> (kind=<a class="code" href="namespacekinds.html#abddc5e60584151b4d48b02e6436330f3">real_kind</a>) :: latp,lonp</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;<span class="keywordtype">    real</span> (kind=<a class="code" href="namespacekinds.html#abddc5e60584151b4d48b02e6436330f3">real_kind</a>) :: tmp</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160; </div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    <span class="keywordtype">integer</span> :: ie,i,j,k,l,ip,jp,tl</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160; </div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    <span class="keywordflow">if</span> (hybrid%masterthread) <span class="keyword">write</span>(<a class="code" href="namespacekinds.html#af49f799ffc0bd030b587fb57de97d162">iulog</a>,*) <span class="stringliteral">&#39;initializing Jablonowski and Williamson ASP baroclinic instability test&#39;</span></div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160; </div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    <span class="keywordflow">do</span> k=1,nhl</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;<span class="preprocessor">#if 1</span></div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;<span class="preprocessor"></span>       shalf(k) = (k-1)*1.0d0/real(<a class="code" href="namespacedimensions__mod.html#a6baa218e1683465acc4f37fcea8e30d5">nlev</a>,kind=<a class="code" href="namespacekinds.html#abddc5e60584151b4d48b02e6436330f3">real_kind</a>)</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;<span class="preprocessor"></span>       shalf(k) = (k-1)*0.05d0</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;<span class="preprocessor"></span>       <span class="comment">!      phalf(k) = shalf(k) * hvcoord%ps0 * 100.D0</span></div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160; </div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    <span class="keywordflow">do</span> k=1,<a class="code" href="namespacedimensions__mod.html#a6baa218e1683465acc4f37fcea8e30d5">nlev</a></div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;       pfull(k) = hvcoord%hyam(k)*hvcoord%ps0 + hvcoord%hybm(k)*<a class="code" href="namespacephysical__constants.html#a723576dfdca03ef9e1ac67040270bf37">p0</a></div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;       zfull(k) = -href * log(pfull(k)/<a class="code" href="namespacephysical__constants.html#a723576dfdca03ef9e1ac67040270bf37">p0</a>)</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160; </div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    <span class="comment">!   sfull = ( shalf(2:nhl) + shalf(1:nhl-1) ) / 2.0D0</span></div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    <span class="comment">!   pfull = sfull * p0 * 100.D0</span></div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    <span class="comment">!   zfull = -href * log(sfull)</span></div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160; </div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    <span class="keywordflow">do</span> k=1,nfl</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;       <span class="keywordflow">if</span> ( zfull(k) &lt;= 11.d0 ) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;          tfull(k) = -6.5d0*zfull(k)</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;       <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( zfull(k) &lt;= 20.d0 ) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;          tfull(k) = -6.5d0*11.d0</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;       <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( zfull(k) &lt;= 32.d0 ) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;          tfull(k) = -6.5d0*11.d0+(zfull(k)-20.d0)</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;       <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( zfull(k) &lt;= 47.d0 ) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;          tfull(k) = -6.5d0*11.d0+(32.d0-20.d0)+2.8d0*(zfull(k)-32.d0)</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;       <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( zfull(k) &lt;= 51.d0 ) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;          tfull(k) = -6.5d0*11.d0+(32.d0-20.d0)+2.8d0*(47.d0-32.d0)</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;       <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( zfull(k) &lt;= 71.d0 ) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;          tfull(k) = -6.5d0*11.d0+(32.d0-20.d0)+2.8d0*(47.d0-32.d0)-2.8d0*(zfull(k)-51.d0)</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;       <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( zfull(k) &lt;= 80.d0 ) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;          tfull(k) = -6.5d0*11.d0+(32.d0-20.d0)+2.8d0*(47.d0-32.d0)-2.8d0*(71.d0-51.d0)- &amp;</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;               2.d0*(zfull(k)-71.d0)</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;       <span class="keywordflow">else</span></div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;<span class="preprocessor">#if 1</span></div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;<span class="preprocessor"></span>          tfull(k) = -6.5d0*11.d0+(32.d0-20.d0)+2.8d0*(47.d0-32.d0)-2.8d0*(71.d0-51.d0)- &amp;</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;               2.d0*(84.852d0-71.d0)</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;<span class="preprocessor"></span>          tfull(k) = 1.0d+99       </div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;<span class="preprocessor"></span><span class="keywordflow">       end if</span></div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;       tfull(k) = tfull(k) + sat0</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160; </div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    gs = <a class="code" href="namespacequadrature__mod.html#aeab04095eea7662f234066f076e82a51">gauss</a>(nlat)</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160; </div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;    t1 = 0.d0</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    <span class="keywordflow">do</span> k=1,<a class="code" href="namespacedimensions__mod.html#a6baa218e1683465acc4f37fcea8e30d5">nlev</a></div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;       <span class="keywordflow">do</span> ie=nets,nete</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160; </div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;          z  = zfull(k)</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;          tz = tanh((z-z0)/zd)</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;          sz = 1.0d0/cosh((z-z0)/zd)</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;          fp = (-3.d0/10.d0) * (tz**2) * (sz**2) * sin(<a class="code" href="namespacephysical__constants.html#a0db9fd87afb6b6822d7817592fcb4634">dd_pi</a>*z/z1) + &amp;</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;               (<a class="code" href="namespacephysical__constants.html#a0db9fd87afb6b6822d7817592fcb4634">dd_pi</a>/60.d0) * (1.d0 - tz**3) * cos(<a class="code" href="namespacephysical__constants.html#a0db9fd87afb6b6822d7817592fcb4634">dd_pi</a>*z/z1)</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160; </div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;          <span class="keywordflow">do</span> j=1,<a class="code" href="namespacedimensions__mod.html#a8648e26ae0e474ccf69d32a8148520c9">np</a></div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;             <span class="keywordflow">do</span> i=1,<a class="code" href="namespacedimensions__mod.html#a8648e26ae0e474ccf69d32a8148520c9">np</a></div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160; </div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;                lonp = elem(ie)%spherep(i,j)%lon</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;                latp = elem(ie)%spherep(i,j)%lat</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160; </div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;                <span class="comment">! Gauss points and weights</span></div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160; </div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;                lat(:) = (latp+<a class="code" href="namespacephysical__constants.html#a0db9fd87afb6b6822d7817592fcb4634">dd_pi</a>*0.5d0)*0.5d0*gs%points(:) + (-<a class="code" href="namespacephysical__constants.html#a0db9fd87afb6b6822d7817592fcb4634">dd_pi</a>*0.5d0+latp)*0.5d0</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;                wts(:) = (latp+<a class="code" href="namespacephysical__constants.html#a0db9fd87afb6b6822d7817592fcb4634">dd_pi</a>*0.5d0)*0.5d0*gs%weights(:)</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160; </div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;                <span class="keywordflow">do</span> l=1,nlat</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;                   mu(l)   = sin(lat(l))</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;                   tp(l)   = tan(lat(l))</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;                   ef(l)   = 2.d0 * <a class="code" href="namespacephysical__constants.html#ac5250a6d5a30592be8eef149e57894fa">omega</a> * mu(l)</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;                   <span class="comment">!JMD The following expression was causing the IBM compiler to generate </span></div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;                   <span class="comment">!    bad code.  So I removed it... </span></div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;                   <span class="comment">!    mulfac(l) = (sin(DD_PI*mu(l)*mu(l)))**3</span></div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;                   tmp     = sin(<a class="code" href="namespacephysical__constants.html#a0db9fd87afb6b6822d7817592fcb4634">dd_pi</a>*mu(l)*mu(l))</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;                   mufac(l) = (tmp)**3</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160; </div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;                   fac = u0 * 0.5d0 * (1.d0-tanh((z-z0)/zd)**3) * sin(<a class="code" href="namespacephysical__constants.html#a0db9fd87afb6b6822d7817592fcb4634">dd_pi</a>*z/z1)</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;                   ufull(l) = fac * mufac(l)</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160; </div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;                   dudz = u0 * fp * mufac(l)</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;                   dtdphi(l) = -hrgas*(<a class="code" href="namespacephysical__constants.html#ab0f67c26417296baa8f3b876c001ff99">rearth</a>*ef(l)+2.d0*ufull(l)*tp(l))*dudz</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;                   <span class="keywordflow">if</span> ( mu(l) &lt; 0.0d0 ) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;                      dtdphi(l) = 0.0d0</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;<span class="keywordflow">                   end if</span></div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;<span class="keywordflow">                end do</span></div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160; </div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;                tmp = 0.d0 </div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;                <span class="keywordflow">do</span> l=1,nlat</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;                   tmp = tmp + wts(l)*dtdphi(l)</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;<span class="keywordflow">                end do</span></div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160; </div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;                t1(i,j,ie,k) = tmp</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160; </div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;<span class="keywordflow">             end do</span></div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;<span class="keywordflow">          end do</span></div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160; </div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;<span class="keywordflow">       end do</span></div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160; </div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;       avg(k) = real(<a class="code" href="namespaceglobal__norms__mod.html#aa60e7cee9b156c24445f02a0692107d2">global_integral</a>(elem, t1(:,:,nets:nete,k),hybrid,<a class="code" href="namespacedimensions__mod.html#a8648e26ae0e474ccf69d32a8148520c9">np</a>,nets,nete))</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160; </div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;    <span class="keywordflow">do</span> k=1,<a class="code" href="namespacedimensions__mod.html#a6baa218e1683465acc4f37fcea8e30d5">nlev</a></div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;       <span class="keywordflow">do</span> ie=nets,nete</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;          <span class="keywordflow">do</span> j=1,<a class="code" href="namespacedimensions__mod.html#a8648e26ae0e474ccf69d32a8148520c9">np</a></div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;             <span class="keywordflow">do</span> i=1,<a class="code" href="namespacedimensions__mod.html#a8648e26ae0e474ccf69d32a8148520c9">np</a></div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;                </div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;                lonp = elem(ie)%spherep(i,j)%lon</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;                latp = elem(ie)%spherep(i,j)%lat</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;                </div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;                t1(i,j,ie,k) = t1(i,j,ie,k) + tfull(k) - avg(k)</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;                </div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;                t1(i,j,ie,k)=t1(i,j,ie,k) + &amp;</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;                     1.d0/cosh(3.d0*(lonp-<a class="code" href="namespacephysical__constants.html#a0db9fd87afb6b6822d7817592fcb4634">dd_pi</a>*0.5d0))**2 * &amp;</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;                     1.d0/cosh(6.d0*(latp-<a class="code" href="namespacephysical__constants.html#a0db9fd87afb6b6822d7817592fcb4634">dd_pi</a>*0.25d0))**2</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;                </div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;<span class="keywordflow">             end do</span></div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;<span class="keywordflow">          end do</span></div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;<span class="keywordflow">       end do</span></div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160; </div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;    <span class="keywordflow">do</span> ie=nets,nete</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;       <span class="keywordflow">do</span> k=1,<a class="code" href="namespacedimensions__mod.html#a6baa218e1683465acc4f37fcea8e30d5">nlev</a></div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160; </div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;          z = zfull(k)</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160; </div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;          <span class="keywordflow">do</span> j=1,<a class="code" href="namespacedimensions__mod.html#a8648e26ae0e474ccf69d32a8148520c9">np</a></div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;             <span class="keywordflow">do</span> i=1,<a class="code" href="namespacedimensions__mod.html#a8648e26ae0e474ccf69d32a8148520c9">np</a></div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160; </div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;                lonp = elem(ie)%spherep(i,j)%lon</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;                latp = elem(ie)%spherep(i,j)%lat</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160; </div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;                fac = u0 * 0.5d0 * (1.d0-tanh((z-z0)/zd)**3) * sin(<a class="code" href="namespacephysical__constants.html#a0db9fd87afb6b6822d7817592fcb4634">dd_pi</a>*z/z1)</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;                tmp = sin(<a class="code" href="namespacephysical__constants.html#a0db9fd87afb6b6822d7817592fcb4634">dd_pi</a>*sin(latp)*sin(latp))</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;                v1 = fac * (tmp)**3</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;                <span class="keywordflow">if</span> (sin(latp) &lt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;                   v1 = 0.0d0</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;<span class="keywordflow">                end if</span></div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160; </div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;                v2 = 0.0d0</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160; </div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;                elem(ie)%state%v(i,j,1,k,1)= v1</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;                elem(ie)%state%v(i,j,2,k,1)= v2</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;<span class="keywordflow">             end do</span></div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;<span class="keywordflow">          end do</span></div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160; </div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;          <span class="keywordflow">do</span> tl=2,<a class="code" href="namespaceelement__state.html#ad600dbbab5d81bfc236df4786d322a10">timelevels</a></div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;             elem(ie)%state%v(:,:,:,k,tl)=elem(ie)%state%v(:,:,:,k,1)</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;<span class="keywordflow">          enddo</span></div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160; </div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;<span class="keywordflow">       end do</span></div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;    <span class="comment">! =======================================</span></div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;    <span class="comment">! Initialize Surface Geopotential</span></div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;    <span class="comment">! =======================================</span></div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160; </div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;    <span class="keywordflow">do</span> ie=nets,nete</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;       elem(ie)%state%phis(:,:) = 0.0d0</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;       elem(ie)%derived%fm = 0.0d0</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;       temperature(:,:,:)=t1(:,:,ie,:)</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;       ps=<a class="code" href="namespacephysical__constants.html#a723576dfdca03ef9e1ac67040270bf37">p0</a> </div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;       <span class="keyword">call </span><a class="code" href="namespaceelement__ops.html#a7fa9079971e0009efbe82ad383b660ad">set_thermostate</a>(elem(ie),ps,temperature,hvcoord)</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160; </div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160; </div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;  <span class="keyword">end subroutine </span><a class="code" href="namespacebaroclinic__inst__mod.html#a983116490ea6a60625d49db92a533c59">binst_init_state</a></div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160; </div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160; </div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160; </div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160; </div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160; </div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;<span class="keyword">end module </span><a class="code" href="namespacebaroclinic__inst__mod.html">baroclinic_inst_mod</a></div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160; </div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160; </div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160; </div>
<div class="ttc" id="anamespacebaroclinic__inst__mod_html"><div class="ttname"><a href="namespacebaroclinic__inst__mod.html">baroclinic_inst_mod</a></div><div class="ttdef"><b>Definition:</b> <a href="baroclinic__inst__mod_8_f90_source.html#l00014">baroclinic_inst_mod.F90:14</a></div></div>
<div class="ttc" id="anamespacebaroclinic__inst__mod_html_a687c122d95eb3e5ea70e19b467ffb10c"><div class="ttname"><a href="namespacebaroclinic__inst__mod.html#a687c122d95eb3e5ea70e19b467ffb10c">baroclinic_inst_mod::jw_baroclinic</a></div><div class="ttdeci">subroutine, public jw_baroclinic(elem, hybrid, hvcoord, nets, nete)</div><div class="ttdef"><b>Definition:</b> <a href="baroclinic__inst__mod_8_f90_source.html#l00057">baroclinic_inst_mod.F90:58</a></div></div>
<div class="ttc" id="anamespacebaroclinic__inst__mod_html_a983116490ea6a60625d49db92a533c59"><div class="ttname"><a href="namespacebaroclinic__inst__mod.html#a983116490ea6a60625d49db92a533c59">baroclinic_inst_mod::binst_init_state</a></div><div class="ttdeci">subroutine, public binst_init_state(elem, hybrid, nets, nete, hvcoord)</div><div class="ttdef"><b>Definition:</b> <a href="baroclinic__inst__mod_8_f90_source.html#l00278">baroclinic_inst_mod.F90:279</a></div></div>
<div class="ttc" id="anamespacecontrol__mod_html"><div class="ttname"><a href="namespacecontrol__mod.html">control_mod</a></div><div class="ttdef"><b>Definition:</b> <a href="control__mod_8_f90_source.html#l00008">control_mod.F90:8</a></div></div>
<div class="ttc" id="anamespacecontrol__mod_html_a168fccf9923f508ba4ac441a049d08cf"><div class="ttname"><a href="namespacecontrol__mod.html#a168fccf9923f508ba4ac441a049d08cf">control_mod::u_perturb</a></div><div class="ttdeci">real(kind=real_kind), public u_perturb</div><div class="ttdef"><b>Definition:</b> <a href="control__mod_8_f90_source.html#l00218">control_mod.F90:218</a></div></div>
<div class="ttc" id="anamespacecontrol__mod_html_a1c2d69b8f71e9a957a5b180477a751e4"><div class="ttname"><a href="namespacecontrol__mod.html#a1c2d69b8f71e9a957a5b180477a751e4">control_mod::test_case</a></div><div class="ttdeci">character(len=max_string_len), public test_case</div><div class="ttdef"><b>Definition:</b> <a href="control__mod_8_f90_source.html#l00114">control_mod.F90:114</a></div></div>
<div class="ttc" id="anamespacecontrol__mod_html_a9a6f4129394969bdffe333ae2e3b4990"><div class="ttname"><a href="namespacecontrol__mod.html#a9a6f4129394969bdffe333ae2e3b4990">control_mod::integration</a></div><div class="ttdeci">character(len=max_string_len), public integration</div><div class="ttdef"><b>Definition:</b> <a href="control__mod_8_f90_source.html#l00016">control_mod.F90:16</a></div></div>
<div class="ttc" id="anamespacecoordinate__systems__mod_html"><div class="ttname"><a href="namespacecoordinate__systems__mod.html">coordinate_systems_mod</a></div><div class="ttdef"><b>Definition:</b> <a href="coordinate__systems__mod_8_f90_source.html#l00005">coordinate_systems_mod.F90:5</a></div></div>
<div class="ttc" id="anamespacedimensions__mod_html"><div class="ttname"><a href="namespacedimensions__mod.html">dimensions_mod</a></div><div class="ttdef"><b>Definition:</b> <a href="dimensions__mod_8_f90_source.html#l00005">dimensions_mod.F90:5</a></div></div>
<div class="ttc" id="anamespacedimensions__mod_html_a0070848a40ac48379601d9a8a183c83b"><div class="ttname"><a href="namespacedimensions__mod.html#a0070848a40ac48379601d9a8a183c83b">dimensions_mod::qsize</a></div><div class="ttdeci">integer, public qsize</div><div class="ttdef"><b>Definition:</b> <a href="dimensions__mod_8_f90_source.html#l00026">dimensions_mod.F90:26</a></div></div>
<div class="ttc" id="anamespacedimensions__mod_html_a6baa218e1683465acc4f37fcea8e30d5"><div class="ttname"><a href="namespacedimensions__mod.html#a6baa218e1683465acc4f37fcea8e30d5">dimensions_mod::nlev</a></div><div class="ttdeci">integer, parameter, public nlev</div><div class="ttdef"><b>Definition:</b> <a href="dimensions__mod_8_f90_source.html#l00029">dimensions_mod.F90:29</a></div></div>
<div class="ttc" id="anamespacedimensions__mod_html_a8648e26ae0e474ccf69d32a8148520c9"><div class="ttname"><a href="namespacedimensions__mod.html#a8648e26ae0e474ccf69d32a8148520c9">dimensions_mod::np</a></div><div class="ttdeci">integer, parameter, public np</div><div class="ttdef"><b>Definition:</b> <a href="dimensions__mod_8_f90_source.html#l00023">dimensions_mod.F90:23</a></div></div>
<div class="ttc" id="anamespaceelement__mod_html"><div class="ttname"><a href="namespaceelement__mod.html">element_mod</a></div><div class="ttdef"><b>Definition:</b> <a href="element__mod_8_f90_source.html#l00005">element_mod.F90:5</a></div></div>
<div class="ttc" id="anamespaceelement__ops_html"><div class="ttname"><a href="namespaceelement__ops.html">element_ops</a></div><div class="ttdef"><b>Definition:</b> <a href="preqx_2share_2element__ops_8_f90_source.html#l00015">element_ops.F90:15</a></div></div>
<div class="ttc" id="anamespaceelement__ops_html_a51c2a4b1d47e6b6f29432c0b7b790ca0"><div class="ttname"><a href="namespaceelement__ops.html#a51c2a4b1d47e6b6f29432c0b7b790ca0">element_ops::get_field</a></div><div class="ttdeci">recursive subroutine get_field(elem, name, field, hvcoord, nt, ntQ)</div><div class="ttdef"><b>Definition:</b> <a href="preqx_2share_2element__ops_8_f90_source.html#l00035">element_ops.F90:36</a></div></div>
<div class="ttc" id="anamespaceelement__ops_html_a7fa9079971e0009efbe82ad383b660ad"><div class="ttname"><a href="namespaceelement__ops.html#a7fa9079971e0009efbe82ad383b660ad">element_ops::set_thermostate</a></div><div class="ttdeci">subroutine set_thermostate(elem, ps, temperature, hvcoord)</div><div class="ttdef"><b>Definition:</b> <a href="preqx_2share_2element__ops_8_f90_source.html#l00239">element_ops.F90:240</a></div></div>
<div class="ttc" id="anamespaceelement__state_html"><div class="ttname"><a href="namespaceelement__state.html">element_state</a></div><div class="ttdef"><b>Definition:</b> <a href="preqx_2element__state_8_f90_source.html#l00005">element_state.F90:5</a></div></div>
<div class="ttc" id="anamespaceelement__state_html_ad600dbbab5d81bfc236df4786d322a10"><div class="ttname"><a href="namespaceelement__state.html#ad600dbbab5d81bfc236df4786d322a10">element_state::timelevels</a></div><div class="ttdeci">integer, parameter, public timelevels</div><div class="ttdef"><b>Definition:</b> <a href="preqx_2element__state_8_f90_source.html#l00012">element_state.F90:12</a></div></div>
<div class="ttc" id="anamespaceglobal__norms__mod_html"><div class="ttname"><a href="namespaceglobal__norms__mod.html">global_norms_mod</a></div><div class="ttdef"><b>Definition:</b> <a href="global__norms__mod_8_f90_source.html#l00005">global_norms_mod.F90:5</a></div></div>
<div class="ttc" id="anamespaceglobal__norms__mod_html_aa60e7cee9b156c24445f02a0692107d2"><div class="ttname"><a href="namespaceglobal__norms__mod.html#aa60e7cee9b156c24445f02a0692107d2">global_norms_mod::global_integral</a></div><div class="ttdeci">real(kind=real_kind) function, public global_integral(elem, h, hybrid, npts, nets, nete)</div><div class="ttdef"><b>Definition:</b> <a href="global__norms__mod_8_f90_source.html#l00041">global_norms_mod.F90:42</a></div></div>
<div class="ttc" id="anamespacehybrid__mod_html"><div class="ttname"><a href="namespacehybrid__mod.html">hybrid_mod</a></div><div class="ttdef"><b>Definition:</b> <a href="hybrid__mod_8_f90_source.html#l00010">hybrid_mod.F90:10</a></div></div>
<div class="ttc" id="anamespacehybvcoord__mod_html"><div class="ttname"><a href="namespacehybvcoord__mod.html">hybvcoord_mod</a></div><div class="ttdef"><b>Definition:</b> <a href="hybvcoord__mod_8_f90_source.html#l00005">hybvcoord_mod.F90:5</a></div></div>
<div class="ttc" id="anamespacekinds_html"><div class="ttname"><a href="namespacekinds.html">kinds</a></div><div class="ttdef"><b>Definition:</b> <a href="kinds_8_f90_source.html#l00005">kinds.F90:5</a></div></div>
<div class="ttc" id="anamespacekinds_html_abddc5e60584151b4d48b02e6436330f3"><div class="ttname"><a href="namespacekinds.html#abddc5e60584151b4d48b02e6436330f3">kinds::real_kind</a></div><div class="ttdeci">integer(kind=4), parameter, public real_kind</div><div class="ttdef"><b>Definition:</b> <a href="kinds_8_f90_source.html#l00027">kinds.F90:27</a></div></div>
<div class="ttc" id="anamespacekinds_html_af49f799ffc0bd030b587fb57de97d162"><div class="ttname"><a href="namespacekinds.html#af49f799ffc0bd030b587fb57de97d162">kinds::iulog</a></div><div class="ttdeci">integer(kind=4), parameter, public iulog</div><div class="ttdef"><b>Definition:</b> <a href="kinds_8_f90_source.html#l00027">kinds.F90:27</a></div></div>
<div class="ttc" id="anamespacephysical__constants_html"><div class="ttname"><a href="namespacephysical__constants.html">physical_constants</a></div><div class="ttdef"><b>Definition:</b> <a href="physical__constants_8_f90_source.html#l00008">physical_constants.F90:8</a></div></div>
<div class="ttc" id="anamespacephysical__constants_html_a0db9fd87afb6b6822d7817592fcb4634"><div class="ttname"><a href="namespacephysical__constants.html#a0db9fd87afb6b6822d7817592fcb4634">physical_constants::dd_pi</a></div><div class="ttdeci">real(kind=real_kind), parameter, public dd_pi</div><div class="ttdef"><b>Definition:</b> <a href="physical__constants_8_f90_source.html#l00056">physical_constants.F90:56</a></div></div>
<div class="ttc" id="anamespacephysical__constants_html_a69f714bc9b76972dfccc59b88524efd3"><div class="ttname"><a href="namespacephysical__constants.html#a69f714bc9b76972dfccc59b88524efd3">physical_constants::rgas</a></div><div class="ttdeci">real(kind=real_kind), parameter, public rgas</div><div class="ttdef"><b>Definition:</b> <a href="physical__constants_8_f90_source.html#l00064">physical_constants.F90:64</a></div></div>
<div class="ttc" id="anamespacephysical__constants_html_a723576dfdca03ef9e1ac67040270bf37"><div class="ttname"><a href="namespacephysical__constants.html#a723576dfdca03ef9e1ac67040270bf37">physical_constants::p0</a></div><div class="ttdeci">real(kind=real_kind), parameter, public p0</div><div class="ttdef"><b>Definition:</b> <a href="physical__constants_8_f90_source.html#l00066">physical_constants.F90:66</a></div></div>
<div class="ttc" id="anamespacephysical__constants_html_a9e383c954fc7f7ee936c4848b91194a3"><div class="ttname"><a href="namespacephysical__constants.html#a9e383c954fc7f7ee936c4848b91194a3">physical_constants::cp</a></div><div class="ttdeci">real(kind=real_kind), parameter, public cp</div><div class="ttdef"><b>Definition:</b> <a href="physical__constants_8_f90_source.html#l00065">physical_constants.F90:65</a></div></div>
<div class="ttc" id="anamespacephysical__constants_html_ab0f67c26417296baa8f3b876c001ff99"><div class="ttname"><a href="namespacephysical__constants.html#ab0f67c26417296baa8f3b876c001ff99">physical_constants::rearth</a></div><div class="ttdeci">real(kind=real_kind), public rearth</div><div class="ttdef"><b>Definition:</b> <a href="physical__constants_8_f90_source.html#l00059">physical_constants.F90:59</a></div></div>
<div class="ttc" id="anamespacephysical__constants_html_ac5250a6d5a30592be8eef149e57894fa"><div class="ttname"><a href="namespacephysical__constants.html#ac5250a6d5a30592be8eef149e57894fa">physical_constants::omega</a></div><div class="ttdeci">real(kind=real_kind), public omega</div><div class="ttdef"><b>Definition:</b> <a href="physical__constants_8_f90_source.html#l00063">physical_constants.F90:63</a></div></div>
<div class="ttc" id="anamespacephysical__constants_html_adf45737a6626ac54e4f0e4d83a69e839"><div class="ttname"><a href="namespacephysical__constants.html#adf45737a6626ac54e4f0e4d83a69e839">physical_constants::g</a></div><div class="ttdeci">real(kind=real_kind), parameter, public g</div><div class="ttdef"><b>Definition:</b> <a href="physical__constants_8_f90_source.html#l00060">physical_constants.F90:60</a></div></div>
<div class="ttc" id="anamespacequadrature__mod_html"><div class="ttname"><a href="namespacequadrature__mod.html">quadrature_mod</a></div><div class="ttdef"><b>Definition:</b> <a href="quadrature__mod_8_f90_source.html#l00007">quadrature_mod.F90:7</a></div></div>
<div class="ttc" id="anamespacequadrature__mod_html_aeab04095eea7662f234066f076e82a51"><div class="ttname"><a href="namespacequadrature__mod.html#aeab04095eea7662f234066f076e82a51">quadrature_mod::gauss</a></div><div class="ttdeci">type(quadrature_t) function, public gauss(npts)</div><div class="ttdef"><b>Definition:</b> <a href="quadrature__mod_8_f90_source.html#l00047">quadrature_mod.F90:48</a></div></div>
<div class="ttc" id="anamespaceviscosity__mod_html"><div class="ttname"><a href="namespaceviscosity__mod.html">viscosity_mod</a></div><div class="ttdef"><b>Definition:</b> <a href="preqx_2viscosity__mod_8_f90_source.html#l00005">viscosity_mod.F90:5</a></div></div>
<div class="ttc" id="astructcoordinate__systems__mod_1_1spherical__polar__t_html"><div class="ttname"><a href="structcoordinate__systems__mod_1_1spherical__polar__t.html">coordinate_systems_mod::spherical_polar_t</a></div><div class="ttdef"><b>Definition:</b> <a href="coordinate__systems__mod_8_f90_source.html#l00028">coordinate_systems_mod.F90:28</a></div></div>
<div class="ttc" id="astructelement__mod_1_1element__t_html"><div class="ttname"><a href="structelement__mod_1_1element__t.html">element_mod::element_t</a></div><div class="ttdef"><b>Definition:</b> <a href="element__mod_8_f90_source.html#l00032">element_mod.F90:32</a></div></div>
<div class="ttc" id="astructhybrid__mod_1_1hybrid__t_html"><div class="ttname"><a href="structhybrid__mod_1_1hybrid__t.html">hybrid_mod::hybrid_t</a></div><div class="ttdef"><b>Definition:</b> <a href="hybrid__mod_8_f90_source.html#l00015">hybrid_mod.F90:15</a></div></div>
<div class="ttc" id="astructhybvcoord__mod_1_1hvcoord__t_html"><div class="ttname"><a href="structhybvcoord__mod_1_1hvcoord__t.html">hybvcoord_mod::hvcoord_t</a></div><div class="ttdef"><b>Definition:</b> <a href="hybvcoord__mod_8_f90_source.html#l00019">hybvcoord_mod.F90:19</a></div></div>
<div class="ttc" id="astructquadrature__mod_1_1quadrature__t_html"><div class="ttname"><a href="structquadrature__mod_1_1quadrature__t.html">quadrature_mod::quadrature_t</a></div><div class="ttdef"><b>Definition:</b> <a href="quadrature__mod_8_f90_source.html#l00012">quadrature_mod.F90:12</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_270697e8d592d2b7e889b4467e9ce43f.html">test_src</a></li><li class="navelem"><a class="el" href="baroclinic__inst__mod_8_f90.html">baroclinic_inst_mod.F90</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
